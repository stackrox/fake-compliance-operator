{
  "apiVersion": "v1",
  "items": [
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Service accounts tokens should not be mounted in pods except where the workload running in the pod explicitly needs to communicate with the API server. To ensure pods do not automatically mount tokens, set automountServiceAccountToken to false.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_restrict_service_account_tokens",
      "instructions": "For each pod in the cluster, review the pod specification and\nensure that pods that do not need to explicitly communicate with\nthe API server have automountServiceAccountToken\nconfigured to false.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-4,ocp4-pci-dss,ocp4-cis,ocp4-high-rev-4,ocp4-moderate,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "accounts-restrict-service-account-tokens",
          "control.compliance.openshift.io/CIS-OCP": "5.1.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.1.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-accounts-restrict-service-account-tokens",
        "namespace": "openshift-compliance",
        "resourceVersion": "76235",
        "uid": "dc3e5ffb-2a7c-414f-bfd3-fd22a265052b"
      },
      "rationale": "Mounting service account tokens inside pods can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster.",
      "severity": "medium",
      "title": "Restrict Automounting of Service Account Tokens"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Using the default service account prevents accurate application rights review and audit tracing. Instead of default , create a new and unique service account with the following command:\n\n$ oc create sa service_account_name\n\nwhere service_account_name is the name of a service account that is needed in the project namespace.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_unique_service_account",
      "instructions": "For each namespace in the cluster, review the rights assigned\nto the default service account. There should be no cluster or local roles\nassigned to the default other than the defaults.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis,ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "accounts-unique-service-account",
          "control.compliance.openshift.io/CIS-OCP": "5.1.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.1.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-accounts-unique-service-account",
        "namespace": "openshift-compliance",
        "resourceVersion": "76238",
        "uid": "08b63212-03f7-4d49-8fed-351316c0ad9e"
      },
      "rationale": "Kubernetes provides a default service account which is used by cluster workloads where no specific service account is assigned to the pod. Where access to the Kubernetes API from a pod is required, a specific service account should be created for that pod, and rights granted to that service account. This increases auditability of service account rights and access making it easier and more accurate to trace potential malicious behaviors to a specific service account and project.",
      "severity": "medium",
      "title": "Ensure Usage of Unique Service Accounts "
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "In OpenShift Container Platform, an alert is fired when the conditions defined in an alerting rule are true. An alert provides a notification that a set of circumstances are apparent within a cluster. Firing alerts can be viewed in the Alerting UI in the OpenShift Container Platform web console by default. After an installation, you can configure OpenShift Container Platform to send alert notifications to external systems so that designate personnel can be alerted in real time. OpenShift provides multiple alert receivers integrations to send realtime alerts to different services such as email, slack, pagerduty, webhooks, etc. [1][2] [1]https://docs.openshift.com/container-platform/latest/post_installation_configuration/configuring-alert-notifications.html#configuring-alert-receivers_configuring-alert-notifications [2]https://docs.openshift.com/container-platform/latest/monitoring/managing-alerts.html#applying-custom-alertmanager-configuration_managing-alerts",
      "id": "xccdf_org.ssgproject.content_rule_alert_receiver_configured",
      "instructions": "Run the following command to see if alert receiver has been configured to send alerts to a organizational defined external system:\n$ oc -n openshift-monitoring get secret alertmanager-main -ojson | jq '.data.\"alertmanager.yaml\"' -r | base64 --decode\nMake sure that alert receiver has configured to send alerts to at least one real time external notification system.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "alert-receiver-configured",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(2)",
          "policies.open-cluster-management.io/controls": "AU-5(2)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-alert-receiver-configured",
        "namespace": "openshift-compliance",
        "resourceVersion": "76496",
        "uid": "4cffc83b-71f4-4d3b-af1c-ebeff57340ec"
      },
      "rationale": "Alerts are a critical part of the OpenShift Container Platform. Proper configuration of receiver is required so that alerts can be sent to external systems in real-time to notify users of potential issues.",
      "severity": "medium",
      "title": "Ensure the alert receiver is configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure OpenShift only responses to requests explicitly allowed by the admission control plugin. Check that the config ConfigMap object does not contain the AlwaysAdmit plugin.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_alwaysadmit",
      "instructions": "To verify that the AlwaysAdmit admission control plugin is not set, run the following command:\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"'\nThe output should not contain AlwaysAdmit",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-pci-dss,ocp4-high,ocp4-moderate-rev-4,ocp4-cis,ocp4-pci-dss-3-2,ocp4-cis-1-5",
          "compliance.openshift.io/rule": "api-server-admission-control-plugin-alwaysadmit",
          "control.compliance.openshift.io/CIS-OCP": "1.2.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-admission-control-plugin-alwaysadmit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76240",
        "uid": "0c8ebd17-1eb9-46c2-a4d1-2cdcd46a184c"
      },
      "rationale": "Enabling the admission control plugin AlwaysAdmit allows all requests and does not provide any filtering.",
      "severity": "medium",
      "title": "Disable the AlwaysAdmit Admission Control Plugin"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The AlwaysPullImages admission control plugin should be disabled, since it can introduce new failure modes for control plane components if an image registry is unreachable.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_alwayspullimages",
      "instructions": "Run the following command:\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"'\nThe output list should not contain \"AlwaysPullImages\".",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-5,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-high,ocp4-high-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-stig,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-cis",
          "compliance.openshift.io/rule": "api-server-admission-control-plugin-alwayspullimages",
          "control.compliance.openshift.io/CIS-OCP": "1.2.11",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.11",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-admission-control-plugin-alwayspullimages",
        "namespace": "openshift-compliance",
        "resourceVersion": "76246",
        "uid": "f6c1b4f1-4153-4589-b316-53f38260c9c6"
      },
      "rationale": "Setting admission control policy to AlwaysPullImages forces every new pod to pull the required images every time. In a multi-tenant cluster users can be assured that their private images can only be used by those who have the credentials to pull them. Without this admission control policy, once an image has been pulled to a node, any pod from any user can use it simply by knowing the image’s name, without any authorization check against the image ownership. When this plug-in is enabled, images are always pulled prior to starting containers, which means valid credentials are required. However, turning on this admission plugin can introduce new kinds of cluster failure modes. OpenShift 4 master and infrastructure components are deployed as pods. Enabling this feature can result in cases where loss of contact to an image registry can cause a redeployed infrastructure pod (oauth-server for example) to fail on an image pull for an image that is currently present on the node. We use PullIfNotPresent so that a loss of image registry access does not prevent the pod from starting. If it becomes PullAlways, then an image registry access outage can cause key infrastructure components to fail. The pull policy can be managed per container, using imagePullPolicy.",
      "severity": "high",
      "title": "Ensure that the Admission Control Plugin AlwaysPullImages is not set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift enables the NamespaceLifecycle plugin by default.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_namespacelifecycle",
      "instructions": "To verify that the NamespaceLifecycle plugin is enabled in\nthe apiserver configuration, run:\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-pci-dss-3-2,ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-high-rev-4,ocp4-high,ocp4-cis-1-4,ocp4-cis",
          "compliance.openshift.io/rule": "api-server-admission-control-plugin-namespacelifecycle",
          "control.compliance.openshift.io/CIS-OCP": "1.2.13",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.13",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-admission-control-plugin-namespacelifecycle",
        "namespace": "openshift-compliance",
        "resourceVersion": "76251",
        "uid": "c0afa157-0129-4ec8-9704-1c80b2ed9b2e"
      },
      "rationale": "Setting admission control policy to NamespaceLifecycle ensures that objects cannot be created in non-existent namespaces, and that namespaces undergoing termination are not used for creating new objects. This is recommended to enforce the integrity of the namespace termination process and also for the availability of new objects.",
      "severity": "medium",
      "title": "Enable the NamespaceLifecycle Admission Control Plugin"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To limit the Node and Pod objects that a kubelet could modify, ensure that the NodeRestriction plugin on kubelets is enabled in the api-server configuration by running the following command:\n\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"'",
      "id": "xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_noderestriction",
      "instructions": "Ensure that the NodeRestriction plugin is enabled in the list of enabled plugins in\nthe apiserver configuration by running the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | grep 'NodeRestriction'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis,ocp4-stig-v1r1,ocp4-moderate,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss",
          "compliance.openshift.io/rule": "api-server-admission-control-plugin-noderestriction",
          "control.compliance.openshift.io/CIS-OCP": "1.2.15",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.15",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-admission-control-plugin-noderestriction",
        "namespace": "openshift-compliance",
        "resourceVersion": "76244",
        "uid": "960a3eef-1913-4c86-b26d-399dc82a1735"
      },
      "rationale": "Using the NodeRestriction plugin ensures that the kubelet is restricted to the Node and Pod objects that it could modify as defined. Such kubelets will only be allowed to modify their own Node API object, and only modify Pod API objects that are bound to their node.",
      "severity": "medium",
      "title": "Enable the NodeRestriction Admission Control Plugin"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure pod permissions are managed, make sure that the SecurityContextConstraint admission control plugin is used.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_scc",
      "instructions": "The SecurityContextConstraint plugin should be enabled in the list of enabled plugins in\nthe apiserver configuration:\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-cis-1-4,ocp4-high,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-cis",
          "compliance.openshift.io/rule": "api-server-admission-control-plugin-scc",
          "control.compliance.openshift.io/CIS-OCP": "1.2.14",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.14",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-admission-control-plugin-scc",
        "namespace": "openshift-compliance",
        "resourceVersion": "76254",
        "uid": "52e7a732-ce8c-4022-bfc4-c1f5d599e50d"
      },
      "rationale": "A Security Context Constraint is a cluster-level resource that controls the actions which a pod can perform and what the pod may access. The SecurityContextConstraint objects define a set of conditions that a pod must run with in order to be accepted into the system. Security Context Constraints are comprised of settings and strategies that control the security features a pod has access to and hence this must be used to control pod access permissions.",
      "severity": "medium",
      "title": "Enable the SecurityContextConstraint Admission Control Plugin"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Instead of using a customized SecurityContext for pods, a Pod Security Policy (PSP) or a SecurityContextConstraint should be used. These are cluster-level resources that control the actions that a pod can perform and what resource the pod may access. The SecurityContextDeny disallows folks from setting a pod's securityContext fields. Ensure that the list of admission controllers does not include SecurityContextDeny:\n\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"'",
      "id": "xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_securitycontextdeny",
      "instructions": "The SecurityContextDeny plugin should not be enabled in the list of enabled plugins in the apiserver configuration:\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "api-server-admission-control-plugin-securitycontextdeny",
          "control.compliance.openshift.io/CIS-OCP": "1.2.13",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.13",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-admission-control-plugin-securitycontextdeny",
        "namespace": "openshift-compliance",
        "resourceVersion": "76255",
        "uid": "3c9225dc-ea89-4e3c-bf2d-d649bcda46a0"
      },
      "rationale": "The SecurityContextDeny admission control plugin disallows setting any security options for your pods. SecurityContextConstraints allow you to enforce RBAC rules on who can set these options on the pods, and what they're allowed to set. Thus, using the SecurityContextDeny will deter you from enforcing granular permissions on your pods.",
      "severity": "medium",
      "title": "Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure ServiceAccount objects must be created and granted before pod creation is allowed, follow the documentation and create ServiceAccount objects as per your environment. Ensure that the plugin is enabled in the api-server configuration:\n\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"'",
      "id": "xccdf_org.ssgproject.content_rule_api_server_admission_control_plugin_service_account",
      "instructions": "The ServiceAccount plugin should be enabled in the list of enabled plugins in\nthe apiserver configuration:\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '.data.\"config.yaml\"' | jq '.apiServerArguments.\"enable-admission-plugins\"'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-high,ocp4-cis-1-4,ocp4-cis,ocp4-stig-v1r1,ocp4-moderate,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "api-server-admission-control-plugin-service-account",
          "control.compliance.openshift.io/CIS-OCP": "1.2.12",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-admission-control-plugin-service-account",
        "namespace": "openshift-compliance",
        "resourceVersion": "76263",
        "uid": "3e3d3758-d224-4729-8757-05fcf99d2ae8"
      },
      "rationale": "When a pod is created, if a service account is not specified, the pod is automatically assigned the default service account in the same namespace. OpenShift operators should create unique service accounts and let the API Server manage its security tokens.",
      "severity": "medium",
      "title": "Enable the ServiceAccount Admission Control Plugin"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "By default, anonymous access to the OpenShift API is enabled, but at the same time, all requests must be authorized. If no authentication mechanism is used, the request is assigned the system:anonymous virtual user and the system:unauthenticated virtual group. This allows the authorization layer to determine which requests, if any, is an anonymous user authorized to make. To verify the authorization rules for anonymous requests run the following:\n\n$ oc describe clusterrolebindings\n\nand inspect the bindings of the system:anonymous virtual user and the system:unauthenticated virtual group. To test that an anonymous request is authorized to access the readyz endpoint, run:\n\n$ oc get --as=\"system:anonymous\" --raw='/readyz?verbose'\n\nIn contrast, a request to list all projects should not be authorized:\n\n$ oc get --as=\"system:anonymous\" projects",
      "id": "xccdf_org.ssgproject.content_rule_api_server_anonymous_auth",
      "instructions": "Run the following command to view the authorization rules for anonymous requests:\n$ oc describe clusterrolebindings\nMake sure that there exists at least one clusterrolebinding that binds\neither the system:unauthenticated group or the system:anonymous\nuser.\nTo test that an anonymous request is authorized to access the readyz\nendpoint, run:\n$ oc get --as=\"system:anonymous\" --raw='/readyz?verbose'\nIn contrast, a request to list all projects should not be authorized:\n$ oc get --as=\"system:anonymous\" projects",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-bsi-2022,ocp4-cis,ocp4-high-rev-4,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss-3-2,ocp4-stig,ocp4-bsi,ocp4-cis-1-5",
          "compliance.openshift.io/rule": "api-server-anonymous-auth",
          "control.compliance.openshift.io/CIS-OCP": "1.2.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-anonymous-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "76267",
        "uid": "b178b944-c552-45b1-a5cd-f639e678e369"
      },
      "rationale": "When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the API server. If you are using RBAC authorization, it is generally considered reasonable to allow anonymous access to the API Server for health checks and discovery purposes, and hence this recommendation is not scored. However, you should consider whether anonymous discovery is an acceptable risk for your purposes.",
      "severity": "medium",
      "title": "Ensure that anonymous requests to the API Server are authorized"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Using APIPriorityAndFairness feature provides a fine-grained way to control the behaviour of the Kubernetes API server in an overload situation. The well-known FlowSchema catch-all should be available to make sure that every request gets some kind of classification. By default, the catch-all priority level only allows one concurrency share and does not queue requests. To inspect all the FlowSchema objects, run:\n\noc get flowschema\n\nTo inspect the well-known catch-all object, run the following:\n\noc describe flowschema catch-all",
      "id": "xccdf_org.ssgproject.content_rule_api_server_api_priority_flowschema_catch_all",
      "instructions": "Run the following commands:\noc get flowschema\nand inspect the FlowSchema objects. Make sure that at least the catch-all\nobject exists by calling:\noc describe flowschema catch-all",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "api-server-api-priority-flowschema-catch-all",
          "control.compliance.openshift.io/CIS-OCP": "1.2.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-api-priority-flowschema-catch-all",
        "namespace": "openshift-compliance",
        "resourceVersion": "76268",
        "uid": "8381012c-e848-4602-81ab-1e68b1b630fa"
      },
      "rationale": "The FlowSchema API objects enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept.",
      "severity": "medium",
      "title": "Ensure catch-all FlowSchema object for API Priority and Fairness Exists"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To limit the rate at which the API Server accepts requests, make sure that the API Priority and Fairness feature is enabled. Using APIPriorityAndFairness feature provides a fine-grained way to control the behaviour of the Kubernetes API server in an overload situation. To enable the APIPriorityAndFairness feature gate, make sure that the feature-gates API server argument, typically set in the config configMap in the openshift-kube-apiserver namespace contains APIPriorityAndFairness=true. Note that since Kubernetes 1.20, this feature gate is enabled by default. As a result, this rule is only applicable to OpenShift releases prior to 4.7 which was the first OCP release to ship Kubernetes 1.20.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_api_priority_gate_enabled",
      "instructions": "To verify that APIPriorityAndFairness is enabled, run the following command:\noc get kubeapiservers.operator.openshift.io cluster -o json | jq '.spec.observedConfig.apiServerArguments[\"feature-gates\"]'\nThe output should contain \"APIPriorityAndFairness=true\"",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-pci-dss-3-2,ocp4-pci-dss,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-high,ocp4-stig-v1r1,ocp4-cis",
          "compliance.openshift.io/rule": "api-server-api-priority-gate-enabled",
          "control.compliance.openshift.io/CIS-OCP": "1.2.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-api-priority-gate-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76270",
        "uid": "f119a4ec-5f2b-4fa1-ae5e-30629d98bc40"
      },
      "rationale": "The APIPriorityAndFairness feature gate enables the use of the FlowSchema API objects which enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept.",
      "severity": "medium",
      "title": "Enable the APIPriorityAndFairness feature gate"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Using APIPriorityAndFairness feature provides a fine-grained way to control the behaviour of the Kubernetes API server in an overload situation. The well-known FlowSchema catch-all should be available to make sure that every request gets some kind of classification. By default, the catch-all priority level only allows one concurrency share and does not queue requests. To inspect all the FlowSchema objects, run:\n\noc get flowschema\n\nTo inspect the well-known catch-all object, run the following:\n\noc describe flowschema catch-all",
      "id": "xccdf_org.ssgproject.content_rule_api_server_api_priority_v1_flowschema_catch_all",
      "instructions": "Run the following commands:\noc get flowschema\nand inspect the FlowSchema objects. Make sure that at least the catch-all\nobject exists by calling:\noc describe flowschema catch-all",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "api-server-api-priority-v1-flowschema-catch-all",
          "control.compliance.openshift.io/CIS-OCP": "1.2.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-api-priority-v1-flowschema-catch-all",
        "namespace": "openshift-compliance",
        "resourceVersion": "76279",
        "uid": "258a6bc7-af8c-4811-969b-eb9a8df266ab"
      },
      "rationale": "The FlowSchema API objects enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept.",
      "severity": "medium",
      "title": "Ensure catch-all FlowSchema object for API Priority and Fairness Exists",
      "warning": "The FlowSchema API objects enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Using APIPriorityAndFairness feature provides a fine-grained way to control the behaviour of the Kubernetes API server in an overload situation. The well-known FlowSchema catch-all should be available to make sure that every request gets some kind of classification. By default, the catch-all priority level only allows one concurrency share and does not queue requests. To inspect all the FlowSchema objects, run:\n\noc get flowschema\n\nTo inspect the well-known catch-all object, run the following:\n\noc describe flowschema catch-all",
      "id": "xccdf_org.ssgproject.content_rule_api_server_api_priority_v1alpha1_flowschema_catch_all",
      "instructions": "Run the following commands:\noc get flowschema\nand inspect the FlowSchema objects. Make sure that at least the catch-all\nobject exists by calling:\noc describe flowschema catch-all",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "api-server-api-priority-v1alpha1-flowschema-catch-all",
          "control.compliance.openshift.io/CIS-OCP": "1.2.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-api-priority-v1alpha1-flowschema-catch-all",
        "namespace": "openshift-compliance",
        "resourceVersion": "76283",
        "uid": "3c391689-6477-4dda-ae52-d67a593bede9"
      },
      "rationale": "The FlowSchema API objects enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept.",
      "severity": "medium",
      "title": "Ensure catch-all FlowSchema object for API Priority and Fairness Exists (v1alpha1)",
      "warning": "The FlowSchema API objects enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Using APIPriorityAndFairness feature provides a fine-grained way to control the behaviour of the Kubernetes API server in an overload situation. The well-known FlowSchema catch-all should be available to make sure that every request gets some kind of classification. By default, the catch-all priority level only allows one concurrency share and does not queue requests. To inspect all the FlowSchema objects, run:\n\noc get flowschema\n\nTo inspect the well-known catch-all object, run the following:\n\noc describe flowschema catch-all",
      "id": "xccdf_org.ssgproject.content_rule_api_server_api_priority_v1beta1_flowschema_catch_all",
      "instructions": "Run the following commands:\noc get flowschema\nand inspect the FlowSchema objects. Make sure that at least the catch-all\nobject exists by calling:\noc describe flowschema catch-all",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "api-server-api-priority-v1beta1-flowschema-catch-all",
          "control.compliance.openshift.io/CIS-OCP": "1.2.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-api-priority-v1beta1-flowschema-catch-all",
        "namespace": "openshift-compliance",
        "resourceVersion": "76281",
        "uid": "f4100bd6-7997-4509-a695-1bc581f2e113"
      },
      "rationale": "The FlowSchema API objects enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept.",
      "severity": "medium",
      "title": "Ensure catch-all FlowSchema object for API Priority and Fairness Exists",
      "warning": "The FlowSchema API objects enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Using APIPriorityAndFairness feature provides a fine-grained way to control the behaviour of the Kubernetes API server in an overload situation. The well-known FlowSchema catch-all should be available to make sure that every request gets some kind of classification. By default, the catch-all priority level only allows one concurrency share and does not queue requests. To inspect all the FlowSchema objects, run:\n\noc get flowschema\n\nTo inspect the well-known catch-all object, run the following:\n\noc describe flowschema catch-all",
      "id": "xccdf_org.ssgproject.content_rule_api_server_api_priority_v1beta2_flowschema_catch_all",
      "instructions": "Run the following commands:\noc get flowschema\nand inspect the FlowSchema objects. Make sure that at least the catch-all\nobject exists by calling:\noc describe flowschema catch-all",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "api-server-api-priority-v1beta2-flowschema-catch-all",
          "control.compliance.openshift.io/CIS-OCP": "1.2.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-api-priority-v1beta2-flowschema-catch-all",
        "namespace": "openshift-compliance",
        "resourceVersion": "76280",
        "uid": "fe0487b0-0d1b-435c-9948-087468c6ea08"
      },
      "rationale": "The FlowSchema API objects enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept.",
      "severity": "medium",
      "title": "Ensure catch-all FlowSchema object for API Priority and Fairness Exists",
      "warning": "The FlowSchema API objects enforce a limit on the number of events that the API Server will accept in a given time slice In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. It is recommended to limit the rate of events that the API Server will accept."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To configure how many rotations of audit logs are retained, edit the openshift-kube-apiserver configmap and set the audit-log-maxbackup parameter to 10 or to an organizationally appropriate value:\n\n\"apiServerArguments\":{\n ...\n \"audit-log-maxbackup\": [10],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_audit_log_maxbackup",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"audit-log-maxbackup\"][0]'\nThe output should return a value of 10 or as appropriate.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-high",
          "compliance.openshift.io/rule": "api-server-audit-log-maxbackup",
          "control.compliance.openshift.io/CIS-OCP": "1.2.22",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.22",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-audit-log-maxbackup",
        "namespace": "openshift-compliance",
        "resourceVersion": "76284",
        "uid": "ab4a7613-c51a-48bb-8a49-2172b949c5fb"
      },
      "rationale": "OpenShift automatically rotates the log files. Retaining old log files ensures OpenShift Operators will have sufficient log data available for carrying out any investigation or correlation. For example, if the audit log size is set to 100 MB and the number of retained log files is set to 10, OpenShift Operators would have approximately 1 GB of log data to use during analysis.",
      "severity": "low",
      "title": "Configure the Kubernetes API Server Maximum Retained Audit Logs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To rotate audit logs upon reaching a maximum size, edit the openshift-kube-apiserver configmap and set the audit-log-maxsize parameter to an appropriate size in MB. For example, to set it to 100 MB:\n\n\"apiServerArguments\":{\n ...\n \"audit-log-maxsize\": [\"100\"],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_audit_log_maxsize",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"audit-log-maxsize\"]'\nThe output should return a value of [\"100\"] or as appropriate.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-5,ocp4-high,ocp4-cis,ocp4-stig-v1r1,ocp4-moderate,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "api-server-audit-log-maxsize",
          "control.compliance.openshift.io/CIS-OCP": "1.2.23",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.23",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-audit-log-maxsize",
        "namespace": "openshift-compliance",
        "resourceVersion": "76288",
        "uid": "9741b1d6-e050-4d01-830f-5fd3d82c52c6"
      },
      "rationale": "OpenShift automatically rotates log files. Retaining old log files ensures that OpenShift Operators have sufficient log data available for carrying out any investigation or correlation. If you have set file size of 100 MB and the number of old log files to keep as 10, there would be approximately 1 GB of log data available for use in analysis.",
      "severity": "medium",
      "title": "Configure Kubernetes API Server Maximum Audit Log Size"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To enable auditing on the Kubernetes API Server, the audit log path must be set. Edit the openshift-kube-apiserver configmap and set the audit-log-path to a suitable path and file where audit logs should be written. For example:\n\n\"apiServerArguments\":{\n ...\n \"audit-log-path\":\"/var/log/kube-apiserver/audit.log\",\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_audit_log_path",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"audit-log-path\"]'\nThe output should return a valid audit log path.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-cis,ocp4-pci-dss-3-2,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss,ocp4-cis-1-4,ocp4-cis-1-5,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "api-server-audit-log-path",
          "control.compliance.openshift.io/CIS-OCP": "1.2.20",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.20",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-audit-log-path",
        "namespace": "openshift-compliance",
        "resourceVersion": "76289",
        "uid": "c8c68fcd-ac09-4089-a9d0-57969a51c9fe"
      },
      "rationale": "Auditing of the Kubernetes API Server is not enabled by default. Auditing the API Server provides a security-relevant chronological set of records documenting the sequence of activities that have affected the system by users, administrators, or other system components.",
      "severity": "high",
      "title": "Configure the Audit Log Path"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Do not always authorize all requests.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_auth_mode_no_aa",
      "instructions": "To verify that the Node authorization mode is be configured and enabled in\nthe apiserver configuration, run:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | grep '\"authorization-mode\":\\[[^]]*\"AlwaysAllow\"'\nThe output should be empty - the \"authorization-mode\" list does NOT contain the \"AlwaysAllow\" authorizer.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-cis,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-high,ocp4-pci-dss,ocp4-moderate,ocp4-stig,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-cis-1-4",
          "compliance.openshift.io/rule": "api-server-auth-mode-no-aa",
          "control.compliance.openshift.io/CIS-OCP": "1.2.7",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-auth-mode-no-aa",
        "namespace": "openshift-compliance",
        "resourceVersion": "76291",
        "uid": "43227093-6c31-4e18-ac35-68f63c886c87"
      },
      "rationale": "The API Server, can be configured to allow all requests. This mode should not be used on any production cluster.",
      "severity": "medium",
      "title": "The authorization-mode cannot be AlwaysAllow"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Restrict kubelet nodes to reading only objects associated with them.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_auth_mode_node",
      "instructions": "To verify that Node authorization mode is enabled, run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | grep '\"authorization-mode\":\\[[^]]*\"Node\"'\nThe output should show that the \"authorization-mode\" list contains the \"Node\" authorizer.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-high-rev-4,ocp4-moderate,ocp4-stig",
          "compliance.openshift.io/rule": "api-server-auth-mode-node",
          "control.compliance.openshift.io/CIS-OCP": "1.2.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-auth-mode-node",
        "namespace": "openshift-compliance",
        "resourceVersion": "76296",
        "uid": "5f7e0c15-39dd-4d71-9b07-b6cc3471e6ec"
      },
      "rationale": "The Node authorization mode only allows kubelets to read Secret, ConfigMap, PersistentVolume, and PersistentVolumeClaim objects associated with their nodes.",
      "severity": "medium",
      "title": "Ensure authorization-mode Node is configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure OpenShift restricts different identities to a defined set of operations they are allowed to perform, check that the API server's authorization-mode configuration option list contains RBAC.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_auth_mode_rbac",
      "instructions": "To verify that RBAC authorization mode is enabled, run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | grep '\"authorization-mode\":\\[[^]]*\"RBAC\"'\nThe output should show that the \"authorization-mode\" list contains the \"RBAC\" authorizer.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-stig,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-pci-dss,ocp4-cis-1-4,ocp4-high,ocp4-moderate-rev-4,ocp4-cis,ocp4-moderate",
          "compliance.openshift.io/rule": "api-server-auth-mode-rbac",
          "control.compliance.openshift.io/CIS-OCP": "1.2.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-auth-mode-rbac",
        "namespace": "openshift-compliance",
        "resourceVersion": "76292",
        "uid": "503d0113-0e5f-4d01-8025-afc5342fdd5b"
      },
      "rationale": "Role Based Access Control (RBAC) allows fine-grained control over the operations that different entities can perform on different objects in the cluster. Enabling RBAC is critical in regulating access to an OpenShift cluster as the RBAC rules specify, given a user, which operations can be executed over a set of namespaced or cluster-wide resources.",
      "severity": "medium",
      "title": "Ensure authorization-mode RBAC is configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Basic Authentication should not be used for any reason. If needed, edit API Edit the openshift-kube-apiserver configmap and remove the basic-auth-file parameter:\n\n\"apiServerArguments\":{\n ...\n \"basic-auth-file\":[\n   \"/path/to/any/file\"\n ],\n ...\n\nAlternate authentication mechanisms such as tokens and certificates will need to be used. Username and password for basic authentication will be disabled.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_basic_auth",
      "instructions": "To verify that basic-auth-file is configured and enabled for the API server, run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"basic-auth-file\"]'\nThe output should be empty as OpenShift does not support basic authentication at all.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-stig,ocp4-cis-1-5,ocp4-high,ocp4-pci-dss,ocp4-high-rev-4,ocp4-cis,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "api-server-basic-auth",
          "control.compliance.openshift.io/CIS-OCP": "1.2.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-basic-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "76297",
        "uid": "d8c18158-9b48-4638-8ca2-23e9e1a2df48"
      },
      "rationale": "Basic authentication uses plaintext credentials for authentication. Currently the basic authentication credentials last indefinitely, and the password cannot be changed without restarting the API Server. The Basic Authentication is currently supported for convenience and is not intended for production workloads.",
      "severity": "medium",
      "title": "Disable basic-auth-file for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The bindAddress is set by default to 0.0.0.0:6443 , and listening with TLS enabled.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_bind_address",
      "instructions": "Run the following command:\noc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.servingInfo[\"bindAddress\"]'\nThe output should return 0.0.0.0:6443.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-cis,ocp4-high-rev-4,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-stig-v1r1,ocp4-pci-dss-3-2,ocp4-high,ocp4-cis-1-4,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "api-server-bind-address",
          "control.compliance.openshift.io/CIS-OCP": "1.2.18",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,Req-2.2.3,Req-2.3,1.2.18",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-bind-address",
        "namespace": "openshift-compliance",
        "resourceVersion": "76298",
        "uid": "77fd6d1d-1207-42c6-82fd-3d8c089bbb5c"
      },
      "rationale": "The OpenShift API server is served over HTTPS with authentication and authorization; the secure API endpoint is bound to 0.0.0.0:6443 by default. In OpenShift, the only supported way to access the API server pod is through the load balancer and then through the internal service. The value is set by the bindAddress argument under the servingInfo parameter.",
      "severity": "low",
      "title": "Ensure that the bindAddress is set to a relevant secure port"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Certificates must be provided to fully setup TLS client certificate authentication. To ensure the API Server utilizes its own TLS certificates, the clientCA must be configured. Verify that servingInfo has the clientCA configured in the openshift-kube-apiserver config configmap to something similar to:\n\n\"apiServerArguments\": {\n ...\n   \"client-ca-file\": [\n     \"/etc/kubernetes/static-pod-certs/configmaps/client-ca/ca-bundle.crt\"\n   ],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_client_ca",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"client-ca-file\"]'\nThe output should return a configured TLS CA certificate file.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis,ocp4-high-rev-4,ocp4-cis-1-5,ocp4-high,ocp4-moderate,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "api-server-client-ca",
          "control.compliance.openshift.io/CIS-OCP": "1.2.29",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-8,SC-8(1),SC-8(2),Req-2.2,Req-2.2.3,Req-2.3,1.2.29",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-client-ca",
        "namespace": "openshift-compliance",
        "resourceVersion": "76302",
        "uid": "1d9513ba-64c2-4371-b4d8-9fdbc7bb4146"
      },
      "rationale": "API Server communication contains sensitive parameters that should remain encrypted in transit. Configure the API Server to serve only HTTPS traffic. If -clientCA is set, any request presenting a client certificate signed by one of the authorities in the client-ca-file is authenticated with an identity corresponding to the CommonName of the client certificate.",
      "severity": "medium",
      "title": "Configure the Client Certificate Authority for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "config.openshift.io/v1",
            "kind": "APIServer",
            "metadata": {
              "name": "cluster"
            },
            "spec": {
              "encryption": {
                "type": "{{.var_apiserver_encryption_type}}"
              }
            }
          }
        }
      ],
      "checkType": "Platform",
      "description": "When you enable etcd encryption, the following OpenShift API server and Kubernetes API server resources are encrypted:\n\n* Secrets\n* ConfigMaps\n* Routes\n* OAuth access tokens\n* OAuth authorize tokens\n\nWhen you enable etcd encryption, encryption keys are created. These keys are rotated on a weekly basis. You must have these keys in order to restore from an etcd backup.\n\nTo ensure the correct cipher, set the encryption type aescbc in the apiserver object which configures the API server itself.\n\nspec:\n encryption:\n   type: aescbc\n\nFor more information, follow the relevant documentation ( https://docs.openshift.com/container-platform/latest/security/encrypting-etcd.html ).",
      "id": "xccdf_org.ssgproject.content_rule_api_server_encryption_provider_cipher",
      "instructions": "OpenShift supports encryption of data at rest of etcd datastore, but it is up to the\ncustomer to configure. The asecbc cipher is used. No other ciphers are supported. Keys\nare stored on the filesystem of the master and automatically rotated.\nRun the following command to review the Encrypted status condition for the OpenShift\nAPI server to verify that its resources were successfully encrypted:\n\n# encrypt the etcd datastore\n$ oc get openshiftapiserver -o=jsonpath='{range.items[0].status.conditions[?(@.type==\"Encrypted\")]}{.reason}{\"\\n\"}{.message}{\"\\n\"}'\n\nThe output shows EncryptionCompleted upon successful encryption.\nIf the output shows EncryptionInProgress this means that encryption is still in\nprogress. Wait a few minutes and try again.\nTo display the encryption configured, run the following command:\n$ oc get --raw /apis/config.openshift.io/v1/apiservers/cluster | jq [.spec.encryption.type] \nIf the output does not list aescbc, the encryption is not configured correctly.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-4,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-e8,ocp4-moderate,ocp4-stig,ocp4-cis-1-5,ocp4-pci-dss,ocp4-cis",
          "compliance.openshift.io/rule": "api-server-encryption-provider-cipher",
          "compliance.openshift.io/rule-variable": "var-apiserver-encryption-path,var-apiserver-encryption-filter",
          "control.compliance.openshift.io/CIS-OCP": "1.2.31;2.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2",
          "control.compliance.openshift.io/NIST-800-53": "SC-28;SC-28(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,SC-28,SC-28(1),Req-2.2,1.2.31,2.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-encryption-provider-cipher",
        "namespace": "openshift-compliance",
        "resourceVersion": "76303",
        "uid": "9306be35-e5b9-49a6-89f6-d60eaf12c5a8"
      },
      "rationale": "etcd is a highly available key-value store used by OpenShift deployments for persistent storage of all REST API objects. These objects are sensitive in nature and should be encrypted at rest to avoid any disclosures. Where etcd encryption is used, it is important to ensure that the appropriate set of encryption providers is used. Currently, aescbc is the only type supported by OCP.",
      "severity": "medium",
      "title": "Configure the Encryption Provider Cipher"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure etcd is configured to make use of TLS encryption for client connections, follow the OpenShift documentation and setup the TLS connection between the API Server and etcd. Then, verify that apiServerArguments has the etcd-cafile configured in the openshift-kube-apiserver config configmap to something similar to:\n\n\"apiServerArguments\": {\n ...\n   \"etcd-cafile\": [\n       \"/etc/kubernetes/static-pod-resources/configmaps/etcd-serving-ca/ca-bundle.crt\"\n   ],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_etcd_ca",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"etcd-cafile\"]'\nThe output should return a configured CA certificate for ETCD.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-pci-dss,ocp4-cis,ocp4-moderate,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-high",
          "compliance.openshift.io/rule": "api-server-etcd-ca",
          "control.compliance.openshift.io/CIS-OCP": "1.2.30",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-8,SC-8(1),SC-8(2),Req-2.2,Req-2.2.3,Req-2.3,1.2.30",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-etcd-ca",
        "namespace": "openshift-compliance",
        "resourceVersion": "76305",
        "uid": "768654c6-abe9-4d8c-8c03-cfa0e3b4bb57"
      },
      "rationale": "etcd is a highly-available key-value store used by OpenShift deployments for persistent storage of all REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API Server to identify itself to the etcd server using a SSL Certificate Authority file.",
      "severity": "medium",
      "title": "Configure the etcd Certificate Authority for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure etcd is configured to make use of TLS encryption for client communications, follow the OpenShift documentation and setup the TLS connection between the API Server and etcd. Then, verify that apiServerArguments has the etcd-certfile configured in the openshift-kube-apiserver configmap to something similar to:\n\n...\n\"etcd-certfile\": [\n   \"/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.crt\"\n],\n...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_etcd_cert",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments.\"etcd-certfile\"'\nThe output should return a configured certificate file.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-pci-dss,ocp4-cis-1-4,ocp4-cis,ocp4-moderate,ocp4-stig,ocp4-high,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "api-server-etcd-cert",
          "control.compliance.openshift.io/CIS-OCP": "1.2.27",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,1.2.27",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-etcd-cert",
        "namespace": "openshift-compliance",
        "resourceVersion": "76311",
        "uid": "7b0c72e4-f3ca-4f9d-a214-6e7cf5bb159e"
      },
      "rationale": "etcd is a highly-available key-value store used by OpenShift deployments for persistent storage of all REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API Server to identify itself to the etcd server using a client certificate and key.",
      "severity": "medium",
      "title": "Configure the etcd Certificate for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure etcd is configured to make use of TLS encryption for client communications, follow the OpenShift documentation and setup the TLS connection between the API Server and etcd. Then, verify that apiServerArguments has the etcd-keyfile configured in the openshift-kube-apiserver configmap to something similar to:\n\n...\n\"etcd-keyfile\": [\n   \"/etc/kubernetes/static-pod-resources/secrets/etcd-client/tls.key\"\n],\n...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_etcd_key",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments.\"etcd-keyfile\"'\nThe output should return a configured certificate key file.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-stig,ocp4-cis-1-5,ocp4-pci-dss,ocp4-high,ocp4-stig-v1r1,ocp4-cis,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "api-server-etcd-key",
          "control.compliance.openshift.io/CIS-OCP": "1.2.27",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,1.2.27",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-etcd-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "76316",
        "uid": "ce40a7b1-2fe4-488c-9fa0-cd2ea9d84978"
      },
      "rationale": "etcd is a highly-available key-value store used by OpenShift deployments for persistent storage of all REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API Server to identify itself to the etcd server using a client certificate and key.",
      "severity": "medium",
      "title": "Configure the etcd Certificate Key for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The kube-apiserver ensures https to the kubelet by default. The apiserver flag \"--kubelet-https\" is deprecated and should be either set to \"true\" or omitted from the argument list.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_https_for_kubelet_conn",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"kubelet-https\"]'\nThe output should return true, or no output at all.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-stig-v1r1,ocp4-cis,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-high",
          "compliance.openshift.io/rule": "api-server-https-for-kubelet-conn",
          "control.compliance.openshift.io/CIS-OCP": "1.2.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.3,1.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-https-for-kubelet-conn",
        "namespace": "openshift-compliance",
        "resourceVersion": "76313",
        "uid": "125788ea-871a-45d9-96ab-2e6607996aa3"
      },
      "rationale": "Connections from the kube-apiserver to kubelets could potentially carry sensitive data such as secrets and keys. It is thus important to use in-transit encryption for any communication between the apiserver and kubelets.",
      "severity": "medium",
      "title": "Ensure that the --kubelet-https argument is set to true"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift should not bind to non-loopback insecure addresses. Edit the openshift-kube-apiserver configmap and remove the insecure-bind-address if it exists:\n\n\"apiServerArguments\":{\n ...\n \"insecure-bind-address\":[\n   \"127.0.0.1\"\n ],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_insecure_bind_address",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"insecure-bind-address\"]'\nThe output should be empty.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-cis-1-5,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-stig,ocp4-pci-dss-3-2,ocp4-cis-1-4,ocp4-high,ocp4-high-rev-4,ocp4-cis,ocp4-moderate",
          "compliance.openshift.io/rule": "api-server-insecure-bind-address",
          "control.compliance.openshift.io/CIS-OCP": "1.2.16",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.16",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-insecure-bind-address",
        "namespace": "openshift-compliance",
        "resourceVersion": "76319",
        "uid": "11b987eb-cc50-4340-944d-94e8452faec8"
      },
      "rationale": "If the API Server is bound to an insecure address the installation would be susceptible to unauthenticated and unencrypted access to the master node(s). The API Server does not perform authentication checking for insecure binds and the traffic is generally not encrypted.",
      "severity": "medium",
      "title": "Disable Use of the Insecure Bind Address"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "By default, traffic for the OpenShift API server is served over HTTPS with authentication and authorization, and the secure API endpoint is bound to 0.0.0.0:8443. To ensure that the insecure port configuration has not been enabled, the insecure-port parameter should be set to 0. Edit the openshift-kube-apiserver configmap and change the insecure-port value to 0:\n\n\"apiServerArguments\":{\n ...\n \"insecure-port\":[\n   \"1234\"\n ],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_insecure_port",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"insecure-port\"]'\nThe output should return 0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis,ocp4-stig-v1r1,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-high,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "api-server-insecure-port",
          "control.compliance.openshift.io/CIS-OCP": "1.2.17",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,Req-2.3,1.2.17",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-insecure-port",
        "namespace": "openshift-compliance",
        "resourceVersion": "76318",
        "uid": "5372c538-c16a-4f83-8e9a-faaa3263649b"
      },
      "rationale": "Configuring the API Server on an insecure port would allow unauthenticated and unencrypted access to your master node(s). It is assumed firewall rules will be configured to ensure this port is not reachable from outside the cluster, however as a defense in depth measure, OpenShift should not be configured to use insecure ports.",
      "severity": "medium",
      "title": "Prevent Insecure Port Access"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure OpenShift verifies kubelet certificates before establishing connections, follow the OpenShift documentation and setup the TLS connection between the API Server and kubelets. Edit the openshift-kube-apiserver configmap and set the below parameter if it is not already configured:\n\n\"apiServerArguments\":{\n ...\n \"kubelet-certificate-authority\":\"/etc/kubernetes/static-pod-resources/configmaps/kubelet-serving-ca/ca-bundle.crt\",\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_kubelet_certificate_authority",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments.\"kubelet-certificate-authority\"'\nThe output should return a configured certificate.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-nerc-cip,ocp4-pci-dss,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high,ocp4-stig-v1r1,ocp4-cis,ocp4-moderate,ocp4-stig,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "api-server-kubelet-certificate-authority",
          "control.compliance.openshift.io/CIS-OCP": "1.2.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,1.2.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-kubelet-certificate-authority",
        "namespace": "openshift-compliance",
        "resourceVersion": "76331",
        "uid": "c8e519b2-8d6b-4439-a709-b6551158401b"
      },
      "rationale": "Connections from the API Server to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet port-forwarding functionality. These connections terminate at the kubelet HTTPS endpoint. By default, the API Server does not verify the kubelet serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks.",
      "severity": "high",
      "title": "Configure the kubelet Certificate Authority for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To enable certificate based kubelet authentication, edit the config configmap in the openshift-kube-apiserver namespace and set the below parameter in the config.yaml key if it is not already configured:\n\n\"apiServerArguments\":{\n...\n \"kubelet-client-certificate\":\"/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt\",\n...\n}",
      "id": "xccdf_org.ssgproject.content_rule_api_server_kubelet_client_cert",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"kubelet-client-certificate\"]'\nThe output should return /etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt\nor /etc/kubernetes/static-pod-certs/secrets/kubelet-client/tls.crt",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-4,ocp4-high,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis,ocp4-stig-v1r1,ocp4-stig,ocp4-high-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-nerc-cip",
          "compliance.openshift.io/rule": "api-server-kubelet-client-cert",
          "control.compliance.openshift.io/CIS-OCP": "1.2.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,1.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-kubelet-client-cert",
        "namespace": "openshift-compliance",
        "resourceVersion": "76337",
        "uid": "811097c5-ab8b-4bef-82b8-3b49691b924a"
      },
      "rationale": "By default the API Server does not authenticate itself to the kubelet's HTTPS endpoints. Requests from the API Server are treated anonymously. Configuring certificate-based kubelet authentication ensures that the API Server authenticates itself to kubelets when submitting requests.",
      "severity": "high",
      "title": "Configure the kubelet Certificate File for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To enable certificate based kubelet authentication, edit the config configmap in the openshift-kube-apiserver namespace and set the below parameter in the config.yaml key if it is not already configured:\n\n\"apiServerArguments\":{\n...\n \"kubelet-client-certificate\":\"/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt\",\n...\n}\n\nNote that this particular rule is only valid for OCP releases up to and\nincluding 4.8",
      "id": "xccdf_org.ssgproject.content_rule_api_server_kubelet_client_cert_pre_4_9",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"kubelet-client-certificate\"]'\nThe output should return /etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.crt",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high,ocp4-cis,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "api-server-kubelet-client-cert-pre-4-9",
          "control.compliance.openshift.io/CIS-OCP": "1.2.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "policies.open-cluster-management.io/controls": "CM-6,CM-6(1),SC-8,SC-8(1),1.2.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-kubelet-client-cert-pre-4-9",
        "namespace": "openshift-compliance",
        "resourceVersion": "76336",
        "uid": "3c14aad3-096b-44a7-be2a-cf580f7c3d0b"
      },
      "rationale": "By default the API Server does not authenticate itself to the kubelet's HTTPS endpoints. Requests from the API Server are treated anonymously. Configuring certificate-based kubelet authentication ensures that the API Server authenticates itself to kubelets when submitting requests.",
      "severity": "high",
      "title": "Configure the kubelet Certificate File for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To enable certificate based kubelet authentication, edit the config configmap in the openshift-kube-apiserver namespace and set the below parameter in the config.yaml key if it is not already configured:\n\n\"apiServerArguments\":{\n...\n \"kubelet-client-key\":\"/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key\",\n...\n}",
      "id": "xccdf_org.ssgproject.content_rule_api_server_kubelet_client_key",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"kubelet-client-key\"]'\nThe output should return /etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key\nor /etc/kubernetes/static-pod-certs/secrets/kubelet-client/tls.key",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-cis,ocp4-stig,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-high,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-cis-1-5,ocp4-pci-dss,ocp4-cis-1-4",
          "compliance.openshift.io/rule": "api-server-kubelet-client-key",
          "control.compliance.openshift.io/CIS-OCP": "1.2.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,1.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-kubelet-client-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "76340",
        "uid": "1fd59326-ae4b-449e-a929-af80a16e13bb"
      },
      "rationale": "By default the API Server does not authenticate itself to the kubelet's HTTPS endpoints. Requests from the API Server are treated anonymously. Configuring certificate-based kubelet authentication ensures that the API Server authenticates itself to kubelets when submitting requests.",
      "severity": "high",
      "title": "Configure the kubelet Certificate Key for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To enable certificate based kubelet authentication, edit the config configmap in the openshift-kube-apiserver namespace and set the below parameter in the config.yaml key if it is not already configured:\n\n\"apiServerArguments\":{\n...\n \"kubelet-client-key\":\"/etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key\",\n...\n}\n\nNote that this particular rule is only valid for OCP releases up to and\nincluding 4.8",
      "id": "xccdf_org.ssgproject.content_rule_api_server_kubelet_client_key_pre_4_9",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"kubelet-client-key\"]'\nThe output should return /etc/kubernetes/static-pod-resources/secrets/kubelet-client/tls.key",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-pci-dss,ocp4-cis-1-4,ocp4-stig-v1r1,ocp4-cis,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-cis-1-5",
          "compliance.openshift.io/rule": "api-server-kubelet-client-key-pre-4-9",
          "control.compliance.openshift.io/CIS-OCP": "1.2.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "policies.open-cluster-management.io/controls": "CM-6,CM-6(1),SC-8,SC-8(1),1.2.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-kubelet-client-key-pre-4-9",
        "namespace": "openshift-compliance",
        "resourceVersion": "76342",
        "uid": "9b8590b0-5407-4f8c-aa0d-bc190c2981de"
      },
      "rationale": "By default the API Server does not authenticate itself to the kubelet's HTTPS endpoints. Requests from the API Server are treated anonymously. Configuring certificate-based kubelet authentication ensures that the API Server authenticates itself to kubelets when submitting requests.",
      "severity": "high",
      "title": "Configure the kubelet Certificate Key for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To make sure none of them is explicitly disabled except PodSecurity, run the following command:\n\n$ oc -n openshift-kube-apiserver get configmap config -o json | jq -r '[.data.\"config.yaml\" | fromjson | .apiServerArguments | select(has(\"disable-admission-plugins\")) | if .\"disable-admission-plugins\" != [\"PodSecurity\"] then .\"disable-admission-plugins\" else empty end]'\n\nand make sure the output is empty.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_no_adm_ctrl_plugins_disabled",
      "instructions": "To verify that the list of disabled admission plugins is empty, run the following command:\n$oc -n openshift-kube-apiserver get configmap config -o json | jq -r '[.data.\"config.yaml\" | fromjson | .apiServerArguments | select(has(\"disable-admission-plugins\")) | if .\"disable-admission-plugins\" != [\"PodSecurity\"] then .\"disable-admission-plugins\" else empty end]'\nThere should be no output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "api-server-no-adm-ctrl-plugins-disabled",
          "control.compliance.openshift.io/CIS-OCP": "1.2.13;1.2.14;1.2.15;1.2.16;1.2.17",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.13,1.2.14,1.2.15,1.2.16,1.2.17",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-no-adm-ctrl-plugins-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76352",
        "uid": "173ef122-96d2-4399-b652-b876e976ae55"
      },
      "rationale": "Several hardening controls depend on certain API server admission plugins being enabled. Checking that no admission control plugins are disabled helps assert that all the critical admission control plugins are indeed enabled and providing the security benefits required.",
      "severity": "medium",
      "title": "Ensure all admission control plugins are enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "By default, the OpenShift OAuth API Server uses TLS. HTTPS should be used for connections between openshift-oauth-apiserver and kube-apiserver. By default, the OpenShift OAuth API Server uses Intermediate profile which requires a minimum TLS version of 1.2.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_oauth_https_serving_cert",
      "instructions": "Run the following command:\n$ oc get APIServer cluster -o yaml\nVerify that the tlsSecurityProfile is not type Old.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-cis,ocp4-moderate,ocp4-stig,ocp4-cis-1-5,ocp4-pci-dss,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "api-server-oauth-https-serving-cert",
          "control.compliance.openshift.io/CIS-OCP": "1.2.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,1.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-oauth-https-serving-cert",
        "namespace": "openshift-compliance",
        "resourceVersion": "76349",
        "uid": "69e8f12e-773c-4c99-8c8b-84722f70f0e3"
      },
      "rationale": "Connections between the kube-apiserver and the extension openshift-oauth-apiserver could potentially carry sensitive data such as secrets and keys. It is important to use in-transit encryption for any communication between the kube-apiserver and the extension openshift-apiserver.",
      "severity": "medium",
      "title": "Ensure the openshift-oauth-apiserver service uses TLS"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "By default, the OpenShift API Server uses TLS. HTTPS should be used for connections between openshift-apiserver and kube-apiserver. By default, the OpenShift OAuth API Server uses Intermediate profile which requires a minimum TLS version of 1.2.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_openshift_https_serving_cert",
      "instructions": "Run the following command:\n$ oc get APIServer cluster -o yaml\nVerify that the tlsSecurityProfile is not type Old.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-5,ocp4-high,ocp4-moderate-rev-4,ocp4-pci-dss,ocp4-stig-v1r1,ocp4-cis,ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-cis-1-4",
          "compliance.openshift.io/rule": "api-server-openshift-https-serving-cert",
          "control.compliance.openshift.io/CIS-OCP": "1.2.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,1.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-openshift-https-serving-cert",
        "namespace": "openshift-compliance",
        "resourceVersion": "76354",
        "uid": "32a2687d-ce6e-497b-bc2e-f541f4bd2b8d"
      },
      "rationale": "Connections between the kube-apiserver and the extension openshift-apiserver could potentially carry sensitive data such as secrets and keys. It is important to use in-transit encryption for any communication between the kube-apiserver and the extension openshift-apiserver.",
      "severity": "medium",
      "title": "Ensure the openshift-oauth-apiserver service uses TLS"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Ensure that the cluster-debugger cluster role includes the /metrics resource URL. This demonstrates that profiling is protected by RBAC, with a specific cluster role to allow access.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_profiling_protected_by_rbac",
      "instructions": "To verify that the cluster-debugger role is configured correctly,\nrun the following command:\n$ oc get clusterroles cluster-debugger -o jsonpath='{.rules[0].nonResourceURLs}'\nand verify that the /metrics path is included there.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis",
          "compliance.openshift.io/rule": "api-server-profiling-protected-by-rbac",
          "control.compliance.openshift.io/CIS-OCP": "1.2.19",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.19",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-profiling-protected-by-rbac",
        "namespace": "openshift-compliance",
        "resourceVersion": "76358",
        "uid": "634f76f8-7f38-4872-9a91-4fc3b87ba594"
      },
      "rationale": "Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. To ensure the collected data is not exploited, profiling endpoints are secured via RBAC (see cluster-debugger role). By default, the profiling endpoints are accessible only by users bound to cluster-admin or cluster-debugger role. Profiling can not be disabled.",
      "severity": "medium",
      "title": "Profiling is protected by RBAC"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The API server minimum request timeout defines the minimum number of seconds a handler must keep a request open before timing it out. To set this, edit the openshift-kube-apiserver configmap and set min-request-timeout under the apiServerArguments field:\n\n\"apiServerArguments\":{\n ...\n \"min-request-timeout\":[ 3600 ],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_request_timeout",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"min-request-timeout\"]'\nThe output should return   .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-stig-v1r1,ocp4-cis,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-cis-1-4",
          "compliance.openshift.io/rule": "api-server-request-timeout",
          "compliance.openshift.io/rule-variable": "var-api-min-request-timeout",
          "control.compliance.openshift.io/CIS-OCP": "1.2.24",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.24",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-request-timeout",
        "namespace": "openshift-compliance",
        "resourceVersion": "76360",
        "uid": "11c6f89b-fce6-461f-bd32-8223c457534d"
      },
      "rationale": "Setting global request timeout allows extending the API Server request timeout limit to a duration appropriate to the user's connection speed. By default, it is set to 1800 seconds which might not be suitable for some environments. Setting the limit too low may result in excessive timeouts, and a limit that is too large may exhaust the API Server resources making it prone to Denial-of-Service attack. It is recommended to set this limit as appropriate and change the default limit of 1800 seconds only if needed.",
      "severity": "medium",
      "title": "Configure the API Server Minimum Request Timeout"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Validate service account before validating token.",
      "id": "xccdf_org.ssgproject.content_rule_api_server_service_account_lookup",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -o json | \\\n    jq -r '.data[\"config.yaml\"]' | \\\n    jq -r '.apiServerArguments[\"service-account-lookup\"]'\nThe output should return true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-cis,ocp4-stig-v1r1,ocp4-cis-1-5,ocp4-high,ocp4-pci-dss,ocp4-cis-1-4,ocp4-high-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-stig,ocp4-nerc-cip",
          "compliance.openshift.io/rule": "api-server-service-account-lookup",
          "control.compliance.openshift.io/CIS-OCP": "1.2.25",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.25",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-service-account-lookup",
        "namespace": "openshift-compliance",
        "resourceVersion": "76377",
        "uid": "f21078c4-534c-43be-903d-b20605c605a7"
      },
      "rationale": "If service-account-lookup is not enabled, the apiserver only verifies that the authentication token is valid, and does not validate that the service account token mentioned in the request is actually present in etcd. This allows using a service account token even after the corresponding service account is deleted. This is an example of time of check to time of use security issue.",
      "severity": "medium",
      "title": "Ensure that the service-account-lookup argument is set to true"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the API Server utilizes its own key pair, edit the openshift-kube-apiserver configmap and set the serviceAccountPublicKeyFiles parameter to the public key file for service accounts:\n\n...\n\"serviceAccountPublicKeyFiles\":[\n \"/etc/kubernetes/static-pod-resources/configmaps/sa-token-signing-certs\"\n],\n...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_service_account_public_key",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r .serviceAccountPublicKeyFiles\nThe output should return configured certificate key file(s).",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-5,ocp4-moderate-rev-4,ocp4-pci-dss-3-2,ocp4-stig,ocp4-stig-v1r1,ocp4-moderate,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-high,ocp4-pci-dss,ocp4-cis,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "api-server-service-account-public-key",
          "control.compliance.openshift.io/CIS-OCP": "1.2.26",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,Req-2.2.3,Req-2.3,1.2.26",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-service-account-public-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "76380",
        "uid": "e13d2055-9bd2-4422-87c8-0b4b1ef359e3"
      },
      "rationale": "By default if no service-account-key-file is specified to the apiserver, it uses the private key from the TLS serving certificate to verify service account tokens. To ensure that the keys for service account tokens are rotated as needed, a separate public/private key pair should be used for signing service account tokens.",
      "severity": "medium",
      "title": "Configure the Service Account Public Key for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the API Server utilizes its own TLS certificates, the tls-cert-file must be configured. Verify that the apiServerArguments section has the tls-cert-file configured in the config configmap in the openshift-kube-apiserver namespace similar to:\n\n\"apiServerArguments\":{\n...\n\"tls-cert-file\": [\n \"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt\"\n],\n...\n}",
      "id": "xccdf_org.ssgproject.content_rule_api_server_tls_cert",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments.\"tls-cert-file\"'\nThe output should return /etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.crt",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-cis,ocp4-high-rev-4,ocp4-cis-1-5,ocp4-high,ocp4-pci-dss",
          "compliance.openshift.io/rule": "api-server-tls-cert",
          "control.compliance.openshift.io/CIS-OCP": "1.2.28",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-8,SC-8(1),SC-8(2),Req-2.2,Req-2.2.3,Req-2.3,1.2.28",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-tls-cert",
        "namespace": "openshift-compliance",
        "resourceVersion": "76383",
        "uid": "7039c7d6-b9bd-4cdf-b0e1-a356ddde38d0"
      },
      "rationale": "API Server communication contains sensitive parameters that should remain encrypted in transit. Configure the API Server to serve only HTTPS traffic.",
      "severity": "medium",
      "title": "Configure the Certificate for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure that the API Server is configured to only use strong cryptographic ciphers, verify the openshift-kube-apiserver configmap contains the following set of ciphers, with no additions:\n\n\"servingInfo\":{\n ...\n \"cipherSuites\": [\n   \"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\",\n   \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\n   \"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\",\n   \"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\",\n   \"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256\",\n   \"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256\",\n ],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_tls_cipher_suites",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.servingInfo[\"cipherSuites\"]'\nVerify that the set of ciphers contains only the following:\n\n\"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\",\n\"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\n\"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\",\n\"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\",\n\"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256\",\n\"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256\"",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-nerc-cip,ocp4-stig-v1r1,ocp4-pci-dss-3-2,ocp4-cis-1-4,ocp4-high,ocp4-cis,ocp4-high-rev-4,ocp4-moderate,ocp4-stig,ocp4-cis-1-5,ocp4-e8,ocp4-pci-dss",
          "compliance.openshift.io/rule": "api-server-tls-cipher-suites",
          "control.compliance.openshift.io/CIS-OCP": "1.2.32",
          "control.compliance.openshift.io/NIST-800-53": "CM-6",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CM-6,Req-2.2,Req-2.2.3,Req-2.3,1.2.32",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-tls-cipher-suites",
        "namespace": "openshift-compliance",
        "resourceVersion": "76393",
        "uid": "9ce466e1-19ce-44da-ae6e-a08e8cb09bf1"
      },
      "rationale": "TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided. By default, OpenShift supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.",
      "severity": "medium",
      "title": "Use Strong Cryptographic Ciphers on the API Server",
      "warning": "TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided. By default, OpenShift supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the API Server utilizes its own TLS certificates, the tls-private-key-file must be configured. Verify that the apiServerArguments section has the tls-private-key-file configured in the config configmap in the openshift-kube-apiserver namespace similar to:\n\n\"apiServerArguments\":{\n...\n\"tls-private-key-file\": [\n \"/etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key\"\n],\n...\n}",
      "id": "xccdf_org.ssgproject.content_rule_api_server_tls_private_key",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments.\"tls-private-key-file\"'\nThe output should return /etc/kubernetes/static-pod-certs/secrets/service-network-serving-certkey/tls.key",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-pci-dss,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-cis,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-high,ocp4-high-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "api-server-tls-private-key",
          "control.compliance.openshift.io/CIS-OCP": "1.2.28",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-8,SC-8(1),SC-8(2),Req-2.2,Req-2.2.3,Req-2.3,1.2.28",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-tls-private-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "76395",
        "uid": "57f04482-7276-40ac-9808-f72fd231e8fd"
      },
      "rationale": "API Server communication contains sensitive parameters that should remain encrypted in transit. Configure the API Server to serve only HTTPS traffic.",
      "severity": "medium",
      "title": "Configure the Certificate Key for the API Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The configuration tlsSecurityProfile specifies TLS configurations to be used while establishing connections with the externally exposed servers. Though secure transport mode is used for establishing connections, the protocols used may not always be strong enough to avoid interception and manipulation of the data in transport. TLS Security profile configured should not make use of any protocols, ciphers, and algorithms with known security vulnerabilities.\n\ntlsSecurityProfile can be configured to use one of custom, intermediate, modern, or old profile. Profile Old should be avoided at all times and when using custom profile one should be extremely careful as invalid configurations can be catastrophic. It is always advised to use highly secure intermediate or modern profiles and if unset a default is chosen.\n\nUpdate tlsSecurityProfile to Intermediate using the following command:\n\noc patch apiservers.config.openshift.io cluster --type 'json' --patch '[{\"op\": \"add\", \"path\": \"/spec/tlsSecurityProfile/intermediate\", \"value\": {}}, {\"op\": \"replace\", \"path\": \"/spec/tlsSecurityProfile/type\", \"value\": \"Intermediate\"}'\n\nFor more information, follow OpenShift documentation: the relevant documentation ( https://docs.openshift.com/container-platform/latest/security/tls-security-profiles.html ).",
      "id": "xccdf_org.ssgproject.content_rule_api_server_tls_security_profile",
      "instructions": "To check for the configured tlsSecurityProfile use below command:\n$ oc get apiservers.config.openshift.io cluster -o jsonpath='{.spec.tlsSecurityProfile}{\"\\n\"}'\nThe output shows the tlsSecurityProfile configured for API Server, and\nthe profile configured should not be old or if custom the minimum TLS\nversion configured should be TLSv1.2 or newer.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig",
          "compliance.openshift.io/rule": "api-server-tls-security-profile",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1)",
          "policies.open-cluster-management.io/controls": "SC-8,SC-8(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-tls-security-profile",
        "namespace": "openshift-compliance",
        "resourceVersion": "76404",
        "uid": "80903fa2-7947-4d5a-aeb5-c82c10c33243"
      },
      "rationale": "The authenticity and integrity of the container platform and communication between nodes and components must be secure. If an insecure protocol, cipher, or algorithms is used, during transmission of data, the data can be intercepted and manipulated. To thwart the manipulation of the data during transmission secure protocol, cipher and algorithms must be used.",
      "severity": "medium",
      "title": "Ensure APIServer is configured with secure tlsSecurityProfile"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "config.openshift.io/v1",
            "kind": "APIServer",
            "metadata": {
              "name": "cluster"
            },
            "spec": {
              "tlsSecurityProfile": {
                "Custom": {
                  "minTLSVersion": "VersionTLS12"
                }
              }
            }
          }
        }
      ],
      "checkType": "Platform",
      "description": "The configuration tlsSecurityProfile specifies TLS configurations to be used while establishing connections with the externally exposed servers. Though secure transport mode is used for establishing connections, the protocols used may not always be strong enough to avoid interception and manipulation of the data in transport. When Custom TLS Security profile is used it's always better to configure TLS version 1.2 or newer to avoid any security breaches. Update minTLSVersion configured in Custom tlsSecurityProfile using the following command:\n\noc patch apiservers.config.openshift.io cluster --type 'merge' --patch '{\"spec\":{\"tlsSecurityProfile\":{\"custom\":{\"minTLSVersion\":\"VersionTLS12\"}}}}'\n\nFor more information, follow OpenShift documentation: the relevant documentation ( https://docs.openshift.com/container-platform/latest/security/tls-security-profiles.html ).",
      "id": "xccdf_org.ssgproject.content_rule_api_server_tls_security_profile_custom_min_tls_version",
      "instructions": "To check for the configured tlsSecurityProfile use below command:\n$ oc get apiservers.config.openshift.io cluster -o jsonpath='{.spec.tlsSecurityProfile.custom.minTLSVersion}{\"\\n\"}'\nThe output shows the minTLSVersion configured in Custom tlsSecurityProfile\nfor API Server, which should be TLSv1.2 or newer.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "api-server-tls-security-profile-custom-min-tls-version",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1)",
          "policies.open-cluster-management.io/controls": "SC-8,SC-8(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-tls-security-profile-custom-min-tls-version",
        "namespace": "openshift-compliance",
        "resourceVersion": "76399",
        "uid": "e09f7adb-cca7-4408-a281-894d3bf220f7"
      },
      "rationale": "The authenticity and integrity of the container platform and communication between nodes and components must be secure. If an insecure protocol, cipher, or algorithms is used, during transmission of data, the data can be intercepted and manipulated. To thwart the manipulation of the data during transmission secure protocol, cipher and algorithms must be used.",
      "severity": "medium",
      "title": "Ensure custom tlsSecurityProfile configured for APIServer uses secure TLS version"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "config.openshift.io/v1",
            "kind": "APIServer",
            "metadata": {
              "name": "cluster"
            },
            "spec": {
              "tlsSecurityProfile": {
                "intermediate": {},
                "type": "Intermediate"
              }
            }
          }
        }
      ],
      "checkType": "Platform",
      "description": "The configuration tlsSecurityProfile specifies TLS configurations to be used while establishing connections with the externally exposed servers. Though secure transport mode is used for establishing connections, the protocols used may not always be strong enough to avoid interception and manipulation of the data in transport. TLS Security profile Old should be avoided, as it supports vulnerable protocols, ciphers, and algorithms which could lead to security breaches. Update tlsSecurityProfile from Old to Intermediate using the following command:\n\noc patch apiservers.config.openshift.io cluster --type 'json' --patch '[{\"op\": \"add\", \"path\": \"/spec/tlsSecurityProfile/intermediate\", \"value\": {}}, {\"op\": \"replace\", \"path\": \"/spec/tlsSecurityProfile/type\", \"value\": \"Intermediate\"}, {\"op\": \"remove\", \"path\": \"/spec/tlsSecurityProfile/old\"}]'\n\nFor more information, follow OpenShift documentation: the relevant documentation ( https://docs.openshift.com/container-platform/latest/security/tls-security-profiles.html ).",
      "id": "xccdf_org.ssgproject.content_rule_api_server_tls_security_profile_not_old",
      "instructions": "To check for the configured tlsSecurityProfile use below command:\n$ oc get apiservers.config.openshift.io cluster -o jsonpath='{.spec.tlsSecurityProfile.type}{\"\\n\"}'\nThe output shows the tlsSecurityProfile configured for API Server, and\nTLS security profile configured should not be \"old\".",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "api-server-tls-security-profile-not-old",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1)",
          "policies.open-cluster-management.io/controls": "SC-8,SC-8(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-tls-security-profile-not-old",
        "namespace": "openshift-compliance",
        "resourceVersion": "76407",
        "uid": "ee6c4bc3-5620-4d70-831d-963a91d9ee66"
      },
      "rationale": "The authenticity and integrity of the container platform and communication between nodes and components must be secure. If an insecure protocol, cipher, or algorithms is used, during transmission of data, the data can be intercepted and manipulated. To thwart the manipulation of the data during transmission secure protocol, cipher and algorithms must be used.",
      "severity": "medium",
      "title": "Ensure APIServer is not configured with Old tlsSecurityProfile"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure OpenShift does not accept token-based authentication, follow the OpenShift documentation and configure alternate mechanisms for authentication. Then, edit the API Server pod specification file Edit the openshift-kube-apiserver configmap and remove the token-auth-file parameter:\n\n\"apiServerArguments\":{\n ...\n \"token-auth-file\":[\n   \"/path/to/any/file\"\n ],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_api_server_token_auth",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments' | grep \"token-auth-file\"\nThe output should be empty as OpenShift does not support token-based authentication at all.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-stig,ocp4-high,ocp4-stig-v1r1,ocp4-cis,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-cis-1-4",
          "compliance.openshift.io/rule": "api-server-token-auth",
          "control.compliance.openshift.io/CIS-OCP": "1.2.3",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-api-server-token-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "76410",
        "uid": "15deccf4-fb58-4f1e-a9d2-6fe47f5ce200"
      },
      "rationale": "The token-based authentication utilizes static tokens to authenticate requests to the API Server. The tokens are stored in clear-text in a file on the API Server, and cannot be revoked or rotated without restarting the API Server.",
      "severity": "high",
      "title": "Disable Token-based Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "monitoring.coreos.com/v1",
            "kind": "PrometheusRule",
            "metadata": {
              "name": "audit-errors",
              "namespace": "openshift-kube-apiserver"
            },
            "spec": {
              "groups": [
                {
                  "name": "apiserver-audit",
                  "rules": [
                    {
                      "alert": "AuditLogError",
                      "annotations": {
                        "description": "An API Server had an error writing to an audit log.",
                        "summary": "An API Server instance was unable to write audit logs. This could be\ntriggered by the node running out of space, or a malicious actor\ntampering with the audit logs."
                      },
                      "expr": "sum by (apiserver,instance)(rate(apiserver_audit_error_total{apiserver=~\".+-apiserver\"}[5m])) / sum by (apiserver,instance) (rate(apiserver_audit_event_total{apiserver=~\".+-apiserver\"}[5m])) > 0\n",
                      "for": "1m",
                      "labels": {
                        "severity": "warning"
                      }
                    }
                  ]
                }
              ]
            }
          }
        }
      ],
      "checkType": "Platform",
      "description": "OpenShift audit works at the API server level, logging all requests coming to the server. However, if API server instance is unable to write errors, an alert must be issued in order for the organization to take a relevant action. e.g. shutting down that instance.\n\nKubernetes by default has metrics that enable one to write such alerts:\n\n* apiserver_audit_event_total\n* apiserver_audit_error_total\n\nSuch an example is shipped in OCP 4.9+\n\napiVersion: monitoring.coreos.com/v1\nkind: PrometheusRule\nmetadata:\n name: audit-errors\n namespace: openshift-kube-apiserver\nspec:\n groups:\n - name: apiserver-audit\n   rules:\n   - alert: AuditLogError\n     annotations:\n       summary: |-\n         An API Server instance was unable to write audit logs. This could be\n         triggered by the node running out of space, or a malicious actor\n         tampering with the audit logs.\n       description: An API Server had an error writing to an audit log.\n     expr: |\n       sum by (apiserver,instance)(rate(apiserver_audit_error_total{apiserver=~\".+-apiserver\"}[5m])) / sum by (apiserver,instance) (rate(apiserver_audit_event_total{apiserver=~\".+-apiserver\"}[5m])) > 0\n     for: 1m\n     labels:\n       severity: warning\n\nFor more information, consult the official Kubernetes documentation ( https://docs.openshift.com/container-platform/latest/logging/cluster-logging-external.html ).",
      "id": "xccdf_org.ssgproject.content_rule_audit_error_alert_exists",
      "instructions": "Run the following command:\noc get --all-namespaces prometheusrules -o json | jq '[.items[].spec.groups[].rules[].expr]' | grep apiserver_audit\nMake sure that there's a prometheus rule that verifies the apiserver_audit_error_total and \napiserver_audit_event_total metrics and will alert based on an error threshold.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig",
          "compliance.openshift.io/rule": "audit-error-alert-exists",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AU-5",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AU-5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-audit-error-alert-exists",
        "namespace": "openshift-compliance",
        "resourceVersion": "76892",
        "uid": "d45b845b-a328-4047-9477-0c3c380f9354"
      },
      "rationale": "When there are errors writing audit logs, security events will not be logged by that specific API Server instance. Security Incident Response teams use these audit logs, amongst other artifacts, to determine the impact of security breaches or events. Without these logs, it becomes very difficult to assess a situation and do appropriate root cause analysis in such incidents.",
      "severity": "high",
      "title": "Ensure that Audit Log Errors Emit Alerts"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift audit works at the API server level, logging all requests coming to the server. Audit is on by default and the best practice is to ship audit logs off the cluster for retention. The cluster-logging-operator is able to do this with the\n\nClusterLogForwarders\n\nresource. The forementioned resource can be configured to logs to different third party systems. For more information on this, please reference the official documentation: https://docs.openshift.com/container-platform/4.6/logging/cluster-logging-external.html",
      "id": "xccdf_org.ssgproject.content_rule_audit_log_forwarding_enabled",
      "instructions": "Run the following command:\noc get clusterlogforwarders instance -n openshift-logging -ojson | jq -r '.spec.pipelines[].inputRefs | contains([\"audit\"])'\nThe output should return true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-cis,ocp4-pci-dss,ocp4-stig-v1r1,ocp4-stig,ocp4-nerc-cip",
          "compliance.openshift.io/rule": "audit-log-forwarding-enabled",
          "control.compliance.openshift.io/CIS-OCP": "1.2.21",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.2;CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-004-6 R3.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(12);AU-3(2);AU-5(1);AU-6;AU-6(1);AU-6(3);AU-9(2);SI-4(16);AU-4(1);AU-11;AU-7;AU-7(1);SI-4(20)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-10.5.3;Req-10.5.4",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.2,CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-004-6 R3.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CIP-007-3 R6.5,AC-2(12),AU-3(2),AU-5(1),AU-6,AU-6(1),AU-6(3),AU-9(2),SI-4(16),AU-4(1),AU-11,AU-7,AU-7(1),SI-4(20),Req-2.2,Req-10.5.3,Req-10.5.4,1.2.21",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-audit-log-forwarding-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76411",
        "uid": "2e425731-2e5e-4ab2-9eaf-82e2abe3d68b"
      },
      "rationale": "Retaining logs ensures the ability to go back in time to investigate or correlate any events. Offloading audit logs from the cluster ensures that an attacker that has access to the cluster will not be able to tamper with the logs because of the logs being stored off-site.",
      "severity": "medium",
      "title": "Ensure that Audit Log Forwarding Is Enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift audit works at the API server level, logging all requests coming to the server. Audit is on by default and the best practice is to ship audit logs off the cluster for retention using a secure protocol.\n\nThe cluster-logging-operator is able to do this with the\n\nClusterLogForwarders\n\nresource. The forementioned resource can be configured to logs to different third party systems. For more information on this, please reference the official documentation: https://docs.openshift.com/container-platform/latest/logging/cluster-logging-external.html",
      "id": "xccdf_org.ssgproject.content_rule_audit_log_forwarding_uses_tls",
      "instructions": "Run the following command:\noc get -n openshift-logging clusterlogforwarders instance -o json | jq 'try [.spec.outputs[].url] catch []'\nThe output should return a list of URL entries with https:// or tls:// transport.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig",
          "compliance.openshift.io/rule": "audit-log-forwarding-uses-tls",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.2;CIP-004-6 R3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AU-9;AU-9(2);AU-9(3);AU-10",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.2,CIP-004-6 R3.3,CIP-007-3 R6.5,AU-9,AU-9(2),AU-9(3),AU-10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-audit-log-forwarding-uses-tls",
        "namespace": "openshift-compliance",
        "resourceVersion": "76895",
        "uid": "2a3b97bf-78c6-4814-b4bb-e93c11612de3"
      },
      "rationale": "It is necessary to ensure that any configured output uses the TLS protocol to receive logs in order to ensure the confidentiality, integrity and authenticity of the logs.",
      "severity": "medium",
      "title": "Ensure that Audit Log Forwarding Uses TLS"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Audit is on by default and the best practice is to ship audit logs off an cluster for retention. HyperShift is able to do this with the a audit webhook, which is configured in the HostedCluster custom resource. The forementioned resource can be configured to log to different third party systems. For more information on this, please reference the official documentation: https://hypershift-docs.netlify.app/reference/api/",
      "id": "xccdf_org.ssgproject.content_rule_audit_log_forwarding_webhook",
      "instructions": "Run the following command to verify that the audit webhook is configured:\noc get hostedclusters None -n clusters -ojson | jq -r '.spec.auditWebhook'\nThe output should contain a properly configured webhook.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-5,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss,ocp4-cis,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "audit-log-forwarding-webhook",
          "compliance.openshift.io/rule-variable": "hypershift-cluster",
          "control.compliance.openshift.io/CIS-OCP": "1.2.21",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-10.5.3;Req-10.5.4",
          "policies.open-cluster-management.io/controls": "Req-2.2,Req-10.5.3,Req-10.5.4,1.2.21",
          "policies.open-cluster-management.io/standards": "PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-audit-log-forwarding-webhook",
        "namespace": "openshift-compliance",
        "resourceVersion": "76417",
        "uid": "7c46e1fc-d83c-462f-8949-f0cef9341fcf"
      },
      "rationale": "Retaining logs ensures the ability to go back in time to investigate or correlate any events. Offloading audit logs from the cluster ensures that an attacker that has access to the cluster will not be able to tamper with the logs because of the logs being stored off-site.",
      "severity": "medium",
      "title": "Ensure that Audit Log Webhook Is Configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift can audit the details of requests made to the API server through the standard Kubernetes audit capabilities.\n\nIn OpenShift, auditing of the API Server is on by default. Audit provides a security-relevant chronological set of records documenting the sequence of activities that have affected system by individual users, administrators, or other components of the system. Audit works at the API server level, logging all requests coming to the server. Each audit log contains two entries:\n\nThe request line containing:\n\n* A Unique ID allowing to match the response line (see #2)\n* The source IP of the request\n* The HTTP method being invoked\n* The original user invoking the operation\n* The impersonated user for the operation (self meaning himself)\n* The impersonated group for the operation (lookup meaning user's group)\n* The namespace of the request or none\n* The URI as requested\n\nThe response line containing:\n\n* The aforementioned unique ID\n* The response code\n\nFor more information on how to configure the audit profile, please visit the documentation ( https://docs.openshift.com/container-platform/4.6/security/audit-log-policy-config.html )",
      "id": "xccdf_org.ssgproject.content_rule_audit_profile_set",
      "instructions": "Run the following command to retrieve the current audit profile:\n$ oc get apiservers cluster -ojsonpath='{.spec.audit.profile}'\nMake sure the profile returned matches the one that should be used.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-high,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-stig,ocp4-cis,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "audit-profile-set",
          "control.compliance.openshift.io/CIS-OCP": "3.2.1;3.2.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4;CIP-003-8 R4.1;CIP-003-8 R4.2;CIP-003-8 R5.2;CIP-003-8 R6;CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-004-6 R3.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AU-2;AU-3;AU-3(1);AU-6;AU-6(1);AU-7;AU-7(1);AU-8;AU-8(1);AU-9;AU-12;AU-12(1);AU-12(3);CM-5(1);SI-11;SI-12;SI-4(20);SI-4(23)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-12.5.5",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4,CIP-003-8 R4.1,CIP-003-8 R4.2,CIP-003-8 R5.2,CIP-003-8 R6,CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-004-6 R3.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CIP-007-3 R6.5,AU-2,AU-3,AU-3(1),AU-6,AU-6(1),AU-7,AU-7(1),AU-8,AU-8(1),AU-9,AU-12,AU-12(1),AU-12(3),CM-5(1),SI-11,SI-12,SI-4(20),SI-4(23),Req-2.2,Req-12.5.5,3.2.1,3.2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-audit-profile-set",
        "namespace": "openshift-compliance",
        "resourceVersion": "76899",
        "uid": "2008c088-bc57-4938-aa10-53f0cf2d7737"
      },
      "rationale": "Logging is an important detective control for all systems, to detect potential unauthorised access.",
      "severity": "medium",
      "title": "Ensure that the cluster's audit profile is properly set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift has an option to provide the Disk Encryption Set [1] when deploying nodes on Azure. This enabled disk encryption and ensures that the OpenShift nodes have that enabled. [1] https://docs.openshift.com/container-platform/latest/machine_management/creating_machinesets/creating-machineset-azure.html#machineset-enabling-customer-managed-encryption-azure_creating-machineset-azure",
      "id": "xccdf_org.ssgproject.content_rule_azure_disk_encryption_enabled",
      "instructions": "Run the following command to retrieve if the Azure disk encryption is enabled:\n$ oc get machineset --all-namespaces -o json | jq '[.items[] | select(.spec.template.spec.providerSpec.value.osDisk.managedDisk.diskEncryptionSet.id != null) | .metadata.name]}'\nMake sure that the result is an array of machineset names where\ndisk encryption is enabled.\nThis can be inspected by going through them\nwith $ oc get machineset --all-namespaces -o yaml",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "azure-disk-encryption-enabled",
          "control.compliance.openshift.io/PCI-DSS": "Req-3.4.1",
          "policies.open-cluster-management.io/controls": "Req-3.4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-azure-disk-encryption-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76207",
        "uid": "ff70d79d-a318-4bf6-9e5c-339a9e13d003"
      },
      "rationale": "The usage of disk encryption for the nodes protects the data at rest and ensures that an attacker cannot easily exfiltrate the machine contents which may contain private keys or other sensitive material.",
      "severity": "high",
      "title": "Ensure that the MachineSets provisioned by Azure have disk encryption enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "A legal notice must be configured.\n\nThis is achievable via the OAuth object by creating a custom login page, storing it in a Kubernetes Secret and referencing it in the appropriate field as described in the documentation ( https://docs.openshift.com/container-platform/latest/web_console/customizing-the-web-console.html#customizing-the-login-page_customizing-web-console )\n\nAnother way of achieving this is via a custom classification banner which is possible to set via the ConsoleNotification CRD as described in the documentation ( https://docs.openshift.com/container-platform/4.7/web_console/customizing-the-web-console.html#creating-custom-notification-banners_customizing-web-console )",
      "id": "xccdf_org.ssgproject.content_rule_banner_or_login_template_set",
      "instructions": "To verify that login template is properly set, do the following:\n$ oc get oauths cluster\nmake sure that the login template is set in \nthe path .spec.templates.login.name, and references a valid\nsecret.\n\nAlternatively, verify that a ConsoleNotification object called\nclassification-banner exists and contains an appropriate\nlegal notice.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "banner-or-login-template-set",
          "control.compliance.openshift.io/NIST-800-53": "AC-8",
          "policies.open-cluster-management.io/controls": "AC-8",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-banner-or-login-template-set",
        "namespace": "openshift-compliance",
        "resourceVersion": "76502",
        "uid": "73736a7b-02ae-4e82-ba7f-0fd2fd54fae1"
      },
      "rationale": "Displays to users organization-defined system use notification message or banner before granting access to the system that provides privacy and security notices consistent with applicable federal laws.",
      "severity": "medium",
      "title": "Ensure that a OpenShift OAuth login template or a classification banner is set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "A classification banner can be configured by creating a Console Notification CRD on OpenShift",
      "id": "xccdf_org.ssgproject.content_rule_classification_banner",
      "instructions": "Verify that a ConsoleNotification object called\nclassification-banner exists and contains an appropriate\nlegal notice.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-stig",
          "compliance.openshift.io/rule": "classification-banner",
          "control.compliance.openshift.io/NIST-800-53": "AC-8",
          "policies.open-cluster-management.io/controls": "AC-8",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-classification-banner",
        "namespace": "openshift-compliance",
        "resourceVersion": "76503",
        "uid": "48c8ab6e-3945-4c85-b688-7ed062e681b8"
      },
      "rationale": "Displays to users organization-defined system use notification message or banner before granting access to the system that provides privacy and security notices consistent with applicable federal laws",
      "severity": "medium",
      "title": "Enable Classification Banner on OpenShift Console"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift Logging Operator provides ability to aggregate all the logs from the OpenShift Container Platform cluster, such as node system audit logs, application container logs, and infrastructure logs. OpenShift Logging aggregates these logs from throughout OpenShift cluster and stores them in a default log store. [1] [1]https://docs.openshift.com/container-platform/4.10/logging/cluster-logging.html",
      "id": "xccdf_org.ssgproject.content_rule_cluster_logging_operator_exist",
      "instructions": "Run the following command to retrieve the clusterlogging objects in the system:\n$ oc get clusterloggings --all-namespaces\nMake sure the OpenShift Logging Operator is installed and there exists\nat least one active clusterlogging object in the cluster.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-high,ocp4-stig-v1r1,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "cluster-logging-operator-exist",
          "control.compliance.openshift.io/NIST-800-53": "AU-3(2)",
          "policies.open-cluster-management.io/controls": "AU-3(2)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-cluster-logging-operator-exist",
        "namespace": "openshift-compliance",
        "resourceVersion": "76913",
        "uid": "a3dba23b-e683-494a-b5dc-c64068f3929a"
      },
      "rationale": "OpenShift Logging Operator is able to collect, aggregate, and manage logs.",
      "severity": "medium",
      "title": "Ensure that OpenShift Logging Operator is scanning the cluster"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Integrity of the OpenShift platform is handled to start by the cluster version operator. Cluster Version Operator will by default GPG verify the integrity of the release image before applying it. [1] This rule checks if Cluster Version Operator is deployed and available in the system. [1] https://github.com/openshift/machine-config-operator/blob/master/docs/OSUpgrades.md#questions-and-answers",
      "id": "xccdf_org.ssgproject.content_rule_cluster_version_operator_exists",
      "instructions": "Run the following command to retrieve the Cluster Version objects in the system:\n$ oc get clusterversion version\nMake sure the Cluster Version Operator is installed and the AVAILABLE is True.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-high-rev-4,ocp4-moderate,ocp4-stig",
          "compliance.openshift.io/rule": "cluster-version-operator-exists",
          "control.compliance.openshift.io/NIST-800-53": "SA-10(1)",
          "policies.open-cluster-management.io/controls": "SA-10(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-cluster-version-operator-exists",
        "namespace": "openshift-compliance",
        "resourceVersion": "76200",
        "uid": "7e18a876-5ae1-488b-95d5-e9913c1abad7"
      },
      "rationale": "Integrity check prevent a malicious actor from using a unauthorized system image, hence it will ensure the image has not been tampered with, or corrupted.",
      "severity": "medium",
      "title": "Ensure that Cluster Version Operator is deployed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Integrity of the OpenShift platform is handled to start by the cluster version operator. Cluster Version Operator will by default GPG verify the integrity of the release image before applying it. This rule check if there is an unverified cluster image.",
      "id": "xccdf_org.ssgproject.content_rule_cluster_version_operator_verify_integrity",
      "instructions": "Run the following command to retrieve the Cluster Version objects in the system:\n$ oc get clusterversion version -o yaml\nMake sure verified is true under status history for each item.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "cluster-version-operator-verify-integrity",
          "control.compliance.openshift.io/NIST-800-53": "SA-10(1)",
          "policies.open-cluster-management.io/controls": "SA-10(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-cluster-version-operator-verify-integrity",
        "namespace": "openshift-compliance",
        "resourceVersion": "76206",
        "uid": "73aff369-0697-4c92-a826-f3aade6bf27b"
      },
      "rationale": "Unverified cluster image will compromise the system integrity. Integrity check prevent a malicious actor from using a unauthorized system image, hence it will ensure the image has not been tampered with, or corrupted.",
      "severity": "medium",
      "title": "Ensure that Cluster Version Operator verifies integrity"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Production environments can deny direct access to the Internet and instead have an HTTP or HTTPS proxy available.\n\nThe Proxy object is used to manage the cluster-wide egress proxy. Setting this will ensure that containers get the appropriate environment variables set to ensure traffic goes to the proxy per organizational requirements.\n\nFor more information, see the relevant documentation. ( https://docs.openshift.com/container-platform/latest/networking/enable-cluster-wide-proxy.html )",
      "id": "xccdf_org.ssgproject.content_rule_cluster_wide_proxy_set",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "cluster-wide-proxy-set",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.4;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-7(8)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.4,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,SC-7(8)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-cluster-wide-proxy-set",
        "namespace": "openshift-compliance",
        "resourceVersion": "77311",
        "uid": "9dc66143-680b-445e-859e-19029bbe85c5"
      },
      "rationale": "External networks tend to be outside of organizational control. By ensuring that egress traffic goes through an authorized proxy, one is able to ensure that expected and safe traffic is coming out, and malicious actors aren't leaking sensitive information, or calling back from a central command center to get further instructions upon intrusion.",
      "severity": "medium",
      "title": "Ensure that cluster-wide proxy is set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The OpenShift platform provides the Compliance Operator for administrators to monitor compliance state of a cluster and provides them with an overview of gaps and ways to remediate them, and this control ensures proper notification alert is enabled for Compliance Operator so that system administrators and security personnel are notified about the alerts on compliance status.",
      "id": "xccdf_org.ssgproject.content_rule_compliance_notification_enabled",
      "instructions": "Run the following command to see if alert monitor is enabled by Compliance Operator:\n$  oc get prometheusrules --all-namespaces -o json | jq '[.items[] | select(.metadata.name ==\"compliance\") | .metadata.name]'\nMake sure that there is one output named: compliance",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "compliance-notification-enabled",
          "control.compliance.openshift.io/NIST-800-53": "SI-6;SI-4(24)",
          "policies.open-cluster-management.io/controls": "SI-6,SI-4(24)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-compliance-notification-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76518",
        "uid": "40fe3436-056a-4988-a63a-c2ed321d1f0c"
      },
      "rationale": "Compliance alert enables OpenShift administrators to be informed on the system compliance status",
      "severity": "medium",
      "title": "Ensure the notification is enabled for Compliance Operator"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "There are a variety of CNI plugins available for Kubernetes. If the CNI in use does not support Network Policies it may not be possible to effectively restrict traffic in the cluster. OpenShift supports Kubernetes NetworkPolicy using a Kubernetes Container Network Interface (CNI) plug-in.",
      "id": "xccdf_org.ssgproject.content_rule_configure_network_policies",
      "instructions": "Verify that your CNI plugin supports NetworkPolicies:\n$ oc get network cluster -ojsonpath='{.spec.networkType}'\nThe result should list a CNI plugin that supports NetworkPolicies,\ncurrently the plugins in the rule's pass list are OpenShiftSDN, OVN\nand Calico.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-cis-1-5,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-high,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "configure-network-policies",
          "control.compliance.openshift.io/CIS-OCP": "5.3.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.1.4;Req-1.2;Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-1.1.4,Req-1.2,Req-2.2,5.3.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-configure-network-policies",
        "namespace": "openshift-compliance",
        "resourceVersion": "77314",
        "uid": "7fe3ba3a-a433-42ac-8154-600d3dea682d"
      },
      "rationale": "Kubernetes network policies are enforced by the CNI plugin in use. As such it is important to ensure that the CNI plugin supports both Ingress and Egress network policies.",
      "severity": "high",
      "title": "Ensure that the CNI in use supports Network Policies"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Use network policies to isolate traffic in your cluster network.",
      "id": "xccdf_org.ssgproject.content_rule_configure_network_policies_hypershift_hosted",
      "instructions": "Verify that the HyperShift hosted control plane namespace has an appropriate\nNetworkPolicy.\nTo get NetworkPolicy for hosted control plane namespace run the following command:\n$ oc get networkpolicies -n clusters-None -o yaml\nMake sure that the namespaces displayed in the commands of the commands match.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high,ocp4-moderate-rev-4,ocp4-cis,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss,ocp4-high-rev-4,ocp4-moderate,ocp4-cis-1-5",
          "compliance.openshift.io/rule": "configure-network-policies-hypershift-hosted",
          "compliance.openshift.io/rule-variable": "hypershift-namespace-prefix,hypershift-cluster",
          "control.compliance.openshift.io/CIS-OCP": "5.3.2",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.1.4;Req-1.2;Req-1.2.1;Req-1.3.1;Req-1.3.2;Req-2.2",
          "policies.open-cluster-management.io/controls": "Req-1.1.4,Req-1.2,Req-1.2.1,Req-1.3.1,Req-1.3.2,Req-2.2,5.3.2",
          "policies.open-cluster-management.io/standards": "PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-configure-network-policies-hypershift-hosted",
        "namespace": "openshift-compliance",
        "resourceVersion": "77324",
        "uid": "6d747748-3078-4cb9-90e9-e3e2418a3d8c"
      },
      "rationale": "Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. When a network policy is introduced to a given namespace, all traffic not allowed by the policy is denied. However, if there are no network policies in a namespace all traffic will be allowed into and out of the pods in that namespace.",
      "severity": "high",
      "title": "Ensure that HyperShift Hosted Namespaces have Network Policies defined."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Use network policies to isolate traffic in your cluster network.",
      "id": "xccdf_org.ssgproject.content_rule_configure_network_policies_namespaces",
      "instructions": "Verify that the every non-control plane namespace has an appropriate\nNetworkPolicy.\n\nTo get all the non-control plane namespaces, you can do the\nfollowing command oc get  namespaces -o json | jq '[.items[] | select((.metadata.name | startswith(\"openshift\") | not) and (.metadata.name | startswith(\"kube-\") | not) and .metadata.name != \"default\") | .metadata.name ]'\n\nTo get all the non-control plane namespaces with a NetworkPolicy, you can do the\nfollowing command oc get --all-namespaces networkpolicies -o json | jq '[.items[] | select((.metadata.namespace | startswith(\"openshift\") | not) and (.metadata.namespace | startswith(\"kube-\") | not) and .metadata.namespace != \"default\") | .metadata.namespace] | unique'\n\nMake sure that the namespaces displayed in the commands of the commands match.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-pci-dss-3-2,ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis,ocp4-cis-1-5,ocp4-high,ocp4-high-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "configure-network-policies-namespaces",
          "control.compliance.openshift.io/CIS-OCP": "5.3.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4;CIP-003-8 R4.2;CIP-003-8 R5;CIP-003-8 R6;CIP-004-6 R2.2.4;CIP-004-6 R3;CIP-007-3 R2;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-4;AC-4(21);CA-3(5);CM-6;CM-6(1);CM-7;CM-7(1);SC-7;SC-7(3);SC-7(5);SC-7(8);SC-7(12);SC-7(13);SC-7(18);SC-7(10);SI-4(22)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.1.4;Req-1.2;Req-1.2.1;Req-1.3.1;Req-1.3.2;Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4,CIP-003-8 R4.2,CIP-003-8 R5,CIP-003-8 R6,CIP-004-6 R2.2.4,CIP-004-6 R3,CIP-007-3 R2,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R6.1,AC-4,AC-4(21),CA-3(5),CM-6,CM-6(1),CM-7,CM-7(1),SC-7,SC-7(3),SC-7(5),SC-7(8),SC-7(12),SC-7(13),SC-7(18),SC-7(10),SI-4(22),Req-1.1.4,Req-1.2,Req-1.2.1,Req-1.3.1,Req-1.3.2,Req-2.2,5.3.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-configure-network-policies-namespaces",
        "namespace": "openshift-compliance",
        "resourceVersion": "77319",
        "uid": "a3aa09b3-7b8d-4a24-91dd-dd7ca82b3a26"
      },
      "rationale": "Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. When a network policy is introduced to a given namespace, all traffic not allowed by the policy is denied. However, if there are no network policies in a namespace all traffic will be allowed into and out of the pods in that namespace.",
      "severity": "high",
      "title": "Ensure that application Namespaces have Network Policies defined."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Using the Red Hat Quay Container Security Operator, you can access vulnerability scan results from the OpenShift Container Platform web console for container images used in active pods on the cluster. The Red Hat Quay Container Security Operator:\n\n* Watches containers associated with pods on all or specified namespaces\n* Queries the container registry where the containers came from for vulnerability information, provided an image’s registry is running image scanning (such as Quay.io or a Red Hat Quay registry with Clair scanning)\n* Exposes vulnerabilities via the ImageManifestVuln object in the Kubernetes API\n\nFor more information on the Container Security Operator, follow the OpenShift documentation: https://docs.openshift.com/container-platform/latest/security/pod-vulnerability-scan.html",
      "id": "xccdf_org.ssgproject.content_rule_container_security_operator_exists",
      "instructions": "To check if the Container Security Operator is installed, run the following command:\noc get sub -nopenshift-operators container-security-operator -ojsonpath='{.status.installedCSV}'\nthe output should return the version of the CSV that represents the installed\noperator.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "container-security-operator-exists",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(b)",
          "policies.open-cluster-management.io/controls": "CM-6(b)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-container-security-operator-exists",
        "namespace": "openshift-compliance",
        "resourceVersion": "77453",
        "uid": "58b3736f-f614-4ebb-a56e-dba29dcaf9a6"
      },
      "rationale": "Vulnerabilities in software packages can be exploited by hackers or malicious users to obtain unauthorized access to resources.",
      "severity": "medium",
      "title": "Make sure the Container Security Operator is installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the Controller Manager service is bound to secure loopback address and a secure port, set the RotateKubeletServerCertificate option to true in the openshift-kube-controller-manager configmap on the master node(s):\n\n\"extendedArguments\": {\n...\n \"port\": [\"0\"],\n...\n\nIt is also acceptable for a system to deprecate the insecure port:\n\n\"extendedArguments\": {\n...\n...",
      "id": "xccdf_org.ssgproject.content_rule_controller_insecure_port_disabled",
      "instructions": "To verify that port is configured correctly,\nrun the following command:\n$ oc get configmaps config -n openshift-kube-controller-manager -ojson | jq ''\nVerify that it's true in the console output (the value will be true if the insecure port is bind to loopback address or disabled) .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-high,ocp4-pci-dss,ocp4-cis,ocp4-pci-dss-3-2,ocp4-stig-v1r1,ocp4-moderate,ocp4-moderate-rev-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "controller-insecure-port-disabled",
          "control.compliance.openshift.io/CIS-OCP": "1.3.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,1.3.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-controller-insecure-port-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76444",
        "uid": "146f5bd9-fc3f-4f84-b964-640cc9bc2da0"
      },
      "rationale": "The Controller Manager API service is used for health and metrics information and is available without authentication or encryption. As such, it should only be bound to a localhost interface to minimize the cluster's attack surface.",
      "severity": "low",
      "title": "Ensure Controller insecure port argument is unset"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To enforce kubelet server certificate rotation on the Controller Manager, set the RotateKubeletServerCertificate option to true in the openshift-kube-controller-manager configmap on the master node(s):\n\n\"extendedArguments\": {\n...\n \"feature-gates\": [\n ...\n   \"RotateKubeletServerCertificate=true\",\n ...\n...\n\nThis feature gate is enabled by default as of Kubernetes 1.12.",
      "id": "xccdf_org.ssgproject.content_rule_controller_rotate_kubelet_server_certs",
      "instructions": "To verify that RotateKubeletServerCertificate is configured correctly,\nrun the following command:\n$ oc get configmaps config -n openshift-kube-controller-manager -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.extendedArguments[\"feature-gates\"]'\nThe output should return RotateKubeletServerCertificate=true.\n      Is it the case that <tt>RotateKubeletServerCertificate</tt> argument is set to <tt>false</tt> in the",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-high-rev-4,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "controller-rotate-kubelet-server-certs",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-controller-rotate-kubelet-server-certs",
        "namespace": "openshift-compliance",
        "resourceVersion": "76445",
        "uid": "62cb827c-5ca9-434d-9192-763745511bc4"
      },
      "rationale": "Enabling kubelet certificate rotation causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that there are no downtimes due to expired certificates and thus addressing the availability in the C/I/A security triad.",
      "severity": "medium",
      "title": "Ensure that the RotateKubeletServerCertificate argument is set",
      "warning": "Enabling kubelet certificate rotation causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that there are no downtimes due to expired certificates and thus addressing the availability in the C/I/A security triad."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the Controller Manager service is bound to secure loopback address using a secure port, set the RotateKubeletServerCertificate option to true in the openshift-kube-controller-manager configmap on the master node(s):\n\n\"extendedArguments\": {\n...\n \"secure-port\": [\"10257\"],\n...",
      "id": "xccdf_org.ssgproject.content_rule_controller_secure_port",
      "instructions": "To verify that secure-port is configured correctly,\nrun the following command:\n$ oc get configmaps config -n openshift-kube-controller-manager -ojson |   jq -r '.data[\"config.yaml\"]' | jq '.extendedArguments[\"secure-port\"][]'\nVerify that it's using an appropriate port (the value is not 0).",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-pci-dss,ocp4-high",
          "compliance.openshift.io/rule": "controller-secure-port",
          "control.compliance.openshift.io/CIS-OCP": "1.3.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,1.3.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-controller-secure-port",
        "namespace": "openshift-compliance",
        "resourceVersion": "76451",
        "uid": "0788809d-1569-4643-8c93-c259253f3eb1"
      },
      "rationale": "The Controller Manager API service is used for health and metrics information and is available without authentication or encryption. As such, it should only be bound to a localhost interface to minimize the cluster's attack surface.",
      "severity": "low",
      "title": "Ensure Controller secure-port argument is set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the API Server utilizes its own key pair, set the masterCA parameter to the public key file for service accounts in the openshift-kube-controller-manager configmap on the master node(s):\n\n\"extendedArguments\": {\n...\n \"root-ca-file\": [\n   \"/etc/kubernetes/static-pod-resources/configmaps/serviceaccount-ca/ca-bundle.crt\"\n ],\n...",
      "id": "xccdf_org.ssgproject.content_rule_controller_service_account_ca",
      "instructions": "To verify that root-ca-file is configured correctly,\nrun the following command:\n$ oc get configmaps config -n openshift-kube-controller-manager -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.extendedArguments[\"root-ca-file\"]'\nThe output should return a configured certificate authority file.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-4,ocp4-high,ocp4-cis,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-high-rev-4,ocp4-stig,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "controller-service-account-ca",
          "control.compliance.openshift.io/CIS-OCP": "1.3.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,1.3.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-controller-service-account-ca",
        "namespace": "openshift-compliance",
        "resourceVersion": "76452",
        "uid": "094423b1-3f60-482f-a280-6b79f991b852"
      },
      "rationale": "Service accounts authenticate to the API using tokens signed by a private RSA key. The authentication layer verifies the signature using a matching public RSA key. Configuring the certificate authority file ensures that the API server's signing certificates are validated.",
      "severity": "medium",
      "title": "Configure the Service Account Certificate Authority Key for the Controller Manager"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the API Server utilizes its own key pair, set the privateKeyFile parameter to the public key file for service accounts in the openshift-kube-controller-manager configmap on the master node(s):\n\n\"extendedArguments\": {\n...\n \"service-account-private-key-file\": [\n   \"/etc/kubernetes/static-pod-resources/secrets/service-account-private-key/service-account.key\"\n ],\n...",
      "id": "xccdf_org.ssgproject.content_rule_controller_service_account_private_key",
      "instructions": "To verify that service-account-private-key-file is configured correctly,\nrun the following command:\n$ oc get configmaps config -n openshift-kube-controller-manager -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.extendedArguments[\"service-account-private-key-file\"]'\nThe output should return a configured private key file.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-stig,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-pci-dss,ocp4-high,ocp4-moderate-rev-4,ocp4-cis",
          "compliance.openshift.io/rule": "controller-service-account-private-key",
          "control.compliance.openshift.io/CIS-OCP": "1.3.3",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,1.3.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-controller-service-account-private-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "76453",
        "uid": "ba8699ba-a7ff-4e75-8a29-28a24af7cb9e"
      },
      "rationale": "By default if no private key file is specified to the API Server, the API Server uses the private key from the TLS serving certificate to verify service account tokens. To ensure that the keys for service account tokens could be rotated as needed, a separate public/private key pair should be used for signing service account tokens.",
      "severity": "medium",
      "title": "Configure the Service Account Private Key for the Controller Manager"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure individual service account credentials are used, set the use-service-account-credentials option to true in the openshift-kube-controller-manager configmap on the master node(s):\n\n\"extendedArguments\": {\n...\n \"use-service-account-credentials\": [\n   \"true\"\n ],\n...",
      "id": "xccdf_org.ssgproject.content_rule_controller_use_service_account",
      "instructions": "To verify that service-account-credentials is configured correctly,\nrun the following command:\n$ oc get configmaps config -n openshift-kube-controller-manager -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.extendedArguments[\"use-service-account-credentials\"]'\nThe value of use-service-account-credentials should be true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-stig,ocp4-high,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-cis,ocp4-high-rev-4,ocp4-moderate,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss",
          "compliance.openshift.io/rule": "controller-use-service-account",
          "control.compliance.openshift.io/CIS-OCP": "1.3.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.3.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-controller-use-service-account",
        "namespace": "openshift-compliance",
        "resourceVersion": "76455",
        "uid": "d9261186-476b-4e0f-a065-a3c2682ca456"
      },
      "rationale": "The controller manager creates a service account per controller in kube-system namespace, generates an API token and credentials for it, then builds a dedicated API client with that service account credential for each controller loop to use. Setting the use-service-account-credentials to true runs each control loop within the controller manager using a separate service account credential. When used in combination with RBAC, this ensures that the control loops run with the minimum permissions required to perform their intended tasks.",
      "severity": "medium",
      "title": "Ensure that use-service-account-credentials is enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Check that the default Ingress CA has been replaced.",
      "id": "xccdf_org.ssgproject.content_rule_default_ingress_ca_replaced",
      "instructions": "Verify that the proxy/cluster resource contains the name of a trusted CA secret:\n  oc get proxy/cluster -ojsonpath='{ .spec.\"trustedCA\".\"name\" }'\nThe result should be the name of a valid secret. If none, the default Ingress CA is in use.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "default-ingress-ca-replaced",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-17",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R5.1,SC-17",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-default-ingress-ca-replaced",
        "namespace": "openshift-compliance",
        "resourceVersion": "77327",
        "uid": "e653fd41-93ec-451c-9d6a-5c0745772926"
      },
      "rationale": "OpenShift auto-generates several PKIs to serve TLS on different endpoints of the system. It is possible and necessary to configure a custom PKI which allows external clients to trust the endpoints. The Ingress Operator is the component responsible for enabling external access to OpenShift Container Platform cluster services. The aforementioned operator creates an internal CA and issues a wildcard certificate that is valid for applications under the .apps sub-domain. Both the web console and CLI use this certificate as well. The certificate and key would need to be replaced since a certificate coming from a trusted provider is needed. https://docs.openshift.com/container-platform/latest/security/certificates/replacing-default-ingress-certificate.html",
      "severity": "medium",
      "title": "Ensure that the default Ingress CA (wildcard issuer) has been replaced"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -a%20always%2Cexit%20-F%20dir%3D/var/log/kube-apiserver/%20-F%20perm%3Dr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess-audit-trail%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-access-var-log-kube-audit.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect access events to read the Kubernetes audit log directory. The following audit rule will assure that access to audit log directory are collected.\n\n-a always,exit -F dir=/var/log/kube-apiserver/ -F perm=r -F auid>=1000 -F auid!=unset -F key=access-audit-trail\n\nIf the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rule to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rule to /etc/audit/audit.rules file.",
      "id": "xccdf_org.ssgproject.content_rule_directory_access_var_log_kube_audit",
      "instructions": "To determine if the system is configured to audit accesses to\n/var/log/kube-apiserver directory, run the following command:\n$ sudo grep \"dir=/var/log/kube-apiserver\" /etc/audit/audit.rules\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-high-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "directory-access-var-log-kube-audit",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-directory-access-var-log-kube-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76915",
        "uid": "7a0ca9b3-dc03-4295-9a63-0a405d174778"
      },
      "rationale": "Attempts to read the logs should be recorded, suspicious access to audit log files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.'",
      "severity": "medium",
      "title": "Record Access Events to Kubernetes Audit Log Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -a%20always%2Cexit%20-F%20dir%3D/var/log/oauth-apiserver/%20-F%20perm%3Dr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess-audit-trail%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-access-var-log-oauth-audit.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect access events to read the OAuth audit log directory. The following audit rule will assure that access to audit log directory are collected.\n\n-a always,exit -F dir=/var/log/oauth-apiserver/ -F perm=r -F auid>=1000 -F auid!=unset -F key=access-audit-trail\n\nIf the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rule to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rule to /etc/audit/audit.rules file.",
      "id": "xccdf_org.ssgproject.content_rule_directory_access_var_log_oauth_audit",
      "instructions": "To determine if the system is configured to audit accesses to\n/var/log/oauth-apiserver directory, run the following command:\n$ sudo grep \"dir=/var/log/oauth-apiserver\" /etc/audit/audit.rules\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-moderate-node",
          "compliance.openshift.io/rule": "directory-access-var-log-oauth-audit",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-directory-access-var-log-oauth-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76919",
        "uid": "9036815c-3751-465c-9247-533d1fafc08c"
      },
      "rationale": "Attempts to read the logs should be recorded, suspicious access to audit log files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.'",
      "severity": "medium",
      "title": "Record Access Events to OAuth Audit Log Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -a%20always%2Cexit%20-F%20dir%3D/var/log/openshift-apiserver/%20-F%20perm%3Dr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess-audit-trail%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-access-var-log-ocp-audit.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect access events to read the OpenShift audit log directory. The following audit rule will assure that access to audit log directory are collected.\n\n-a always,exit -F dir=/var/log/openshift-apiserver/ -F perm=r -F auid>=1000 -F auid!=unset -F key=access-audit-trail\n\nIf the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rule to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rule to /etc/audit/audit.rules file.",
      "id": "xccdf_org.ssgproject.content_rule_directory_access_var_log_ocp_audit",
      "instructions": "To determine if the system is configured to audit accesses to\n/var/log/openshift-apiserver directory, run the following command:\n$ sudo grep \"dir=/var/log/openshift-apiserver\" /etc/audit/audit.rules\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-high-node",
          "compliance.openshift.io/rule": "directory-access-var-log-ocp-audit",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-directory-access-var-log-ocp-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76922",
        "uid": "81f818f3-08c4-416c-a1e5-0b04df4890c8"
      },
      "rationale": "Attempts to read the logs should be recorded, suspicious access to audit log files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.'",
      "severity": "medium",
      "title": "Record Access Events to OpenShift Audit Log Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log/kube-apiserver/ , run the command:\n\n$ sudo chmod 0700 /var/log/kube-apiserver/",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_var_log_kube_audit",
      "instructions": "To check the permissions of /var/log/kube-apiserver/,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log/kube-apiserver/\nIf properly configured, the output should indicate the following permissions:\ndrwx------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "directory-permissions-var-log-kube-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.2;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-004-6 R3.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.2,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-004-6 R3.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CIP-007-3 R6.5,CM-6(a),AC-6(1),AU-9,Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-directory-permissions-var-log-kube-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76923",
        "uid": "d6361527-3b59-4785-a447-bb800678a167"
      },
      "rationale": "If users can write to audit logs, audit trails can be modified or destroyed.",
      "severity": "medium",
      "title": "The Kubernetes Audit Logs Directory Must Have Mode 0700"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log/oauth-apiserver/ , run the command:\n\n$ sudo chmod 0700 /var/log/oauth-apiserver/",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_var_log_oauth_audit",
      "instructions": "To check the permissions of /var/log/oauth-apiserver/,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log/oauth-apiserver/\nIf properly configured, the output should indicate the following permissions:\ndrwx------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "directory-permissions-var-log-oauth-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.2;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-004-6 R3.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.2,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-004-6 R3.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CIP-007-3 R6.5,CM-6(a),AC-6(1),AU-9,Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-directory-permissions-var-log-oauth-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76932",
        "uid": "1ccc1a9f-7fc4-4b59-bd44-5168681e7567"
      },
      "rationale": "If users can write to audit logs, audit trails can be modified or destroyed.",
      "severity": "medium",
      "title": "The OAuth Audit Logs Directory Must Have Mode 0700"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log/openshift-apiserver/ , run the command:\n\n$ sudo chmod 0700 /var/log/openshift-apiserver/",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_var_log_ocp_audit",
      "instructions": "To check the permissions of /var/log/openshift-apiserver/,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log/openshift-apiserver/\nIf properly configured, the output should indicate the following permissions:\ndrwx------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node",
          "compliance.openshift.io/rule": "directory-permissions-var-log-ocp-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.2;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-004-6 R3.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.2,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-004-6 R3.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CIP-007-3 R6.5,CM-6(a),AC-6(1),AU-9,Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-directory-permissions-var-log-ocp-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76935",
        "uid": "d5ccb0f9-25cd-4961-bc6a-e07dbc24e375"
      },
      "rationale": "If users can write to audit logs, audit trails can be modified or destroyed.",
      "severity": "medium",
      "title": "The OpenShift Audit Logs Directory Must Have Mode 0700"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift MachineSets can be configured to enable EBS encryption on EBS storage used by cluster nodes. By using EBS encryption, disk contents are encrypted using a AWS KMS key.",
      "id": "xccdf_org.ssgproject.content_rule_ebs_encryption_enabled_on_machinesets",
      "instructions": "Run the following command to retrieve if the EBS encryption is enabled:\n$ oc get machineset --all-namespaces -o json | jq '[.items[] | .spec.template.spec.providerSpec.value.blockDevices[0].ebs.encrypted] | map(. == true)'\nMake sure that the result is an array of 'true' values.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "ebs-encryption-enabled-on-machinesets",
          "control.compliance.openshift.io/PCI-DSS": "Req-3.4.1",
          "policies.open-cluster-management.io/controls": "Req-3.4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ebs-encryption-enabled-on-machinesets",
        "namespace": "openshift-compliance",
        "resourceVersion": "76214",
        "uid": "f92d0797-b966-433b-a9e7-8a16b6452828"
      },
      "rationale": "Enabling encryption on EBS storage used by the cluster nodes, more specifically worker nodes, help protect any card holder data that might be persisted on those EBS volumes. Only authorized AWS resources will be able, through IAM policies, to use the KMS key to eventually read or alter data on those volumes.",
      "severity": "high",
      "title": "Ensure that EBS volumes use by cluster nodes are encrypted"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the etcd service is not using self-signed certificates, run the following command:\n\n$ oc get cm/etcd-pod -n openshift-etcd -o yaml\n\nThe etcd pod configuration contained in the configmap should not contain the --auto-tls=true flag.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_auto_tls",
      "instructions": "Run the following command:\n$ oc get cm/etcd-pod -n openshift-etcd -o yaml\nThe etcd pod configuration contained in the configmap should not\ncontain the --auto-tls=true flag.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-cis-1-5,ocp4-high,ocp4-moderate-rev-4,ocp4-cis,ocp4-stig-v1r1,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-pci-dss,ocp4-high-rev-4,ocp4-nerc-cip,ocp4-cis-1-4",
          "compliance.openshift.io/rule": "etcd-auto-tls",
          "control.compliance.openshift.io/CIS-OCP": "2.3",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,2.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-auto-tls",
        "namespace": "openshift-compliance",
        "resourceVersion": "76460",
        "uid": "288380e1-c0cb-40f6-845c-e23746d56cc2"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection. Using self-signed certificates ensures that the certificates are never validated against a certificate authority and could lead to compromised and invalidated data.",
      "severity": "medium",
      "title": "Disable etcd Self-Signed Certificates"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the etcd service is serving TLS to clients, make sure the etcd-pod* ConfigMaps in the openshift-etcd namespace contain the following argument for the etcd binary in the etcd pod:\n\n--cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-serving-NODE_NAME.crt\n\n. Note that the\n\n[a-z]+\n\nis being used since the directory might change between OpenShift versions.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_cert_file",
      "instructions": "Run the following command:\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep -E \"\\-\\-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-serving-NODE_NAME.crt\"\nVerify that there is a certificate configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-high,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-cis,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-nerc-cip",
          "compliance.openshift.io/rule": "etcd-cert-file",
          "control.compliance.openshift.io/CIS-OCP": "2.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,2.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-cert-file",
        "namespace": "openshift-compliance",
        "resourceVersion": "76462",
        "uid": "495eb58a-69e6-40c7-b257-d6f0264bb873"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Ensure That The etcd Client Certificate Is Correctly Set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Check the current cipher suite used in ETCD.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_check_cipher_suite",
      "instructions": "Run the following command to check the cipher suites for ETCD:\n$  oc get configmaps etcd-pod -n openshift-etcd -o yaml | grep -oE 'TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256|TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256|TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384|TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384|TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256|TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256'\nMake sure that the result has at least one cipher.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-pci-dss",
          "compliance.openshift.io/rule": "etcd-check-cipher-suite",
          "control.compliance.openshift.io/PCI-DSS": "Req-4.1",
          "policies.open-cluster-management.io/controls": "Req-4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-check-cipher-suite",
        "namespace": "openshift-compliance",
        "resourceVersion": "76463",
        "uid": "a482cdf4-5cdc-4c74-9c9c-2daf13e89f7d"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "medium",
      "title": "Ensure ETCD has correct cipher suite"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the etcd service is serving TLS to clients, make sure the etcd-pod* ConfigMaps in the openshift-etcd namespace contain the following argument for the etcd binary in the etcd pod:\n\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep \"\\-\\-client-cert-auth=\"\n\nthe parameter should be set to true.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_client_cert_auth",
      "instructions": "Run the following command:\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep \"\\-\\-client-cert-auth=\"\nThe parameter should be set to true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-cis,ocp4-high-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-pci-dss,ocp4-stig-v1r1,ocp4-stig,ocp4-cis-1-4",
          "compliance.openshift.io/rule": "etcd-client-cert-auth",
          "control.compliance.openshift.io/CIS-OCP": "2.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-client-cert-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "76466",
        "uid": "5eb7dcfc-1006-4061-abca-a3ee99a8f7a2"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Enable The Client Certificate Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the etcd service is serving TLS to clients, make sure the etcd-pod* ConfigMaps in the openshift-etcd namespace contain the following argument for the etcd binary in the etcd pod:\n\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep \"\\-\\-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-serving-NODE_NAME.key\"\n\n. Note that the\n\n[a-z]+\n\nis being used since the directory might change between OpenShift versions.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_key_file",
      "instructions": "Run the following command:\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep \"\\-\\-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-serving-NODE_NAME.key\"\nVerify that there is a private key configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis,ocp4-stig-v1r1,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-5,ocp4-high,ocp4-pci-dss,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "etcd-key-file",
          "control.compliance.openshift.io/CIS-OCP": "2.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,2.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-key-file",
        "namespace": "openshift-compliance",
        "resourceVersion": "76467",
        "uid": "7bba63f3-8482-4ed2-9a94-b328163fbbac"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Ensure That The etcd Key File Is Correctly Set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the etcd service is not using self-signed certificates, run the following command:\n\n$ oc get cm/etcd-pod -n openshift-etcd -o yaml\n\nThe etcd pod configuration contained in the configmap should not contain the --peer-auto-tls=true flag.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_peer_auto_tls",
      "instructions": "Run the following command:\n$ oc get cm/etcd-pod -n openshift-etcd -o yaml\nThe etcd pod configuration contained in the configmap should not\ncontain the --peer-auto-tls=true flag.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-5,ocp4-pci-dss,ocp4-cis-1-4,ocp4-high,ocp4-moderate-rev-4,ocp4-stig,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-stig-v1r1,ocp4-cis,ocp4-high-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "etcd-peer-auto-tls",
          "control.compliance.openshift.io/CIS-OCP": "2.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,2.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-peer-auto-tls",
        "namespace": "openshift-compliance",
        "resourceVersion": "76476",
        "uid": "d97708d2-6f8a-4b3f-bb77-cbb8d68bd092"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection. Using self-signed certificates ensures that the certificates are never validated against a certificate authority and could lead to compromised and invalidated data.",
      "severity": "medium",
      "title": "Disable etcd Peer Self-Signed Certificates"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the etcd service is serving TLS to peers, make sure the etcd-pod* ConfigMaps in the openshift-etcd namespace contain the following argument for the etcd binary in the etcd pod:\n\n--peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-peer-NODE_NAME.crt\n\nNote that the\n\n[a-z]+\n\nis being used since the directory might change between OpenShift versions.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_peer_cert_file",
      "instructions": "Run the following command:\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep \"\\-\\-peer-cert-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-peer-NODE_NAME.crt\"\nVerify that there is a certificate configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-cis,ocp4-high-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-high,ocp4-pci-dss",
          "compliance.openshift.io/rule": "etcd-peer-cert-file",
          "control.compliance.openshift.io/CIS-OCP": "2.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-8,SC-8(1),SC-8(2),Req-2.2,Req-2.2.3,Req-2.3,2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-peer-cert-file",
        "namespace": "openshift-compliance",
        "resourceVersion": "76484",
        "uid": "533a6136-09cd-4632-826e-4c7d715d98a3"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Ensure That The etcd Peer Client Certificate Is Correctly Set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the etcd service is serving TLS to clients, make sure the etcd-pod* ConfigMaps in the openshift-etcd namespace contain the following argument for the etcd binary in the etcd pod:\n\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep \"\\-\\-peer-client-cert-auth=\"\n\nthe parameter should be set to true.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_peer_client_cert_auth",
      "instructions": "Run the following command:\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep \"\\-\\-peer-client-cert-auth=\"\nThe parameter should be set to true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis,ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-5,ocp4-high,ocp4-stig-v1r1,ocp4-high-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "etcd-peer-client-cert-auth",
          "control.compliance.openshift.io/CIS-OCP": "2.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,Req-2.2.3,Req-2.3,2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-peer-client-cert-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "76488",
        "uid": "7fcf252f-d0db-4581-b77e-caf5c6084e2c"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Enable The Peer Client Certificate Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the etcd service is serving TLS to peers, make sure the etcd-pod* ConfigMaps in the openshift-etcd namespace contain the following argument for the etcd binary in the etcd pod:\n\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep \"\\-\\-peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-peer-NODE_NAME.key\"\n\nNote that the\n\n[a-z]+\n\nis being used since the directory might change between OpenShift versions.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_peer_key_file",
      "instructions": "Run the following command:\noc get -nopenshift-etcd cm etcd-pod -oyaml | grep \"\\-\\-peer-key-file=/etc/kubernetes/static-pod-certs/secrets/etcd-all-[a-z]+/etcd-peer-NODE_NAME.key\"\nVerify that there is a private key configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high-rev-4,ocp4-moderate,ocp4-cis,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "etcd-peer-key-file",
          "control.compliance.openshift.io/CIS-OCP": "2.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-8,SC-8(1),SC-8(2),Req-2.2,Req-2.2.3,Req-2.3,2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-peer-key-file",
        "namespace": "openshift-compliance",
        "resourceVersion": "76490",
        "uid": "1d42ef02-5ff3-4bbd-9fca-6d63a8fae01a"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Ensure That The etcd Peer Key File Is Correctly Set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "A unique CA certificate should be created for etcd. OpenShift by default creates separate PKIs for etcd and the Kubernetes API server. The same is done for other points of communication in the cluster.",
      "id": "xccdf_org.ssgproject.content_rule_etcd_unique_ca",
      "instructions": "Run the following command:\noc debug node/$NODE -- diff /host/etc/kubernetes/static-pod-resources/etcd-certs/configmaps/etcd-serving-ca/ca-bundle.crt /host/etc/kubernetes/static-pod-resources/kube-apiserver-certs/configmaps/client-ca/ca-bundle.crt\nwhere $NODE is a master node. If you don't see diff output\nthe differences, you might have a compromise and should isolate the cluster.\nOpenShift will use separate PKIs by default.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-stig-node,ocp4-high-node,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "etcd-unique-ca",
          "control.compliance.openshift.io/CIS-OCP": "2.7",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),2.7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-etcd-unique-ca",
        "namespace": "openshift-compliance",
        "resourceVersion": "76495",
        "uid": "1288465f-12d8-48b8-988b-14f1284dcd78"
      },
      "rationale": "The Kubernetes API server and etcd utilize separate CA certificates in OpenShift. This ensures that the etcd data is still protected in the event that the API server CA is compromised.",
      "severity": "medium",
      "title": "Configure A Unique CA Certificate for etcd",
      "warning": "The Kubernetes API server and etcd utilize separate CA certificates in OpenShift. This ensures that the etcd data is still protected in the event that the API server CA is compromised."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/cni/net.d/* , run the command:\n\n$ sudo chgrp root /etc/cni/net.d/*",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_cni_conf",
      "instructions": "To check the group ownership of /etc/cni/net.d/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/cni/net.d/*\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-moderate-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-cis-node-1-4,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "file-groupowner-cni-conf",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-cni-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "76981",
        "uid": "c46bdabb-83b4-4238-b6a0-d16d12fece61"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift Container Network Interface Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig , run the command:\n\n$ sudo chgrp root /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_controller_manager_kubeconfig",
      "instructions": "To check the group ownership of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig\n  If properly configured, the output should indicate the following group-owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-moderate-node,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-groupowner-controller-manager-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "1.1.18",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.18",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-controller-manager-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "76984",
        "uid": "7afb77d5-bbda-451d-b591-1f1052782d42"
      },
      "rationale": "The Controller Manager's kubeconfig contains information about how the component will access the API server. You should set its file ownership to maintain the integrity of the file.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift Controller Manager Kubeconfig File",
      "warning": "The Controller Manager's kubeconfig contains information about how the component will access the API server. You should set its file ownership to maintain the integrity of the file."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/lib/etcd/member/ , run the command:\n\n$ sudo chgrp root /var/lib/etcd/member/",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etcd_data_dir",
      "instructions": "To check the group ownership of /var/lib/etcd/member/,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/etcd/member/\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-nerc-cip-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-stig-node",
          "compliance.openshift.io/rule": "file-groupowner-etcd-data-dir",
          "control.compliance.openshift.io/CIS-OCP": "1.1.12",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-etcd-data-dir",
        "namespace": "openshift-compliance",
        "resourceVersion": "76986",
        "uid": "938452dc-1b8d-40f2-bf4b-ad1bc86ade0b"
      },
      "rationale": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Etcd Database Directory",
      "warning": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/lib/etcd/member/wal/* , run the command:\n\n$ sudo chgrp root /var/lib/etcd/member/wal/*",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etcd_data_files",
      "instructions": "To check the group ownership of /var/lib/etcd/member/wal/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/etcd/member/wal/*\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node,ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-high-node,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "file-groupowner-etcd-data-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.12",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-etcd-data-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "76990",
        "uid": "fd3be0ef-aa08-43dd-adb3-1783bd71908b"
      },
      "rationale": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Etcd Write-Ahead-Log Files",
      "warning": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/manifests/etcd-pod.yaml , run the command:\n\n$ sudo chgrp root /etc/kubernetes/manifests/etcd-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etcd_member",
      "instructions": "To check the group ownership of /etc/kubernetes/manifests/etcd-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/manifests/etcd-pod.yaml\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "file-groupowner-etcd-member",
          "control.compliance.openshift.io/CIS-OCP": "1.1.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-etcd-member",
        "namespace": "openshift-compliance",
        "resourceVersion": "76995",
        "uid": "745ca5cb-7ba3-4788-b21c-4fd70248bf4d"
      },
      "rationale": "The etcd pod specification file controls various parameters that set the behavior of the etcd service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.",
      "severity": "medium",
      "title": "Verify Group Who Owns The etcd Member Pod Specification File",
      "warning": "The etcd pod specification file controls various parameters that set the behavior of the etcd service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/static-pod-resources/*/*/*/*.crt , run the command:\n\n$ sudo chgrp root /etc/kubernetes/static-pod-resources/*/*/*/*.crt",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etcd_pki_cert_files",
      "instructions": "To check the group ownership of /etc/kubernetes/static-pod-resources/*/*/*/*.crt,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/*/*/*/*.crt\n  If properly configured, the output should indicate the following group-owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node,ocp4-stig-node,ocp4-high-node,ocp4-stig-node-v1r1,ocp4-nerc-cip-node,ocp4-pci-dss-node,ocp4-cis-node-1-5",
          "compliance.openshift.io/rule": "file-groupowner-etcd-pki-cert-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.19",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.19",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-etcd-pki-cert-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "76999",
        "uid": "c7bc9ce2-f06b-470d-af87-1e6bc47f1c43"
      },
      "rationale": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by the system administrator.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Etcd PKI Certificate Files",
      "warning": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by the system administrator."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/lib/cni/networks/openshift-sdn/.* , run the command:\n\n$ sudo chgrp root /var/lib/cni/networks/openshift-sdn/.*",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ip_allocations",
      "instructions": "To check the group ownership of /var/lib/cni/networks/openshift-sdn/.*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/cni/networks/openshift-sdn/.*\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-cis-node,ocp4-pci-dss-node,ocp4-high-node-rev-4,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5",
          "compliance.openshift.io/rule": "file-groupowner-ip-allocations",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ip-allocations",
        "namespace": "openshift-compliance",
        "resourceVersion": "77002",
        "uid": "f5bb4a4a-a4f1-4248-bad5-943bb987c833"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift SDN Container Network Interface Plugin IP Address Allocations"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml , run the command:\n\n$ sudo chgrp root /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_kube_apiserver",
      "instructions": "To check the group ownership of /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "file-groupowner-kube-apiserver",
          "control.compliance.openshift.io/CIS-OCP": "1.1.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-kube-apiserver",
        "namespace": "openshift-compliance",
        "resourceVersion": "77003",
        "uid": "147ab84b-ae31-4678-84ae-b61a686b2a2d"
      },
      "rationale": "The Kubernetes specification file contains information about the configuration of the Kubernetes API Server that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Kubernetes API Server Pod Specification File",
      "warning": "The Kubernetes specification file contains information about the configuration of the Kubernetes API Server that is configured on the system. Protection of this file is critical for OpenShift security."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml , run the command:\n\n$ sudo chgrp root /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_kube_controller_manager",
      "instructions": "To check the group ownership of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-nerc-cip-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "file-groupowner-kube-controller-manager",
          "control.compliance.openshift.io/CIS-OCP": "1.1.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-kube-controller-manager",
        "namespace": "openshift-compliance",
        "resourceVersion": "77006",
        "uid": "ff0f7fe5-3aae-48d1-be51-fd6e04fc2fb0"
      },
      "rationale": "The Kubernetes specification file contains information about the configuration of the Kubernetes Controller Manager Server that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Kubernetes Controller Manager Pod Specification File",
      "warning": "The Kubernetes specification file contains information about the configuration of the Kubernetes Controller Manager Server that is configured on the system. Protection of this file is critical for OpenShift security."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml , run the command:\n\n$ sudo chgrp root /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_kube_scheduler",
      "instructions": "To check the group ownership of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node,ocp4-pci-dss-node,ocp4-high-node-rev-4,ocp4-moderate-node,ocp4-cis-node-1-4,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-groupowner-kube-scheduler",
          "control.compliance.openshift.io/CIS-OCP": "1.1.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-kube-scheduler",
        "namespace": "openshift-compliance",
        "resourceVersion": "77018",
        "uid": "2cc0ced9-5f49-4b38-a509-1aaa0260ed9c"
      },
      "rationale": "The Kubernetes Specification file contains information about the configuration of the Kubernetes scheduler that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Kubernetes Scheduler Pod Specification File",
      "warning": "The Kubernetes Specification file contains information about the configuration of the Kubernetes scheduler that is configured on the system. Protection of this file is critical for OpenShift security."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To properly set the group owner of /etc/kubernetes/kubeconfig , run the command:\n\n$ sudo chgrp root /etc/kubernetes/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_kubeconfig",
      "instructions": "To check the group ownership of /etc/kubernetes/kubeconfig,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/kubeconfig\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-groupowner-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "1.1.14",
          "policies.open-cluster-management.io/controls": "1.1.14",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77020",
        "uid": "aa4b035b-c7bb-4ec4-a99a-c91cef1335bc"
      },
      "rationale": "The /etc/kubernetes/kubeconfig file contains information about the administrative configuration of the OpenShift cluster that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift Admin Kubeconfig File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/kubelet.conf , run the command:\n\n$ sudo chgrp root /etc/kubernetes/kubelet.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_kubelet_conf",
      "instructions": "To check the group ownership of /etc/kubernetes/kubelet.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/kubelet.conf\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-high-node,ocp4-cis-node-1-4,ocp4-cis-node,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "file-groupowner-kubelet-conf",
          "control.compliance.openshift.io/CIS-OCP": "4.1.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-kubelet-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77529",
        "uid": "1bf2fdbe-0bba-4595-875e-89fd4a982a9c"
      },
      "rationale": "The kubelet configuration file contains information about the configuration of the OpenShift node that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Kubelet Configuration File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig , run the command:\n\n$ sudo chgrp root /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_master_admin_kubeconfigs",
      "instructions": "To check the group ownership of /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig\n  If properly configured, the output should indicate the following group-owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-moderate-node-rev-4,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "file-groupowner-master-admin-kubeconfigs",
          "control.compliance.openshift.io/CIS-OCP": "1.1.14",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.14",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-master-admin-kubeconfigs",
        "namespace": "openshift-compliance",
        "resourceVersion": "77022",
        "uid": "df4e6604-2f02-4bb1-bd05-a6482d8b6c68"
      },
      "rationale": "There are various kubeconfig files that can be used by the administrator, defining various settings for the administration of the cluster. These files contain credentials that can be used to control the cluster and are needed for disaster recovery and each kubeconfig points to a different endpoint in the cluster. You should restrict its file permissions to maintain the integrity of the kubeconfig file as an attacker who gains access to these files can take over the cluster.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift Admin Kubeconfig Files",
      "warning": "There are various kubeconfig files that can be used by the administrator, defining various settings for the administration of the cluster. These files contain credentials that can be used to control the cluster and are needed for disaster recovery and each kubeconfig points to a different endpoint in the cluster. You should restrict its file permissions to maintain the integrity of the kubeconfig file as an attacker who gains access to these files can take over the cluster."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/run/multus/cni/net.d/* , run the command:\n\n$ sudo chgrp root /var/run/multus/cni/net.d/*",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_multus_conf",
      "instructions": "To check the group ownership of /var/run/multus/cni/net.d/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/run/multus/cni/net.d/*\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-cis-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-stig-node",
          "compliance.openshift.io/rule": "file-groupowner-multus-conf",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-multus-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77024",
        "uid": "f0fc4c47-32a0-4b69-8f63-17290ac59c4d"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift Multus Container Network Interface Plugin Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/static-pod-resources/*/*/*/tls.crt , run the command:\n\n$ sudo chgrp root /etc/kubernetes/static-pod-resources/*/*/*/tls.crt",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_openshift_pki_cert_files",
      "instructions": "To check the group ownership of /etc/kubernetes/static-pod-resources/.*/.*/.*/tls.crt,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/.*/.*/.*/tls.crt\n  If properly configured, the output should indicate the following group-owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "file-groupowner-openshift-pki-cert-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.19",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.19",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-openshift-pki-cert-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77027",
        "uid": "b2a3248d-5f78-4643-96b6-13826c5291e0"
      },
      "rationale": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by the system administrator.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift PKI Certificate Files",
      "warning": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by the system administrator."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/static-pod-resources/*/*/*/*.key , run the command:\n\n$ sudo chgrp root /etc/kubernetes/static-pod-resources/*/*/*/*.key",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_openshift_pki_key_files",
      "instructions": "To check the group ownership of /etc/kubernetes/static-pod-resources/*/*/*/*.key,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/*/*/*/*.key\n  If properly configured, the output should indicate the following group-owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-pci-dss-node-3-2,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-cis-node-1-4,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node",
          "compliance.openshift.io/rule": "file-groupowner-openshift-pki-key-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.19",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.19",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-openshift-pki-key-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77038",
        "uid": "9fbb24c3-4323-4d62-bf5d-79d1e04b6c35"
      },
      "rationale": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by root:root.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift PKI Private Key Files",
      "warning": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by root:root."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/run/openshift-sdn/cniserver/config.json , run the command:\n\n$ sudo chgrp root /var/run/openshift-sdn/cniserver/config.json",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_openshift_sdn_cniserver_config",
      "instructions": "To check the group ownership of /var/run/openshift-sdn/cniserver/config.json,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/run/openshift-sdn/cniserver/config.json\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "file-groupowner-openshift-sdn-cniserver-config",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-openshift-sdn-cniserver-config",
        "namespace": "openshift-compliance",
        "resourceVersion": "77040",
        "uid": "d21ceb64-29c4-4d04-a8bc-90bbc8399669"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift SDN CNI Server Config"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/openvswitch/.* , run the command:\n\n$ sudo chgrp root /etc/openvswitch/.*",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_openvswitch",
      "instructions": "To check the group ownership of /etc/origin/openvswitch/.*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/origin/openvswitch/.*\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-groupowner-openvswitch",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "policies.open-cluster-management.io/controls": "1.1.10",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-openvswitch",
        "namespace": "openshift-compliance",
        "resourceVersion": "77041",
        "uid": "cbd0834e-d2fa-4a97-b512-c7c2eef351bf"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift Open vSwitch Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /run/ovn-kubernetes/cni/ovn-cni-server.sock , run the command:\n\n$ sudo chgrp root /run/ovn-kubernetes/cni/ovn-cni-server.sock",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovn_cni_server_sock",
      "instructions": "To check the group ownership of /run/ovn-kubernetes/cni/ovn-cni-server.sock,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /run/ovn-kubernetes/cni/ovn-cni-server.sock\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-stig-node,ocp4-high-node,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node",
          "compliance.openshift.io/rule": "file-groupowner-ovn-cni-server-sock",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovn-cni-server-sock",
        "namespace": "openshift-compliance",
        "resourceVersion": "77047",
        "uid": "45cb255a-d846-43b3-9a20-9e7f46c45ff0"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OVNKubernetes Socket"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/lib/ovn/etc/*.db , run the command:\n\n$ sudo chgrp root /var/lib/ovn/etc/*.db",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovn_db_files",
      "instructions": "To check the group ownership of /var/lib/ovn/etc/*.db,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /var/lib/ovn/etc/*.db\n  If properly configured, the output should indicate the following group-owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-pci-dss-node-3-2,ocp4-cis-node",
          "compliance.openshift.io/rule": "file-groupowner-ovn-db-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovn-db-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77048",
        "uid": "9d3d6d04-54ab-41d3-96b1-8ffe7a91a3f1"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OVNKubernetes DB files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Check if the group owner of /etc/openvswitch/conf.db is hugetlbfs on architectures other than s390x or openvswitch on s390x.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_conf_db",
      "instructions": "To check the group ownership of /etc/openvswitch/conf.db,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\nThen,\nrun the command:\n$ ls -lL /etc/openvswitch/conf.db\nIf properly configured, the output should indicate the following group-owner:\nhugetlbfs on architectures other than s390x. On s390x, the\ngroup-owner should be openvswitch.\n      Is it the case that <code>/etc/openvswitch/conf.db</code> does not have a group owner of\ncode>hugetlbfs</code> on architectures other than s390x or <code>openvswitch</code>",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-cis-node,ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-pci-dss-node-3-2,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "file-groupowner-ovs-conf-db",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-conf-db",
        "namespace": "openshift-compliance",
        "resourceVersion": "77056",
        "uid": "ba2f45a0-21bf-4006-8e03-0ce664d02740"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Configuration Database"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Check if the group owner of /etc/openvswitch/conf.db.~lock~ is hugetlbfs on architectures other than s390x or openvswitch on s390x.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_conf_db_lock",
      "instructions": "To check the group ownership of /etc/openvswitch/conf.db~lock~,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\nThen,\nrun the command:\n$ ls -lL /etc/openvswitch/conf.db~lock~\nIf properly configured, the output should indicate the following group-owner:\nhugetlbfs on architectures other than s390x. On s390x, the\ngroup-owner should be openvswitch.\n      Is it the case that <code>/etc/openvswitch/conf.db.~lock~</code> does not have a group owner of\ncode>hugetlbfs</code> on architectures other than s390x or <code>openvswitch</code>",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-stig-node,ocp4-pci-dss-node,ocp4-high-node,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "file-groupowner-ovs-conf-db-lock",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-conf-db-lock",
        "namespace": "openshift-compliance",
        "resourceVersion": "77062",
        "uid": "dceb30da-b8a1-47bf-8d96-b70179e2e32a"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Configuration Database Lock"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/openvswitch/.conf.db.~lock~ , run the command:\n\n$ sudo chgrp hugetlbfs /etc/openvswitch/.conf.db.~lock~",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_conf_db_lock_not_s390x",
      "instructions": "To check the group ownership of /etc/openvswitch/.conf.db.~lock~,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/.conf.db.~lock~\nIf properly configured, the output should indicate the following group-owner:\nhugetlbfs",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-groupowner-ovs-conf-db-lock-not-s390x",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-conf-db-lock-not-s390x",
        "namespace": "openshift-compliance",
        "resourceVersion": "77061",
        "uid": "5d3991f9-bf84-4b41-9ad6-bd584b9a5d42"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Configuration Database Lock"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/openvswitch/.conf.db.~lock~ , run the command:\n\n$ sudo chgrp hugetlbfs /etc/openvswitch/.conf.db.~lock~",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_conf_db_lock_s390x",
      "instructions": "To check the group ownership of /etc/openvswitch/.conf.db.~lock~,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/.conf.db.~lock~\nIf properly configured, the output should indicate the following group-owner:\nhugetlbfs",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-groupowner-ovs-conf-db-lock-s390x",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-conf-db-lock-s390x",
        "namespace": "openshift-compliance",
        "resourceVersion": "77074",
        "uid": "228e17e2-ca90-4d1e-a227-1bd67c8523c7"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Configuration Database Lock"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/openvswitch/conf.db , run the command:\n\n$ sudo chgrp hugetlbfs /etc/openvswitch/conf.db",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_conf_db_not_s390x",
      "instructions": "To check the group ownership of /etc/openvswitch/conf.db,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/conf.db\nIf properly configured, the output should indicate the following group-owner:\nhugetlbfs",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-groupowner-ovs-conf-db-not-s390x",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-conf-db-not-s390x",
        "namespace": "openshift-compliance",
        "resourceVersion": "77073",
        "uid": "d8f9b7d9-9a76-4dbb-8358-b6dfa14e4866"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Configuration Database"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/openvswitch/conf.db , run the command:\n\n$ sudo chgrp openvswitch /etc/openvswitch/conf.db",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_conf_db_s390x",
      "instructions": "To check the group ownership of /etc/openvswitch/conf.db,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/conf.db\nIf properly configured, the output should indicate the following group-owner:\nopenvswitch",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-groupowner-ovs-conf-db-s390x",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-conf-db-s390x",
        "namespace": "openshift-compliance",
        "resourceVersion": "77078",
        "uid": "4ed2cdd8-32f0-4b77-8b7c-43f01a41667e"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Configuration Database"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that the file\n\n/var/run/openvswitch/ovs-vswitchd.pid\n\n, is owned by the group\n\nopenvswitch\n\nor\n\nhugetlbfs\n\n, depending on your settings and Open vSwitch version.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_pid",
      "instructions": "To check the group ownership of /var/run/openvswitch/ovs-vswitchd.pid,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n\n$ oc debug node/$NODE_NAME\n\n\nAt the sh-4.4# prompt, run:\n\n\n# chroot /host\n\n\nThen,run the command:\n\n$ ls -l /var/run/openvswitch/ovs-vswitchd.pid\n\nIf properly configured, the output should indicate one of the following group-owners:\nopenvswitch or hugetlbfs",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-nerc-cip-node,ocp4-cis-node-1-4,ocp4-moderate-node",
          "compliance.openshift.io/rule": "file-groupowner-ovs-pid",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "77085",
        "uid": "22a52a3a-7829-4c52-abd6-294fb951ad32"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Process ID File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Check if the group owner of /etc/openvswitch/system-id.conf is hugetlbfs on architectures other than s390x or openvswitch on x390x.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_sys_id_conf",
      "instructions": "To check the group ownership of /etc/openvswitch/system-id.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\nThen,\nrun the command:\n$ ls -lL /etc/openvswitch/system-id.conf\nIf properly configured, the output should indicate the following group-owner:\nhugetlbfs on architectures other than s390x. On s390x, the\ngroup-owner should be openvswitch.\n      Is it the case that <code>/etc/openvswitch/system-id.conf</code> does not have a group owner of\ncode>hugetlbfs</code> on architectures other than s390x or <code>openvswitch</code>",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-cis-node",
          "compliance.openshift.io/rule": "file-groupowner-ovs-sys-id-conf",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-sys-id-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77079",
        "uid": "cb4ea09a-049e-4f1e-bb32-a5e3e30cb5e9"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Persistent System ID"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/openvswitch/system-id.conf , run the command:\n\n$ sudo chgrp hugetlbfs /etc/openvswitch/system-id.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_sys_id_conf_not_s390x",
      "instructions": "To check the group ownership of /etc/openvswitch/system-id.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/system-id.conf\nIf properly configured, the output should indicate the following group-owner:\nhugetlbfs",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-groupowner-ovs-sys-id-conf-not-s390x",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-sys-id-conf-not-s390x",
        "namespace": "openshift-compliance",
        "resourceVersion": "77091",
        "uid": "03bcfc00-4cf7-4954-83b9-ede989b5d807"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Persistent System ID"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/openvswitch/system-id.conf , run the command:\n\n$ sudo chgrp hugetlbfs /etc/openvswitch/system-id.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_sys_id_conf_s390x",
      "instructions": "To check the group ownership of /etc/openvswitch/system-id.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/system-id.conf\nIf properly configured, the output should indicate the following group-owner:\nhugetlbfs",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-groupowner-ovs-sys-id-conf-s390x",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-sys-id-conf-s390x",
        "namespace": "openshift-compliance",
        "resourceVersion": "77093",
        "uid": "2a4512dc-a6b2-4b8e-a037-0c1f05e3ff72"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Persistent System ID"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that the file\n\n/run/openvswitch/ovs-vswitchd.pid\n\n, is owned by the group\n\nopenvswitch\n\nor\n\nhugetlbfs\n\n, depending on your settings and Open vSwitch version.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovs_vswitchd_pid",
      "instructions": "To check the group ownership of /run/openvswitch/ovs-vswitchd.pid,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n\n$ oc debug node/$NODE_NAME\n\n\nAt the sh-4.4# prompt, run:\n\n\n# chroot /host\n\n\nThen,run the command:\n\n$ ls -l /run/openvswitch/ovs-vswitchd.pid\n\nIf properly configured, the output should indicate one of the following group-owners:\nopenvswitch or hugetlbfs",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-stig-node,ocp4-pci-dss-node-3-2,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-moderate-node",
          "compliance.openshift.io/rule": "file-groupowner-ovs-vswitchd-pid",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovs-vswitchd-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "77096",
        "uid": "650cf443-e34a-423a-9e90-1cdca08c90fc"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Daemon PID File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that the file\n\n/run/openvswitch/ovsdb-server.pid\n\n, is owned by the group\n\nopenvswitch\n\nor\n\nhugetlbfs\n\n, depending on your settings and Open vSwitch version.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_ovsdb_server_pid",
      "instructions": "To check the group ownership of /run/openvswitch/ovsdb-server.pid,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n\n$ oc debug node/$NODE_NAME\n\n\nAt the sh-4.4# prompt, run:\n\n\n# chroot /host\n\n\nThen,run the command:\n\n$ ls -l /run/openvswitch/ovsdb-server.pid\n\nIf properly configured, the output should indicate one of the following group-owners:\nopenvswitch or hugetlbfs",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-cis-node-1-4,ocp4-cis-node-1-5",
          "compliance.openshift.io/rule": "file-groupowner-ovsdb-server-pid",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-ovsdb-server-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "77098",
        "uid": "ac164bc6-12cb-4ce0-9770-21b8b226c193"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Open vSwitch Database Server PID"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All logs must be owned by root user and group and have permissions 755. By default, the path for the Kubernetes pod logs is\n\n/var/log/pods/\n\n.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_pod_logs",
      "instructions": "To properly set the group owner of /var/log/pods/*, run the command:\n$ sudo chgrp root /var/log/pods/*",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-groupowner-pod-logs"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-pod-logs",
        "namespace": "openshift-compliance",
        "resourceVersion": "76521",
        "uid": "7489280d-7aa6-4c68-8865-2a15ea96d5a1"
      },
      "rationale": "Pod log files may contain sensitive information such as application data, user credentials, or system configurations. Unauthorized access to these log files can expose sensitive data to malicious actors. By setting owner permissions, OpenShift ensures that only authorized users or processes with the necessary privileges can access the pod log files, preserving the confidentiality of the logged information.",
      "severity": "medium",
      "title": "Kubernetes Pod Logs Must Be Group Owned By Root"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To ensure the Kubernetes ConfigMap is mounted into the sdn daemonset pods with the correct ownership, make sure that the sdn-config ConfigMap is mounted using a ConfigMap at the /config mount point and that the sdn container points to that configuration using the --proxy-config command line option. Run:\n\noc get -nopenshift-sdn ds sdn -ojson | jq -r '.spec.template.spec.containers[] | select(.name == \"sdn\")'\n\nand ensure the --proxy-config parameter points to /config/kube-proxy-config.yaml and that the config mount point is mounted from the sdn-config ConfigMap.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_proxy_kubeconfig",
      "instructions": "Run the following command:\n\n $ for i in $(oc get pods -n openshift-sdn -l app=sdn -oname)\n   do\n      oc exec -n openshift-sdn $i -- stat -Lc %U:%G /config/kube-proxy-config.yaml\n   done\n\nThe output should be root:root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-stig,ocp4-high,ocp4-cis",
          "compliance.openshift.io/rule": "file-groupowner-proxy-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "4.1.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,4.1.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-proxy-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77527",
        "uid": "bc3ce6ee-69e6-472f-bac9-434cf9d00705"
      },
      "rationale": "The kubeconfig file for kube-proxy provides permissions to the kube-proxy service. The proxy kubeconfig file contains information about the administrative configuration of the OpenShift cluster that is configured on the system. Protection of this file is critical for OpenShift security. The file is provided via a ConfigMap mount, so the kubelet itself makes sure that the file permissions are appropriate for the container taking it into use.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Worker Proxy Kubeconfig File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig , run the command:\n\n$ sudo chgrp root /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_scheduler_kubeconfig",
      "instructions": "To check the group ownership of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig\n  If properly configured, the output should indicate the following group-owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-groupowner-scheduler-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "1.1.16",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.16",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-scheduler-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77102",
        "uid": "437db3fd-59cd-4f72-95c7-4b05ec6e8b74"
      },
      "rationale": "The kubeconfig for the Scheduler contains parameters for the scheduler to access the Kube API. You should set its file ownership to maintain the integrity of the file.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Kubernetes Scheduler Kubeconfig File",
      "warning": "The kubeconfig for the Scheduler contains parameters for the scheduler to access the Kube API. You should set its file ownership to maintain the integrity of the file."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/kubernetes/kubelet-ca.crt , run the command:\n\n$ sudo chgrp root /etc/kubernetes/kubelet-ca.crt",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_worker_ca",
      "instructions": "To check the group ownership of /etc/kubernetes/kubelet-ca.crt,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/kubelet-ca.crt\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-high-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-groupowner-worker-ca",
          "control.compliance.openshift.io/CIS-OCP": "4.1.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-worker-ca",
        "namespace": "openshift-compliance",
        "resourceVersion": "77533",
        "uid": "fc4bb3bd-7776-4b04-a516-ab66515ba4c4"
      },
      "rationale": "The worker certificate authority file contains the certificate authority certificate for an OpenShift node that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Group Who Owns the Worker Certificate Authority File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/lib/kubelet/kubeconfig , run the command:\n\n$ sudo chgrp root /var/lib/kubelet/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_worker_kubeconfig",
      "instructions": "To check the group ownership of /var/lib/kubelet/kubeconfig,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/kubelet/kubeconfig\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-5,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "file-groupowner-worker-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "4.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-worker-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77540",
        "uid": "3e3abc65-72ca-4084-b2a2-b56bd0323f19"
      },
      "rationale": "The worker kubeconfig file contains information about the administrative configuration of the OpenShift cluster that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Group Who Owns The Worker Kubeconfig File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "' To properly set the group owner of /etc/systemd/system/kubelet.service , run the command:\n\n$ sudo chgrp root /etc/systemd/system/kubelet.service\n\n'",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_worker_service",
      "instructions": "To check the group ownership of /etc/systemd/system/kubelet.service,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/systemd/system/kubelet.service\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "file-groupowner-worker-service",
          "control.compliance.openshift.io/CIS-OCP": "4.1.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-groupowner-worker-service",
        "namespace": "openshift-compliance",
        "resourceVersion": "77546",
        "uid": "5b56fba1-525e-4757-a32f-65787d2ee114"
      },
      "rationale": "The /etc/systemd/system/kubelet.service file contains information about the configuration of the OpenShift node service that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Group Who Owns The OpenShift Node Service File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The File Integrity Operator ( https://docs.openshift.com/container-platform/4.7/security/file_integrity_operator/file-integrity-operator-understanding.html ) continually runs file integrity checks on the cluster nodes. It deploys a daemon set that initializes and runs privileged AIDE containers on each node, providing a status object with a log of files that are modified during the initial run of the daemon set pods.",
      "id": "xccdf_org.ssgproject.content_rule_file_integrity_exists",
      "instructions": "Run the following command to retrieve the fileintegrity objects in the system:\n$ oc get fileintegrities --all-namespaces\nMake sure the File Integrity Operator is installed and there exists\nat least one active FileIntegrity object in the cluster.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-moderate,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "file-integrity-exists",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2",
          "control.compliance.openshift.io/NIST-800-53": "SC-4(23);SI-6;SI-7;SI-7(1);CM-6(a);SI-7(2);SI-4(24)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5;Req-11.5",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,SC-4(23),SI-6,SI-7,SI-7(1),CM-6(a),SI-7(2),SI-4(24),Req-10.5.5,Req-11.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-integrity-exists",
        "namespace": "openshift-compliance",
        "resourceVersion": "76205",
        "uid": "8532daac-b163-4fe0-81df-16c558ebb944"
      },
      "rationale": "File integrity scanning able to detect potential and unauthorised access.",
      "severity": "medium",
      "title": "Ensure that File Integrity Operator is scanning the cluster"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The OpenShift platform provides the File Integrity Operator to monitor for unwanted file changes, and this control ensures proper notification alert is enabled so that system administrators and security personnel are notified about the alerts",
      "id": "xccdf_org.ssgproject.content_rule_file_integrity_notification_enabled",
      "instructions": "Run the following command to see if alert monitor is enabled by File Integrity Operator:\n$  oc get prometheusrules --all-namespaces -o json | jq '[.items[] | select(.metadata.name ==\"file-integrity\") | .metadata.name]'\nMake sure that there is one output named: file-integrity",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "file-integrity-notification-enabled",
          "control.compliance.openshift.io/NIST-800-53": "SI-6;SI-7(2);SI-4(24)",
          "control.compliance.openshift.io/PCI-DSS": "Req-11.5.1;Req-12.10.5",
          "policies.open-cluster-management.io/controls": "SI-6,SI-7(2),SI-4(24),Req-11.5.1,Req-12.10.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-integrity-notification-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76525",
        "uid": "cb6d819d-4208-40c3-978b-563ced99709d"
      },
      "rationale": "File Integrity Operator is able to send out alerts",
      "severity": "medium",
      "title": "Ensure the notification is enabled for file integrity operator"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/cni/net.d/* , run the command:\n\n$ sudo chown root /etc/cni/net.d/*",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_cni_conf",
      "instructions": "To check the ownership of /etc/cni/net.d/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/cni/net.d/*\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "file-owner-cni-conf",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-cni-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77111",
        "uid": "f5339021-d77a-4db2-a629-56c193e73d1c"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift Container Network Interface Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig , run the command:\n\n$ sudo chown root /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_controller_manager_kubeconfig",
      "instructions": "To check the ownership of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig\n  If properly configured, the output should indicate the following owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "file-owner-controller-manager-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "1.1.18",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.18",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-controller-manager-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77113",
        "uid": "27ac12f1-4b79-413f-b5e0-165252283c1b"
      },
      "rationale": "The Controller Manager's kubeconfig contains information about how the component will access the API server. You should set its file ownership to maintain the integrity of the file.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift Controller Manager Kubeconfig File",
      "warning": "The Controller Manager's kubeconfig contains information about how the component will access the API server. You should set its file ownership to maintain the integrity of the file."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/lib/etcd/member/ , run the command:\n\n$ sudo chown root /var/lib/etcd/member/",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etcd_data_dir",
      "instructions": "To check the ownership of /var/lib/etcd/member/,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/etcd/member/\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "file-owner-etcd-data-dir",
          "control.compliance.openshift.io/CIS-OCP": "1.1.12",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-etcd-data-dir",
        "namespace": "openshift-compliance",
        "resourceVersion": "77115",
        "uid": "59e4a9a5-72fb-4895-9c9d-62112235b833"
      },
      "rationale": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes.",
      "severity": "medium",
      "title": "Verify User Who Owns The Etcd Database Directory",
      "warning": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/lib/etcd/member/wal/* , run the command:\n\n$ sudo chown root /var/lib/etcd/member/wal/*",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etcd_data_files",
      "instructions": "To check the ownership of /var/lib/etcd/member/wal/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/etcd/member/wal/*\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-moderate-node,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-5,ocp4-high-node-rev-4,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "file-owner-etcd-data-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.12",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-etcd-data-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77118",
        "uid": "2af72f28-7dd1-4ee2-8a15-1db27f87a88b"
      },
      "rationale": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes.",
      "severity": "medium",
      "title": "Verify User Who Owns The Etcd Write-Ahead-Log Files",
      "warning": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/manifests/etcd-pod.yaml , run the command:\n\n$ sudo chown root /etc/kubernetes/manifests/etcd-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etcd_member",
      "instructions": "To check the ownership of /etc/kubernetes/manifests/etcd-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/manifests/etcd-pod.yaml\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-5,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "file-owner-etcd-member",
          "control.compliance.openshift.io/CIS-OCP": "1.1.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-etcd-member",
        "namespace": "openshift-compliance",
        "resourceVersion": "77121",
        "uid": "d2fed2fe-3607-406b-8220-1942ab6d7058"
      },
      "rationale": "The etcd pod specification file controls various parameters that set the behavior of the etcd service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.",
      "severity": "medium",
      "title": "Verify User Who Owns The Etcd Member Pod Specification File",
      "warning": "The etcd pod specification file controls various parameters that set the behavior of the etcd service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/static-pod-resources/*/*/*/*.crt , run the command:\n\n$ sudo chown root /etc/kubernetes/static-pod-resources/*/*/*/*.crt",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etcd_pki_cert_files",
      "instructions": "To check the ownership of /etc/kubernetes/static-pod-resources/*/*/*/*.crt,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/*/*/*/*.crt\n  If properly configured, the output should indicate the following owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node",
          "compliance.openshift.io/rule": "file-owner-etcd-pki-cert-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.19",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.19",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-etcd-pki-cert-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77126",
        "uid": "09cf7995-77a6-4882-a71b-343b052c0491"
      },
      "rationale": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by the system administrator.",
      "severity": "medium",
      "title": "Verify User Who Owns The Etcd PKI Certificate Files",
      "warning": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by the system administrator."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All logs must be owned by root user and group and have permissions 755. By default, the path for the Kubernetes pod logs is\n\n/var/log/pods/\n\n.\n\nIf any of the files have incorrect permissions or ownerhship, change the permissions and ownership of files located under \"/var/log/pods\" to protect from unauthorized access. 1. Execute the following to set the output of pods readable only by the owner: for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n \"$HOSTNAME \"; find /var/log/pods/ -type f \\( -perm /022 -o -perm /044 \\) | xargs -r chmod 600' 2>/dev/null; done 2. Execute the following to set the group and group-ownership to root for files that store the output of pods: for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n \"$HOSTNAME \"; find /var/log/pods/ -type f \\! -user 0 | xargs -r chown root:root' 2>/dev/null; done",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_groupowner_permissions_pod_logs",
      "instructions": "Verify the permissions and ownership of files located under \"/var/log/pods\" that store the output of pods are set to protect from unauthorized access.\n\n1. Verify the files are readable only by the owner by executing the following command:\n\nfor node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n \"$HOSTNAME \"; find /var/log/pods/ -type f \\( -perm /022 -o -perm /044 \\)' 2>/dev/null; done\n\nIf any files are returned, this is a finding.\n\n2. Verify files are group-owned by root and owned by root by executing the following:\n\nfor node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n \"$HOSTNAME \"; find /var/log/pods/ -type f \\! -user 0' 2>/dev/null; done\n\n(Example output:\nip-10-0-150-1 root root)\n\nIf \"root\" is not returned as the owner, this is a finding.\n\nIf \"root\" is not returned as the group owner, this is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "file-owner-groupowner-permissions-pod-logs"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-groupowner-permissions-pod-logs",
        "namespace": "openshift-compliance",
        "resourceVersion": "76531",
        "uid": "2ae5ec3f-53d0-4228-8c8f-e3ea2e42aa26"
      },
      "rationale": "Pod log files may contain sensitive information such as application data, user credentials, or system configurations. Unauthorized access to these log files can expose sensitive data to malicious actors. By setting owner permissions, OpenShift ensures that only authorized users or processes with the necessary privileges can access the pod log files, preserving the confidentiality of the logged information.",
      "severity": "medium",
      "title": "Kubernetes Pod Logs Must Be Owned and Group Owned By Root and have permissions 755"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/lib/cni/networks/openshift-sdn/.* , run the command:\n\n$ sudo chown root /var/lib/cni/networks/openshift-sdn/.*",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_ip_allocations",
      "instructions": "To check the ownership of /var/lib/cni/networks/openshift-sdn/.*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/cni/networks/openshift-sdn/.*\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-pci-dss-node-3-2,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "file-owner-ip-allocations",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-ip-allocations",
        "namespace": "openshift-compliance",
        "resourceVersion": "77130",
        "uid": "278f046a-a696-48b8-9069-70f9746f7b0c"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift SDN Container Network Interface Plugin IP Address Allocations"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml , run the command:\n\n$ sudo chown root /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_kube_apiserver",
      "instructions": "To check the ownership of /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node",
          "compliance.openshift.io/rule": "file-owner-kube-apiserver",
          "control.compliance.openshift.io/CIS-OCP": "1.1.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-kube-apiserver",
        "namespace": "openshift-compliance",
        "resourceVersion": "77133",
        "uid": "889b9078-1578-406c-817e-927da19dfc17"
      },
      "rationale": "The Kubernetes specification file contains information about the configuration of the Kubernetes API Server that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify User Who Owns The Kubernetes API Server Pod Specification File",
      "warning": "The Kubernetes specification file contains information about the configuration of the Kubernetes API Server that is configured on the system. Protection of this file is critical for OpenShift security."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml , run the command:\n\n$ sudo chown root /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_kube_controller_manager",
      "instructions": "To check the ownership of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "file-owner-kube-controller-manager",
          "control.compliance.openshift.io/CIS-OCP": "1.1.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-kube-controller-manager",
        "namespace": "openshift-compliance",
        "resourceVersion": "77135",
        "uid": "5cf5f747-3011-469d-87d8-b2a7393a3283"
      },
      "rationale": "The Kubernetes specification file contains information about the configuration of the Kubernetes Controller Manager Server that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify User Who Owns The Kubernetes Controller Manager Pod Specification File",
      "warning": "The Kubernetes specification file contains information about the configuration of the Kubernetes Controller Manager Server that is configured on the system. Protection of this file is critical for OpenShift security."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml , run the command:\n\n$ sudo chown root /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_kube_scheduler",
      "instructions": "To check the ownership of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node-1-5",
          "compliance.openshift.io/rule": "file-owner-kube-scheduler",
          "control.compliance.openshift.io/CIS-OCP": "1.1.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-kube-scheduler",
        "namespace": "openshift-compliance",
        "resourceVersion": "77138",
        "uid": "483eba3c-477d-4e49-b952-064c128f236b"
      },
      "rationale": "The Kubernetes specification file contains information about the configuration of the Kubernetes scheduler that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify User Who Owns The Kubernetes Scheduler Pod Specification File",
      "warning": "The Kubernetes specification file contains information about the configuration of the Kubernetes scheduler that is configured on the system. Protection of this file is critical for OpenShift security."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To properly set the owner of /etc/kubernetes/kubeconfig , run the command:\n\n$ sudo chown root /etc/kubernetes/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_kubeconfig",
      "instructions": "To check the ownership of /etc/kubernetes/kubeconfig,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/kubeconfig\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-owner-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "1.1.14",
          "policies.open-cluster-management.io/controls": "1.1.14",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77144",
        "uid": "2144890c-7ba4-4f50-b678-19020d24d191"
      },
      "rationale": "The /etc/kubernetes/kubeconfig file contains information about the administrative configuration of the OpenShift cluster that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift Admin Kubeconfig File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/lib/kubelet/config.json , run the command:\n\n$ sudo chown root /var/lib/kubelet/config.json",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_kubelet",
      "instructions": "To check the ownership of /var/lib/kubelet/config.json,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/kubelet/config.json\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-high-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "file-owner-kubelet",
          "control.compliance.openshift.io/CIS-OCP": "4.1.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-kubelet",
        "namespace": "openshift-compliance",
        "resourceVersion": "77539",
        "uid": "3f12b77d-df6e-4d43-a3bf-6f7db4cc558f"
      },
      "rationale": "The kubelet configuration file contains information about the configuration of the OpenShift node that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify User Who Owns The Kubelet Configuration File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/kubelet.conf , run the command:\n\n$ sudo chown root /etc/kubernetes/kubelet.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_kubelet_conf",
      "instructions": "To check the ownership of /etc/kubernetes/kubelet.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/kubelet.conf\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-owner-kubelet-conf",
          "control.compliance.openshift.io/CIS-OCP": "4.1.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-kubelet-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77538",
        "uid": "f62bf441-0cde-42ab-9964-c0b1d4f75da9"
      },
      "rationale": "The kubelet configuration file contains information about the configuration of the OpenShift node that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify User Who Owns The Kubelet Configuration File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig , run the command:\n\n$ sudo chown root /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_master_admin_kubeconfigs",
      "instructions": "To check the ownership of /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig\n  If properly configured, the output should indicate the following owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-moderate-node,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "file-owner-master-admin-kubeconfigs",
          "control.compliance.openshift.io/CIS-OCP": "1.1.14",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.14",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-master-admin-kubeconfigs",
        "namespace": "openshift-compliance",
        "resourceVersion": "77147",
        "uid": "cd9216b1-06dd-42bd-9b17-d6317218db6e"
      },
      "rationale": "There are various kubeconfig files that can be used by the administrator, defining various settings for the administration of the cluster. These files contain credentials that can be used to control the cluster and are needed for disaster recovery and each kubeconfig points to a different endpoint in the cluster. You should restrict its file permissions to maintain the integrity of the kubeconfig file as an attacker who gains access to these files can take over the cluster.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift Admin Kubeconfig Files",
      "warning": "There are various kubeconfig files that can be used by the administrator, defining various settings for the administration of the cluster. These files contain credentials that can be used to control the cluster and are needed for disaster recovery and each kubeconfig points to a different endpoint in the cluster. You should restrict its file permissions to maintain the integrity of the kubeconfig file as an attacker who gains access to these files can take over the cluster."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/run/multus/cni/net.d/* , run the command:\n\n$ sudo chown root /var/run/multus/cni/net.d/*",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_multus_conf",
      "instructions": "To check the ownership of /var/run/multus/cni/net.d/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/run/multus/cni/net.d/*\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node",
          "compliance.openshift.io/rule": "file-owner-multus-conf",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-multus-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77150",
        "uid": "01a1346b-8182-4dbe-912f-afd22b7da97c"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift Multus Container Network Interface Plugin Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/static-pod-resources/*/*/*/tls.crt , run the command:\n\n$ sudo chown root /etc/kubernetes/static-pod-resources/*/*/*/tls.crt",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_openshift_pki_cert_files",
      "instructions": "To check the ownership of /etc/kubernetes/static-pod-resources/*/*/*/tls.crt,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/*/*/*/tls.crt\n  If properly configured, the output should indicate the following owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-moderate-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node",
          "compliance.openshift.io/rule": "file-owner-openshift-pki-cert-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.19",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.19",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-openshift-pki-cert-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77151",
        "uid": "cfefcca0-ef63-46fb-abfc-450a12b75163"
      },
      "rationale": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift PKI Certificate Files",
      "warning": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/static-pod-resources/*/*/*/*.key , run the command:\n\n$ sudo chown root /etc/kubernetes/static-pod-resources/*/*/*/*.key",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_openshift_pki_key_files",
      "instructions": "To check the ownership of /etc/kubernetes/static-pod-resources/*/*/*/*.key,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/*/*/*/*.key\n  If properly configured, the output should indicate the following owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "file-owner-openshift-pki-key-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.19",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.19",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-openshift-pki-key-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77156",
        "uid": "c4ea1b4d-730a-4eb3-9579-05042fd7c560"
      },
      "rationale": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by root:root.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift PKI Private Key Files",
      "warning": "OpenShift makes use of a number of certificates as part of its operation. You should verify the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by root:root."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/run/openshift-sdn/cniserver/config.json , run the command:\n\n$ sudo chown root /var/run/openshift-sdn/cniserver/config.json",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_openshift_sdn_cniserver_config",
      "instructions": "To check the ownership of /var/run/openshift-sdn/cniserver/config.json,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/run/openshift-sdn/cniserver/config.json\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5",
          "compliance.openshift.io/rule": "file-owner-openshift-sdn-cniserver-config",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-openshift-sdn-cniserver-config",
        "namespace": "openshift-compliance",
        "resourceVersion": "77161",
        "uid": "b9259270-8415-46cb-aff8-8996a2bb56a1"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift SDN CNI Server Config"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/openvswitch/.* , run the command:\n\n$ sudo chown root /etc/openvswitch/.*",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_openvswitch",
      "instructions": "To check the ownership of /etc/openvswitch/.*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/.*\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-owner-openvswitch",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "policies.open-cluster-management.io/controls": "1.1.10",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-openvswitch",
        "namespace": "openshift-compliance",
        "resourceVersion": "77164",
        "uid": "3e1d43a0-15cf-460f-8856-126a07cab58a"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift Open vSwitch Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /run/ovn-kubernetes/cni/ovn-cni-server.sock , run the command:\n\n$ sudo chown root /run/ovn-kubernetes/cni/ovn-cni-server.sock",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_ovn_cni_server_sock",
      "instructions": "To check the ownership of /run/ovn-kubernetes/cni/ovn-cni-server.sock,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /run/ovn-kubernetes/cni/ovn-cni-server.sock\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "file-owner-ovn-cni-server-sock",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-ovn-cni-server-sock",
        "namespace": "openshift-compliance",
        "resourceVersion": "77166",
        "uid": "0d4caaa5-8757-4920-9ae0-060998ffd321"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The OVNKubernetes Socket"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/lib/ovn/etc/*.db , run the command:\n\n$ sudo chown root /var/lib/ovn/etc/*.db",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_ovn_db_files",
      "instructions": "To check the ownership of /var/lib/ovn/etc/*.db,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /var/lib/ovn/etc/*.db\n  If properly configured, the output should indicate the following owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "file-owner-ovn-db-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-ovn-db-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77169",
        "uid": "3cd0a541-a6f6-48d5-a1f5-9fc086597a35"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Who Owns The OVNKubernetes DB files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/openvswitch/conf.db , run the command:\n\n$ sudo chown openvswitch /etc/openvswitch/conf.db",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_ovs_conf_db",
      "instructions": "To check the ownership of /etc/openvswitch/conf.db,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/conf.db\nIf properly configured, the output should indicate the following owner:\nopenvswitch",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "file-owner-ovs-conf-db",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-ovs-conf-db",
        "namespace": "openshift-compliance",
        "resourceVersion": "77172",
        "uid": "0141faa2-d76c-47fa-a5b9-0a3d8c495d77"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The Open vSwitch Configuration Database"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/openvswitch/.conf.db.~lock~ , run the command:\n\n$ sudo chown openvswitch /etc/openvswitch/.conf.db.~lock~",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_ovs_conf_db_lock",
      "instructions": "To check the ownership of /etc/openvswitch/.conf.db.~lock~,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/.conf.db.~lock~\nIf properly configured, the output should indicate the following owner:\nopenvswitch",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node-v1r1,ocp4-high-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "file-owner-ovs-conf-db-lock",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-ovs-conf-db-lock",
        "namespace": "openshift-compliance",
        "resourceVersion": "77179",
        "uid": "2512f0c3-83d8-48a9-ba73-862ce1b81896"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The Open vSwitch Configuration Database Lock"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/run/openvswitch/ovs-vswitchd.pid , run the command:\n\n$ sudo chown openvswitch /var/run/openvswitch/ovs-vswitchd.pid",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_ovs_pid",
      "instructions": "To check the ownership of /var/run/openvswitch/ovs-vswitchd.pid,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/run/openvswitch/ovs-vswitchd.pid\nIf properly configured, the output should indicate the following owner:\nopenvswitch",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node,ocp4-nerc-cip-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node",
          "compliance.openshift.io/rule": "file-owner-ovs-pid",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-ovs-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "77182",
        "uid": "3a55b59d-f60e-429d-9011-1575a237086e"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The Open vSwitch Process ID File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/openvswitch/system-id.conf , run the command:\n\n$ sudo chown openvswitch /etc/openvswitch/system-id.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_ovs_sys_id_conf",
      "instructions": "To check the ownership of /etc/openvswitch/system-id.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/openvswitch/system-id.conf\nIf properly configured, the output should indicate the following owner:\nopenvswitch",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-owner-ovs-sys-id-conf",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-ovs-sys-id-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77184",
        "uid": "6adf5e74-e054-4b53-9c6b-1c385cbf5ae9"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The Open vSwitch Persistent System ID"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /run/openvswitch/ovs-vswitchd.pid , run the command:\n\n$ sudo chown openvswitch /run/openvswitch/ovs-vswitchd.pid",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_ovs_vswitchd_pid",
      "instructions": "To check the ownership of /run/openvswitch/ovs-vswitchd.pid,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /run/openvswitch/ovs-vswitchd.pid\nIf properly configured, the output should indicate the following owner:\nopenvswitch",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node-v1r1,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-high-node,ocp4-high-node-rev-4,ocp4-moderate-node,ocp4-stig-node,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "file-owner-ovs-vswitchd-pid",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-ovs-vswitchd-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "77188",
        "uid": "2d1c23b2-b5c3-4953-be65-81429f254fd7"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The Open vSwitch Daemon PID File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /run/openvswitch/ovsdb-server.pid , run the command:\n\n$ sudo chown openvswitch /run/openvswitch/ovsdb-server.pid",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_ovsdb_server_pid",
      "instructions": "To check the ownership of /run/openvswitch/ovsdb-server.pid,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /run/openvswitch/ovsdb-server.pid\nIf properly configured, the output should indicate the following owner:\nopenvswitch",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "file-owner-ovsdb-server-pid",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-ovsdb-server-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "77190",
        "uid": "6e2d25de-a813-4267-b626-9d5dde181a6d"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify User Who Owns The Open vSwitch Database Server PID"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All logs must be owned by root user and group. By default, the path for the Kubernetes audit log is\n\n/var/log/kube-apiserver/\n\n. To properly set the owner of /var/log/pods/* , run the command:\n\n$ sudo chown root /var/log/pods/*",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_pod_logs",
      "instructions": "To properly set the owner of /var/log/pods/*, run the command:\n$ sudo chown root /var/log/pods/*",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-owner-pod-logs"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-pod-logs",
        "namespace": "openshift-compliance",
        "resourceVersion": "76528",
        "uid": "2ced84ee-fbb7-405b-a3a4-da49030d6bce"
      },
      "rationale": "Pod log files may contain sensitive information such as application data, user credentials, or system configurations. Unauthorized access to these log files can expose sensitive data to malicious actors. By setting owner permissions, OpenShift ensures that only authorized users or processes with the necessary privileges can access the pod log files, preserving the confidentiality of the logged information.",
      "severity": "medium",
      "title": "Kubernetes Pod Logs Must Be Owned By Root"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To ensure the Kubernetes ConfigMap is mounted into the sdn daemonset pods with the correct ownership, make sure that the sdn-config ConfigMap is mounted using a ConfigMap at the /config mount point and that the sdn container points to that configuration using the --proxy-config command line option. Run:\n\noc get -nopenshift-sdn ds sdn -ojson | jq -r '.spec.template.spec.containers[] | select(.name == \"sdn\")'\n\nand ensure the --proxy-config parameter points to /config/kube-proxy-config.yaml and that the config mount point is mounted from the sdn-config ConfigMap.",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_proxy_kubeconfig",
      "instructions": "Run the following command:\n\n $ for i in $(oc get pods -n openshift-sdn -l app=sdn -oname)\n   do\n      oc exec -n openshift-sdn $i -- stat -Lc %U:%G /config/kube-proxy-config.yaml\n   done\n\nThe output should be root:root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis,ocp4-moderate,ocp4-cis-1-4,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-high,ocp4-high-rev-4,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "file-owner-proxy-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "4.1.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,4.1.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-proxy-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77542",
        "uid": "586aaa9f-e5fd-46de-bae2-2141caebb01c"
      },
      "rationale": "The kubeconfig file for kube-proxy provides permissions to the kube-proxy service. The proxy kubeconfig file contains information about the administrative configuration of the OpenShift cluster that is configured on the system. Protection of this file is critical for OpenShift security. The file is provided via a ConfigMap mount, so the kubelet itself makes sure that the file permissions are appropriate for the container taking it into use.",
      "severity": "medium",
      "title": "Verify User Who Owns The Worker Proxy Kubeconfig File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig , run the command:\n\n$ sudo chown root /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_scheduler_kubeconfig",
      "instructions": "To check the ownership of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -lL /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig\n  If properly configured, the output should indicate the following owner:\n  root",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-stig-node,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "file-owner-scheduler-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "1.1.16",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.16",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-scheduler-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77196",
        "uid": "50d23048-91cf-4493-b37c-94161b81ce71"
      },
      "rationale": "The kubeconfig for the Scheduler contains parameters for the scheduler to access the Kube API. You should set its file ownership to maintain the integrity of the file.",
      "severity": "medium",
      "title": "Verify User Who Owns The Kubernetes Scheduler Kubeconfig File",
      "warning": "The kubeconfig for the Scheduler contains parameters for the scheduler to access the Kube API. You should set its file ownership to maintain the integrity of the file."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/lib/etcd , run the command:\n\n$ sudo chown root /var/lib/etcd",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_var_lib_etcd",
      "instructions": "To check the ownership of /var/lib/etcd,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/etcd\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-owner-var-lib-etcd",
          "control.compliance.openshift.io/CIS-OCP": "1.1.12",
          "policies.open-cluster-management.io/controls": "1.1.12",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-var-lib-etcd",
        "namespace": "openshift-compliance",
        "resourceVersion": "77199",
        "uid": "c9441798-6798-48f2-bb91-5d6f81c974c6"
      },
      "rationale": "The /var/lib/etcd directory contains highly-available distributed key/value data storage across an OpenShift cluster. Allowing access to users to this directory could compromise OpenShift data and the cluster.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift etcd Data Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/kubernetes/kubelet-ca.crt , run the command:\n\n$ sudo chown root /etc/kubernetes/kubelet-ca.crt",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_worker_ca",
      "instructions": "To check the ownership of /etc/kubernetes/kubelet-ca.crt,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/kubernetes/kubelet-ca.crt\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node,ocp4-stig-node,ocp4-high-node,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "file-owner-worker-ca",
          "control.compliance.openshift.io/CIS-OCP": "4.1.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-worker-ca",
        "namespace": "openshift-compliance",
        "resourceVersion": "77562",
        "uid": "42d3a183-2a64-4313-9901-a3529f562954"
      },
      "rationale": "The worker certificate authority file contains the certificate authority certificate for an OpenShift node that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify User Who Owns the Worker Certificate Authority File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/lib/kubelet/kubeconfig , run the command:\n\n$ sudo chown root /var/lib/kubelet/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_worker_kubeconfig",
      "instructions": "To check the ownership of /var/lib/kubelet/kubeconfig,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/lib/kubelet/kubeconfig\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-owner-worker-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "4.1.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-worker-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77563",
        "uid": "93aad1a9-31b0-4b5c-920b-df1a952a1c68"
      },
      "rationale": "The worker kubeconfig file contains information about the administrative configuration of the OpenShift cluster that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify User Who Owns The Worker Kubeconfig File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "' To properly set the owner of /etc/systemd/system/kubelet.service , run the command:\n\n$ sudo chown root /etc/systemd/system/kubelet.service\n\n'",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_worker_service",
      "instructions": "To check the ownership of /etc/systemd/system/kubelet.service,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/systemd/system/kubelet.service\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-cis-node,ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-high-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-owner-worker-service",
          "control.compliance.openshift.io/CIS-OCP": "4.1.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-owner-worker-service",
        "namespace": "openshift-compliance",
        "resourceVersion": "77574",
        "uid": "f9c453eb-a8d4-4e3f-b4d6-05f5c0070df5"
      },
      "rationale": "The /etc/systemd/system/kubelet.service file contains information about the configuration of the OpenShift node service that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify User Who Owns The OpenShift Node Service File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All audit logs must be owned by root user and group. By default, the path for the Kubernetes audit log is\n\n/var/log/kube-apiserver/\n\n. To properly set the owner of /var/log/kube-apiserver , run the command:\n\n$ sudo chown root /var/log/kube-apiserver\n\nTo properly set the owner of /var/log/kube-apiserver/* , run the command:\n\n$ sudo chown root /var/log/kube-apiserver/*",
      "id": "xccdf_org.ssgproject.content_rule_file_ownership_var_log_kube_audit",
      "instructions": "To properly set the owner of /var/log/kube-apiserver, run the command:\n$ sudo chown root /var/log/kube-apiserver \n\nTo properly set the owner of /var/log/kube-apiserver/*, run the command:\n$ sudo chown root /var/log/kube-apiserver/*",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node",
          "compliance.openshift.io/rule": "file-ownership-var-log-kube-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9(4)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),AU-9(4),Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-ownership-var-log-kube-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76938",
        "uid": "2dfdeaad-8461-40ef-bf17-175b0dcf4a0b"
      },
      "rationale": "Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.",
      "severity": "medium",
      "title": "Kubernetes Audit Logs Must Be Owned By Root"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All audit logs must be owned by root user and group. By default, the path for the OAuth audit log is\n\n/var/log/oauth-apiserver/\n\n. To properly set the owner of /var/log/oauth-apiserver , run the command:\n\n$ sudo chown root /var/log/oauth-apiserver\n\nTo properly set the owner of /var/log/oauth-apiserver/* , run the command:\n\n$ sudo chown root /var/log/oauth-apiserver/*",
      "id": "xccdf_org.ssgproject.content_rule_file_ownership_var_log_oauth_audit",
      "instructions": "To properly set the owner of /var/log/oauth-apiserver, run the command:\n$ sudo chown root /var/log/oauth-apiserver \n\nTo properly set the owner of /var/log/oauth-apiserver/*, run the command:\n$ sudo chown root /var/log/oauth-apiserver/*",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node",
          "compliance.openshift.io/rule": "file-ownership-var-log-oauth-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9(4)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),AU-9(4),Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-ownership-var-log-oauth-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76940",
        "uid": "624f4ed0-e731-4b1f-8604-b9726ccdfa9c"
      },
      "rationale": "Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.",
      "severity": "medium",
      "title": "OAuth Audit Logs Must Be Owned By Root"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All audit logs must be owned by root user and group. By default, the path for the OpenShift audit log is\n\n/var/log/openshift-apiserver/\n\n. To properly set the owner of /var/log/openshift-apiserver , run the command:\n\n$ sudo chown root /var/log/openshift-apiserver\n\nTo properly set the owner of /var/log/openshift-apiserver/* , run the command:\n\n$ sudo chown root /var/log/openshift-apiserver/*",
      "id": "xccdf_org.ssgproject.content_rule_file_ownership_var_log_ocp_audit",
      "instructions": "To properly set the owner of /var/log/openshift-apiserver, run the command:\n$ sudo chown root /var/log/openshift-apiserver \n\nTo properly set the owner of /var/log/openshift-apiserver/*, run the command:\n$ sudo chown root /var/log/openshift-apiserver/*",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-ownership-var-log-ocp-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9(4)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),AU-9(4),Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-ownership-var-log-ocp-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76944",
        "uid": "8d3903e8-942c-4e0d-b54a-b9f80126ab01"
      },
      "rationale": "Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.",
      "severity": "medium",
      "title": "OpenShift Audit Logs Must Be Owned By Root"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/cni/net.d/* , run the command:\n\n$ sudo chmod 0600 /etc/cni/net.d/*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_cni_conf",
      "instructions": "To check the permissions of /etc/cni/net.d/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/cni/net.d/*\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node",
          "compliance.openshift.io/rule": "file-permissions-cni-conf",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-cni-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77202",
        "uid": "6d6a41bb-75c2-432e-9762-0a7f2f666279"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift Container Network Interface Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_controller_manager_kubeconfig",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -l /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/configmaps/controller-manager-kubeconfig/kubeconfig\n  If properly configured, the output should indicate the following permissions:\n  -rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-permissions-controller-manager-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "1.1.17",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.17",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-controller-manager-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77205",
        "uid": "086fefac-df28-4d1c-9f1e-9e147df94c29"
      },
      "rationale": "The Controller Manager's kubeconfig contains information about how the component will access the API server. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift Controller Manager Kubeconfig File",
      "warning": "The Controller Manager's kubeconfig contains information about how the component will access the API server. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/lib/etcd , run the command:\n\n$ sudo chmod 0700 /var/lib/etcd",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etcd_data_dir",
      "instructions": "To check the permissions of /var/lib/etcd,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/lib/etcd\nIf properly configured, the output should indicate the following permissions:\ndrwx------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node",
          "compliance.openshift.io/rule": "file-permissions-etcd-data-dir",
          "control.compliance.openshift.io/CIS-OCP": "1.1.11",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.11",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-etcd-data-dir",
        "namespace": "openshift-compliance",
        "resourceVersion": "77206",
        "uid": "6719c15c-841b-4da9-9037-6f332a9439b5"
      },
      "rationale": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should not be readable or writable by any group members or the world.",
      "severity": "medium",
      "title": "Verify Permissions on the Etcd Database Directory",
      "warning": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should not be readable or writable by any group members or the world."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/lib/etcd/member/wal/* , run the command:\n\n$ sudo chmod 0600 /var/lib/etcd/member/wal/*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etcd_data_files",
      "instructions": "To check the permissions of /var/lib/etcd/member/wal/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/lib/etcd/member/wal/*\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-high-node,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "file-permissions-etcd-data-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.11",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.11",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-etcd-data-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77215",
        "uid": "e625f7e1-46a0-464d-96f9-45d6dae94614"
      },
      "rationale": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should not be readable or writable by any group members or the world.",
      "severity": "medium",
      "title": "Verify Permissions on the Etcd Write-Ahead-Log Files",
      "warning": "etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should not be readable or writable by any group members or the world."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/manifests/etcd-pod.yaml , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/manifests/etcd-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etcd_member",
      "instructions": "To check the permissions of /etc/kubernetes/manifests/etcd-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/kubernetes/manifests/etcd-pod.yaml\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node-1-5,ocp4-high-node,ocp4-cis-node-1-4,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "file-permissions-etcd-member",
          "control.compliance.openshift.io/CIS-OCP": "1.1.7",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-etcd-member",
        "namespace": "openshift-compliance",
        "resourceVersion": "77217",
        "uid": "c9310397-13df-49dc-990c-da019badb9f6"
      },
      "rationale": "The etcd pod specification file controls various parameters that set the behavior of the etcd service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.",
      "severity": "medium",
      "title": "Verify Permissions on the Etcd Member Pod Specification File",
      "warning": "The etcd pod specification file controls various parameters that set the behavior of the etcd service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/etcd-*/secrets/*/*.crt , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/static-pod-resources/etcd-*/secrets/*/*.crt",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etcd_pki_cert_files",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/etcd-*/secrets/*/*.crt,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -l /etc/kubernetes/static-pod-resources/etcd-*/secrets/*/*.crt\n  If properly configured, the output should indicate the following permissions:\n  -rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-cis-node,ocp4-stig-node,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "file-permissions-etcd-pki-cert-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.20",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.20",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-etcd-pki-cert-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77221",
        "uid": "d223623e-2a6c-4111-ba14-b472c2493287"
      },
      "rationale": "OpenShift makes use of a number of certificate files as part of the operation of its components. The permissions on these files should be set to\n\n600\n\nor more restrictive to protect their integrity.",
      "severity": "medium",
      "title": "Verify Permissions on the Etcd PKI Certificate Files",
      "warning": "OpenShift makes use of a number of certificate files as part of the operation of its components. The permissions on these files should be set to\n\n600\n\nor more restrictive to protect their integrity."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/lib/cni/networks/openshift-sdn/* , run the command:\n\n$ sudo chmod 0644 /var/lib/cni/networks/openshift-sdn/*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_ip_allocations",
      "instructions": "To check the permissions of /var/lib/cni/networks/openshift-sdn/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/lib/cni/networks/openshift-sdn/*\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-nerc-cip-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "file-permissions-ip-allocations",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-ip-allocations",
        "namespace": "openshift-compliance",
        "resourceVersion": "77224",
        "uid": "84662115-84c3-4d42-bb74-ef18fdb20cea"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift SDN Container Network Interface Plugin IP Address Allocations"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_kube_apiserver",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/kubernetes/static-pod-resources/kube-apiserver-pod-*/kube-apiserver-pod.yaml\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "file-permissions-kube-apiserver",
          "control.compliance.openshift.io/CIS-OCP": "1.1.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-kube-apiserver",
        "namespace": "openshift-compliance",
        "resourceVersion": "77226",
        "uid": "42c9318f-0266-441e-b2de-ec923c37ba8a"
      },
      "rationale": "If the Kubernetes specification file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the configuration of the Kubernetes API server that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on the Kubernetes API Server Pod Specification File",
      "warning": "If the Kubernetes specification file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the configuration of the Kubernetes API server that is configured on the system. Protection of this file is critical for OpenShift security."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_kube_controller_manager",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/kubernetes/static-pod-resources/kube-controller-manager-pod-*/kube-controller-manager-pod.yaml\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-stig-node",
          "compliance.openshift.io/rule": "file-permissions-kube-controller-manager",
          "control.compliance.openshift.io/CIS-OCP": "1.1.3",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-kube-controller-manager",
        "namespace": "openshift-compliance",
        "resourceVersion": "77232",
        "uid": "66897998-27bb-4541-a051-a1119e05fb84"
      },
      "rationale": "If the Kubernetes specification file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the configuration of an Kubernetes Controller Manager server that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on the Kubernetes Controller Manager Pod Specification File",
      "warning": "If the Kubernetes specification file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the configuration of an Kubernetes Controller Manager server that is configured on the system. Protection of this file is critical for OpenShift security."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/kube-scheduler-pod.yaml , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/static-pod-resources/kube-scheduler-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_kube_scheduler",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/kube-scheduler-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/kubernetes/static-pod-resources/kube-scheduler-pod.yaml\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-permissions-kube-scheduler",
          "control.compliance.openshift.io/CIS-OCP": "1.1.5",
          "policies.open-cluster-management.io/controls": "1.1.5",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-kube-scheduler",
        "namespace": "openshift-compliance",
        "resourceVersion": "77235",
        "uid": "c5b09b12-046b-4c6e-8c4f-659a5fc6ae5c"
      },
      "rationale": "If the Kube specification file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the configuration of an OpenShift scheduler that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on the Kube Scheduler Pod Specification File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To properly set the permissions of /etc/kubernetes/kubeconfig , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_kubeconfig",
      "instructions": "To check the permissions of /etc/kubernetes/kubeconfig,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/kubernetes/kubeconfig\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-permissions-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "1.1.13",
          "policies.open-cluster-management.io/controls": "1.1.13",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77239",
        "uid": "38a3d205-9d61-46c2-b42b-3c9866b97b51"
      },
      "rationale": "If the /etc/kubernetes/kubeconfig file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the administration configuration of the OpenShift cluster that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift Admin Kubeconfig File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/lib/kubelet/config.json , run the command:\n\n$ sudo chmod 0600 /var/lib/kubelet/config.json",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_kubelet",
      "instructions": "To check the permissions of /var/lib/kubelet/config.json,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/lib/kubelet/config.json\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "file-permissions-kubelet",
          "control.compliance.openshift.io/CIS-OCP": "4.1.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-kubelet",
        "namespace": "openshift-compliance",
        "resourceVersion": "77549",
        "uid": "3737a728-1a06-427e-9995-55616c60baea"
      },
      "rationale": "If the kubelet configuration file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the configuration of an OpenShift node that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on The Kubelet Configuration File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/kubelet.conf , run the command:\n\n$ sudo chmod 0644 /etc/kubernetes/kubelet.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_kubelet_conf",
      "instructions": "To check the permissions of /etc/kubernetes/kubelet.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/kubernetes/kubelet.conf\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-high-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-permissions-kubelet-conf",
          "control.compliance.openshift.io/CIS-OCP": "4.1.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-kubelet-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77559",
        "uid": "dd0e974f-7aad-4902-8c25-72c34d07e78b"
      },
      "rationale": "If the kubelet configuration file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the configuration of an OpenShift node that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on The Kubelet Configuration File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_master_admin_kubeconfigs",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -l /etc/kubernetes/static-pod-resources/kube-apiserver-certs/secrets/node-kubeconfigs/*.kubeconfig\n  If properly configured, the output should indicate the following permissions:\n  -rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node,ocp4-cis-node-1-4,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "file-permissions-master-admin-kubeconfigs",
          "control.compliance.openshift.io/CIS-OCP": "1.1.13",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.13",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-master-admin-kubeconfigs",
        "namespace": "openshift-compliance",
        "resourceVersion": "77241",
        "uid": "10beba85-9d63-4bb1-87ba-6e698eec9cee"
      },
      "rationale": "There are various kubeconfig files that can be used by the administrator, defining various settings for the administration of the cluster. These files contain credentials that can be used to control the cluster and are needed for disaster recovery and each kubeconfig points to a different endpoint in the cluster. You should restrict its file permissions to maintain the integrity of the kubeconfig file as an attacker who gains access to these files can take over the cluster.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift Admin Kubeconfig Files",
      "warning": "There are various kubeconfig files that can be used by the administrator, defining various settings for the administration of the cluster. These files contain credentials that can be used to control the cluster and are needed for disaster recovery and each kubeconfig points to a different endpoint in the cluster. You should restrict its file permissions to maintain the integrity of the kubeconfig file as an attacker who gains access to these files can take over the cluster."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/run/multus/cni/net.d/* , run the command:\n\n$ sudo chmod 0644 /var/run/multus/cni/net.d/*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_multus_conf",
      "instructions": "To check the permissions of /var/run/multus/cni/net.d/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/run/multus/cni/net.d/*\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "file-permissions-multus-conf",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-multus-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77243",
        "uid": "584d0e93-393f-43de-80c3-1f33492bff6c"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift Multus Container Network Interface Plugin Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/kube-*/secrets/*/tls.crt , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/static-pod-resources/kube-*/secrets/*/tls.crt",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_openshift_pki_cert_files",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/kube-*/secrets/*/tls.crt,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -l /etc/kubernetes/static-pod-resources/kube-*/secrets/*/tls.crt\n  If properly configured, the output should indicate the following permissions:\n  -rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "file-permissions-openshift-pki-cert-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.20",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.20",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-openshift-pki-cert-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77253",
        "uid": "8d72c298-62ee-4002-846e-6df3309e2a69"
      },
      "rationale": "OpenShift makes use of a number of certificate files as part of the operation of its components. The permissions on these files should be set to\n\n600\n\nor more restrictive to protect their integrity.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift PKI Certificate Files",
      "warning": "OpenShift makes use of a number of certificate files as part of the operation of its components. The permissions on these files should be set to\n\n600\n\nor more restrictive to protect their integrity."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/*/*/*/*.key , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/static-pod-resources/*/*/*/*.key",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_openshift_pki_key_files",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/*/*/*/*.key,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -l /etc/kubernetes/static-pod-resources/*/*/*/*.key\n  If properly configured, the output should indicate the following permissions:\n  -rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-stig-node-v1r1,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "file-permissions-openshift-pki-key-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.21",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R1.3;CIP-003-8 R3;CIP-003-8 R3.1;CIP-003-8 R3.2;CIP-003-8 R3.3;CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);IA-5(2)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R1.3,CIP-003-8 R3,CIP-003-8 R3.1,CIP-003-8 R3.2,CIP-003-8 R3.3,CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CM-6,CM-6(1),IA-5(2),1.1.21",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-openshift-pki-key-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77256",
        "uid": "aa10cf9d-5120-4345-a560-3d944eb4e0b0"
      },
      "rationale": "OpenShift makes use of a number of key files as part of the operation of its components. The permissions on these files should be set to\n\n600\n\nto protect their integrity and confidentiality.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift PKI Private Key Files",
      "warning": "OpenShift makes use of a number of key files as part of the operation of its components. The permissions on these files should be set to\n\n600\n\nto protect their integrity and confidentiality."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/openvswitch/.* , run the command:\n\n$ sudo chmod 0644 /etc/openvswitch/.*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_openvswitch",
      "instructions": "To check the permissions of /etc/openvswitch/.*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/openvswitch/.*\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-permissions-openvswitch",
          "control.compliance.openshift.io/CIS-OCP": "1.4.9",
          "policies.open-cluster-management.io/controls": "1.4.9",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-openvswitch",
        "namespace": "openshift-compliance",
        "resourceVersion": "77259",
        "uid": "94379d1b-796a-4089-b6a6-3d55baf234ca"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift Open vSwitch Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /run/ovn-kubernetes/cni/ovn-cni-server.sock , run the command:\n\n$ sudo chmod 0600 /run/ovn-kubernetes/cni/ovn-cni-server.sock",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_ovn_cni_server_sock",
      "instructions": "To check the permissions of /run/ovn-kubernetes/cni/ovn-cni-server.sock,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /run/ovn-kubernetes/cni/ovn-cni-server.sock\nIf properly configured, the output should indicate the following permissions:\nsrw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-cis-node-1-4,ocp4-cis-node",
          "compliance.openshift.io/rule": "file-permissions-ovn-cni-server-sock",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-ovn-cni-server-sock",
        "namespace": "openshift-compliance",
        "resourceVersion": "77263",
        "uid": "131bb8bd-a70b-47f8-95f2-ffa7bd068dd1"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the OVNKubernetes socket"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/lib/ovn/etc/*.db , run the command:\n\n$ sudo chmod 0640 /var/lib/ovn/etc/*.db",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_ovn_db_files",
      "instructions": "To check the permissions of /var/lib/ovn/etc/*.db,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/lib/ovn/etc/*.db\nIf properly configured, the output should indicate the following permissions:\nsrw-r-----",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-high-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "file-permissions-ovn-db-files",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-ovn-db-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77267",
        "uid": "d2d7d3de-05c4-426c-b6fd-73ee2ff3481a"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the OVNKubernetes DB files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/openvswitch/conf.db , run the command:\n\n$ sudo chmod 0640 /etc/openvswitch/conf.db",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_ovs_conf_db",
      "instructions": "To check the permissions of /etc/openvswitch/conf.db,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/openvswitch/conf.db\nIf properly configured, the output should indicate the following permissions:\n-rw-r-----",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "file-permissions-ovs-conf-db",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-ovs-conf-db",
        "namespace": "openshift-compliance",
        "resourceVersion": "77279",
        "uid": "6481f81c-6dd5-4628-beb4-70fbae9199aa"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the Open vSwitch Configuration Database"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/openvswitch/.conf.db.~lock~ , run the command:\n\n$ sudo chmod 0600 /etc/openvswitch/.conf.db.~lock~",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_ovs_conf_db_lock",
      "instructions": "To check the permissions of /etc/openvswitch/.conf.db.~lock~,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/openvswitch/.conf.db.~lock~\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "file-permissions-ovs-conf-db-lock",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-ovs-conf-db-lock",
        "namespace": "openshift-compliance",
        "resourceVersion": "77280",
        "uid": "dcd7fdd0-1efa-4f62-ad7a-f1611399fb06"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the Open vSwitch Configuration Database Lock"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/run/openvswitch/ovs-vswitchd.pid , run the command:\n\n$ sudo chmod 0644 /var/run/openvswitch/ovs-vswitchd.pid",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_ovs_pid",
      "instructions": "To check the permissions of /var/run/openvswitch/ovs-vswitchd.pid,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/run/openvswitch/ovs-vswitchd.pid\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-cis-node,ocp4-stig-node-v1r1,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node",
          "compliance.openshift.io/rule": "file-permissions-ovs-pid",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-ovs-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "77282",
        "uid": "6c109f02-4d77-4486-a5b1-2e03733f0094"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the Open vSwitch Process ID File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/openvswitch/system-id.conf , run the command:\n\n$ sudo chmod 0644 /etc/openvswitch/system-id.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_ovs_sys_id_conf",
      "instructions": "To check the permissions of /etc/openvswitch/system-id.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/openvswitch/system-id.conf\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node",
          "compliance.openshift.io/rule": "file-permissions-ovs-sys-id-conf",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-ovs-sys-id-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "77283",
        "uid": "c0300f6f-4f15-4117-9846-4698f980abc2"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the Open vSwitch Persistent System ID"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /run/openvswitch/ovs-vswitchd.pid , run the command:\n\n$ sudo chmod 0644 /run/openvswitch/ovs-vswitchd.pid",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_ovs_vswitchd_pid",
      "instructions": "To check the permissions of /run/openvswitch/ovs-vswitchd.pid,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /run/openvswitch/ovs-vswitchd.pid\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-cis-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "file-permissions-ovs-vswitchd-pid",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-ovs-vswitchd-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "77287",
        "uid": "01364c6c-cf0c-45bd-bb66-242f603e4d65"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the Open vSwitch Daemon PID File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /run/openvswitch/ovsdb-server.pid , run the command:\n\n$ sudo chmod 0644 /run/openvswitch/ovsdb-server.pid",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_ovsdb_server_pid",
      "instructions": "To check the permissions of /run/openvswitch/ovsdb-server.pid,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /run/openvswitch/ovsdb-server.pid\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-high-node-rev-4,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-nerc-cip-node,ocp4-high-node",
          "compliance.openshift.io/rule": "file-permissions-ovsdb-server-pid",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-ovsdb-server-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "77294",
        "uid": "b412ff9a-9d10-414d-a25c-0ae6d2d02f09"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the Open vSwitch Database Server PID"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All logs must be owned by root user and group and have permissions 755. By default, the path for the Kubernetes pod logs is\n\n/var/log/pods/\n\n.",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_pod_logs",
      "instructions": "To check the permissions of /var/log/pods/*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log/pods/*\nIf properly configured, the output should indicate the following permissions:\n-rwxr-xr-x",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-permissions-pod-logs"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-pod-logs",
        "namespace": "openshift-compliance",
        "resourceVersion": "76543",
        "uid": "f84ab3c3-e7dc-49bd-b5ce-0f3872f971ef"
      },
      "rationale": "Pod log files may contain sensitive information such as application data, user credentials, or system configurations. Unauthorized access to these log files can expose sensitive data to malicious actors. By setting owner permissions, OpenShift ensures that only authorized users or processes with the necessary privileges can access the pod log files, preserving the confidentiality of the logged information.",
      "severity": "medium",
      "title": "Verify Permissions on the pod log files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the Kubernetes ConfigMap is mounted into the sdn daemonset pods with the correct permissions, make sure that the sdn-config ConfigMap is mounted using restrictive permissions. Check that the config VolumeMount mounts the sdn-config configMap with permissions set to 420:\n\n{\n\"configMap\": {\n \"defaultMode\": 420,\n \"name\": \"sdn-config\"\n },\n\"name\": \"config\"\n}",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_proxy_kubeconfig",
      "instructions": "Run the following command:\n$ oc get -nopenshift-sdn ds sdn -ojson | jq -r '.spec.template.spec.volumes[] | select(.configMap.name == \"sdn-config\") | .configMap.defaultMode'\nThe output should return a value of 420.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-cis-1-5,ocp4-high,ocp4-pci-dss,ocp4-cis-1-4,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-stig,ocp4-moderate-rev-4,ocp4-cis,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "file-permissions-proxy-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "4.1.3",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,4.1.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-proxy-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77573",
        "uid": "ae1b00ab-86cc-49d5-a258-8c5d96405948"
      },
      "rationale": "The kube-proxy kubeconfig file controls various parameters of the kube-proxy service in the worker node. If used, you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system. The kube-proxy runs with the kubeconfig parameters configured as a Kubernetes ConfigMap instead of a file. In this case, there is no proxy kubeconfig file. But appropriate permissions still need to be set in the ConfigMap mount.",
      "severity": "medium",
      "title": "Verify Permissions on the Worker Proxy Kubeconfig File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml , run the command:\n\n$ sudo chmod 0644 /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_scheduler",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/kube-scheduler-pod.yaml\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "file-permissions-scheduler",
          "control.compliance.openshift.io/CIS-OCP": "1.1.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-scheduler",
        "namespace": "openshift-compliance",
        "resourceVersion": "77303",
        "uid": "9ef7b07a-79d3-4ed4-a19b-1468215f35fb"
      },
      "rationale": "If the Kubernetes specification file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the configuration of an Kubernetes Scheduler service that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on the Kubernetes Scheduler Pod Specification File",
      "warning": "If the Kubernetes specification file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the configuration of an Kubernetes Scheduler service that is configured on the system. Protection of this file is critical for OpenShift security."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig , run the command:\n\n$ sudo chmod 0600 /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_scheduler_kubeconfig",
      "instructions": "To check the permissions of /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -l /etc/kubernetes/static-pod-resources/kube-scheduler-pod-*/configmaps/scheduler-kubeconfig/kubeconfig\n  If properly configured, the output should indicate the following permissions:\n  -rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node-rev-4,ocp4-high-node-rev-4,ocp4-moderate-node,ocp4-cis-node",
          "compliance.openshift.io/rule": "file-permissions-scheduler-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "1.1.15",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.15",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-scheduler-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77307",
        "uid": "7dbb837f-913d-4163-9d94-a055990ac98e"
      },
      "rationale": "The kubeconfig for the Scheduler contains parameters for the scheduler to access the Kube API. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.",
      "severity": "medium",
      "title": "Verify Permissions on the Kubernetes Scheduler Kubeconfig File",
      "warning": "The kubeconfig for the Scheduler contains parameters for the scheduler to access the Kube API. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/lib/etcd , run the command:\n\n$ sudo chmod 0700 /var/lib/etcd",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_var_lib_etcd",
      "instructions": "To check the permissions of /var/lib/etcd,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/lib/etcd\nIf properly configured, the output should indicate the following permissions:\n-rwx------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "file-permissions-var-lib-etcd",
          "control.compliance.openshift.io/CIS-OCP": "1.1.11",
          "policies.open-cluster-management.io/controls": "1.1.11",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-var-lib-etcd",
        "namespace": "openshift-compliance",
        "resourceVersion": "77297",
        "uid": "e648f7c9-66a8-4ab0-a5b5-c3534a1de021"
      },
      "rationale": "The /var/lib/etcd directory contains highly-available distributed key/value data storage across an OpenShift cluster. Allowing access to users to this directory could compromise OpenShift data and the cluster.",
      "severity": "medium",
      "title": "The OpenShift etcd Data Directory Must Have Mode 0700"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log/kube-apiserver/.* , run the command:\n\n$ sudo chmod 0600 /var/log/kube-apiserver/.*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_var_log_kube_audit",
      "instructions": "To check the permissions of /var/log/kube-apiserver/.*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log/kube-apiserver/.*\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "file-permissions-var-log-kube-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9(4)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),AU-9(4),Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-var-log-kube-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76952",
        "uid": "7d0a04ac-0498-4752-ab76-df735e64a0af"
      },
      "rationale": "If users can write to audit logs, audit trails can be modified or destroyed.",
      "severity": "medium",
      "title": "Kubernetes Audit Logs Must Have Mode 0600"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log/oauth-apiserver/.* , run the command:\n\n$ sudo chmod 0600 /var/log/oauth-apiserver/.*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_var_log_oauth_audit",
      "instructions": "To check the permissions of /var/log/oauth-apiserver/.*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log/oauth-apiserver/.*\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "file-permissions-var-log-oauth-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9(4)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),AU-9(4),Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-var-log-oauth-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76954",
        "uid": "be5c1644-10cb-4286-bd4e-f74c7aad2118"
      },
      "rationale": "If users can write to audit logs, audit trails can be modified or destroyed.",
      "severity": "medium",
      "title": "OAuth Audit Logs Must Have Mode 0600"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log/openshift-apiserver/.* , run the command:\n\n$ sudo chmod 0600 /var/log/openshift-apiserver/.*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_var_log_ocp_audit",
      "instructions": "To check the permissions of /var/log/openshift-apiserver/.*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log/openshift-apiserver/.*\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-permissions-var-log-ocp-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9(4)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),AU-9(4),Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-var-log-ocp-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76957",
        "uid": "e47bd565-c15e-455a-85f8-9d37bec68d72"
      },
      "rationale": "If users can write to audit logs, audit trails can be modified or destroyed.",
      "severity": "medium",
      "title": "OpenShift Audit Logs Must Have Mode 0600"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/kubernetes/kubelet-ca.crt , run the command:\n\n$ sudo chmod 0644 /etc/kubernetes/kubelet-ca.crt",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_worker_ca",
      "instructions": "To check the permissions of /etc/kubernetes/kubelet-ca.crt,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/kubernetes/kubelet-ca.crt\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-high-node,ocp4-moderate-node,ocp4-cis-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "file-permissions-worker-ca",
          "control.compliance.openshift.io/CIS-OCP": "4.1.7",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-worker-ca",
        "namespace": "openshift-compliance",
        "resourceVersion": "77583",
        "uid": "321956da-587f-4a37-a152-6b19b2a82add"
      },
      "rationale": "If the worker certificate authority file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the certificate authority certificate for an OpenShift node that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on the Worker Certificate Authority File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/lib/kubelet/kubeconfig , run the command:\n\n$ sudo chmod 0600 /var/lib/kubelet/kubeconfig",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_worker_kubeconfig",
      "instructions": "To check the permissions of /var/lib/kubelet/kubeconfig,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/lib/kubelet/kubeconfig\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-nerc-cip-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5",
          "compliance.openshift.io/rule": "file-permissions-worker-kubeconfig",
          "control.compliance.openshift.io/CIS-OCP": "4.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-worker-kubeconfig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77581",
        "uid": "7d5ab91f-3fb0-4578-aa50-aea92a386e92"
      },
      "rationale": "If the worker kubeconfig file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the administration configuration of the OpenShift cluster that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on the Worker Kubeconfig File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/systemd/system/kubelet.service , run the command:\n\n$ sudo chmod 0644 /etc/systemd/system/kubelet.service",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_worker_service",
      "instructions": "To check the permissions of /etc/systemd/system/kubelet.service,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -l /etc/systemd/system/kubelet.service\n  If properly configured, the output should indicate the following permissions:\n  -rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-cis-node,ocp4-pci-dss-node,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "file-permissions-worker-service",
          "control.compliance.openshift.io/CIS-OCP": "4.1.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.1.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-permissions-worker-service",
        "namespace": "openshift-compliance",
        "resourceVersion": "77598",
        "uid": "de92ea05-b19f-4192-bfe5-b73591e32b1c"
      },
      "rationale": "If the /etc/systemd/system/kubelet.service file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the service configuration of the OpenShift node service that is configured on the system. Protection of this file is critical for OpenShift security.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift Node Service File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/run/openshift-sdn/cniserver/config.json , run the command:\n\n$ sudo chmod 0444 /var/run/openshift-sdn/cniserver/config.json",
      "id": "xccdf_org.ssgproject.content_rule_file_perms_openshift_sdn_cniserver_config",
      "instructions": "To check the permissions of /var/run/openshift-sdn/cniserver/config.json,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/run/openshift-sdn/cniserver/config.json\nIf properly configured, the output should indicate the following permissions:\n-r--r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-high-node,ocp4-moderate-node,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-pci-dss-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "file-perms-openshift-sdn-cniserver-config",
          "control.compliance.openshift.io/CIS-OCP": "1.1.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.1.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-file-perms-openshift-sdn-cniserver-config",
        "namespace": "openshift-compliance",
        "resourceVersion": "77304",
        "uid": "38ae335f-7d22-47ef-9a74-59491adc6a45"
      },
      "rationale": "CNI (Container Network Interface) files consist of a specification and libraries for writing plugins to configure network interfaces in Linux containers, along with a number of supported plugins. Allowing writeable access to the files could allow an attacker to modify the networking configuration potentially adding a rogue network connection.",
      "severity": "medium",
      "title": "Verify Permissions on the OpenShift SDN CNI Server Config"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift has an installation-time flag that can enable FIPS mode for the cluster. The flag\n\nfips: true\n\nmust be enabled at install time in the\n\ninstall-config.yaml\n\nfile.",
      "id": "xccdf_org.ssgproject.content_rule_fips_mode_enabled_on_all_nodes",
      "instructions": "Run the following command to retrieve if the FIPS flag is enabled:\n$ oc get machineconfig -o json | jq '[.items[] | select(.metadata.name | test(\"^rendered-worker-[0-9a-z]+$|^rendered-master-[0-9a-z]+$\"))] | map(.spec.fips == true)'\nMake sure that the result is an array of 'true' values.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig",
          "compliance.openshift.io/rule": "fips-mode-enabled-on-all-nodes",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1;CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(2);CM-3(6);SC-12(2);SC-12(3);SC-13;IA-7",
          "control.compliance.openshift.io/PCI-DSS": "Req-3.4.1",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CIP-007-3 R7.1,AC-17(2),CM-3(6),SC-12(2),SC-12(3),SC-13,IA-7,Req-3.4.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-fips-mode-enabled-on-all-nodes",
        "namespace": "openshift-compliance",
        "resourceVersion": "76222",
        "uid": "7b6c3f19-9be9-40a5-9676-09c5fa4c96c5"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "high",
      "title": "Ensure that FIPS mode is enabled on all cluster nodes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift has an option to provide the Disk Encryption Set [1] when deploying nodes on GCP. This enabled disk encryption and ensures that the OpenShift nodes have that enabled. [1] https://docs.openshift.com/container-platform/latest/machine_management/creating_machinesets/creating-machineset-gcp.html#machineset-enabling-customer-managed-encryption_creating-machineset-gcp",
      "id": "xccdf_org.ssgproject.content_rule_gcp_disk_encryption_enabled",
      "instructions": "Run the following command to retrieve if the GCP disk encryption is enabled:\n$ oc get machineset --all-namespaces -o json | jq '[.items[] | select(.spec.template.spec.providerSpec.value.disks[0].encryptionKey.kmsKey.name != null) | .metadata.name]'\nMake sure that the result is an array MachineSet names. These MachineSets \nhave references to the GCP's KMS key names, which can be inspected by going through them\nwith $ oc get machineset --all-namespaces -o yaml",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "gcp-disk-encryption-enabled",
          "control.compliance.openshift.io/PCI-DSS": "Req-3.4.1",
          "policies.open-cluster-management.io/controls": "Req-3.4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-gcp-disk-encryption-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76225",
        "uid": "7fc9f20a-a48b-45aa-acd2-6c28b111ca30"
      },
      "rationale": "The usage of disk encryption for the nodes protects the data at rest and ensures that an attacker cannot easily exfiltrate the machine contents which may contain private keys or other sensitive material.",
      "severity": "high",
      "title": "Ensure that the MachineSets provisioned by GCP have disk encryption enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Apply Security Context to your Pods and Containers",
      "id": "xccdf_org.ssgproject.content_rule_general_apply_scc",
      "instructions": "Review the pod definitions in your cluster and verify they have appropriate\nsecurity contexts. OpenShift comes configured with default security context\nconstraints you can use immediately to secure pods in your cluster. For more\ninformation on security context constraints, how to use them, and how to\nbuild your own, please refer to the OpenShift security constraints documentation.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-pci-dss,ocp4-cis-1-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-high,ocp4-moderate-rev-4,ocp4-cis",
          "compliance.openshift.io/rule": "general-apply-scc",
          "control.compliance.openshift.io/CIS-OCP": "5.7.3",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.7.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-general-apply-scc",
        "namespace": "openshift-compliance",
        "resourceVersion": "76548",
        "uid": "70b4880f-68a3-402d-bc11-f36945524a6d"
      },
      "rationale": "A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume. There are two levels of security context: pod level security context, and container level security context.",
      "severity": "medium",
      "title": "Apply Security Context to Your Pods and Containers"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "OpenShift administrators can control which images can be imported, tagged, and run in a cluster. There are two facilities for this purpose: (1) Allowed Registries, allowing administrators to restrict image origins to known external registries; and (2) ImagePolicy Admission plug-in which lets administrators specify specific images which are allowed to run on the OpenShift cluster. Configure an Image policy per the Image Policy chapter in the OpenShift documentation: https://docs.openshift.com/container-platform/4.4/openshift_images/image-configuration.html",
      "id": "xccdf_org.ssgproject.content_rule_general_configure_imagepolicywebhook",
      "instructions": "To ensure that an image policy is configured, review the output\nreturned from the following command:\n$ oc get image.config.openshift.io/cluster -o yaml",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-high-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "general-configure-imagepolicywebhook",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-general-configure-imagepolicywebhook",
        "namespace": "openshift-compliance",
        "resourceVersion": "76551",
        "uid": "9ae43618-cbd0-41d3-bc94-b6619496f261"
      },
      "rationale": "Image Policy ensures that only approved container images are allowed to be ran on the OpenShift platform.",
      "severity": "medium",
      "title": "Manage Image Provenance Using ImagePolicyWebhook"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Kubernetes provides a default namespace, where objects are placed if no namespace is specified for them. Placing objects in this namespace makes application of RBAC and other controls more difficult.",
      "id": "xccdf_org.ssgproject.content_rule_general_default_namespace_use",
      "instructions": "Run the following command to list objects in the default namespace:\n$ oc get all -n default\nThe only entries there should be system-managed resources such as the\nkubernetes and openshift service.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-nerc-cip,ocp4-stig-v1r1,ocp4-cis,ocp4-moderate,ocp4-stig,ocp4-pci-dss-3-2,ocp4-cis-1-4,ocp4-high,ocp4-high-rev-4,ocp4-cis-1-5",
          "compliance.openshift.io/rule": "general-default-namespace-use",
          "control.compliance.openshift.io/CIS-OCP": "5.7.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.7.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-general-default-namespace-use",
        "namespace": "openshift-compliance",
        "resourceVersion": "76557",
        "uid": "070adc62-1d4c-4bfc-99fe-e6b0e8701c0c"
      },
      "rationale": "Resources in a Kubernetes cluster should be segregated by namespace, to allow for security controls to be applied at that level and to make it easier to manage resources.",
      "severity": "medium",
      "title": "The default namespace should not be used"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Enable default seccomp profiles in your pod definitions.",
      "id": "xccdf_org.ssgproject.content_rule_general_default_seccomp_profile",
      "instructions": "In OpenShift 4, CRI-O is the supported runtime. CRI-O runs unconfined by\ndefault in order to meet CRI conformance criteria.  On RHEL CoreOS, the\ndefault seccomp policy is associated with CRI-O and stored in\n/etc/crio/seccomp.json.  The default profile is applied when the user asks\nfor the runtime/default profile via annotation to the pod and when the\nassociated SCC allows use of the specified seccomp profile.\n\nConfiguration of allowable seccomp profiles is managed through OpenShift\nSecurity Context Constraints.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-pci-dss-3-2,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss,ocp4-cis,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "general-default-seccomp-profile",
          "control.compliance.openshift.io/CIS-OCP": "5.7.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.7.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-general-default-seccomp-profile",
        "namespace": "openshift-compliance",
        "resourceVersion": "76559",
        "uid": "09fc5d02-c0fb-4508-b19b-5a41e48e8d45"
      },
      "rationale": "Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.",
      "severity": "medium",
      "title": "Ensure Seccomp Profile Pod Definitions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Use namespaces to isolate your Kubernetes objects.",
      "id": "xccdf_org.ssgproject.content_rule_general_namespaces_in_use",
      "instructions": "OpenShift projects wrap Kubernetes namespaces and are used by default in\nOpenShift 4.  Run the following command and review the namespaces created in\nthe cluster.  $ oc get namespaces Ensure that the namespaces are\nthe ones you need and are adequately administered.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-5,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss,ocp4-cis,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "general-namespaces-in-use",
          "control.compliance.openshift.io/CIS-OCP": "5.7.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.7.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-general-namespaces-in-use",
        "namespace": "openshift-compliance",
        "resourceVersion": "76565",
        "uid": "8f0eca7c-38e8-48ab-858a-785bea480d2a"
      },
      "rationale": "Limiting the scope of user permissions can reduce the impact of mistakes or malicious activities. A Kubernetes namespace allows you to partition created resources into logically named groups. Resources created in one namespace can be hidden from other namespaces. By default, each resource created by a user in Kubernetes cluster runs in a default namespace, called default. You can create additional namespaces and attach resources and users to them. You can use Kubernetes Authorization plugins to create policies that segregate access to namespace resources between different users.",
      "severity": "medium",
      "title": "Create administrative boundaries between resources using namespaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Red Hat OpenShift GitOps is a declarative continuous delivery platform based on Argo CD. It enables teams to adopt GitOps principles for managing cluster configurations and automating secure and repeatable application delivery across hybrid multi-cluster Kubernetes environments. Following GitOps and infrastructure as code principles, you can store the configuration of clusters and applications in Git repositories and use Git workflows to roll them out to the target clusters.",
      "id": "xccdf_org.ssgproject.content_rule_gitops_operator_exists",
      "instructions": "Run the following command to retrieve the gitopsservices objects in the system:\n$ oc get gitopsservices\nMake sure there is at least one output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "gitops-operator-exists",
          "control.compliance.openshift.io/NIST-800-53": "CM-3(6);MA-2(2)",
          "policies.open-cluster-management.io/controls": "CM-3(6),MA-2(2)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-gitops-operator-exists",
        "namespace": "openshift-compliance",
        "resourceVersion": "76581",
        "uid": "8ff7c7fe-31cf-4e75-a46b-ddb35de74368"
      },
      "rationale": "GitOps provides a mean to track system configuration changes",
      "severity": "medium",
      "title": "Ensure that GitOps Operator is deployed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "For users to interact with OpenShift Container Platform, they must first authenticate to the cluster. The authentication layer identifies the user associated with requests to the OpenShift Container Platform API. The authorization layer then uses information about the requesting user to determine if the request is allowed. Understanding authentication | Authentication | OpenShift Container Platform ( https://docs.openshift.com/container-platform/4.6/logging/cluster-logging-external.html )\n\nThe OpenShift Container Platform includes a built-in OAuth server for token-based authentication. Developers and administrators obtain OAuth access tokens to authenticate themselves to the API. It is recommended for an administrator to configure OAuth to specify an identity provider after the cluster is installed. User access to the cluster is managed through the identity provider. Understanding identity provider configuration | Authentication | OpenShift Container Platform ( https://docs.openshift.com/container-platform/4.6/authentication/understanding-identity-provider.html )\n\nOpenShift includes built-in role based access control (RBAC) to determine whether a user is allowed to perform a given action within the cluster. Roles can have cluster scope or local (i.e. project) scope. Using RBAC to define and apply permissions | Authentication | OpenShift Container Platform ( https://docs.openshift.com/container-platform/4.6/authentication/using-rbac.html )",
      "id": "xccdf_org.ssgproject.content_rule_idp_is_configured",
      "instructions": "Run the following command to list the identity providers configured:\n$ oc get oauths cluster -ojsonpath='{.spec.identityProviders}' | jq \nMake sure that there exists at least one item referenced by the above path.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-high,ocp4-cis,ocp4-cis-1-5,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "idp-is-configured",
          "control.compliance.openshift.io/CIS-OCP": "3.1.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2;CIP-007-3 R5.1.3;CIP-007-3 R5.2;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2;AC-2(1);AC-2(2);AC-2(3);AC-2(4);AC-2(5);AC-2(6);AC-2(7);AC-2(8);AC-7;AC-12(1);IA-2(8);IA-2(9);SC-12(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-8.1.1",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CIP-007-3 R5.1.3,CIP-007-3 R5.2,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-2,AC-2(1),AC-2(2),AC-2(3),AC-2(4),AC-2(5),AC-2(6),AC-2(7),AC-2(8),AC-7,AC-12(1),IA-2(8),IA-2(9),SC-12(1),Req-2.2,Req-8.1.1,3.1.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-idp-is-configured",
        "namespace": "openshift-compliance",
        "resourceVersion": "76423",
        "uid": "199a37e3-2f76-48b1-9c5e-7dc6b92bcd77"
      },
      "rationale": "With any authentication mechanism the ability to revoke credentials if they are compromised or no longer required, is a key control. Kubernetes client certificate authentication does not allow for this due to a lack of support for certificate revocation.\n\nOpenShift's built-in OAuth server allows credential revocation by relying on the Identity provider, as well as giving the administrators the ability to revoke any tokens given to a specific user.",
      "severity": "medium",
      "title": "Configure An Identity Provider"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Images from the internal registry that are no longer required by the system due to age, status, or exceed limits are automatically pruned. Cluster administrators can configure the Pruning Custom Resource, or suspend it.\n\nFor more information on configuring the ImagePruner, consult the OpenShift documentation: https://access.redhat.com/documentation/en-us/openshift_container_platform/latest/html/building_applications/pruning-objects",
      "id": "xccdf_org.ssgproject.content_rule_image_pruner_active",
      "instructions": "Ensure that the imagepruner is configured and is not in a suspended state.\noc get imagepruners.imageregistry.operator.openshift.io/cluster -o jsonpath='{.spec}{\"\\n\"}'.spec.suspend field should not be set to false.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-stig",
          "compliance.openshift.io/rule": "image-pruner-active",
          "control.compliance.openshift.io/NIST-800-53": "SI-2(6)",
          "policies.open-cluster-management.io/controls": "SI-2(6)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-image-pruner-active",
        "namespace": "openshift-compliance",
        "resourceVersion": "77427",
        "uid": "4ff13756-e65c-49b2-a08c-e8e7679281eb"
      },
      "rationale": "Obsolete and stale images need to be removed from the registry to ensure the container platform maintains a secure posture. While the storing of these images does not directly pose a threat, they do increase the likelihood of these images being deployed.\n\nRemoving stale or obsolete images and only keeping the most recent versions of those that are still in use removes any possibility of vulnerable images being deployed.",
      "severity": "medium",
      "title": "Configure ImagePruner so that images that are no longer needed are automatically removed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The configuration imagestream.spec.tags.importPolicy.scheduled determines whether the imagestream is configured to periodically check for updates. This is useful when working with an external container image registry, to periodically re-import an image, for example to get latest security updates.\n\nYou can set the scheduled update by calling:\n\n$ oc patch imagestream NAME -n NAMESPACE --type merge -p '{\"spec\":{\"tags\":[{\"name\":\"TAG_NAME\",\"importPolicy\":{\"scheduled\":true}}]}}'\n\nFor more information, follow the ImageStreams documentation ( https://docs.openshift.com/container-platform/latest/openshift_images/image-streams-manage.html#images-imagestream-import_image-streams-managing )",
      "id": "xccdf_org.ssgproject.content_rule_imagestream_sets_schedule",
      "instructions": "To list all the imagestreams and identify which imagestream tags are\nconfigured to periodically check for updates (imagePolicy = { scheduled: true }), run the following command:\noc get imagestream  --all-namespaces -o jsonpath='[.items[]] | map(.spec.tags[]?.importPolicy.scheduled != true) | any'\nAlternatively, to view a list of ImageStreams that do not schedule updates,\nrun:\noc get imagestreams -A -ojson | jq '.items[] | select(.spec.tags[]?.importPolicy.scheduled != true) | .metadata.name' | sort | uniq",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "imagestream-sets-schedule",
          "control.compliance.openshift.io/NIST-800-53": "SI-2(c)",
          "policies.open-cluster-management.io/controls": "SI-2(c)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-imagestream-sets-schedule",
        "namespace": "openshift-compliance",
        "resourceVersion": "77430",
        "uid": "724849fa-6946-4992-907e-b890cf877fac"
      },
      "rationale": "Periodical refresh of container images helps keep the images up-to-date and apply any relevant updates in a timely manner.",
      "severity": "medium",
      "title": "All configured ImageStreams are configured to periodically check for updates"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Check that the default Ingress certificate has been replaced.",
      "id": "xccdf_org.ssgproject.content_rule_ingress_controller_certificate",
      "instructions": "Verify that the ingresscontroller.operator/default resource contains the name of a certificate secret:\n  oc get ingresscontroller.operator/default -n openshift-ingress-operator -ojsonpath='{ .spec.\"defaultCertificate\".\"name\" }'\nThe result should be the name of a valid secret. If none, the default Ingress certificate is in use.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "ingress-controller-certificate",
          "control.compliance.openshift.io/NIST-800-53": "SC-12",
          "policies.open-cluster-management.io/controls": "SC-12",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ingress-controller-certificate",
        "namespace": "openshift-compliance",
        "resourceVersion": "77330",
        "uid": "2651cf76-95f8-4a36-b8c3-47ed27e3b0a1"
      },
      "rationale": "OpenShift auto-generates several PKIs to serve TLS on different endpoints of the system. It is possible and necessary to configure a custom PKI which allows external clients to trust the endpoints. The Ingress Operator is the component responsible for enabling external access to OpenShift Container Platform cluster services. The aforementioned operator creates an internal CA and issues a wildcard certificate that is valid for applications under the .apps sub-domain. Both the web console and CLI use this certificate as well. The certificate and key would need to be replaced since a certificate coming from a trusted provider is needed. https://docs.openshift.com/container-platform/latest/security/certificates/replacing-default-ingress-certificate.html",
      "severity": "medium",
      "title": "Ensure that the default Ingress certificate has been replaced"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The configuration tlsSecurityProfile specifies TLS configurations to be used while establishing connections with the externally exposed servers. Though secure transport mode is used for establishing connections, the protocols used may not always be strong enough to avoid interception and manipulation of the data in transport. TLS Security profile configured should not make use of any protocols, ciphers, and algorithms with known security vulnerabilities.\n\ntlsSecurityProfile can be configured to use one of custom, intermediate, modern, or old profile. Profile Old should be avoided at all times and when using custom profile one should be extremely careful as invalid configurations can be catastrophic. It is always advised to use highly secure intermediate or modern profiles and if unset profile configured in apiservers.config.openshift.io/cluster resource will be used as default.\n\nTo update tlsSecurityProfile to Intermediate use the following command:\n\noc patch -n openshift-ingress-operator ingresscontrollers.operator.openshift.io default --type 'json' --patch '[{\"op\": \"add\", \"path\": \"/spec/tlsSecurityProfile/intermediate\", \"value\": {}}, {\"op\": \"replace\", \"path\": \"/spec/tlsSecurityProfile/type\", \"value\": \"Intermediate\"}'\n\nFor more information, follow OpenShift documentation: the relevant documentation ( https://docs.openshift.com/container-platform/latest/security/tls-security-profiles.html ).",
      "id": "xccdf_org.ssgproject.content_rule_ingress_controller_tls_security_profile",
      "instructions": "To check for the configured tlsSecurityProfile use below command:\n$ oc get -n openshift-ingress-operator ingresscontrollers.operator.openshift.io default -o jsonpath='{.spec.tlsSecurityProfile}{\"\\n\"}'\nThe output shows the tlsSecurityProfile configured for IngressController, and\nthe profile configured should not be old or if custom, the minimum TLS version\nconfigured should be TLSv1.2 or newer.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "ingress-controller-tls-security-profile",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1)",
          "policies.open-cluster-management.io/controls": "SC-8,SC-8(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ingress-controller-tls-security-profile",
        "namespace": "openshift-compliance",
        "resourceVersion": "77335",
        "uid": "4796d225-07c5-4477-9a54-13bb3303735d"
      },
      "rationale": "The authenticity and integrity of the container platform and communication between nodes and components must be secure. If an insecure protocol, cipher, or algorithms is used, during transmission of data, the data can be intercepted and manipulated. To thwart the manipulation of the data during transmission secure protocol, cipher and algorithms must be used.",
      "severity": "medium",
      "title": "Ensure IngressController is configured to use secure tlsSecurityProfile"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "operator.openshift.io/v1",
            "kind": "IngressController",
            "metadata": {
              "name": "default",
              "namespace": "openshift-ingress-operator"
            },
            "spec": {
              "tlsSecurityProfile": {
                "Custom": {
                  "minTLSVersion": "VersionTLS12"
                }
              }
            }
          }
        }
      ],
      "checkType": "Platform",
      "description": "The configuration tlsSecurityProfile specifies TLS configurations to be used while establishing connections with the externally exposed servers. Though secure transport mode is used for establishing connections, the protocols used may not always be strong enough to avoid interception and manipulation of the data in transport. When Custom TLS Security profile is used it's always better to configure TLS version 1.2 or newer to avoid any security breaches. Update minTLSVersion configured in Custom tlsSecurityProfile using the following command:\n\noc patch -n openshift-ingress-operator ingresscontrollers.operator.openshift.io default --type 'merge' --patch '{\"spec\":{\"tlsSecurityProfile\":{\"custom\":{\"minTLSVersion\":\"VersionTLS12\"}}}}'\n\nFor more information, follow OpenShift documentation: the relevant documentation ( https://docs.openshift.com/container-platform/latest/security/tls-security-profiles.html ).",
      "id": "xccdf_org.ssgproject.content_rule_ingress_controller_tls_security_profile_custom_min_tls_version",
      "instructions": "To check for the configured tlsSecurityProfile use below command:\n$ oc get -n openshift-ingress-operator ingresscontrollers.operator.openshift.io default -o jsonpath='{.spec.tlsSecurityProfile.custom.minTLSVersion}{\"\\n\"}'\nThe output shows the minTLSVersion configured in Custom tlsSecurityProfile\nfor IngressController, which should be TLSv1.2 or newer.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "ingress-controller-tls-security-profile-custom-min-tls-version",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1)",
          "policies.open-cluster-management.io/controls": "SC-8,SC-8(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ingress-controller-tls-security-profile-custom-min-tls-version",
        "namespace": "openshift-compliance",
        "resourceVersion": "77338",
        "uid": "a4578448-494c-420b-a8f7-c3ff62bc0ad0"
      },
      "rationale": "The authenticity and integrity of the container platform and communication between nodes and components must be secure. If an insecure protocol, cipher, or algorithms is used, during transmission of data, the data can be intercepted and manipulated. To thwart the manipulation of the data during transmission secure protocol, cipher and algorithms must be used.",
      "severity": "medium",
      "title": "Ensure custom tlsSecurityProfile configured for IngressController uses secure TLS version"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "operator.openshift.io/v1",
            "kind": "IngressController",
            "metadata": {
              "name": "default",
              "namespace": "openshift-ingress-operator"
            },
            "spec": {
              "tlsSecurityProfile": {
                "intermediate": {},
                "type": "Intermediate"
              }
            }
          }
        }
      ],
      "checkType": "Platform",
      "description": "The configuration tlsSecurityProfile specifies TLS configurations to be used while establishing connections with the externally exposed servers. Though secure transport mode is used for establishing connections, the protocols used may not always be strong enough to avoid interception and manipulation of the data in transport. TLS Security profile Old should be avoided, as it supports vulnerable protocols, ciphers, and algorithms which could lead to security breaches. To update tlsSecurityProfile from Old to Intermediate use the following command:\n\noc patch -n openshift-ingress-operator ingresscontrollers.operator.openshift.io default --type 'json' --patch '[{\"op\": \"add\", \"path\": \"/spec/tlsSecurityProfile/intermediate\", \"value\": {}}, {\"op\": \"replace\", \"path\": \"/spec/tlsSecurityProfile/type\", \"value\": \"Intermediate\"}, {\"op\": \"remove\", \"path\": \"/spec/tlsSecurityProfile/old\"}]'\n\nFor more information, follow OpenShift documentation: the relevant documentation ( https://docs.openshift.com/container-platform/latest/security/tls-security-profiles.html ).",
      "id": "xccdf_org.ssgproject.content_rule_ingress_controller_tls_security_profile_not_old",
      "instructions": "To check for the configured tlsSecurityProfile use below command:\n$ oc get -n openshift-ingress-operator ingresscontrollers.operator.openshift.io default -o jsonpath='{.spec.tlsSecurityProfile.type}{\"\\n\"}'\nThe output shows the tlsSecurityProfile configured for IngressController, and\nTLS security profile configured should not be \"old\".",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "ingress-controller-tls-security-profile-not-old",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1)",
          "policies.open-cluster-management.io/controls": "SC-8,SC-8(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ingress-controller-tls-security-profile-not-old",
        "namespace": "openshift-compliance",
        "resourceVersion": "77344",
        "uid": "46fa2950-512b-461c-a059-3109f7d2f16b"
      },
      "rationale": "The authenticity and integrity of the container platform and communication between nodes and components must be secure. If an insecure protocol, cipher, or algorithms is used, during transmission of data, the data can be intercepted and manipulated. To thwart the manipulation of the data during transmission secure protocol, cipher and algorithms must be used.",
      "severity": "medium",
      "title": "Ensure IngressController is not configured to use Old tlsSecurityProfile"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The kubeadmin user is meant to be a temporary user used for bootstrapping purposes. It is preferable to assign system administrators whose users are backed by an Identity Provider.\n\nMake sure to remove the user as described in the documentation ( https://docs.openshift.com/container-platform/latest/authentication/remove-kubeadmin.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubeadmin_removed",
      "instructions": "To verify that the kubeadmin secret has been deleted, make sure\nthat oc get secrets kubeadmin -n kube-system\nreturns a NotFound error.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-stig-v1r1,ocp4-stig,ocp4-cis-1-5,ocp4-pci-dss,ocp4-pci-dss-3-2,ocp4-moderate-rev-4,ocp4-bsi-2022,ocp4-cis,ocp4-bsi,ocp4-cis-1-4,ocp4-high,ocp4-high-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "kubeadmin-removed",
          "control.compliance.openshift.io/CIS-OCP": "3.1.1;5.1.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R2;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3;CIP-007-3 R6.1;CIP-007-3 R6.2;CIP-007-3 R6.3;CIP-007-3 R6.4",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(2);AC-2(7);AC-2(9);AC-2(10);AC-12(1);IA-2(5);MA-4;SC-12(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.1",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R2,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,CIP-007-3 R6.1,CIP-007-3 R6.2,CIP-007-3 R6.3,CIP-007-3 R6.4,AC-2(2),AC-2(7),AC-2(9),AC-2(10),AC-12(1),IA-2(5),MA-4,SC-12(1),Req-2.1,3.1.1,5.1.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubeadmin-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76588",
        "uid": "637df94f-109f-421d-90d2-52b8663ce19a"
      },
      "rationale": "The kubeadmin user has an auto-generated password and a self-signed certificate, and has effectively\n\ncluster-admin\n\npermissions; therefore, it's considered a security liability.",
      "severity": "medium",
      "title": "Ensure that the kubeadmin secret has been removed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "By default, anonymous access to the Kubelet server is enabled. This configuration check ensures that anonymous requests to the Kubelet server are disabled. Edit the Kubelet server configuration file /etc/kubernetes/kubelet.conf on the kubelet node(s) and set the below parameter:\n\nauthentication:\n ...\n anonymous:\n   enabled: false\n ...",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_anonymous_auth",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\"' | grep -A1 anonymous; done\nThe output should return enabled: false.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-bsi-node,ocp4-bsi-node-2022,ocp4-pci-dss-node,ocp4-cis-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-moderate-node,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "kubelet-anonymous-auth",
          "control.compliance.openshift.io/CIS-OCP": "4.2.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-anonymous-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "76689",
        "uid": "f60e0bbd-e7a9-4540-82e9-6e2e33068718"
      },
      "rationale": "When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the Kubelet server. OpenShift Operators should rely on authentication to authorize access and disallow anonymous requests.",
      "severity": "medium",
      "title": "Disable Anonymous Authentication to the Kubelet"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Unauthenticated/unauthorized users should have no access to OpenShift nodes. The Kubelet should be set to only allow Webhook authorization. To ensure that the Kubelet requires authorization, validate that authorization is configured to Webhook in /etc/kubernetes/kubelet.conf :\n\nauthorization:\n mode: Webhook\n ...",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_authorization_mode",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\"' | sudo grep -A1 authorization; done\nVerify that the output is not set to mode: AlwaysAllow, or missing\n(defaults to mode: Webhook).",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node",
          "compliance.openshift.io/rule": "kubelet-authorization-mode",
          "control.compliance.openshift.io/CIS-OCP": "4.2.3",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-authorization-mode",
        "namespace": "openshift-compliance",
        "resourceVersion": "76694",
        "uid": "a0daa42f-3bef-47ca-a417-61c93ba209cf"
      },
      "rationale": "Ensuring that the authorization is configured correctly helps enforce that unauthenticated/unauthorized users have no access to OpenShift nodes.",
      "severity": "medium",
      "title": "Ensure authorization is set to Webhook"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "By default, the kubelet is not configured with a CA certificate which can subject the kubelet to man-in-the-middle attacks. To configure a client CA certificate, edit the kubelet configuration file /etc/kubernetes/kubelet.conf on the kubelet node(s) and set the below parameter:\n\nauthentication:\n...\n x509:\n   clientCAFile: /etc/kubernetes/kubelet-ca.crt\n...",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_client_ca",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\"' | grep -A1 x509; done\nThe output should contain a configured certificate like /etc/kubernetes/kubelet-ca.crt.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-stig-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node",
          "compliance.openshift.io/rule": "kubelet-configure-client-ca",
          "control.compliance.openshift.io/CIS-OCP": "4.2.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-client-ca",
        "namespace": "openshift-compliance",
        "resourceVersion": "76696",
        "uid": "7aa4a925-4ac8-418a-99e5-e22619cf54b5"
      },
      "rationale": "Not having a CA certificate for the kubelet will subject the kubelet to possible man-in-the-middle attacks especially on unsafe or untrusted networks. Certificate validation for the kubelet allows the API server to validate the kubelet's identity.",
      "severity": "medium",
      "title": "kubelet - Configure the Client CA Certificate"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Security relevant information should be captured. The eventRecordQPS Kubelet option can be used to limit the rate at which events are gathered. Setting this too low could result in relevant events not being logged, however the unlimited setting of 0 could result in a denial of service on the kubelet. Processing and storage systems should be scaled to handle the expected event load. To set the eventRecordQPS option for the kubelet, create a KubeletConfig option along these lines:\n\napiVersion: machineconfiguration.openshift.io/v1\nkind: KubeletConfig\nmetadata:\n  name: kubelet-config-$pool\nspec:\n   machineConfigPoolSelector:\n       matchLabels:\n           pools.operator.machineconfiguration.openshift.io/$pool_name: \"\"\n   kubeletConfig:\n       eventRecordQPS: 50",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_event_creation",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\"' | grep eventRecordQPS; done\nThe output should return .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-cis-node-1-4,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5",
          "compliance.openshift.io/rule": "kubelet-configure-event-creation",
          "compliance.openshift.io/rule-variable": "var-event-record-qps",
          "control.compliance.openshift.io/CIS-OCP": "4.2.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-event-creation",
        "namespace": "openshift-compliance",
        "resourceVersion": "76700",
        "uid": "c181d9a0-6368-4101-bd85-19dc60ac4bac"
      },
      "rationale": "It is important to capture all events and not restrict event creation. Events are an important source of security information and analytics that ensure that your environment is consistently monitored using the event data.",
      "severity": "medium",
      "title": "Kubelet - Ensure Event Creation Is Configured",
      "warning": "It is important to capture all events and not restrict event creation. Events are an important source of security information and analytics that ensure that your environment is consistently monitored using the event data."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the kubelet TLS client certificate is configured, edit the kubelet configuration file /etc/kubernetes/kubelet.conf and configure the kubelet certificate file.\n\ntlsCertFile: /path/to/TLS/cert.key",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cert",
      "instructions": "Run the following command on the kubelet node(s):\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments[\"kubelet-client-certificate\"]'\nVerify that a client certificate is configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-5,ocp4-nerc-cip,ocp4-moderate,ocp4-high,ocp4-moderate-rev-4,ocp4-cis,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-pci-dss,ocp4-cis-1-4",
          "compliance.openshift.io/rule": "kubelet-configure-tls-cert",
          "control.compliance.openshift.io/CIS-OCP": "4.2.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-8,SC-8(1),SC-8(2),Req-2.2,Req-2.2.3,Req-2.3,4.2.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-tls-cert",
        "namespace": "openshift-compliance",
        "resourceVersion": "76714",
        "uid": "776a44a3-4ce8-41a4-aa6b-61b4467ddca5"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Ensure That The kubelet Client Certificate Is Correctly Set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the kubelet TLS client certificate is configured, edit the kubelet configuration file /etc/kubernetes/kubelet.conf and configure the kubelet certificate file.\n\ntlsCertFile: /path/to/TLS/cert.key\n\nNote that this particular rule is only valid for OCP releases up to and\nincluding 4.8",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cert_pre_4_9",
      "instructions": "Run the following command on the kubelet node(s):\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments[\"kubelet-client-certificate\"]'\nVerify that a client certificate is configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-pci-dss",
          "compliance.openshift.io/rule": "kubelet-configure-tls-cert-pre-4-9",
          "control.compliance.openshift.io/CIS-OCP": "4.2.10",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "policies.open-cluster-management.io/controls": "SC-8,SC-8(1),SC-8(2),4.2.10",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-tls-cert-pre-4-9",
        "namespace": "openshift-compliance",
        "resourceVersion": "76715",
        "uid": "fac73815-9eaf-4449-9c9d-f7b73df36dd5"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Ensure That The kubelet Client Certificate Is Correctly Set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that the Kubelet is configured to only use strong cryptographic ciphers. To set the cipher suites for the kubelet, create new or modify existing KubeletConfig object along these lines, one for every MachineConfigPool :\n\napiVersion: machineconfiguration.openshift.io/v1\n kind: KubeletConfig\n metadata:\n    name: kubelet-config-$pool\n spec:\n     machineConfigPoolSelector:\n         matchLabels:\n             pools.operator.machineconfiguration.openshift.io/$pool_name: \"\"\n     kubeletConfig:\n       tlsCipherSuites:\n       - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\n       - TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\n       - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\n       - TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\n       - TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256\n       - TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256\n\nIn order to configure this rule to check for an alternative cipher, both var_kubelet_tls_cipher_suites_regex and var_kubelet_tls_cipher_suites have to be set",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cipher_suites",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .tlsCipherSuites'; done\nVerify that the set of ciphers contains only the following:\n\nTLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,\nTLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,\nTLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,\nTLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,\nTLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,\nTLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node-1-5,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-pci-dss-node,ocp4-stig-node",
          "compliance.openshift.io/rule": "kubelet-configure-tls-cipher-suites",
          "control.compliance.openshift.io/CIS-OCP": "4.2.12",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-tls-cipher-suites",
        "namespace": "openshift-compliance",
        "resourceVersion": "76720",
        "uid": "759f8852-4326-4b83-b179-608560d64aad"
      },
      "rationale": "TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.",
      "severity": "medium",
      "title": "Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "operator.openshift.io/v1",
            "kind": "IngressController",
            "metadata": {
              "name": "default",
              "namespace": "openshift-ingress-operator"
            },
            "spec": {
              "tlsSecurityProfile": {
                "custom": {
                  "ciphers": [
                    "ECDHE-ECDSA-AES128-GCM-SHA256",
                    "ECDHE-RSA-AES128-GCM-SHA256",
                    "ECDHE-RSA-AES256-GCM-SHA384"
                  ],
                  "minTLSVersion": "VersionTLS12"
                },
                "type": "Custom"
              }
            }
          }
        }
      ],
      "checkType": "Platform",
      "description": "Ensure that the Ingress Controller is configured to only use strong cryptographic ciphers.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cipher_suites_ingresscontroller",
      "instructions": "Run the following command on the kubelet nodes(s):\noc -n openshift-ingress-operator patch ingresscontroller/default --type merge -p '{\"spec\":{\"tlsSecurityProfile\":{\"type\":\"Custom\",\"custom\":{\"ciphers\":[\"ECDHE-ECDSA-AES128-GCM-SHA256\",\"ECDHE-RSA-AES128-GCM-SHA256\",\"ECDHE-RSA-AES256-GCM-SHA384\"],\"minTLSVersion\":\"VersionTLS12\"} } } }'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-configure-tls-cipher-suites-ingresscontroller",
          "control.compliance.openshift.io/CIS-OCP": "4.2.13",
          "policies.open-cluster-management.io/controls": "4.2.13",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-tls-cipher-suites-ingresscontroller",
        "namespace": "openshift-compliance",
        "resourceVersion": "76723",
        "uid": "b8055ab0-ce09-4cea-b693-623ee789dd86"
      },
      "rationale": "TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.",
      "severity": "medium",
      "title": "Ensure that the Ingress Controller only makes use of Strong Cryptographic Ciphers"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "operator.openshift.io/v1",
            "kind": "KubeAPIServer",
            "metadata": {
              "name": "cluster"
            },
            "spec": {
              "unsupportedConfigOverrides": {
                "servingInfo": {
                  "cipherSuites": [
                    "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256",
                    "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
                    "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305",
                    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384",
                    "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305",
                    "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384",
                    "TLS_RSA_WITH_AES_256_GCM_SHA384",
                    "TLS_RSA_WITH_AES_128_GCM_SHA256"
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Platform",
      "description": "Ensure that the Kubernetes API Server Operator is configured to only use strong cryptographic ciphers.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cipher_suites_kubeapiserver_operator",
      "instructions": "Run the following comman on the kubelete nodes(s):\noc patch kubeapiservers.operator.openshift.io cluster --type merge -p '{\"spec\":{\"unsupportedConfigOverrides\":{\"servingInfo\":{\"cipherSuites\":[\"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\",\"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305\",\"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\",\"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305\",\"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\",\"TLS_RSA_WITH_AES_256_GCM_SHA384\",\"TLS_RSA_WITH_AES_128_GCM_SHA256\"]} } } }'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-configure-tls-cipher-suites-kubeapiserver-operator",
          "control.compliance.openshift.io/CIS-OCP": "4.2.13",
          "policies.open-cluster-management.io/controls": "4.2.13",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-tls-cipher-suites-kubeapiserver-operator",
        "namespace": "openshift-compliance",
        "resourceVersion": "76725",
        "uid": "e894b4b6-42cf-400a-9bb5-313c35bd9fac"
      },
      "rationale": "TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.",
      "severity": "medium",
      "title": "Ensure that the Kubernetes API Server Operator only makes use of Strong Cryptographic Ciphers"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Ensure that the OpenShift API Server Operator is configured to only use strong cryptographic ciphers.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_tls_cipher_suites_openshiftapiserver_operator",
      "instructions": "Run the following command on the kubelet node(s):\noc patch openshiftapiservers.operator.openshift.io cluster --type merge -p '{\"spec\":{\"unsupportedConfigOverrides\":{\"servingInfo\":{\"cipherSuites\":[\"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\",\"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305\",\"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\",\"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305\",\"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\",\"TLS_RSA_WITH_AES_256_GCM_SHA384\",\"TLS_RSA_WITH_AES_128_GCM_SHA256\"] } } } }'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-configure-tls-cipher-suites-openshiftapiserver-operator",
          "control.compliance.openshift.io/CIS-OCP": "4.2.13",
          "policies.open-cluster-management.io/controls": "4.2.13",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-tls-cipher-suites-openshiftapiserver-operator",
        "namespace": "openshift-compliance",
        "resourceVersion": "76739",
        "uid": "7e06f93e-de82-4ab0-ac4b-6f46d870ec67"
      },
      "rationale": "TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.",
      "severity": "medium",
      "title": "Ensure that the OpenShift API Server Operator only makes use of Strong Cryptographic Ciphers"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the kubelet TLS private server key certificate is configured, edit the kubelet configuration file /etc/kubernetes/kubelet.conf and configure the kubelet private key file.\n\ntlsPrivateKeyFile: /path/to/TLS/private.key",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_tls_key",
      "instructions": "Run the following command on the kubelet node(s):\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments[\"kubelet-client-key\"]'\nVerify that a client certificate is configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-cis,ocp4-high-rev-4,ocp4-moderate,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high,ocp4-pci-dss,ocp4-pci-dss-3-2,ocp4-nerc-cip",
          "compliance.openshift.io/rule": "kubelet-configure-tls-key",
          "control.compliance.openshift.io/CIS-OCP": "4.2.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-2.2.3;Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-8,SC-8(1),SC-8(2),Req-2.2,Req-2.2.3,Req-2.3,4.2.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-tls-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "76744",
        "uid": "d21aa675-478e-4fd8-ae9e-df4c1fc3c2f2"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Ensure That The kubelet Server Key Is Correctly Set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To ensure the kubelet TLS private server key certificate is configured, edit the kubelet configuration file /etc/kubernetes/kubelet.conf and configure the kubelet private key file.\n\ntlsPrivateKeyFile: /path/to/TLS/private.key\n\nNote that this particular rule is only valid for OCP releases up to and\nincluding 4.8",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_tls_key_pre_4_9",
      "instructions": "Run the following command on the kubelet node(s):\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments[\"kubelet-client-key\"]'\nVerify that a client certificate is configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-pci-dss",
          "compliance.openshift.io/rule": "kubelet-configure-tls-key-pre-4-9",
          "control.compliance.openshift.io/CIS-OCP": "4.2.10",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1);SC-8(2)",
          "policies.open-cluster-management.io/controls": "SC-8,SC-8(1),SC-8(2),4.2.10",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-tls-key-pre-4-9",
        "namespace": "openshift-compliance",
        "resourceVersion": "76749",
        "uid": "58976f29-5937-4ca1-a622-e2925db49b03"
      },
      "rationale": "Without cryptographic integrity protections, information can be altered by unauthorized users without detection.",
      "severity": "medium",
      "title": "Ensure That The kubelet Server Key Is Correctly Set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "KubeletConfig",
            "spec": {
              "kubeletConfig": {
                "tlsMinVersion": "{{.var_kubelet_tls_min_version}}"
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The configuration tlsSecurityProfile specifies TLS configurations to be used while establishing connections with the externally exposed servers. Though secure transport mode is used for establishing connections, the protocols used may not always be strong enough to avoid interception and manipulation of the data in transport. TLS Security profile configured should not make use of any protocols, ciphers, and algorithms with known security vulnerabilities.\n\ntlsSecurityProfile can be configured to use one of custom, intermediate, modern, or old profile. Profile Old should be avoided at all times and when using custom profile one should be extremely careful as invalid configurations can be catastrophic. It is always advised to configure minimum TLS version to TLSv1.2 or latest when using Custom profile or to use predefined profiles Intermediate or modern. If a TLS security profile is not configured, the default TLS security profile is Intermediate.\n\nTo configure Custom tlsSecurityProfile for the Kubelet with TLSv1.2 as minimum TLS version, create a new or modify existing KubeletConfig object along these lines, one for every MachineConfigPool :\n\napiVersion: machineconfiguration.openshift.io/v1\n kind: KubeletConfig\n metadata:\n     name: kubelet-tls-config-$pool\n spec:\n     tlsSecurityProfile:\n         type: Custom\n         custom:\n             ciphers:\n             - ECDHE-ECDSA-CHACHA20-POLY1305\n             - ECDHE-RSA-CHACHA20-POLY1305\n             - ECDHE-RSA-AES128-GCM-SHA256\n             - ECDHE-ECDSA-AES128-GCM-SHA256\n             minTLSVersion: VersionTLS12 machineConfigPoolSelector:\n         matchLabels:\n             pools.operator.machineconfiguration.openshift.io/$pool_name: \"\"\n\nIn order to configure this rule to check for an alternate TLS version, both var_kubelet_tls_min_version_regex and var_kubelet_tls_min_version should be updated.\n\nFor more information, follow OpenShift documentation: the relevant documentation ( https://docs.openshift.com/container-platform/4.11/nodes/nodes/nodes-nodes-tls.html ).",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_configure_tls_min_version",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .tlsMinVersion'; done\nThe output shows the configured TLS minimum version which should be\nTLSv1.2 or newer.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "kubelet-configure-tls-min-version",
          "compliance.openshift.io/rule-variable": "var-kubelet-tls-min-version",
          "control.compliance.openshift.io/NIST-800-53": "SC-8;SC-8(1)",
          "policies.open-cluster-management.io/controls": "SC-8,SC-8(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-configure-tls-min-version",
        "namespace": "openshift-compliance",
        "resourceVersion": "76750",
        "uid": "bab40355-4240-4795-86a4-12c5565e158e"
      },
      "rationale": "The authenticity and integrity of the container platform and communication between nodes and components must be secure. If an insecure protocol, cipher, or algorithms is used, during transmission of data, the data can be intercepted and manipulated. To thwart the manipulation of the data during transmission secure protocol, cipher and algorithms must be used.",
      "severity": "medium",
      "title": "Ensure Kubelet is configured with allowed TLS versions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Normally, OpenShift lets the kubelet get the hostname from either the cloud provider itself, or from the node's hostname. This ensures that the PKI allocated by the deployment uses the appropriate values, is valid and keeps working throughout the lifecycle of the cluster. IP addresses are not used, and hence this makes it easier for security analysts to associate kubelet logs with the appropriate node.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_disable_hostname_override",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-disable-hostname-override",
          "control.compliance.openshift.io/CIS-OCP": "4.2.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-3 R6;CIP-004-3 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-3 R6,CIP-004-3 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-disable-hostname-override",
        "namespace": "openshift-compliance",
        "resourceVersion": "76754",
        "uid": "cf2de9a8-6413-4ff7-bf7c-1bc6cab24442"
      },
      "rationale": "Allowing hostnames to be overridden creates issues around resolving nodes in addition to TLS configuration, certificate validation, and log correlation and validation. However, in some cases explicit overriding this parameter is necessary to ensure that the appropriate node name stays as it is in case of certain upgrade conditions. e.g. as is the case in AWS and OpenStack when migrating to external cloud providers.",
      "severity": "low",
      "title": "kubelet - Hostname Override handling"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To disable the read-only port, edit the kubelet configuration Edit the openshift-kube-apiserver configmap and set the kubelet-read-only-port parameter to 0:\n\n\"apiServerArguments\":{\n ...\n \"kubelet-read-only-port\":[\n   \"0\"\n ],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_disable_readonly_port",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-kube-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq -r '.apiServerArguments[\"kubelet-read-only-port\"]'\nThe output should be 0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-cis,ocp4-moderate,ocp4-stig,ocp4-cis-1-5,ocp4-high,ocp4-pci-dss,ocp4-stig-v1r1,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "kubelet-disable-readonly-port",
          "control.compliance.openshift.io/CIS-OCP": "4.2.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,4.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-disable-readonly-port",
        "namespace": "openshift-compliance",
        "resourceVersion": "76766",
        "uid": "d65905cf-9a10-4ba0-bb08-65ce36c58dd4"
      },
      "rationale": "OpenShift disables the read-only port ( 10255 ) on all nodes by setting the read-only port kubelet flag to 0. This ensures only authenticated connections are able to receive information about the OpenShift system.",
      "severity": "medium",
      "title": "kubelet - Disable the Read-Only Port"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable the kubelet to rotate client certificates, edit the kubelet configuration file /etc/kubernetes/kubelet.conf on the kubelet node(s) and set the below parameter:\n\n...\nrotateCertificates: true\n...",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_cert_rotation",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\"' | grep rotateCertificates; done\nThe output should return nothing or true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node,ocp4-stig-node,ocp4-cis-node-1-5",
          "compliance.openshift.io/rule": "kubelet-enable-cert-rotation",
          "control.compliance.openshift.io/CIS-OCP": "4.2.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-cert-rotation",
        "namespace": "openshift-compliance",
        "resourceVersion": "76772",
        "uid": "640bb772-e698-422f-905c-cd9cd955ae2e"
      },
      "rationale": "Allowing the kubelet to auto-update the certificates ensure that there is no downtime in certificate renewal as well as ensures confidentiality and integrity.",
      "severity": "medium",
      "title": "kubelet - Enable Certificate Rotation"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable the kubelet to rotate client certificates, edit the kubelet configuration file /etc/kubernetes/kubelet.conf on the kubelet node(s) and set the below parameter:\n\nfeatureGates:\n...\n RotateKubeletClientCertificate: true\n...",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_client_cert_rotation",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\"' | grep RotateKubeletClientCertificate; done\nThe output should return nothing or true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-pci-dss-node-3-2,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-cis-node-1-4",
          "compliance.openshift.io/rule": "kubelet-enable-client-cert-rotation",
          "control.compliance.openshift.io/CIS-OCP": "4.2.10",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-client-cert-rotation",
        "namespace": "openshift-compliance",
        "resourceVersion": "76777",
        "uid": "a3ee58f5-cef3-4afa-b018-7c359f039624"
      },
      "rationale": "Allowing the kubelet to auto-update the certificates ensure that there is no downtime in certificate renewal as well as ensures confidentiality and integrity.",
      "severity": "medium",
      "title": "kubelet - Enable Client Certificate Rotation"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "KubeletConfig",
            "spec": {
              "kubeletConfig": {
                "makeIPTablesUtilChains": true
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The kubelet has the ability to automatically configure the firewall to allow the containers required ports and connections to networking resources and destinations parameters potentially creating a security incident. To allow the kubelet to modify the firewall, edit the kubelet configuration file /etc/kubernetes/kubelet.conf on the kubelet node(s) and set the below parameter:\n\nmakeIPTablesUtilChains: true",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_iptables_util_chains",
      "instructions": "Run the following command on the kubelet node(s):\n$ oc get --raw /api/v1/nodes/${NODE_NAME}/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\"' | grep makeIPTablesUtilChains \nThe output should return true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-stig-node,ocp4-cis-node,ocp4-moderate-node-rev-4,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "kubelet-enable-iptables-util-chains",
          "control.compliance.openshift.io/CIS-OCP": "4.2.7",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-iptables-util-chains",
        "namespace": "openshift-compliance",
        "resourceVersion": "76779",
        "uid": "574e2318-c0e3-4102-9cb2-1c9ed0c45458"
      },
      "rationale": "The kubelet should automatically configure the firewall settings to allow access and networking traffic through. This ensures that when a pod or container is running that the correct ports are configured as well as removing the ports when a pod or container is no longer in existence.",
      "severity": "medium",
      "title": "kubelet - Allow Automatic Firewall Configuration"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "KubeletConfig",
            "metadata": {
              "annotations": {
                "complianceascode.io/depends-on": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl"
              }
            },
            "spec": {
              "kubeletConfig": {
                "protectKernelDefaults": true
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Protect tuned kernel parameters from being overwritten by the kubelet.\n\nBefore enabling this kernel parameter, it's important and necessary to first create a MachineConfig object that persist the required sysctl's. The required sysctl's are the following:\n\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n\nThe these need to be enabled via MachineConfig since they need to be available as soon as the node starts and before the Kubelet does. The manifest may look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-kubelet-sysctls\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n       mode: 0644\n       path: /etc/sysctl.d/90-kubelet.conf\n       overwrite: true\n\nThis will need to be done for each relevant MachineConfigPool in the cluster.\n\nAfter enabling this and after the changes have successfully rolled out to the whole cluster, it will now be possible to set the protectKernelDefaults parameter.\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.6/nodes/nodes/nodes-nodes-managing.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_defaults",
      "instructions": "Run the following command on the kubelet node(s):\n$ sudo grep protectKernelDefaults /etc/kubernetes/kubelet.conf\nThe output should return true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4",
          "compliance.openshift.io/rule": "kubelet-enable-protect-kernel-defaults",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-protect-kernel-defaults",
        "namespace": "openshift-compliance",
        "resourceVersion": "76783",
        "uid": "84095266-aad7-419e-b83e-8cf10997f4ea"
      },
      "rationale": "Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.",
      "severity": "medium",
      "title": "kubelet - Enable Protect Kernel Defaults"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/90-kubelet.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Setup required tuned kernel parameters before enabling overwritten protection. Note that depending on the Linux distribution and its version that your cluster nodes are running, these parameters might be already set up for you. Please refer to the rule instructions for a check.\n\nBefore enabling kernel parameter overwritten protection default, it's important to check if these values are already set to the required values. If not, it is necessary to first create a MachineConfig object that persist the required sysctl's. The required sysctl's are the following:\n\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n\nThe these need to be enabled via MachineConfig since they need to be available as soon as the node starts and before the Kubelet does. The manifest may look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-kubelet-sysctls\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n       mode: 0644\n       path: /etc/sysctl.d/90-kubelet.conf\n       overwrite: true\n\nThis will need to be done for each relevant MachineConfigPool in the cluster.\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-managing.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl",
      "instructions": "Run the following command on the kubelet node(s) to check parameter vm.panic_on_oom:\n$ sysctl vm.panic_on_oom\nThe output should return 0\n\nRun the following command on the kubelet node(s) to check parameter kernel.keys.root_maxbytes:\n$ sysctl kernel.keys.root_maxbytes \nThe output should return 25000000\n\nRun the following command on the kubelet node(s) to check parameter kernel.keys.root_maxkeys:\n$ sysctl kernel.keys.root_maxkeys\nThe output should return 1000000\n\nRun the following command on the kubelet node(s) to check parameter kernel.panic:\n$ sysctl kernel.panic\nThe output should return 10\n\nRun the following command on the kubelet node(s) to check parameter kernel.panic_on_oops:\n$ sysctl kernel.panic_on_oops\nThe output should return  1\n\nRun the following command on the kubelet node(s) to check parameter vm.overcommit_memory:\n$ sysctl vm.overcommit_memory\nThe output should return  1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node",
          "compliance.openshift.io/rule": "kubelet-enable-protect-kernel-sysctl",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-protect-kernel-sysctl",
        "namespace": "openshift-compliance",
        "resourceVersion": "76794",
        "uid": "0e34a781-5278-4843-b117-5e2688e13466"
      },
      "rationale": "Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.",
      "severity": "medium",
      "title": "kubelet - Set Up Sysctl to Enable Protect Kernel Defaults"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Setup required tuned kernel parameters before enabling overwritten protection.\n\nBefore enabling kernel parameter overwritten protection default, it's important and necessary to first create a MachineConfig object that persist the required sysctl's. The required sysctl's are the following:\n\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n\nThe these need to be enabled via MachineConfig since they need to be available as soon as the node starts and before the Kubelet does. The manifest may look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-kubelet-sysctls\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n       mode: 0644\n       path: /etc/sysctl.d/90-kubelet.conf\n       overwrite: true\n\nThis will need to be done for each relevant MachineConfigPool in the cluster.\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.6/nodes/nodes/nodes-nodes-managing.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl_file_exist",
      "instructions": "Run the following command on the kubelet node(s):\n$ sudo [ -f /etc/sysctl.d/90-kubelet.conf ] && echo \"Exists\" || echo \"Not Exists\"\nThe output should return Exists.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "kubelet-enable-protect-kernel-sysctl-file-exist",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-protect-kernel-sysctl-file-exist",
        "namespace": "openshift-compliance",
        "resourceVersion": "76802",
        "uid": "ee773ad5-66e2-491d-ba03-7202a938b198"
      },
      "rationale": "Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.",
      "severity": "medium",
      "title": "kubelet - Set Up Sysctl to Enable Protect Kernel Defaults - Check sysctl configuration file exist"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Setup required tuned kernel parameters before enabling overwritten protection. Note that depending on the Linux distribution and its version that your cluster nodes are running, these parameters might be already set up for you. Please refer to the rule instructions for a check.\n\nBefore enabling kernel parameter overwritten protection default, it's important to check if these values are already set to the required values. If not, it is necessary to first create a MachineConfig object that persist the required sysctl's. The required sysctl's are the following:\n\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n\nThe these need to be enabled via MachineConfig since they need to be available as soon as the node starts and before the Kubelet does. The manifest may look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-kubelet-sysctls\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n       mode: 0644\n       path: /etc/sysctl.d/90-kubelet.conf\n       overwrite: true\n\nThis will need to be done for each relevant MachineConfigPool in the cluster.\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-managing.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl_kernel_keys_root_maxbytes",
      "instructions": "Run the following command on the kubelet node(s) to check parameter kernel.keys.root_maxbytes:\n$ sysctl kernel.keys.root_maxbytes \nThe output should return 25000000",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "kubelet-enable-protect-kernel-sysctl-kernel-keys-root-maxbytes",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-protect-kernel-sysctl-kernel-keys-root-maxbytes",
        "namespace": "openshift-compliance",
        "resourceVersion": "76795",
        "uid": "f6756a5a-3ca3-44ea-94a4-49b6da1637ff"
      },
      "rationale": "Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.",
      "severity": "medium",
      "title": "kubelet - Set Up Sysctl to Enable Protect Kernel Defaults - Check Parameter kernel.keys.root_maxbytes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Setup required tuned kernel parameters before enabling overwritten protection. Note that depending on the Linux distribution and its version that your cluster nodes are running, these parameters might be already set up for you. Please refer to the rule instructions for a check.\n\nBefore enabling kernel parameter overwritten protection default, it's important to check if these values are already set to the required values. If not, it is necessary to first create a MachineConfig object that persist the required sysctl's. The required sysctl's are the following:\n\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n\nThe these need to be enabled via MachineConfig since they need to be available as soon as the node starts and before the Kubelet does. The manifest may look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-kubelet-sysctls\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n       mode: 0644\n       path: /etc/sysctl.d/90-kubelet.conf\n       overwrite: true\n\nThis will need to be done for each relevant MachineConfigPool in the cluster.\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-managing.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl_kernel_keys_root_maxkeys",
      "instructions": "Run the following command on the kubelet node(s) to check parameter kernel.keys.root_maxkeys:\n$ sysctl kernel.keys.root_maxkeys\nThe output should return 1000000",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "kubelet-enable-protect-kernel-sysctl-kernel-keys-root-maxkeys",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-protect-kernel-sysctl-kernel-keys-root-maxkeys",
        "namespace": "openshift-compliance",
        "resourceVersion": "76796",
        "uid": "a1f6eadb-0fbc-40f4-bf08-23c45f66208c"
      },
      "rationale": "Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.",
      "severity": "medium",
      "title": "kubelet - Set Up Sysctl to Enable Protect Kernel Defaults - Check Parameter kernel.keys.root_maxkeys"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Setup required tuned kernel parameters before enabling overwritten protection. Note that depending on the Linux distribution and its version that your cluster nodes are running, these parameters might be already set up for you. Please refer to the rule instructions for a check.\n\nBefore enabling kernel parameter overwritten protection default, it's important to check if these values are already set to the required values. If not, it is necessary to first create a MachineConfig object that persist the required sysctl's. The required sysctl's are the following:\n\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n\nThe these need to be enabled via MachineConfig since they need to be available as soon as the node starts and before the Kubelet does. The manifest may look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-kubelet-sysctls\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n       mode: 0644\n       path: /etc/sysctl.d/90-kubelet.conf\n       overwrite: true\n\nThis will need to be done for each relevant MachineConfigPool in the cluster.\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-managing.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl_kernel_panic",
      "instructions": "Run the following command on the kubelet node(s) to check parameter kernel.panic:\n$ sysctl kernel.panic\nThe output should return 10",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "kubelet-enable-protect-kernel-sysctl-kernel-panic",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-protect-kernel-sysctl-kernel-panic",
        "namespace": "openshift-compliance",
        "resourceVersion": "76803",
        "uid": "b8328f9f-46bd-44fd-bcd3-5c7e5c560935"
      },
      "rationale": "Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.",
      "severity": "medium",
      "title": "kubelet - Set Up Sysctl to Enable Protect Kernel Defaults - Check Parameter kernel.panic"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Setup required tuned kernel parameters before enabling overwritten protection. Note that depending on the Linux distribution and its version that your cluster nodes are running, these parameters might be already set up for you. Please refer to the rule instructions for a check.\n\nBefore enabling kernel parameter overwritten protection default, it's important to check if these values are already set to the required values. If not, it is necessary to first create a MachineConfig object that persist the required sysctl's. The required sysctl's are the following:\n\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n\nThe these need to be enabled via MachineConfig since they need to be available as soon as the node starts and before the Kubelet does. The manifest may look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-kubelet-sysctls\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n       mode: 0644\n       path: /etc/sysctl.d/90-kubelet.conf\n       overwrite: true\n\nThis will need to be done for each relevant MachineConfigPool in the cluster.\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-managing.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl_kernel_panic_on_oops",
      "instructions": "Run the following command on the kubelet node(s) to check parameter kernel.panic_on_oops:\n$ sysctl kernel.panic_on_oops\nThe output should return  1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "kubelet-enable-protect-kernel-sysctl-kernel-panic-on-oops",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-protect-kernel-sysctl-kernel-panic-on-oops",
        "namespace": "openshift-compliance",
        "resourceVersion": "76815",
        "uid": "97d02457-a323-4d8a-9a32-fe5f7dc32b34"
      },
      "rationale": "Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.",
      "severity": "medium",
      "title": "kubelet - Set Up Sysctl to Enable Protect Kernel Defaults - Check Parameter kernel.panic_on_oops"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Setup required tuned kernel parameters before enabling overwritten protection. Note that depending on the Linux distribution and its version that your cluster nodes are running, these parameters might be already set up for you. Please refer to the rule instructions for a check.\n\nBefore enabling kernel parameter overwritten protection default, it's important to check if these values are already set to the required values. If not, it is necessary to first create a MachineConfig object that persist the required sysctl's. The required sysctl's are the following:\n\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n\nThe these need to be enabled via MachineConfig since they need to be available as soon as the node starts and before the Kubelet does. The manifest may look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-kubelet-sysctls\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n       mode: 0644\n       path: /etc/sysctl.d/90-kubelet.conf\n       overwrite: true\n\nThis will need to be done for each relevant MachineConfigPool in the cluster.\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-managing.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl_vm_overcommit_memory",
      "instructions": "Run the following command on the kubelet node(s) to check parameter vm.overcommit_memory:\n$ sysctl vm.overcommit_memory\nThe output should return  1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "kubelet-enable-protect-kernel-sysctl-vm-overcommit-memory",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-protect-kernel-sysctl-vm-overcommit-memory",
        "namespace": "openshift-compliance",
        "resourceVersion": "76812",
        "uid": "defacaa5-10c0-40bb-96b6-f48033ceb84a"
      },
      "rationale": "Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.",
      "severity": "medium",
      "title": "kubelet - Set Up Sysctl to Enable Protect Kernel Defaults - Check Parameter vm.overcommit_memory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Setup required tuned kernel parameters before enabling overwritten protection. Note that depending on the Linux distribution and its version that your cluster nodes are running, these parameters might be already set up for you. Please refer to the rule instructions for a check.\n\nBefore enabling kernel parameter overwritten protection default, it's important to check if these values are already set to the required values. If not, it is necessary to first create a MachineConfig object that persist the required sysctl's. The required sysctl's are the following:\n\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n\nThe these need to be enabled via MachineConfig since they need to be available as soon as the node starts and before the Kubelet does. The manifest may look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-kubelet-sysctls\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n       mode: 0644\n       path: /etc/sysctl.d/90-kubelet.conf\n       overwrite: true\n\nThis will need to be done for each relevant MachineConfigPool in the cluster.\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-managing.html )",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl_vm_panic_on_oom",
      "instructions": "Run the following command on the kubelet node(s) to check parameter kernel.panic:\n$ sysctl kernel.panic\nThe output should return 10",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "kubelet-enable-protect-kernel-sysctl-vm-panic-on-oom",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-protect-kernel-sysctl-vm-panic-on-oom",
        "namespace": "openshift-compliance",
        "resourceVersion": "76818",
        "uid": "c3fc6ea3-defa-4049-beb0-d504f0d157bf"
      },
      "rationale": "Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.",
      "severity": "medium",
      "title": "kubelet - Set Up Sysctl to Enable Protect Kernel Defaults - Check Parameter vm.panic_on_oom"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable the kubelet to rotate server certificates, edit the kubelet configuration file /etc/kubernetes/kubelet.conf on the kubelet node(s) and set the below parameter:\n\nserverTLSBootstrap: true",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_server_cert_rotation",
      "instructions": "Run the following command on the kubelet node(s):\n$ for node in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$node/proxy/configz | jq '.kubeletconfig.serverTLSBootstrap'; done\nThe output should return true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "kubelet-enable-server-cert-rotation",
          "control.compliance.openshift.io/CIS-OCP": "4.2.11",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.11",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-server-cert-rotation",
        "namespace": "openshift-compliance",
        "resourceVersion": "76821",
        "uid": "fcd9095a-d9bc-49fc-8d4c-0fa4d7340e5b"
      },
      "rationale": "Allowing the kubelet to auto-update the certificates ensure that there is no downtime in certificate renewal as well as ensures confidentiality and integrity.",
      "severity": "medium",
      "title": "kubelet - Enable Server Certificate Rotation"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Timouts for streaming connections should not be disabled as they help to prevent denial-of-service attacks. To configure streaming connection timeouts To set the streamingConnectionIdleTimeout option for the kubelet, create a KubeletConfig option along these lines:\n\napiVersion: machineconfiguration.openshift.io/v1\nkind: KubeletConfig\nmetadata:\n  name: kubelet-config-$pool\nspec:\n   machineConfigPoolSelector:\n       matchLabels:\n           pools.operator.machineconfiguration.openshift.io/$pool_name: \"\"\n   kubeletConfig:\n       streamingConnectionIdleTimeout: 4h0m0s",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_streaming_connections",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\"' | grep streamingConnectionIdleTimeout; done\nThe output should not return 0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-nerc-cip-node,ocp4-cis-node-1-5,ocp4-high-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-moderate-node-rev-4",
          "compliance.openshift.io/rule": "kubelet-enable-streaming-connections",
          "compliance.openshift.io/rule-variable": "var-streaming-connection-timeouts",
          "control.compliance.openshift.io/CIS-OCP": "4.2.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-streaming-connections",
        "namespace": "openshift-compliance",
        "resourceVersion": "76824",
        "uid": "a330b37b-5915-497d-9d58-2ad114031d85"
      },
      "rationale": "Ensuring connections have timeouts helps to protect against denial-of-service attacks as well as disconnect inactive connections. In addition, setting connections timeouts helps to prevent from running out of ephemeral ports.",
      "severity": "medium",
      "title": "kubelet - Do Not Disable Streaming Timeouts"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Timeouts for streaming connections should not be disabled as they help to prevent denial-of-service attacks. To configure streaming connection timeouts, edit the kubelet configuration file /etc/kubernetes/kubelet.conf on the kubelet node(s) and set the below parameter:\n\nstreamingConnectionIdleTimeout: 4h0m0s",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_enable_streaming_connections_deprecated",
      "instructions": "Run the following command on the kubelet node(s):\n$ sudo grep streamingConnectionIdleTimeout /etc/kubernetes/kubelet.conf\nThe output should return .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-enable-streaming-connections-deprecated",
          "compliance.openshift.io/rule-variable": "var-streaming-connection-timeouts",
          "control.compliance.openshift.io/CIS-OCP": "4.2.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),4.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-enable-streaming-connections-deprecated",
        "namespace": "openshift-compliance",
        "resourceVersion": "76834",
        "uid": "973d1c08-b02f-4da3-ae32-18058c42c40e"
      },
      "rationale": "Ensuring connections have timeouts helps to protect against denial-of-service attacks as well as disconnect inactive connections. In addition, setting connections timeouts helps to prevent from running out of ephemeral ports.",
      "severity": "medium",
      "title": "kubelet - Do Not Disable Streaming Timeouts"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the imagefs.available setting of the evictionHard section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_hard_imagefs_available",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionHard.\"imagefs.available\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-stig-node-v1r1,ocp4-high-node,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-stig-node,ocp4-high-node-rev-4,ocp4-cis-node,ocp4-cis-node-1-5",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-hard-imagefs-available",
          "control.compliance.openshift.io/CIS-OCP": "1.3.1;4.2.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.3.1,4.2.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-hard-imagefs-available",
        "namespace": "openshift-compliance",
        "resourceVersion": "76836",
        "uid": "e1ce8235-8f1c-4f41-8f68-5e88125d7546"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionHard: imagefs.available"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the imagefs.inodesFree setting of the evictionHard section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_hard_imagefs_inodesfree",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionHard.\"imagefs.inodesFree\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-hard-imagefs-inodesfree",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-hard-imagefs-inodesfree",
        "namespace": "openshift-compliance",
        "resourceVersion": "76843",
        "uid": "910e6a83-5b73-4cca-8d29-7655bea800f5"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionHard: imagefs.inodesFree"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the memory.available setting of the evictionHard section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_hard_memory_available",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionHard.\"memory.available\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-node,ocp4-stig-node,ocp4-high-node,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-cis-node-1-4,ocp4-moderate-node,ocp4-stig-node-v1r1,ocp4-high-node-rev-4,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-hard-memory-available",
          "control.compliance.openshift.io/CIS-OCP": "1.3.1;4.2.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.3.1,4.2.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-hard-memory-available",
        "namespace": "openshift-compliance",
        "resourceVersion": "76846",
        "uid": "90a173d4-9818-4be4-8835-df2922a51107"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionHard: memory.available"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the nodefs.available setting of the evictionHard section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_hard_nodefs_available",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionHard.\"nodefs.available\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-cis-node,ocp4-pci-dss-node,ocp4-stig-node,ocp4-cis-node-1-4,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-stig-node-v1r1,ocp4-high-node",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-hard-nodefs-available",
          "control.compliance.openshift.io/CIS-OCP": "1.3.1;4.2.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.3.1,4.2.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-hard-nodefs-available",
        "namespace": "openshift-compliance",
        "resourceVersion": "76850",
        "uid": "2e374ee7-00b1-4ad3-b720-bf0d82cc23e8"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionHard: nodefs.available"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/latest/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the nodefs.inodesFree setting of the evictionHard section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_hard_nodefs_inodesfree",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionHard.\"nodefs.inodesFree\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-cis-node,ocp4-stig-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-cis-node-1-4,ocp4-nerc-cip-node,ocp4-moderate-node-rev-4,ocp4-cis-node-1-5,ocp4-pci-dss-node,ocp4-stig-node-v1r1",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-hard-nodefs-inodesfree",
          "control.compliance.openshift.io/CIS-OCP": "1.3.1;4.2.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),1.3.1,4.2.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-hard-nodefs-inodesfree",
        "namespace": "openshift-compliance",
        "resourceVersion": "76864",
        "uid": "7e09e86f-9191-426b-a5f4-a31babe6f701"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionHard: nodefs.inodesFree"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the imagefs.available setting of the evictionSoft section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_soft_imagefs_available",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionSoft.\"imagefs.available\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-soft-imagefs-available",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-soft-imagefs-available",
        "namespace": "openshift-compliance",
        "resourceVersion": "76866",
        "uid": "060551a0-ca97-4749-9332-169658d7a3d3"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionSoft: imagefs.available"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the imagefs.inodesFree setting of the evictionSoft section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_soft_imagefs_inodesfree",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionSoft.\"imagefs.inodesFree\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-soft-imagefs-inodesfree",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-soft-imagefs-inodesfree",
        "namespace": "openshift-compliance",
        "resourceVersion": "76869",
        "uid": "f351aadc-a86f-4d47-bacc-b12a835d6e5e"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionSoft: imagefs.inodesFree"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the memory.available setting of the evictionSoft section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_soft_memory_available",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionSoft.\"memory.available\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-soft-memory-available",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-soft-memory-available",
        "namespace": "openshift-compliance",
        "resourceVersion": "76873",
        "uid": "8a94ca78-b976-4a76-b892-2d51c25ecadf"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionSoft: memory.available"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.6/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the nodefs.available setting of the evictionSoft section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_soft_nodefs_available",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionSoft.\"nodefs.available\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-soft-nodefs-available",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-soft-nodefs-available",
        "namespace": "openshift-compliance",
        "resourceVersion": "76876",
        "uid": "90e7f184-5ffd-4063-abe8-824c1ed2e85d"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionSoft: nodefs.available"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Two types of garbage collection are performed on an OpenShift Container Platform node:\n\n* Container garbage collection: Removes terminated containers.\n* Image garbage collection: Removes images not referenced by any running pods.\n\nContainer garbage collection can be performed using eviction thresholds. Image garbage collection relies on disk usage as reported by cAdvisor on the node to decide which images to remove from the node.\n\nThe OpenShift administrator can configure how OpenShift Container Platform performs garbage collection by creating a kubeletConfig object for each Machine Config Pool using any combination of the following:\n\n* soft eviction for containers\n* hard eviction for containers\n* eviction for images\n\nTo configure, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.5/nodes/nodes/nodes-nodes-garbage-collection.html#nodes-nodes-garbage-collection-configuring_nodes-nodes-configuring )\n\nThis rule pertains to the nodefs.inodesFree setting of the evictionSoft section.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_eviction_thresholds_set_soft_nodefs_inodesfree",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\" | .evictionSoft.\"nodefs.inodesFree\"'; done\nand make sure it outputs a value.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-eviction-thresholds-set-soft-nodefs-inodesfree",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-eviction-thresholds-set-soft-nodefs-inodesfree",
        "namespace": "openshift-compliance",
        "resourceVersion": "76886",
        "uid": "3ab7d0a5-f656-4c5d-8300-1c6e4c374d00"
      },
      "rationale": "Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.",
      "severity": "medium",
      "title": "Ensure Eviction threshold Settings Are Set - evictionSoft: nodefs.inodesFree"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Disable the read-only port.",
      "id": "xccdf_org.ssgproject.content_rule_kubelet_read_only_port_secured",
      "instructions": "Run the following command on the kubelet node(s):\n$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind=\"KubeletConfiguration\"|.apiVersion=\"kubelet.config.k8s.io/v1beta1\"' | grep readOnlyPort; done\nand make sure it outputs 0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "kubelet-read-only-port-secured",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-kubelet-read-only-port-secured",
        "namespace": "openshift-compliance",
        "resourceVersion": "76889",
        "uid": "2125d824-0ad2-4437-9d75-be1240a0239a"
      },
      "rationale": "The Kubelet process provides a read-only API in addition to the main Kubelet API. Unauthenticated access is provided to this read-only API which could possibly retrieve potentially sensitive information about the cluster.",
      "severity": "medium",
      "title": "kubelet - Ensure that the --read-only-port is secured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift has an installation-time flag that can enable LUKS (TPM2 or TANG) full disk encryption at installation. The object\n\nluks\n\nmust be present at install time in the\n\nmachineconfig\n\nfile prepared with the\n\ninstall-config.yaml\n\nfile.",
      "id": "xccdf_org.ssgproject.content_rule_luks_enabled_on_all_nodes",
      "instructions": "Run the following command to retrieve if the LUKS object is configured:\n$ oc get machineconfig -o json | jq '[.items[] | select(.metadata.name | test(\"^rendered-worker-[0-9a-z]+$|^rendered-master-[0-9a-z]+$\"))] | map(.spec.config.storage.luks[0].clevis != null)'\nMake sure that the result is an array of 'true' values.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "luks-enabled-on-all-nodes",
          "control.compliance.openshift.io/PCI-DSS": "Req-3.4.1",
          "policies.open-cluster-management.io/controls": "Req-3.4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-luks-enabled-on-all-nodes",
        "namespace": "openshift-compliance",
        "resourceVersion": "76227",
        "uid": "019f23a5-c54d-453c-8877-a81d2d69e1cb"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "high",
      "title": "Ensure that LUKS is configured on worker nodes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "When full disk encryption is chosen as a way to protect card data at rest, OpenShift can provide several solutions depending on the hosting environment. While LUKS (with TPM2 or Tang) can be used for bare metal use cases, cloud-provider specific disk encryption can be used as well. [1][2] [1] https://docs.openshift.com/container-platform/latest/machine_management/creating_machinesets/creating-machineset-azure.html#machineset-enabling-customer-managed-encryption-azure_creating-machineset-azure [2] https://docs.openshift.com/container-platform/latest/machine_management/creating_machinesets/creating-machineset-gcp.html#machineset-enabling-customer-managed-encryption_creating-machineset-gcp",
      "id": "xccdf_org.ssgproject.content_rule_machine_volume_encrypted",
      "instructions": "Run the following command to see if EBS encryption is enabled:\n$ oc get machineset --all-namespaces -o json | jq '[.items[] | .spec.template.spec.providerSpec.value.blockDevices[0].ebs.encrypted] | map(. == true)'\nMake sure that the result is an array of 'true' values.\n\nRun the following command to retrieve if the GCP disk encryption is enabled:\n$ oc get machineset --all-namespaces -o json | jq '[.items[] | select(.spec.template.spec.providerSpec.value.disks[0].encryptionKey.kmsKey.name != null) | .metadata.name]'\nMake sure that the result is an array MachineSet names. These MachineSets \nhave references to the GCP's KMS key names, which can be inspected by going through them\nwith $ oc get machineset --all-namespaces -o yaml\n\nRun the following command to retrieve if the Azure disk encryption is enabled:\n$ oc get machineset --all-namespaces -o json | jq '[.items[] | select(.spec.template.spec.providerSpec.value.osDisk.managedDisk.diskEncryptionSet.id != null) | .metadata.name]'\nMake sure that the result is an array of machineset names where\ndisk encryption is enabled.\nThis can be inspected by going through them\nwith $ oc get machineset --all-namespaces -o yaml\n\nIf not, run the following command to retrieve if the FIPS flag is enabled:\n$ oc get machineconfig -o json | jq '[.items[] | select(.metadata.name | test(\"^rendered-worker-[0-9a-z]+$|^rendered-master-[0-9a-z]+$\"))] | map(.spec.fips == true)'\nMake sure that the result is an array of 'true' values.\nThen, run this next command to retrieve if LUKS encryption is enabled:\n$ oc get machineconfig -o json | jq '[.items[] | select(.metadata.name | test(\"^rendered-worker-[0-9a-z]+$|^rendered-master-[0-9a-z]+$\"))] | map(.spec.config.storage.luks[0].clevis != null)'\nThe result must also be an array of 'true' values.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-pci-dss",
          "compliance.openshift.io/rule": "machine-volume-encrypted",
          "control.compliance.openshift.io/PCI-DSS": "Req-3.4.1",
          "policies.open-cluster-management.io/controls": "Req-3.4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-machine-volume-encrypted",
        "namespace": "openshift-compliance",
        "resourceVersion": "76228",
        "uid": "b34d7ae8-fd56-4ec5-9391-5eec28f9b9cc"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "high",
      "title": "Ensure that full disk encryption is configured on cluster nodes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "You can configure OAuth tokens to expire after a set period of inactivity. By default, no token inactivity timeout is set.\n\nThe inactivity timeout can be either set in the OAuth server configuration or in any of the OAuth clients. The client settings override the OAuth server setting.\n\nTo set the OAuth server inactivity timeout, edit the OAuth server object: oc edit oauth cluster and set the.spec.tokenConfig.accessTokenInactivityTimeout parameter to the desired value:\n\napiVersion: config.openshift.io/v1\nkind: OAuth\nmetadata:\n...\nspec:\n  tokenConfig:\n    accessTokenInactivityTimeout: 10m0s \n\nPlease note that the OAuth server converts the value internally to a human-readable format,\nso that e.g. setting accessTokenInactivityTimeout=600s would be converted by the OAuth\nserver to accessTokenInactivityTimeout=10m0s.\n\nFor more information on configuring the OAuth server, consult the OpenShift documentation: https://docs.openshift.com/container-platform/4.7/authentication/configuring-oauth-clients.html",
      "id": "xccdf_org.ssgproject.content_rule_oauth_inactivity_timeout",
      "instructions": "To check if the OAuth server timeout is configured, run the following command:\noc get oauth cluster -ojsonpath='{.spec.tokenConfig.accessTokenInactivityTimeout}'\nthe output should return   .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "oauth-inactivity-timeout",
          "compliance.openshift.io/rule-variable": "var-oauth-inactivity-timeout",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-007-3 R5.1;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(5);SC-10",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-007-3 R5.1,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-2(5),SC-10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-oauth-inactivity-timeout",
        "namespace": "openshift-compliance",
        "resourceVersion": "76430",
        "uid": "bf7a24ad-340c-4814-a0a9-24e725a5264c"
      },
      "rationale": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a session that has been left unattended.",
      "severity": "medium",
      "title": "Configure OAuth server so that tokens expire after a set period of inactivity"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "A legal notice can be configured via a customized login template.\n\nThis is achievable via the OAuth object by creating a custom login page, storing it in a Kubernetes Secret and referencing it in the appropriate field as described in the documentation ( https://docs.openshift.com/container-platform/4.7/web_console/customizing-the-web-console.html#customizing-the-login-page_customizing-web-console )",
      "id": "xccdf_org.ssgproject.content_rule_oauth_login_template_set",
      "instructions": "To verify that login template is properly set, do the following:\n$ oc get oauths cluster\nmake sure that the login template is set in \nthe path .spec.templates.login.name, and references a valid\nsecret.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "oauth-login-template-set",
          "control.compliance.openshift.io/NIST-800-53": "AC-8",
          "policies.open-cluster-management.io/controls": "AC-8",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-oauth-login-template-set",
        "namespace": "openshift-compliance",
        "resourceVersion": "76590",
        "uid": "5d87a6ab-62bc-4636-9b3b-6c78984b1afc"
      },
      "rationale": "Displays to users organization-defined system use notification message or banner before granting access to the system that provides privacy and security notices consistent with applicable federal laws.",
      "severity": "medium",
      "title": "Ensure that the OpenShift OAuth login template is set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The user can be redirected to a configured URL upon logout\n\nThis is achievable via the OAuth object by setting the logoutRedirect attribute. Refer to the relevant documentation ( https://docs.openshift.com/container-platform/latest/web_console/configuring-web-console.html )",
      "id": "xccdf_org.ssgproject.content_rule_oauth_logout_url_set",
      "instructions": "Verify that the logout redirect setting in web console configuration\nis set:\noc get console.config.openshift.io cluster -o jsonpath='{.spec.authentication.logoutRedirect}{\"\\n\"}'\nMake sure that the command returns the expected logout URL.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-stig",
          "compliance.openshift.io/rule": "oauth-logout-url-set",
          "control.compliance.openshift.io/NIST-800-53": "AC-12(1)",
          "policies.open-cluster-management.io/controls": "AC-12(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-oauth-logout-url-set",
        "namespace": "openshift-compliance",
        "resourceVersion": "76596",
        "uid": "4fd4b118-c63d-47c7-8dcd-89b38c2189e1"
      },
      "rationale": "The web console's default logout will invalidate the user's session token and redirect back to the console page, which will redirect the user to the authentication page. There is no explicit logout message. And in addition, if the IdP provider type is OIDC, the session token from the SSO provider will remain valid, which would effectively keep the user logged in. To correct this, the web console needs to be configured to redirect the user to a logout page. If using an OIDC provider, this would be the logout page for that provider.",
      "severity": "medium",
      "title": "Ensure that the OpenShift OAuth logout URL is set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "You can configure OAuth tokens to expire after a set period of inactivity. By default, no token inactivity timeout is set.\n\nThe inactivity timeout can be either set in the OAuth server configuration or in any of the OAuth clients. The client settings override the OAuth server setting.\n\nTo set the OAuth server inactivity timeout, edit the OAuth server object: oc edit oauth cluster and set the.spec.tokenConfig.accessTokenInactivityTimeout parameter to the desired value:\n\napiVersion: config.openshift.io/v1\nkind: OAuth\nmetadata:\n...\nspec:\n  tokenConfig:\n    accessTokenInactivityTimeout: 10m0s\n\nPlease note that the OAuth server converts the value internally to a human-readable format,\nso that e.g. setting accessTokenInactivityTimeout=600s would be converted by the OAuth\nserver to accessTokenInactivityTimeout=10m0s.\n\nFor more information on configuring the OAuth server, consult the OpenShift documentation: https://docs.openshift.com/container-platform/4.7/authentication/configuring-oauth-clients.html\n\nTo edit the OAuth client inactivity timeout, edit the OAuth client object: oc edit oauthclient $clientname and set the top-level accessTokenInactivityTimeoutSeconds attribute.\n\napiVersion: oauth.openshift.io/v1\ngrantMethod: auto\nkind: OAuthClient\nmetadata:\n...\naccessTokenInactivityTimeoutSeconds: 600\n\nFor more information on configuring the OAuth clients, consult the OpenShift documentation: https://access.redhat.com/documentation/en-us/openshift_container_platform/4.7/html-single/authentication_and_authorization/index#oauth-token-inactivity-timeout_configuring-internal-oauth",
      "id": "xccdf_org.ssgproject.content_rule_oauth_or_oauthclient_inactivity_timeout",
      "instructions": "To check if the OAuth server timeout is configured, run the following command:\noc get oauth cluster -ojsonpath='{.spec.tokenConfig.accessTokenInactivityTimeout}'\nthe output should return a timeout value.\n\nTo check if the OAuth client timeout is configured, run the following command:\noc get oauthclients -ojson | jq -r '.items[] | { accessTokenInactivityTimeoutSeconds: .accessTokenInactivityTimeoutSeconds}'\nthe output should return a timeout value per client.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "oauth-or-oauthclient-inactivity-timeout",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-007-3 R5.1;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(5);IA-5(13);SC-10",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-007-3 R5.1,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-2(5),IA-5(13),SC-10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-oauth-or-oauthclient-inactivity-timeout",
        "namespace": "openshift-compliance",
        "resourceVersion": "76431",
        "uid": "d3c0eb23-b976-4c7f-878b-abf10cc4af9a"
      },
      "rationale": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a session that has been left unattended.",
      "severity": "medium",
      "title": "Configure OAuth tokens to expire after a set period of inactivity"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "You can configure OAuth tokens to have have a custom duration. By default, the tokens are valid for 24 hours (86400 seconds).\n\nThe maximum age can be either set in the OAuth server configuration or in any of the OAuth clients. The client settings override the OAuth server setting.\n\nTo set the OAuth server token max age, edit the OAuth server object: oc edit oauth cluster and set the.spec.tokenConfig.accessTokenMaxAgeSeconds parameter to the desired value:\n\napiVersion: config.openshift.io/v1\nkind: OAuth\nmetadata:\n...\nspec:\n  tokenConfig:\n    accessTokenMaxAgeSeconds: 28800\n\nTo set the OAuth client token max age, edit the OAuth client object: oc edit oauthclient $clientname and set the top-level accessTokenMaxAgeSeconds attribute.\n\napiVersion: oauth.openshift.io/v1\ngrantMethod: auto\nkind: OAuthClient\nmetadata:\n...\naccessTokenMaxAgeSeconds: 28800\n\nFor more information on configuring the OAuth server, consult the OpenShift documentation: https://docs.openshift.com/container-platform/4.7/authentication/configuring-internal-oauth.html",
      "id": "xccdf_org.ssgproject.content_rule_oauth_or_oauthclient_token_maxage",
      "instructions": "To check if the OAuth server token max age is configured, run the following command:\noc get oauth cluster -ojsonpath='{.spec.tokenConfig.accessTokenMaxAgeSeconds}'\nthe output should return a timeout value\n\nTo check if the OAuth client token max age is configured, run the following command:\noc get oauthclients -ojson | jq -r '.items[] | { accessTokenMaxAgeSeconds: .accessTokenMaxAgeSeconds}'\nthe output should return a timeout value per client.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "oauth-or-oauthclient-token-maxage",
          "control.compliance.openshift.io/NIST-800-53": "AC-12",
          "policies.open-cluster-management.io/controls": "AC-12",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-oauth-or-oauthclient-token-maxage",
        "namespace": "openshift-compliance",
        "resourceVersion": "76434",
        "uid": "b3a15429-ce9c-4b62-a077-f69c1e9401b9"
      },
      "rationale": "Setting a token maximum age to a shorter time period reduces the window of opportunity for unauthorized personnel to take control of the session.",
      "severity": "medium",
      "title": "Configure OAuth tokens to expire after a set period of inactivity"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Custom login pages can be helpful to show users a branded page that they trust and expect before being redirected to the authentication provider.\n\nThis is achievable via the OAuth object by creating a custom login template, storing it in a Kubernetes Secret and referencing it in the appropriate field as described in the documentation ( https://docs.openshift.com/container-platform/latest/web_console/customizing-the-web-console.html#customizing-the-login-page_customizing-web-console )",
      "id": "xccdf_org.ssgproject.content_rule_oauth_provider_selection_set",
      "instructions": "To verify that provider selection is properly set, do the following:\n$ oc get oauths cluster\nmake sure that the provider selection is set in the path\n.spec.templates.providerSelection.name, and references a valid secret.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-stig",
          "compliance.openshift.io/rule": "oauth-provider-selection-set",
          "control.compliance.openshift.io/NIST-800-53": "AC-8",
          "policies.open-cluster-management.io/controls": "AC-8",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-oauth-provider-selection-set",
        "namespace": "openshift-compliance",
        "resourceVersion": "76607",
        "uid": "d6a8758a-3ae0-4fb8-a729-02c8a22c1442"
      },
      "rationale": "Displays to users organization-defined IdP selection",
      "severity": "medium",
      "title": "Ensure that the OpenShift OAuth provider selection is set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "You can configure OAuth tokens to have have a custom duration. By default, the tokens are valid for 24 hours (86400 seconds).\n\nThe maximum age can be either set in the OAuth server configuration or in any of the OAuth clients. The client settings override the OAuth server setting.\n\nTo set the OAuth server token max age, edit the OAuth server object: oc edit oauth cluster and set the.spec.tokenConfig.accessTokenMaxAgeSeconds parameter to the desired value:\n\napiVersion: config.openshift.io/v1\nkind: OAuth\nmetadata:\n...\nspec:\n  tokenConfig:\n    accessTokenMaxAgeSeconds: 28800\n\nFor more information on configuring the OAuth server, consult the OpenShift documentation: https://docs.openshift.com/container-platform/4.7/authentication/configuring-internal-oauth.html",
      "id": "xccdf_org.ssgproject.content_rule_oauth_token_maxage",
      "instructions": "To check if the OAuth server token max age is configured, run the following command:\noc get oauth cluster -ojsonpath='{.spec.tokenConfig.accessTokenMaxAgeSeconds}'\nthe output should return a timeout value",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "oauth-token-maxage",
          "control.compliance.openshift.io/NIST-800-53": "AC-12",
          "policies.open-cluster-management.io/controls": "AC-12",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-oauth-token-maxage",
        "namespace": "openshift-compliance",
        "resourceVersion": "76433",
        "uid": "7f1f919a-1635-47b1-acd6-1fa78adff15b"
      },
      "rationale": "Setting a token maximum age to a shorter time period reduces the window of opportunity for unauthorized personnel to take control of the session.",
      "severity": "medium",
      "title": "Configure OAuth server so that tokens have a maximum age set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "You can configure OAuth tokens to expire after a set period of inactivity. By default, no token inactivity timeout is set.\n\nThe inactivity timeout can be either set in the OAuth server configuration or in any of the OAuth clients. The client settings override the OAuth server setting.\n\nTo edit the OAuth client inactivity timeout, edit the OAuth client object: oc edit oauthclient $clientname and set the top-level accessTokenInactivityTimeoutSeconds attribute.\n\napiVersion: oauth.openshift.io/v1\ngrantMethod: auto\nkind: OAuthClient\nmetadata:\n...\naccessTokenInactivityTimeoutSeconds: 600\n\nFor more information on configuring the OAuth clients, consult the OpenShift documentation: https://access.redhat.com/documentation/en-us/openshift_container_platform/4.7/html-single/authentication_and_authorization/index#oauth-token-inactivity-timeout_configuring-internal-oauth",
      "id": "xccdf_org.ssgproject.content_rule_oauthclient_inactivity_timeout",
      "instructions": "To check if the OAuth client timeout is configured, run the following command:\noc get oauthclients -ojson | jq -r '.items[] | { accessTokenInactivityTimeoutSeconds: .accessTokenInactivityTimeoutSeconds}'\nthe output should return a timeout value per client.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-stig",
          "compliance.openshift.io/rule": "oauthclient-inactivity-timeout",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-007-3 R5.1;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(5);SC-10",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-007-3 R5.1,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-2(5),SC-10",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-oauthclient-inactivity-timeout",
        "namespace": "openshift-compliance",
        "resourceVersion": "76432",
        "uid": "39202bf7-230f-428b-b7fe-c5687b34de78"
      },
      "rationale": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a session that has been left unattended.",
      "severity": "medium",
      "title": "Configure OAuth clients so that tokens expire after a set period of inactivity"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "You can configure OAuth tokens to have have a custom duration. By default, the tokens are valid for 24 hours (86400 seconds).\n\nThe maximum age can be either set in the OAuth server configuration or in any of the OAuth clients. The client settings override the OAuth server setting.\n\nTo set the OAuth client token max age, edit the OAuth client object: oc edit oauthclient $clientname and set the top-level accessTokenMaxAgeSeconds attribute.\n\napiVersion: oauth.openshift.io/v1\ngrantMethod: auto\nkind: OAuthClient\nmetadata:\n...\naccessTokenMaxAgeSeconds: 28800\n\nFor more information on configuring the OAuth clients, consult the OpenShift documentation: https://docs.openshift.com/container-platform/4.7/authentication/configuring-internal-oauth.html",
      "id": "xccdf_org.ssgproject.content_rule_oauthclient_token_maxage",
      "instructions": "To check if the OAuth client token max age is configured, run the following command:\noc get oauthclients -ojson | jq -r '.items[] | { accessTokenMaxAgeSeconds: .accessTokenMaxAgeSeconds}'\nthe output should return a timeout value per client.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "oauthclient-token-maxage",
          "control.compliance.openshift.io/NIST-800-53": "AC-12",
          "policies.open-cluster-management.io/controls": "AC-12",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-oauthclient-token-maxage",
        "namespace": "openshift-compliance",
        "resourceVersion": "76436",
        "uid": "386b0abe-620d-4c4b-afa4-b851931b67a9"
      },
      "rationale": "Setting a token maximum age to a shorter time period reduces the window of opportunity for unauthorized personnel to take control of the session.",
      "severity": "medium",
      "title": "Configure OAuth clients so that tokens have a maximum age set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The configuration registrySources.allowedRegistries determines the permitted registries that the OpenShift container runtime can access for builds and pods. This configuration setting ensures that all registries other than those specified are blocked. You can set the allowed repositories by applying the following manifest using\n\noc patch\n\n, e.g. if you save the following snippet to\n\n/tmp/allowed-registries-patch.yaml\n\nspec:\n registrySources:\n   allowedRegistries:\n   - my-trusted-registry.internal.example.com\n\nyou would call\n\noc patch image.config.openshift.io cluster --patch=\"$(cat /tmp/allowed-registries-patch.yaml)\" --type=merge",
      "id": "xccdf_org.ssgproject.content_rule_ocp_allowed_registries",
      "instructions": "To verify that the allowed registries are configured, run the following:\n$ oc get image.config.openshift.io cluster -ojsonpath='{.spec.registrySources.allowedRegistries}'\nmake sure the output is not empty and matches the registries that you wish to allow.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-stig,ocp4-e8,ocp4-moderate-rev-4,ocp4-cis,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high,ocp4-nerc-cip,ocp4-pci-dss,ocp4-high-rev-4,ocp4-moderate,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "ocp-allowed-registries",
          "control.compliance.openshift.io/CIS-OCP": "5.5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(3);CM-7(2);CM-7(5);CM-11",
          "policies.open-cluster-management.io/controls": "CM-5(3),CM-7(2),CM-7(5),CM-11,5.5.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ocp-allowed-registries",
        "namespace": "openshift-compliance",
        "resourceVersion": "77437",
        "uid": "37ae91e3-e9e2-4e4d-b884-c74d469b8e63"
      },
      "rationale": "Allowed registries should be configured to restrict the registries that the OpenShift container runtime can access, and all other registries should be blocked.",
      "severity": "medium",
      "title": "Allowed registries are configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The configuration allowedRegistriesForImport limits the container image registries from which normal users may import images. This is important to control, as a user who can stand up a malicious registry can then import content which claims to include the SHAs of legitimate content layers. You can set the allowed repositories for import by applying the following manifest using\n\noc patch\n\n, e.g. if you save the following snippet to\n\n/tmp/allowed-import-registries-patch.yaml\n\nspec:\n allowedRegistriesForImport:\n - domainName: my-trusted-registry.internal.example.com\n   insecure: false\n\nyou would call\n\noc patch image.config.openshift.io cluster --patch=\"$(cat /tmp/allowed-import-registries-patch.yaml)\" --type=merge",
      "id": "xccdf_org.ssgproject.content_rule_ocp_allowed_registries_for_import",
      "instructions": "To verify that the allowed registries for import are configured, run the following:\n$ oc get image.config.openshift.io cluster -ojsonpath='{.spec.allowedRegistriesForImport[:].domainName}'\nmake sure the output is not empty and matches the registries that you wish to allow\nimporting from.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-e8,ocp4-cis,ocp4-high-rev-4,ocp4-stig,ocp4-cis-1-4,ocp4-high,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "ocp-allowed-registries-for-import",
          "control.compliance.openshift.io/CIS-OCP": "5.5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(3);CM-7(2);CM-7(5);CM-11",
          "policies.open-cluster-management.io/controls": "CM-5(3),CM-7(2),CM-7(5),CM-11,5.5.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ocp-allowed-registries-for-import",
        "namespace": "openshift-compliance",
        "resourceVersion": "77444",
        "uid": "96115408-908f-46b5-b197-32aa754beac5"
      },
      "rationale": "Allowed registries for import should be specified to limit the registries from which users may import images.",
      "severity": "medium",
      "title": "Allowed registries for import are configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To configure how many rotations of audit logs are retained, edit the openshift-apiserver configmap and set the audit-log-maxbackup parameter to 10 or to an organizationally appropriate value:\n\n\"apiServerArguments\":{\n ...\n \"audit-log-maxbackup\": [10],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxbackup",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"audit-log-maxbackup\"][0]'\nThe output should return a value of 10 or as appropriate.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss,ocp4-stig-v1r1,ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-cis,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "ocp-api-server-audit-log-maxbackup",
          "control.compliance.openshift.io/CIS-OCP": "1.2.22",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.22",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ocp-api-server-audit-log-maxbackup",
        "namespace": "openshift-compliance",
        "resourceVersion": "77369",
        "uid": "a09bb8fc-8a91-4cab-9472-2ded6052faaa"
      },
      "rationale": "OpenShift automatically rotates the log files. Retaining old log files ensures OpenShift Operators will have sufficient log data available for carrying out any investigation or correlation. For example, if the audit log size is set to 100 MB and the number of retained log files is set to 10, OpenShift Operators would have approximately 1 GB of log data to use during analysis.",
      "severity": "low",
      "title": "Configure the OpenShift API Server Maximum Retained Audit Logs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To rotate audit logs upon reaching a maximum size, edit the openshift-apiserver configmap and set the audit-log-maxsize parameter to an appropriate size in MB. For example, to set it to 100 MB:\n\n\"apiServerArguments\":{\n ...\n \"audit-log-maxsize\": [\"100\"],\n ...",
      "id": "xccdf_org.ssgproject.content_rule_ocp_api_server_audit_log_maxsize",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"audit-log-maxsize\"]'\nThe output should return a value of [\"100\"] or as appropriate.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-4,ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-high,ocp4-cis,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-pci-dss,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "ocp-api-server-audit-log-maxsize",
          "control.compliance.openshift.io/CIS-OCP": "1.2.23",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.23",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ocp-api-server-audit-log-maxsize",
        "namespace": "openshift-compliance",
        "resourceVersion": "77374",
        "uid": "89c23aaa-e5c9-4348-aaf7-39f6e87f0345"
      },
      "rationale": "OpenShift automatically rotates log files. Retaining old log files ensures that OpenShift Operators have sufficient log data available for carrying out any investigation or correlation. If you have set file size of 100 MB and the number of old log files to keep as 10, there would be approximately 1 GB of log data available for use in analysis.",
      "severity": "medium",
      "title": "Configure OpenShift API Server Maximum Audit Log Size"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "For users to interact with OpenShift Container Platform, they must first authenticate to the cluster. The authentication layer identifies the user associated with requests to the OpenShift Container Platform API. The authorization layer then uses information about the requesting user to determine if the request is allowed. Understanding authentication | Authentication | OpenShift Container Platform ( https://docs.openshift.com/container-platform/latest/logging/cluster-logging-external.html )\n\nThe OpenShift Container Platform includes a built-in OAuth server for token-based authentication. Developers and administrators obtain OAuth access tokens to authenticate themselves to the API. It is recommended for an administrator to configure OAuth to specify an identity provider after the cluster is installed. User access to the cluster is managed through the identity provider. Understanding identity provider configuration | Authentication | OpenShift Container Platform ( https://docs.openshift.com/container-platform/latest/authentication/understanding-identity-provider.html )\n\nHowever, not all Identity Providers supported by OpenShift provide the same level of capabilities. As an example, the htpasswd Identity Provider only checks the username and password match and provides no means of 2FA, account lockout or notification mechanism. This rule therefore only allows a subset of identity providers.",
      "id": "xccdf_org.ssgproject.content_rule_ocp_idp_no_htpasswd",
      "instructions": "Run the following command to list the identity providers configured:\n$ oc get oauths cluster -ojsonpath='{.spec.identityProviders}' | jq \nMake sure that there exists at least one item referenced by the above path\nand that the value is not HTPasswd",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-e8,ocp4-high,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "ocp-idp-no-htpasswd",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2;CIP-007-3 R5.1.3;CIP-007-3 R5.2;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(1);AC-2(2);AC-2(3);AC-2(4);AC-2(7);AC-2(8);AC-7;IA-2;IA-2(1);IA-2(2);IA-2(3);IA-2(5);IA-2(8);IA-2(9);IA-2(12);IA-5(4);SC-12(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CIP-007-3 R5.1.3,CIP-007-3 R5.2,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-2(1),AC-2(2),AC-2(3),AC-2(4),AC-2(7),AC-2(8),AC-7,IA-2,IA-2(1),IA-2(2),IA-2(3),IA-2(5),IA-2(8),IA-2(9),IA-2(12),IA-5(4),SC-12(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ocp-idp-no-htpasswd",
        "namespace": "openshift-compliance",
        "resourceVersion": "76437",
        "uid": "a5bd5b4b-82d7-4547-8836-f92125370eeb"
      },
      "rationale": "With any authentication mechanism the ability to revoke credentials if they are compromised or no longer required, is a key control. Kubernetes client certificate authentication does not allow for this due to a lack of support for certificate revocation.\n\nOpenShift's built-in OAuth server allows credential revocation by relying on the Identity provider, as well as giving the administrators the ability to revoke any tokens given to a specific user.\n\nIn addition, using an external Identity provider allows for setting up notifications on account creation or deletion, multi-factor authentication, disabling inactive accounts or other features required by different compliance standards.",
      "severity": "medium",
      "title": "Do Not Use htpasswd-based IdP"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The configuration allowedRegistriesForImport limits the container image registries from which normal users may import images. This is a list of the registries that can be trusted to contain valid images and the image location configured is assumed to be secured unless configured otherwise. It is important to allow only secure registries to avoid man in the middle attacks, as the insecure image import request can be impersonated and could lead to fetching malicious content. List all the allowed repositories for import configured with insecure set to true using the following command:\n\noc get image.config.openshift.io/cluster -o json | jq '.spec | (.allowedRegistriesForImport[])? | select(.insecure==true)'\n\nRemove or edit the listed registries having insecure set by using the command:\n\noc edit image.config.openshift.io/cluster\n\nFor more information, follow the relevant documentation ( https://docs.openshift.com/container-platform/latest/openshift_images/image-configuration.html ).",
      "id": "xccdf_org.ssgproject.content_rule_ocp_insecure_allowed_registries_for_import",
      "instructions": "To check for the configured allowedRegistriesForImport with insecure option use below command:\n$ oc get image.config.openshift.io/cluster -ojsonpath='{.spec.allowedRegistriesForImport}'\nThe output lists the configured allowedRegistriesForImport and the insecure option used.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-bsi,ocp4-cis-1-4,ocp4-pci-dss,ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-high,ocp4-cis,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-moderate-rev-4,ocp4-bsi-2022",
          "compliance.openshift.io/rule": "ocp-insecure-allowed-registries-for-import",
          "control.compliance.openshift.io/CIS-OCP": "5.5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(3)",
          "policies.open-cluster-management.io/controls": "CM-5(3),5.5.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ocp-insecure-allowed-registries-for-import",
        "namespace": "openshift-compliance",
        "resourceVersion": "77448",
        "uid": "ea6b3a07-8a98-4cc7-9156-cc2af9c89c23"
      },
      "rationale": "Configured list of allowed registries for import should be from the secure source.",
      "severity": "medium",
      "title": "Check configured allowed registries for import uses secure protocol"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The configuration registrySources.insecureRegistries determines the insecure registries that the OpenShift container runtime can access for builds and pods. This configuration setting is for accessing the configured registries without TLS validation which could lead to security breaches and should be avoided. Remove any insecureRegistries configured using the following command:\n\noc patch image.config.openshift.io cluster --type=json -p \"[{'op': 'remove', 'path': '/spec/registrySources/insecureRegistries'}]\"\n\nFor more information, follow the relevant documentation ( https://docs.openshift.com/container-platform/latest/openshift_images/image-configuration.html ).",
      "id": "xccdf_org.ssgproject.content_rule_ocp_insecure_registries",
      "instructions": "To check for the configured insecure registry sources use below command:\n$ oc get image.config.openshift.io/cluster -ojsonpath='{.spec.registrySources.insecureRegistries}'\nThe output lists the insecure registry sources configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-bsi-2022,ocp4-cis,ocp4-cis-1-5,ocp4-moderate-rev-4,ocp4-stig,ocp4-pci-dss-3-2,ocp4-bsi,ocp4-pci-dss,ocp4-high,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "ocp-insecure-registries",
          "control.compliance.openshift.io/CIS-OCP": "5.5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(3)",
          "policies.open-cluster-management.io/controls": "CM-5(3),5.5.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ocp-insecure-registries",
        "namespace": "openshift-compliance",
        "resourceVersion": "77450",
        "uid": "8f1c1c5a-d691-4901-bf4f-e0b33f138527"
      },
      "rationale": "Insecure registries should not be configured, which would restrict the possibilities of OpenShift container runtime accessing registries which cannot be validated.",
      "severity": "medium",
      "title": "Check if any insecure registry sources is configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "For users to interact with OpenShift Container Platform, they must first authenticate to the cluster. The authentication layer identifies the user associated with requests to the OpenShift Container Platform API. The authorization layer then uses information about the requesting user to determine if the request is allowed. Understanding authentication | Authentication | OpenShift Container Platform ( https://docs.openshift.com/container-platform/latest/logging/cluster-logging-external.html )\n\nThe OpenShift Container Platform includes a built-in OAuth server for token-based authentication. Developers and administrators obtain OAuth access tokens to authenticate themselves to the API. It is recommended for an administrator to configure OAuth to specify an identity provider after the cluster is installed. User access to the cluster is managed through the identity provider. Understanding identity provider configuration | Authentication | OpenShift Container Platform ( https://docs.openshift.com/container-platform/latest/authentication/understanding-identity-provider.html )\n\nIf the identity provider is LDAP, setting the insecure flag to true would mean that passwords, such as the one used to authenticate the OAuth proxy to the LDAP server would be transmitted in the clear, potentially allowing an attacker to read the password if they captured the network traffic.",
      "id": "xccdf_org.ssgproject.content_rule_ocp_no_ldap_insecure",
      "instructions": "Run the following command to list the identity providers configured:\n$ oc get oauths cluster -ojsonpath='{.spec.identityProviders}' | jq \nIf any of the IDP providers' type is LDAP, make sure the insecure\nflag is not set or is set to false.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-pci-dss,ocp4-stig-v1r1,ocp4-high-rev-4,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "ocp-no-ldap-insecure",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "IA-2(8);IA-2(9);SC-8",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.3",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,IA-2(8),IA-2(9),SC-8,Req-2.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-ocp-no-ldap-insecure",
        "namespace": "openshift-compliance",
        "resourceVersion": "76442",
        "uid": "308a875b-b086-4179-ab50-ba5ecd7a78f8"
      },
      "rationale": "Transmitting authentication tokens as clear-text may leak them to an attacker.",
      "severity": "high",
      "title": "Only Use LDAP-based IdPs with TLS"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To enable auditing on the OpenShift API Server, the audit log path must be set. Edit the openshift-apiserver configmap and set the audit-log-path to a suitable path and file where audit logs should be written. For example:\n\n\"apiServerArguments\":{\n ...\n \"audit-log-path\":\"/var/log/openshift-apiserver/audit.log\",\n ...",
      "id": "xccdf_org.ssgproject.content_rule_openshift_api_server_audit_log_path",
      "instructions": "Run the following command:\n$ oc get configmap config -n openshift-apiserver -ojson | jq -r '.data[\"config.yaml\"]' | jq '.apiServerArguments[\"audit-log-path\"]'\nThe output should return a valid audit log path.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis,ocp4-stig,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-cis-1-5,ocp4-pci-dss,ocp4-cis-1-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "openshift-api-server-audit-log-path",
          "control.compliance.openshift.io/CIS-OCP": "1.2.20",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.2.20",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-openshift-api-server-audit-log-path",
        "namespace": "openshift-compliance",
        "resourceVersion": "77377",
        "uid": "e9971210-517e-4b44-b28c-d7335a507f58"
      },
      "rationale": "Auditing of the API Server is not enabled by default. Auditing the API Server provides a security-relevant chronological set of records documenting the sequence of activities that have affected the system by users, administrators, or other system components.",
      "severity": "high",
      "title": "Configure the Audit Log Path"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "To configure OpenShift's MOTD, create a *ConfigMap* called motd in the openshift namespace. The object should look as follows:\n\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\nname: motd\nnamespace: openshift\ndata:\n message: \"A relevant MOTD\"\n\nWhere message is a mandatory key. The DoD required text is either:\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\n\nOR:\n\nI've read & consent to terms in IS user agreement.",
      "id": "xccdf_org.ssgproject.content_rule_openshift_motd_exists",
      "instructions": "To verify that the MOTD is properly set, do the following:\n$ oc get configmaps -n openshift motd -ojsonpath='{.data.message}'\nmake sure that the output matches the relevant legal message for\nyour organization.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "openshift-motd-exists",
          "control.compliance.openshift.io/NIST-800-53": "AC-8",
          "policies.open-cluster-management.io/controls": "AC-8",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-openshift-motd-exists",
        "namespace": "openshift-compliance",
        "resourceVersion": "76609",
        "uid": "dc96c527-d246-40b7-a53b-de7d8aa133eb"
      },
      "rationale": "Display of a standardized and approved use notification before granting access to the system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.",
      "severity": "medium",
      "title": "Ensure that the OpenShift MOTD is set"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Kubernetes API server audit logs are stored in the /var/log/kube-apiserver directory.\n\nPartitioning Red Hat CoreOS is a Day 1 operation and cannot be changed afterwards. For documentation on how to add a MachineConfig manifest that specifies a separate /var/log/kube-apiserver partition, follow: https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic\n\nNote that the Red Hat OpenShift documentation often references a block device, such as /dev/vda. The name of the available block devices depends on the underlying infrastructure (bare metal vs cloud), and often the specific instance type. For example in AWS, some instance types have NVMe drives ( /dev/nvme* ), others use /dev/xvda*. You will need to look for relevant documentation for your infrastructure around this. In many cases, the simplest thing is to boot a single machine with an Ignition configuration that just gives you SSH access, and inspect the block devices via e.g. the lsblk command. For physical hardware, a good best practice is to reference devices via the /dev/disk/by-id/ or /dev/disk/by-path links.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_var_log_kube_apiserver",
      "instructions": "Verify that a separate file system/partition has been created for /var/log/kube-apiserver with the following command:\n\n$ mountpoint /var/log/kube-apiserver",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "partition-for-var-log-kube-apiserver",
          "control.compliance.openshift.io/NIST-800-53": "AU-4",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.3;Req-10.5.4",
          "policies.open-cluster-management.io/controls": "AU-4,Req-10.5.3,Req-10.5.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-partition-for-var-log-kube-apiserver",
        "namespace": "openshift-compliance",
        "resourceVersion": "76964",
        "uid": "b0bced58-60aa-47e3-b8eb-8e3ae0537151"
      },
      "rationale": "Placing /var/log/kube-apiserver in its own partition enables better separation between Kubernetes API server audit files and other log files, and helps ensure that auditing cannot be halted due to the partition running out of space.",
      "severity": "medium",
      "title": "Ensure /var/log/kube-apiserver Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "OpenShift OAuth server audit logs are stored in the /var/log/oauth-apiserver directory.\n\nPartitioning Red Hat CoreOS is a Day 1 operation and cannot be changed afterwards. For documentation on how to add a MachineConfig manifest that specifies a separate /var/log/oauth-apiserver partition, follow: https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic\n\nNote that the Red Hat OpenShift documentation often references a block device, such as /dev/vda. The name of the available block devices depends on the underlying infrastructure (bare metal vs cloud), and often the specific instance type. For example in AWS, some instance types have NVMe drives ( /dev/nvme* ), others use /dev/xvda*. You will need to look for relevant documentation for your infrastructure around this. In many cases, the simplest thing is to boot a single machine with an Ignition configuration that just gives you SSH access, and inspect the block devices via e.g. the lsblk command. For physical hardware, a good best practice is to reference devices via the /dev/disk/by-id/ or /dev/disk/by-path links.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_var_log_oauth_apiserver",
      "instructions": "Verify that a separate file system/partition has been created for /var/log/oauth-apiserver with the following command:\n\n$ mountpoint /var/log/oauth-apiserver",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-node-rev-4,ocp4-pci-dss-node,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node",
          "compliance.openshift.io/rule": "partition-for-var-log-oauth-apiserver",
          "control.compliance.openshift.io/NIST-800-53": "AU-4",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.3;Req-10.5.4",
          "policies.open-cluster-management.io/controls": "AU-4,Req-10.5.3,Req-10.5.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-partition-for-var-log-oauth-apiserver",
        "namespace": "openshift-compliance",
        "resourceVersion": "76967",
        "uid": "ecaf9025-9605-4ebf-b59e-5e337449190a"
      },
      "rationale": "Placing /var/log/oauth-apiserver in its own partition enables better separation between OpenShift OAuth server audit files and other log files, and helps ensure that auditing cannot be halted due to the partition running out of space.",
      "severity": "medium",
      "title": "Ensure /var/log/oauth-apiserver Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Openshift API server audit logs are stored in the /var/log/openshift-apiserver directory.\n\nPartitioning Red Hat CoreOS is a Day 1 operation and cannot be changed afterwards. For documentation on how to add a MachineConfig manifest that specifies a separate /var/log/openshift-apiserver partition, follow: https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic\n\nNote that the Red Hat OpenShift documentation often references a block device, such as /dev/vda. The name of the available block devices depends on the underlying infrastructure (bare metal vs cloud), and often the specific instance type. For example in AWS, some instance types have NVMe drives ( /dev/nvme* ), others use /dev/xvda*. You will need to look for relevant documentation for your infrastructure around this. In many cases, the simplest thing is to boot a single machine with an Ignition configuration that just gives you SSH access, and inspect the block devices via e.g. the lsblk command. For physical hardware, a good best practice is to reference devices via the /dev/disk/by-id/ or /dev/disk/by-path links.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_var_log_openshift_apiserver",
      "instructions": "Verify that a separate file system/partition has been created for /var/log/openshift-apiserver with the following command:\n\n$ mountpoint /var/log/openshift-apiserver",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-pci-dss-node-3-2,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-pci-dss-node",
          "compliance.openshift.io/rule": "partition-for-var-log-openshift-apiserver",
          "control.compliance.openshift.io/NIST-800-53": "AU-4",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.3;Req-10.5.4",
          "policies.open-cluster-management.io/controls": "AU-4,Req-10.5.3,Req-10.5.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-partition-for-var-log-openshift-apiserver",
        "namespace": "openshift-compliance",
        "resourceVersion": "76979",
        "uid": "4dfe78e0-c097-41bb-9842-16d77e03619c"
      },
      "rationale": "Placing /var/log/openshift-apiserver in its own partition enables better separation between Openshift API server audit files and other log files, and helps ensure that auditing cannot be halted due to the partition running out of space.",
      "severity": "medium",
      "title": "Ensure /var/log/openshift-apiserver Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "config.openshift.io/v1",
            "kind": "Project",
            "metadata": {
              "name": "cluster"
            },
            "spec": {
              "projectRequestTemplate": {
                "name": "co-project-request"
              }
            }
          }
        },
        {
          "fixObject": {
            "apiVersion": "template.openshift.io/v1",
            "kind": "Template",
            "metadata": {
              "name": "co-project-request",
              "namespace": "openshift-config"
            },
            "objects": [
              {
                "apiVersion": "project.openshift.io/v1",
                "kind": "Project",
                "metadata": {
                  "annotations": {
                    "openshift.io/description": "${PROJECT_DESCRIPTION}",
                    "openshift.io/display-name": "${PROJECT_DISPLAYNAME}",
                    "openshift.io/requester": "${PROJECT_REQUESTING_USER}"
                  },
                  "creationTimestamp": null,
                  "name": "${PROJECT_NAME}"
                },
                "spec": {},
                "status": {}
              },
              {
                "apiVersion": "rbac.authorization.k8s.io/v1",
                "kind": "RoleBinding",
                "metadata": {
                  "creationTimestamp": null,
                  "name": "admin",
                  "namespace": "${PROJECT_NAME}"
                },
                "roleRef": {
                  "apiGroup": "rbac.authorization.k8s.io",
                  "kind": "ClusterRole",
                  "name": "admin"
                },
                "subjects": [
                  {
                    "apiGroup": "rbac.authorization.k8s.io",
                    "kind": "User",
                    "name": "${PROJECT_ADMIN_USER}"
                  }
                ]
              },
              {
                "apiVersion": "v1",
                "kind": "ResourceQuota",
                "metadata": {
                  "name": "${PROJECT_NAME}-quota"
                },
                "spec": {
                  "hard": {
                    "cpu": "2",
                    "memory": "5Gi",
                    "pods": "40"
                  }
                }
              },
              {
                "apiVersion": "v1",
                "kind": "LimitRange",
                "metadata": {
                  "name": "${PROJECT_NAME}-limit-range"
                },
                "spec": {
                  "limits": [
                    {
                      "default": {
                        "cpu": "200m"
                      },
                      "defaultRequest": {
                        "cpu": "10m"
                      },
                      "type": "Container"
                    }
                  ]
                }
              },
              {
                "apiVersion": "networking.k8s.io/v1",
                "kind": "NetworkPolicy",
                "metadata": {
                  "name": "allow-from-same-namespace"
                },
                "spec": {
                  "ingress": [
                    {
                      "from": [
                        {
                          "podSelector": {}
                        }
                      ]
                    }
                  ],
                  "podSelector": {}
                }
              },
              {
                "apiVersion": "networking.k8s.io/v1",
                "kind": "NetworkPolicy",
                "metadata": {
                  "name": "allow-from-openshift-ingress"
                },
                "spec": {
                  "ingress": [
                    {
                      "from": [
                        {
                          "namespaceSelector": {
                            "matchLabels": {
                              "network.openshift.io/policy-group": "ingress"
                            }
                          }
                        }
                      ]
                    }
                  ],
                  "podSelector": {},
                  "policyTypes": [
                    "Ingress"
                  ]
                }
              }
            ],
            "parameters": [
              {
                "name": "PROJECT_NAME"
              },
              {
                "name": "PROJECT_DISPLAYNAME"
              },
              {
                "name": "PROJECT_DESCRIPTION"
              },
              {
                "name": "PROJECT_ADMIN_USER"
              },
              {
                "name": "PROJECT_REQUESTING_USER"
              }
            ]
          }
        }
      ],
      "checkType": "Platform",
      "description": "Configure a template for newly created projects to use default network policies and make sure this template is referenced from the default project template. The OpenShift Container Platform API server automatically provisions new projects based on the project template that is identified by the projectRequestTemplate parameter in the cluster’s project configuration resource. As a cluster administrator, you can modify the default project template so that new projects created would satisfy the chosen compliance standards. For more information on configuring default network policies, follow the relevant documentation ( https://docs.openshift.com/container-platform/latest/networking/network_policy/default-network-policy.html ).",
      "id": "xccdf_org.ssgproject.content_rule_project_config_and_template_network_policy",
      "instructions": "Verify that a Template exists in the openshift-config namespace\nthat includes at least one NetworkPolicy Kind in the list of .objects:\noc get -nopenshift-config template -ojson |  jq -r '[.items[] | any(.objects[]?; .kind == \"NetworkPolicy\") ]'\nIf there is at least one matching template, the above query would\nreturn true.\n\nVerify that the project config named cluster references the\nprojectRequestTemplate that defines NetworkPolicies:\noc get project.config.openshift.io/cluster -ojsonpath=\"{.spec.projectRequestTemplate.name}\"",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-stig",
          "compliance.openshift.io/rule": "project-config-and-template-network-policy"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-project-config-and-template-network-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "77346",
        "uid": "8e4cb9be-2018-4a31-9084-643f3013f6fd"
      },
      "rationale": "Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. When a network policy is introduced to a given namespace, all traffic not allowed by the policy is denied. Editing the default project template to include NetworkPolicies in all new namespaces ensures that all namespaces include at least some NetworkPolicy objects. Ensuring that the project configuration references a project template that sets up the required objects for new projects ensures that all new projects will be set in accordance with centralized settings.",
      "severity": "medium",
      "title": "Ensure that project templates autocreate Network Policies"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "config.openshift.io/v1",
            "kind": "Project",
            "metadata": {
              "name": "cluster"
            },
            "spec": {
              "projectRequestTemplate": {
                "name": "co-project-request"
              }
            }
          }
        },
        {
          "fixObject": {
            "apiVersion": "template.openshift.io/v1",
            "kind": "Template",
            "metadata": {
              "name": "co-project-request",
              "namespace": "openshift-config"
            },
            "objects": [
              {
                "apiVersion": "project.openshift.io/v1",
                "kind": "Project",
                "metadata": {
                  "annotations": {
                    "openshift.io/description": "${PROJECT_DESCRIPTION}",
                    "openshift.io/display-name": "${PROJECT_DISPLAYNAME}",
                    "openshift.io/requester": "${PROJECT_REQUESTING_USER}"
                  },
                  "creationTimestamp": null,
                  "name": "${PROJECT_NAME}"
                },
                "spec": {},
                "status": {}
              },
              {
                "apiVersion": "rbac.authorization.k8s.io/v1",
                "kind": "RoleBinding",
                "metadata": {
                  "creationTimestamp": null,
                  "name": "admin",
                  "namespace": "${PROJECT_NAME}"
                },
                "roleRef": {
                  "apiGroup": "rbac.authorization.k8s.io",
                  "kind": "ClusterRole",
                  "name": "admin"
                },
                "subjects": [
                  {
                    "apiGroup": "rbac.authorization.k8s.io",
                    "kind": "User",
                    "name": "${PROJECT_ADMIN_USER}"
                  }
                ]
              },
              {
                "apiVersion": "v1",
                "kind": "ResourceQuota",
                "metadata": {
                  "name": "${PROJECT_NAME}-quota"
                },
                "spec": {
                  "hard": {
                    "cpu": "2",
                    "memory": "5Gi",
                    "pods": "40"
                  }
                }
              },
              {
                "apiVersion": "v1",
                "kind": "LimitRange",
                "metadata": {
                  "name": "${PROJECT_NAME}-limit-range"
                },
                "spec": {
                  "limits": [
                    {
                      "default": {
                        "cpu": "200m"
                      },
                      "defaultRequest": {
                        "cpu": "10m"
                      },
                      "type": "Container"
                    }
                  ]
                }
              },
              {
                "apiVersion": "networking.k8s.io/v1",
                "kind": "NetworkPolicy",
                "metadata": {
                  "name": "allow-from-same-namespace"
                },
                "spec": {
                  "ingress": [
                    {
                      "from": [
                        {
                          "podSelector": {}
                        }
                      ]
                    }
                  ],
                  "podSelector": {}
                }
              },
              {
                "apiVersion": "networking.k8s.io/v1",
                "kind": "NetworkPolicy",
                "metadata": {
                  "name": "allow-from-openshift-ingress"
                },
                "spec": {
                  "ingress": [
                    {
                      "from": [
                        {
                          "namespaceSelector": {
                            "matchLabels": {
                              "network.openshift.io/policy-group": "ingress"
                            }
                          }
                        }
                      ]
                    }
                  ],
                  "podSelector": {},
                  "policyTypes": [
                    "Ingress"
                  ]
                }
              }
            ],
            "parameters": [
              {
                "name": "PROJECT_NAME"
              },
              {
                "name": "PROJECT_DISPLAYNAME"
              },
              {
                "name": "PROJECT_DESCRIPTION"
              },
              {
                "name": "PROJECT_ADMIN_USER"
              },
              {
                "name": "PROJECT_REQUESTING_USER"
              }
            ]
          }
        }
      ],
      "checkType": "Platform",
      "description": "Configure a template for newly created projects to use default resource quotas and make sure this template is referenced from the default project template.\n\nThe OpenShift Container Platform API server automatically provisions new projects based on the project template that is identified by the projectRequestTemplate parameter in the cluster’s project configuration resource.\n\nAs a cluster administrator, you can modify the default project template so that new projects created would satisfy the chosen compliance standards.\n\nFor more information, follow the relevant documentation ( https://docs.openshift.com/container-platform/4.12/applications/projects/configuring-project-creation.html ).",
      "id": "xccdf_org.ssgproject.content_rule_project_config_and_template_resource_quota",
      "instructions": "Verify that a Template exists in the openshift-config namespace\nthat includes at least one ResourceQuota Kind in the list of .objects:\noc get -nopenshift-config template -ojson |  jq -r '[.items[] | any(.objects[]?; .kind == \"ResourceQuota\") ]'\nIf there is at least one matching template, the above query would\nreturn true.\n\nVerify that the project config named cluster references the\nprojectRequestTemplate that defines ResourceQuotas:\noc get project.config.openshift.io/cluster -ojsonpath=\"{.spec.projectRequestTemplate.name}\"",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "project-config-and-template-resource-quota",
          "control.compliance.openshift.io/NIST-800-53": "SC-5;SC-5(1)",
          "policies.open-cluster-management.io/controls": "SC-5,SC-5(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-project-config-and-template-resource-quota",
        "namespace": "openshift-compliance",
        "resourceVersion": "76615",
        "uid": "baf00363-f3cd-4874-a4a2-02161075123b"
      },
      "rationale": "Running different applications on the same Kubernetes cluster creates a risk of a \"noisy neighbor\" when one application monopolizes cluster resources. A resource quota, defined by a ResourceQuota object, provides constraints that limit aggregate resource consumption per project. It can limit the quantity of objects that can be created in a project by type, as well as the total amount of compute resources and storage that might be consumed by resources in that project.\n\nEditing the default project template to include ResourceQuotas in all new namespaces ensures that all namespaces include at least some ResourceQuotas objects.\n\nEnsuring that the project configuration references a project template that sets up the required objects for new projects ensures that all new projects will be set in accordance with centralized settings.",
      "severity": "medium",
      "title": "Ensure that project templates autocreate Resource Quotas"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "config.openshift.io/v1",
            "kind": "Project",
            "metadata": {
              "name": "cluster"
            },
            "spec": {
              "projectRequestTemplate": {
                "name": "co-project-request"
              }
            }
          }
        }
      ],
      "checkType": "Platform",
      "description": "The OpenShift Container Platform API server automatically provisions new projects based on the project template that is identified by the projectRequestTemplate parameter in the cluster’s project configuration resource. As a cluster administrator, you can modify the default project template so that new projects created would satisfy the chosen compliance standards. For more information, follow the relevant documentation ( https://docs.openshift.com/container-platform/4.12/applications/projects/configuring-project-creation.html ).",
      "id": "xccdf_org.ssgproject.content_rule_project_config_has_template",
      "instructions": "Verify that the project config named cluster references a\nprojectRequestTemplate:\noc get project.config.openshift.io/cluster -ojsonpath=\"{.spec.projectRequestTemplate.name}\"",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "project-config-has-template",
          "control.compliance.openshift.io/NIST-800-53": "AC-4;SC-5;SC-5(1)",
          "policies.open-cluster-management.io/controls": "AC-4,SC-5,SC-5(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-project-config-has-template",
        "namespace": "openshift-compliance",
        "resourceVersion": "76618",
        "uid": "6d6ae65e-b34d-4783-b617-6f6921f67f7c"
      },
      "rationale": "Ensuring that the project configuration references a project template that sets up the required objects for new projects ensures that all new projects will be set in accordance with centralized settings.",
      "severity": "medium",
      "title": "Ensure that project config references a project template"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "template.openshift.io/v1",
            "kind": "Template",
            "metadata": {
              "name": "co-project-request",
              "namespace": "openshift-config"
            },
            "objects": [
              {
                "apiVersion": "project.openshift.io/v1",
                "kind": "Project",
                "metadata": {
                  "annotations": {
                    "openshift.io/description": "${PROJECT_DESCRIPTION}",
                    "openshift.io/display-name": "${PROJECT_DISPLAYNAME}",
                    "openshift.io/requester": "${PROJECT_REQUESTING_USER}"
                  },
                  "creationTimestamp": null,
                  "name": "${PROJECT_NAME}"
                },
                "spec": {},
                "status": {}
              },
              {
                "apiVersion": "rbac.authorization.k8s.io/v1",
                "kind": "RoleBinding",
                "metadata": {
                  "creationTimestamp": null,
                  "name": "admin",
                  "namespace": "${PROJECT_NAME}"
                },
                "roleRef": {
                  "apiGroup": "rbac.authorization.k8s.io",
                  "kind": "ClusterRole",
                  "name": "admin"
                },
                "subjects": [
                  {
                    "apiGroup": "rbac.authorization.k8s.io",
                    "kind": "User",
                    "name": "${PROJECT_ADMIN_USER}"
                  }
                ]
              },
              {
                "apiVersion": "v1",
                "kind": "ResourceQuota",
                "metadata": {
                  "name": "${PROJECT_NAME}-quota"
                },
                "spec": {
                  "hard": {
                    "cpu": "2",
                    "memory": "5Gi",
                    "pods": "40"
                  }
                }
              },
              {
                "apiVersion": "v1",
                "kind": "LimitRange",
                "metadata": {
                  "name": "${PROJECT_NAME}-limit-range"
                },
                "spec": {
                  "limits": [
                    {
                      "default": {
                        "cpu": "200m"
                      },
                      "defaultRequest": {
                        "cpu": "10m"
                      },
                      "type": "Container"
                    }
                  ]
                }
              },
              {
                "apiVersion": "networking.k8s.io/v1",
                "kind": "NetworkPolicy",
                "metadata": {
                  "name": "allow-from-same-namespace"
                },
                "spec": {
                  "ingress": [
                    {
                      "from": [
                        {
                          "podSelector": {}
                        }
                      ]
                    }
                  ],
                  "podSelector": {}
                }
              },
              {
                "apiVersion": "networking.k8s.io/v1",
                "kind": "NetworkPolicy",
                "metadata": {
                  "name": "allow-from-openshift-ingress"
                },
                "spec": {
                  "ingress": [
                    {
                      "from": [
                        {
                          "namespaceSelector": {
                            "matchLabels": {
                              "network.openshift.io/policy-group": "ingress"
                            }
                          }
                        }
                      ]
                    }
                  ],
                  "podSelector": {},
                  "policyTypes": [
                    "Ingress"
                  ]
                }
              }
            ],
            "parameters": [
              {
                "name": "PROJECT_NAME"
              },
              {
                "name": "PROJECT_DISPLAYNAME"
              },
              {
                "name": "PROJECT_DESCRIPTION"
              },
              {
                "name": "PROJECT_ADMIN_USER"
              },
              {
                "name": "PROJECT_REQUESTING_USER"
              }
            ]
          }
        }
      ],
      "checkType": "Platform",
      "description": "Configure a template for newly created projects to use default network policies. For more information, follow the relevant documentation ( https://docs.openshift.com/container-platform/latest/networking/network_policy/default-network-policy.html ).",
      "id": "xccdf_org.ssgproject.content_rule_project_template_network_policy",
      "instructions": "Verify that a Template exists in the openshift-config namespace\nthat includes at least one NetworkPolicy Kind in the list of .objects:\noc get -nopenshift-config template -ojson |  jq -r '[.items[] | any(.objects[]?; .kind == \"NetworkPolicy\") ]'\nIf there is at least one matching template, the above query would\nreturn true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "project-template-network-policy"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-project-template-network-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "77351",
        "uid": "0805ed10-9454-404f-8209-f046226a668c"
      },
      "rationale": "Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. When a network policy is introduced to a given namespace, all traffic not allowed by the policy is denied. Editing the default project template to include NetworkPolicies in all new namespaces ensures that all namespaces include at least some NetworkPolicy objects.",
      "severity": "medium",
      "title": "Ensure that project templates autocreate Network Policies"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "template.openshift.io/v1",
            "kind": "Template",
            "metadata": {
              "name": "co-project-request",
              "namespace": "openshift-config"
            },
            "objects": [
              {
                "apiVersion": "project.openshift.io/v1",
                "kind": "Project",
                "metadata": {
                  "annotations": {
                    "openshift.io/description": "${PROJECT_DESCRIPTION}",
                    "openshift.io/display-name": "${PROJECT_DISPLAYNAME}",
                    "openshift.io/requester": "${PROJECT_REQUESTING_USER}"
                  },
                  "creationTimestamp": null,
                  "name": "${PROJECT_NAME}"
                },
                "spec": {},
                "status": {}
              },
              {
                "apiVersion": "rbac.authorization.k8s.io/v1",
                "kind": "RoleBinding",
                "metadata": {
                  "creationTimestamp": null,
                  "name": "admin",
                  "namespace": "${PROJECT_NAME}"
                },
                "roleRef": {
                  "apiGroup": "rbac.authorization.k8s.io",
                  "kind": "ClusterRole",
                  "name": "admin"
                },
                "subjects": [
                  {
                    "apiGroup": "rbac.authorization.k8s.io",
                    "kind": "User",
                    "name": "${PROJECT_ADMIN_USER}"
                  }
                ]
              },
              {
                "apiVersion": "v1",
                "kind": "ResourceQuota",
                "metadata": {
                  "name": "${PROJECT_NAME}-quota"
                },
                "spec": {
                  "hard": {
                    "cpu": "2",
                    "memory": "5Gi",
                    "pods": "40"
                  }
                }
              },
              {
                "apiVersion": "v1",
                "kind": "LimitRange",
                "metadata": {
                  "name": "${PROJECT_NAME}-limit-range"
                },
                "spec": {
                  "limits": [
                    {
                      "default": {
                        "cpu": "200m"
                      },
                      "defaultRequest": {
                        "cpu": "10m"
                      },
                      "type": "Container"
                    }
                  ]
                }
              },
              {
                "apiVersion": "networking.k8s.io/v1",
                "kind": "NetworkPolicy",
                "metadata": {
                  "name": "allow-from-same-namespace"
                },
                "spec": {
                  "ingress": [
                    {
                      "from": [
                        {
                          "podSelector": {}
                        }
                      ]
                    }
                  ],
                  "podSelector": {}
                }
              },
              {
                "apiVersion": "networking.k8s.io/v1",
                "kind": "NetworkPolicy",
                "metadata": {
                  "name": "allow-from-openshift-ingress"
                },
                "spec": {
                  "ingress": [
                    {
                      "from": [
                        {
                          "namespaceSelector": {
                            "matchLabels": {
                              "network.openshift.io/policy-group": "ingress"
                            }
                          }
                        }
                      ]
                    }
                  ],
                  "podSelector": {},
                  "policyTypes": [
                    "Ingress"
                  ]
                }
              }
            ],
            "parameters": [
              {
                "name": "PROJECT_NAME"
              },
              {
                "name": "PROJECT_DISPLAYNAME"
              },
              {
                "name": "PROJECT_DESCRIPTION"
              },
              {
                "name": "PROJECT_ADMIN_USER"
              },
              {
                "name": "PROJECT_REQUESTING_USER"
              }
            ]
          }
        }
      ],
      "checkType": "Platform",
      "description": "Configure a template for newly created projects to use default resource quotas and make sure this template is referenced from the default project template. For more information, follow the relevant documentation ( https://docs.openshift.com/container-platform/4.12/applications/projects/configuring-project-creation.html ).",
      "id": "xccdf_org.ssgproject.content_rule_project_template_resource_quota",
      "instructions": "Verify that a Template exists in the openshift-config namespace\nthat includes at least one ResourceQuota Kind in the list of .objects:\noc get -nopenshift-config template -ojson |  jq -r '[.items[] | any(.objects[]?; .kind == \"ResourceQuota\") ]'\nIf there is at least one matching template, the above query would\nreturn true.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "project-template-resource-quota",
          "control.compliance.openshift.io/NIST-800-53": "SC-5;SC-5(1)",
          "policies.open-cluster-management.io/controls": "SC-5,SC-5(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-project-template-resource-quota",
        "namespace": "openshift-compliance",
        "resourceVersion": "76623",
        "uid": "abc6dc19-efd9-46d9-a784-04417657929a"
      },
      "rationale": "Running different applications on the same Kubernetes cluster creates a risk of a \"noisy neighbor\" when one application monopolizes cluster resources. A resource quota, defined by a ResourceQuota object, provides constraints that limit aggregate resource consumption per project. It can limit the quantity of objects that can be created in a project by type, as well as the total amount of compute resources and storage that might be consumed by resources in that project. Ensuring that the project configuration references a project template that sets up the required objects for new projects ensures that all new projects will be set in accordance with centralized settings.",
      "severity": "medium",
      "title": "Ensure that project templates autocreate Resource Quotas"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "RBAC is a critical feature in terms of security for Kubernetes and OpenShift. It enables administrators to segment the privileges granted to a service account, and thus allows us to limit the access to resources that they get. By defining cluster roles appropriately one is able to codify organizational policy. [1]\n\n[1] https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html",
      "id": "xccdf_org.ssgproject.content_rule_rbac_cluster_roles_defined",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "rbac-cluster-roles-defined",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1.1",
          "policies.open-cluster-management.io/controls": "Req-7.1.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-cluster-roles-defined",
        "namespace": "openshift-compliance",
        "resourceVersion": "77381",
        "uid": "34e744e8-fdd1-4be0-a116-5c7d078f30a1"
      },
      "rationale": "By defining RBAC cluster roles, one is able to limit the permissions given to a Service Account, and thus limit the blast radius that an account compromise would have.",
      "severity": "medium",
      "title": "Ensure cluster roles are defined in the cluster"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Ensure that the cluster-debugger cluster role includes the /debug/pprof resource URL. This demonstrates that profiling is protected by RBAC, with a specific cluster role to allow access.",
      "id": "xccdf_org.ssgproject.content_rule_rbac_debug_role_protects_pprof",
      "instructions": "To verify that the cluster-debugger role is configured correctly,\nrun the following command:\n$ oc get clusterroles cluster-debugger -o jsonpath='{.rules[0].nonResourceURLs}'\nand verify that the /debug/pprof path is included there.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-cis,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-pci-dss,ocp4-high",
          "compliance.openshift.io/rule": "rbac-debug-role-protects-pprof",
          "control.compliance.openshift.io/CIS-OCP": "1.3.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,1.3.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-debug-role-protects-pprof",
        "namespace": "openshift-compliance",
        "resourceVersion": "77388",
        "uid": "a5acf1d4-86b6-4e59-a3ac-b2d7f36001e7"
      },
      "rationale": "Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface. To ensure the collected data is not exploited, profiling endpoints are secured via RBAC (see cluster-debugger role). By default, the profiling endpoints are accessible only by users bound to cluster-admin or cluster-debugger role. Profiling can not be disabled.",
      "severity": "medium",
      "title": "Profiling is protected by RBAC"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Role-based access control (RBAC) objects determine whether a user is allowed to perform a given action within a project. If users or groups exist that are bound to roles they must not have, modify the user or group permissions using the following cluster and local role binding commands: Remove a User from a Cluster RBAC role by executing the following: oc adm policy remove-cluster-role-from-user role username Remove a Group from a Cluster RBAC role by executing the following: oc adm policy remove-cluster-role-from-group role groupname Remove a User from a Local RBAC role by executing the following: oc adm policy remove-role-from-user role username Remove a Group from a Local RBAC role by executing the following: oc adm policy remove-role-from-group role groupname NOTE: For additional information. https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html",
      "id": "xccdf_org.ssgproject.content_rule_rbac_least_privilege",
      "instructions": "The administrator must verify that Openshift is configured with the necessary RBAC access controls.\n\nReview the RBAC configuration.\n\nAs the cluster-admin, view the cluster roles and their associated rule sets by executing the following::\n\noc describe clusterrole.rbac\n\nNow view the current set of cluster role bindings, which shows the users and groups that are bound to various roles by executing the following:\n\noc describe clusterrolebinding.rbac\n\nLocal roles and bindings can be determined using the follow commands by executing the following:\n\noc describe rolebinding.rbac\n\nIf these results show users with privileged access that do not require that access, this is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-stig,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high,ocp4-bsi,ocp4-stig-v1r1,ocp4-bsi-2022,ocp4-cis,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "rbac-least-privilege",
          "control.compliance.openshift.io/CIS-OCP": "5.2.10",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;CM-5(6);IA-2;IA-2(5);AC-6(10);CM-11(2);CM-5(1);CM-7(5)(b)",
          "policies.open-cluster-management.io/controls": "AC-3,CM-5(6),IA-2,IA-2(5),AC-6(10),CM-11(2),CM-5(1),CM-7(5)(b),5.2.10",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-least-privilege",
        "namespace": "openshift-compliance",
        "resourceVersion": "77396",
        "uid": "8e5df5f2-1eaa-4d7b-b39d-d9643149792e"
      },
      "rationale": "Controlling and limiting users access to system services and resources is key to securing the platform and limiting the intentional or unintentional comprimising of the system and its services. OpenShift provides a robust RBAC policy system that allows for authorization policies to be as detailed as needed. Additionally there are two layers of RBAC policies, the first is Cluster RBAC policies which administrators can control who has what access to cluster level services. The other is Local RBAC policies, which allow project developers/administrators to control what level of access users have to a given project or namespace.",
      "severity": "high",
      "title": "Ensure that the RBAC setup follows the principle of least privilege"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The RBAC role cluster-admin provides wide-ranging powers over the environment and should be used only where and when needed.",
      "id": "xccdf_org.ssgproject.content_rule_rbac_limit_cluster_admin",
      "instructions": "Review users and groups bound to cluster-admin and decide whether they\nrequire such access. Consider creating least-privilege roles for users and\nservice accounts. Obtain a list of the users who have access to the\ncluster-admin role by reviewing the clusterrolebinding output for each role\nbinding that has access to the cluster-admin role. To do this, run the\nfollowing command:\n$ oc get clusterrolebindings -o=custom-columns=NAME:.metadata.name,ROLE:.roleRef.name,SUBJECT:.subjects[*].kind | grep cluster-admin\n\nCare should be taken before removing any clusterrolebindings from the\nenvironment to ensure they are not required for operation of the cluster.\nSpecifically, modifications should not be made to the default\nclusterrolebindings including those with the \"system:\" prefix.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-high-rev-4,ocp4-nerc-cip,ocp4-high,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-moderate-rev-4,ocp4-cis,ocp4-stig,ocp4-cis-1-4,ocp4-stig-v1r1,ocp4-cis-1-5,ocp4-e8",
          "compliance.openshift.io/rule": "rbac-limit-cluster-admin",
          "control.compliance.openshift.io/CIS-OCP": "5.1.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);CM-8(3)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2;Req-7.1.2;Req-10.5.1",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),CM-8(3),Req-2.2,Req-7.1.2,Req-10.5.1,5.1.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-limit-cluster-admin",
        "namespace": "openshift-compliance",
        "resourceVersion": "77400",
        "uid": "ca9e003c-7fcc-414e-98b2-131b6b06b92f"
      },
      "rationale": "Kubernetes provides a set of default roles where RBAC is used. Some of these roles such as cluster-admin provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as cluster-admin allow super-user access to perform any action on any resource. When used in a ClusterRoleBinding, it gives full control over every resource in the cluster and in all namespaces. When used in a RoleBinding, it gives full control over every resource in the rolebinding's namespace, including the namespace itself.",
      "severity": "medium",
      "title": "Ensure that the cluster-admin role is only used where required"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The Kubernetes API stores secrets, which may be service account tokens for the Kubernetes API or credentials used by workloads in the cluster. Access to these secrets should be restricted to the smallest possible group of users to reduce the risk of privilege escalation. To restrict users from secrets, remove get , list , and watch access to unauthorized users to secret objects in the cluster.",
      "id": "xccdf_org.ssgproject.content_rule_rbac_limit_secrets_access",
      "instructions": "To review the policy rules assigned to roles in all namespaces, run\nthe following command:\n$ for ns in $(oc get projects -ojsonpath='{.items[*].metadata.name}'); do oc describe roles -n$ns; done\nTo review the policy rules assigned to cluster roles, run the following\ncommand:\n$ for i in $(oc get clusterroles -o jsonpath='{.items[*].metadata.name}'); do oc describe clusterrole ${i}; done\nReview the output and ensure that only authorized roles have access to the\nsecrets resource or all resources using a wildcard.\nTo filter clusterroles that have assigned access to the secrets resources for clustrroles, run:\n$ oc get clusterroles -ojson | jq -r '.items[] | {name: .metadata.name, rules: .rules} | select(.rules[]?.resources | try contains([\"secrets\"])) | .name' | sort | uniq\nand similarly to filter namespace/role pairs:\n$ for ns in $(oc get projects -ojsonpath='{.items[*].metadata.name}'); do oc get roles -n$ns -ojson | jq -r '.items[] | {name: .metadata.name, namespace: .metadata.namespace, rules: .rules} | select(.rules[]?.resources | try contains([\"secrets\"])) | \"\\(.namespace)/\\(.name)\"' | sort | uniq; done\nnote that the two commands above do not show roles and/or clusterroles with wildcard access to any resources.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-stig,ocp4-cis-1-4,ocp4-cis,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-high",
          "compliance.openshift.io/rule": "rbac-limit-secrets-access",
          "control.compliance.openshift.io/CIS-OCP": "5.1.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.1.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-limit-secrets-access",
        "namespace": "openshift-compliance",
        "resourceVersion": "77404",
        "uid": "aeee33ea-74bc-4b91-958d-8b6ae55f9a2f"
      },
      "rationale": "Inappropriate access to secrets stored within the Kubernetes cluster can allow for an attacker to gain additional access to the Kubernetes cluster or external resources whose credentials are stored as secrets.",
      "severity": "medium",
      "title": "Limit Access to Kubernetes Secrets"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The ClusterLogging and ClusterLoggingForwarder Custom Resources provide a way to configure the logging forwarding subsystem and delete access to it should be restricted to as-needed basis. Remove delete permissions from any unauthorized user or group by performing one or more of the following commands: * Remove role from user > oc adm policy remove-role-from-user ROLE USER -n openshift-logging * Remove role from group > oc adm policy remove-role-from-group ROLE GROUP -n openshift-logging * Remove cluster role from user > oc adm policy remove-cluster-role-from-user CLUSTER_ROLE USER -n openshift-logging * Remove cluster role from group > oc adm policy remove-cluster-role-from-group CLUSTER_ROLE GROUP -n openshift-logging Where ROLE/CLUSTER_ROLE is the role granting user delete permission to resources in openshift-logging namespace.}",
      "id": "xccdf_org.ssgproject.content_rule_rbac_logging_del",
      "instructions": "Perform a check to list the users and groups who have permission to delete the cluster logging configuration by running the following two commands.\n\n> oc policy who-can delete ClusterLogging -n openshift-logging\n\n> oc policy who-can delete ClusterLoggingForwarder -n openshift-logging\n\nReview the list of users and groups who have delete access to the cluster logging resources.\nIf any user or group listed should not have access to delete the cluster logging resources, this is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-stig",
          "compliance.openshift.io/rule": "rbac-logging-del",
          "control.compliance.openshift.io/NIST-800-53": "AU-9",
          "policies.open-cluster-management.io/controls": "AU-9",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-logging-del",
        "namespace": "openshift-compliance",
        "resourceVersion": "77408",
        "uid": "424fbbcb-6e58-4251-bd1c-59e4d82483d4"
      },
      "rationale": "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.",
      "severity": "medium",
      "title": "Ensure that the ClusterLogging and ClusterLoggingForwarder resources are protected from unauthorized deletion"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The ClusterLogging and ClusterLoggingForwarder Custom Resources provide a way to configure the logging forwarding subsystem and modification access to it should be restricted to as-needed basis. Remove edit permissions from any unauthorized user or group by performing one or more of the following commands: * Remove role from user > oc adm policy remove-role-from-user ROLE USER -n openshift-logging * Remove role from group > oc adm policy remove-role-from-group ROLE GROUP -n openshift-logging * Remove cluster role from user > oc adm policy remove-cluster-role-from-user CLUSTER_ROLE USER -n openshift-logging * Remove cluster role from group > oc adm policy remove-cluster-role-from-group CLUSTER_ROLE GROUP -n openshift-logging Where ROLE/CLUSTER_ROLE is the role granting user edit permission to resources in openshift-logging namespace.}",
      "id": "xccdf_org.ssgproject.content_rule_rbac_logging_mod",
      "instructions": "Perform a check to list the users and groups who have permission to edit the cluster logging configuration by running the following two commands.\n\n> oc policy who-can edit ClusterLogging -n openshift-logging\n\n> oc policy who-can edit ClusterLoggingForwarder -n openshift-logging\n\nReview the list of users and groups who have edit access to the cluster logging resources.\nIf any user or group listed should not have access to edit the cluster logging resources, this is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "rbac-logging-mod",
          "control.compliance.openshift.io/NIST-800-53": "AU-9",
          "policies.open-cluster-management.io/controls": "AU-9",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-logging-mod",
        "namespace": "openshift-compliance",
        "resourceVersion": "77411",
        "uid": "e5f18caa-9cc2-4559-aae5-e1740f16adfe"
      },
      "rationale": "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.",
      "severity": "medium",
      "title": "Ensure that the ClusterLogging and ClusterLoggingForwarder resources are protected from unauthorized modification"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The ClusterLogging and ClusterLoggingForwarder Custom Resources provide a way to configure the logging forwarding subsystem and view access to it should be restricted to as-needed basis. Remove view permissions from any unauthorized user or group by performing one or more of the following commands: * Remove role from user > oc adm policy remove-role-from-user ROLE USER -n openshift-logging * Remove role from group > oc adm policy remove-role-from-group ROLE GROUP -n openshift-logging * Remove cluster role from user > oc adm policy remove-cluster-role-from-user CLUSTER_ROLE USER -n openshift-logging * Remove cluster role from group > oc adm policy remove-cluster-role-from-group CLUSTER_ROLE GROUP -n openshift-logging Where ROLE/CLUSTER_ROLE is the role granting user view permission to resources in openshift-logging namespace.}",
      "id": "xccdf_org.ssgproject.content_rule_rbac_logging_view",
      "instructions": "Perform a check to list the users and groups who have permission to view the cluster logging configuration by running the following two commands.\n\n> oc policy who-can view ClusterLogging -n openshift-logging\n\n> oc policy who-can view ClusterLoggingForwarder -n openshift-logging\n\nReview the list of users and groups who have view access to the cluster logging resources.\nIf any user or group listed should not have access to view the cluster logging resources, this is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "rbac-logging-view",
          "control.compliance.openshift.io/NIST-800-53": "AU-9",
          "policies.open-cluster-management.io/controls": "AU-9",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-logging-view",
        "namespace": "openshift-compliance",
        "resourceVersion": "77417",
        "uid": "c83e57c8-95e7-4729-a54a-28c0ebcefbc5"
      },
      "rationale": "Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.",
      "severity": "medium",
      "title": "Ensure that the ClusterLogging and ClusterLoggingForwarder resources are protected from unauthorized access"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The ability to create pods in a namespace can provide a number of opportunities for privilege escalation. Where applicable, remove create access to pod objects in the cluster.",
      "id": "xccdf_org.ssgproject.content_rule_rbac_pod_creation_access",
      "instructions": "To review the pod creation privileges in roles, run the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nReview the output, and for any role/clusterrole defining create permissions\nfor pods that are NOT an OpenShift \"system:\" or other system-provided\nrole/clusterrole, determine if the users bound to the role truly have the\nneed to create pods.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-moderate,ocp4-stig,ocp4-pci-dss,ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-pci-dss-3-2,ocp4-cis,ocp4-e8,ocp4-cis-1-5",
          "compliance.openshift.io/rule": "rbac-pod-creation-access",
          "control.compliance.openshift.io/CIS-OCP": "5.1.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.1.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-pod-creation-access",
        "namespace": "openshift-compliance",
        "resourceVersion": "77420",
        "uid": "02ea649d-1560-4d30-b404-ae5a08ba920f"
      },
      "rationale": "The ability to create pods in a cluster opens up the cluster for privilege escalation.",
      "severity": "medium",
      "title": "Minimize Access to Pod Creation"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "RBAC is a critical feature in terms of security for Kubernetes and OpenShift. It enables administrators to segment the privileges granted to a service account, and thus allows us to limit the access to resources that they get. By defining roles appropriately one is able to codify organizational policy. [1]\n\n[1] https://docs.openshift.com/container-platform/latest/authentication/using-rbac.html",
      "id": "xccdf_org.ssgproject.content_rule_rbac_roles_defined",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-pci-dss",
          "compliance.openshift.io/rule": "rbac-roles-defined",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1.1",
          "policies.open-cluster-management.io/controls": "Req-7.1.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-roles-defined",
        "namespace": "openshift-compliance",
        "resourceVersion": "77421",
        "uid": "b4dd71e3-f605-44c7-a5fb-c5687c2745ec"
      },
      "rationale": "By defining RBAC roles, one is able to limit the permissions given to a Service Account, and thus limit the blast radius that an account compromise would have.",
      "severity": "medium",
      "title": "Ensure roles are defined in the cluster"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Kubernetes Cluster and Local Roles provide access to resources based on sets of objects and actions that can be taken on those objects. It is possible to set either of these using a wildcard * which matches all items. This violates the principle of least privilege and leaves a cluster in a more vulnerable state to privilege abuse.",
      "id": "xccdf_org.ssgproject.content_rule_rbac_wildcard_use",
      "instructions": "To review the wildcard usage in roles, run the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nReview the output, and for any role/clusterrole specifying a wildcard\nresource that is NOT an OpenShift \"system:\" or other system-provided\nrole/clusterrole, determine if the wildcard access can be replaced with\nspecific resources.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-4,ocp4-moderate,ocp4-cis-1-5,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-stig-v1r1,ocp4-stig,ocp4-e8,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss-3-2,ocp4-cis,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "rbac-wildcard-use",
          "control.compliance.openshift.io/CIS-OCP": "5.1.3",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.1.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-rbac-wildcard-use",
        "namespace": "openshift-compliance",
        "resourceVersion": "77425",
        "uid": "6dd41935-b7a6-412a-9aef-721ef6db2032"
      },
      "rationale": "The principle of least privilege recommends that users are provided only the access required for their role and nothing more. The use of wildcard rights grants is likely to provide excessive rights to the Kubernetes API.",
      "severity": "medium",
      "title": "Minimize Wildcard Usage in Cluster and Local Roles"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The OpenShift Platform allows for verifying the signature of a container image before pulling it. this is done via the policy.json file [1] which needs to be configured via the Machine Config Operator [2].\n\nEnsure that the default policy is \"reject\" in /etc/containers/policy.json , which should look as follows:\n\n{\n   \"default\": [{\"type\": \"reject\"}],\n   \"transports\":\n   ...\n }\n\nAddition of allowed registries must be an explicit action to ensure that only containers from allowed registries are used.\n\n[1] https://github.com/containers/image/blob/main/docs/containers-policy.json.5.md\n\n[2] https://docs.openshift.com/container-platform/latest/security/container_security/security-container-signature.html",
      "id": "xccdf_org.ssgproject.content_rule_reject_unsigned_images_by_default",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\nSubsequently, run the following command:\n\ncat /etc/containers/policy.json\n\nMake sure that the default policy to verify container images is set to reject.\nThis should look as follows:\n\n\n  {\n    \"default\": [{\"type\": \"reject\"}],\n    \"transports\":\n    ...\n  }",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-node-v1r1,ocp4-high-node,ocp4-high-node-rev-4,ocp4-nerc-cip-node,ocp4-moderate-node,ocp4-moderate-node-rev-4,ocp4-stig-node",
          "compliance.openshift.io/rule": "reject-unsigned-images-by-default",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(3);CM-7(2);CM-7(5);CM-11;SA-10(1)",
          "policies.open-cluster-management.io/controls": "CM-5(3),CM-7(2),CM-7(5),CM-11,SA-10(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-reject-unsigned-images-by-default",
        "namespace": "openshift-compliance",
        "resourceVersion": "76211",
        "uid": "ad6548e8-c276-4ace-b726-0cf9cc0621ad"
      },
      "rationale": "By ensuring that the container runtime verifies the integrity of container images before pulling them one is able to prevent a malicious actor from introducing unauthorized images into the deployment.",
      "severity": "medium",
      "title": "Ensure the Container Runtime rejects unsigned images by default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "When deploying an application, it is important to tune based on memory and CPU consumption, allocating enough resources for the application to function properly. Images provided by OpenShift Dedicated behave properly within the confines of the memory they are allocated. However, any application images must pay attention to the specific resources required to ensure they are available. If the node where a Pod is running has enough of a resource available, it's possible (and allowed) for a container to use more resource than its request for that resource specifies. However, a container is not allowed to use more than its resource limit.",
      "id": "xccdf_org.ssgproject.content_rule_resource_requests_limits_in_daemonset",
      "instructions": "Run the following command to retrieve a list of daemonsets that does not have resource requests and limits:\n$  oc get daemonset.apps  --all-namespaces -o json  | jq '[ .items[] | select(.metadata.namespace | startswith(\"kube-\") or startswith(\"openshift-\") | not) | select( .spec.template.spec.containers[].resources.requests.cpu == null  or  .spec.template.spec.containers[].resources.requests.memory == null or .spec.template.spec.containers[].resources.limits.cpu == null  or  .spec.template.spec.containers[].resources.limits.memory == null )  | .metadata.name ]'\nMake sure that there is output nothing in the result.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-high",
          "compliance.openshift.io/rule": "resource-requests-limits-in-daemonset",
          "control.compliance.openshift.io/NIST-800-53": "SC-6",
          "policies.open-cluster-management.io/controls": "SC-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-resource-requests-limits-in-daemonset",
        "namespace": "openshift-compliance",
        "resourceVersion": "76636",
        "uid": "cf60fda3-6552-4f8b-9ae5-8d3ebaa1b538"
      },
      "rationale": "Resource requests/limits provide constraints that limit aggregate resource consumption per container. This helps prevent resource starvation. When deploying your application, it is important to tune based on memory and CPU consumption, allocating enough resources for the application to function properly.",
      "severity": "medium",
      "title": "Ensure that all daemonsets has resource limits"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "When deploying an application, it is important to tune based on memory and CPU consumption, allocating enough resources for the application to function properly. Images provided by OpenShift Dedicated behave properly within the confines of the memory they are allocated. However, any application images must pay attention to the specific resources required to ensure they are available. If the node where a Pod is running has enough of a resource available, it's possible (and allowed) for a container to use more resource than its request for that resource specifies. However, a container is not allowed to use more than its resource limit.",
      "id": "xccdf_org.ssgproject.content_rule_resource_requests_limits_in_deployment",
      "instructions": "Run the following command to retrieve a list of deployments that does not have resource requests and limits:\n$  oc get deployment.apps  --all-namespaces -o json  | jq '[ .items[] | select(.metadata.namespace | startswith(\"kube-\") or startswith(\"openshift-\") | not) | select( .spec.template.spec.containers[].resources.requests.cpu == null  or  .spec.template.spec.containers[].resources.requests.memory == null or .spec.template.spec.containers[].resources.limits.cpu == null  or  .spec.template.spec.containers[].resources.limits.memory == null )  | .metadata.name ]'\nMake sure that there is output nothing in the result.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "resource-requests-limits-in-deployment",
          "control.compliance.openshift.io/NIST-800-53": "SC-6",
          "policies.open-cluster-management.io/controls": "SC-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-resource-requests-limits-in-deployment",
        "namespace": "openshift-compliance",
        "resourceVersion": "76638",
        "uid": "5b17915b-5e52-4133-8263-df2acaea0941"
      },
      "rationale": "Resource requests/limits provide constraints that limit aggregate resource consumption per container. This helps prevent resource starvation. When deploying your application, it is important to tune based on memory and CPU consumption, allocating enough resources for the application to function properly.",
      "severity": "medium",
      "title": "Ensure that all deployments has resource limits"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "When deploying an application, it is important to tune based on memory and CPU consumption, allocating enough resources for the application to function properly. Images provided by OpenShift Dedicated behave properly within the confines of the memory they are allocated. However, any application images must pay attention to the specific resources required to ensure they are available. If the node where a Pod is running has enough of a resource available, it's possible (and allowed) for a container to use more resource than its request for that resource specifies. However, a container is not allowed to use more than its resource limit.",
      "id": "xccdf_org.ssgproject.content_rule_resource_requests_limits_in_statefulset",
      "instructions": "Run the following command to retrieve a list of statefulsets that does not have resource requests and limits:\n$  oc get statefulset.apps --all-namespaces -o json  | jq '[ .items[] | select(.metadata.namespace | startswith(\"kube-\") or startswith(\"openshift-\") | not) | select( .spec.template.spec.containers[].resources.requests.cpu == null  or  .spec.template.spec.containers[].resources.requests.memory == null or .spec.template.spec.containers[].resources.limits.cpu == null  or  .spec.template.spec.containers[].resources.limits.memory == null )  | .metadata.name ]'\nMake sure that there is output nothing in the result.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-high",
          "compliance.openshift.io/rule": "resource-requests-limits-in-statefulset",
          "control.compliance.openshift.io/NIST-800-53": "SC-6",
          "policies.open-cluster-management.io/controls": "SC-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-resource-requests-limits-in-statefulset",
        "namespace": "openshift-compliance",
        "resourceVersion": "76644",
        "uid": "c81e9848-7933-4dfb-8b24-6869d2c64113"
      },
      "rationale": "Resource requests/limits provide constraints that limit aggregate resource consumption per container. This helps prevent resource starvation. When deploying your application, it is important to tune based on memory and CPU consumption, allocating enough resources for the application to function properly.",
      "severity": "medium",
      "title": "Ensure that all statefulsets has resource limits"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "There are two ways to enable resource requests and limits. To create either: A multi-project quota, defined by a ClusterResourceQuota object, allows quotas to be shared across multiple projects. Resources used in each selected project are aggregated and that aggregate is used to limit resources across all the selected projects. A resource quota, defined by a ResourceQuota object, provides constraints that limit aggregate resource consumption per project. It can limit the quantity of objects that can be created in a project by type, as well as the total amount of compute resources and storage that might be consumed by resources in that project. We want to make sure either a ClusterResourceQuota is used in a cluster or a ResourceQuota is used per namespaces.\n\nTo configure ClusterResourceQuota, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.9/applications/quotas/quotas-setting-across-multiple-projects.html )\n\nTo configure ResourceQuota Per Project, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.9/applications/quotas/quotas-setting-per-project.html )",
      "id": "xccdf_org.ssgproject.content_rule_resource_requests_quota",
      "instructions": "Run the following command to retrieve the ClusterResourceQuota objects in the system:\n$ oc get clusterquota --all-namespaces \nMake sure there exists at least one ClusterResourceQuota object in the cluster.\n\nOr\n\nVerify that the every non-control plane namespace has an appropriate ResourceQuota.\n\nTo get all the non-control plane namespaces, you can do the\nfollowing command oc get  namespaces -o json | jq '[.items[] | select((.metadata.name | startswith(\"openshift\") | not) and (.metadata.name | startswith(\"kube-\") | not) and .metadata.name != \"default\") | .metadata.name ]'\n\nTo get all the non-control plane namespaces with a ResourceQuota, you can do the\nfollowing command oc get --all-namespaces resourcequota -o json | jq '[.items[] | select((.metadata.namespace | startswith(\"openshift\") | not) and (.metadata.namespace | startswith(\"kube-\") | not) and .metadata.namespace != \"default\") | .metadata.namespace] | unique'\n\nMake sure that the namespaces displayed in the commands of the commands match.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4",
          "compliance.openshift.io/rule": "resource-requests-quota",
          "control.compliance.openshift.io/NIST-800-53": "SC-5;SC-5(1);SC-5(2)",
          "policies.open-cluster-management.io/controls": "SC-5,SC-5(1),SC-5(2)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-resource-requests-quota",
        "namespace": "openshift-compliance",
        "resourceVersion": "76647",
        "uid": "779a21e7-f53d-49cc-9088-56a3ff5ddf41"
      },
      "rationale": "Resource quotas provide constraints that limit aggregate resource consumption per project. This helps prevent resource starvation. When deploying your application, it is important to tune based on memory and CPU consumption, allocating enough resources for the application to function properly.",
      "severity": "medium",
      "title": "Ensure workloads use resource requests and limits"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "There are two ways to enable resource requests and limits. To create either: A multi-project quota, defined by a ClusterResourceQuota object, allows quotas to be shared across multiple projects. Resources used in each selected project are aggregated and that aggregate is used to limit resources across all the selected projects. A resource quota, defined by a ResourceQuota object, provides constraints that limit aggregate resource consumption per project. It can limit the quantity of objects that can be created in a project by type, as well as the total amount of compute resources and storage that might be consumed by resources in that project. We want to make sure either a ClusterResourceQuota is used in a cluster or a ResourceQuota is used per namespaces.\n\nTo configure ClusterResourceQuota, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.9/applications/quotas/quotas-setting-across-multiple-projects.html )\n\nTo configure ResourceQuota Per Project, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.9/applications/quotas/quotas-setting-per-project.html )",
      "id": "xccdf_org.ssgproject.content_rule_resource_requests_quota_cluster",
      "instructions": "Run the following command to retrieve the ClusterResourceQuota objects in the system:\n$ oc get clusterquota --all-namespaces \nMake sure there exists at least one ClusterResourceQuota object in the cluster.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "resource-requests-quota-cluster",
          "control.compliance.openshift.io/NIST-800-53": "SC-5;SC-5(1);SC-5(2)",
          "policies.open-cluster-management.io/controls": "SC-5,SC-5(1),SC-5(2)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-resource-requests-quota-cluster",
        "namespace": "openshift-compliance",
        "resourceVersion": "76654",
        "uid": "a6160da2-4f4b-4300-a019-e953298dc85e"
      },
      "rationale": "Resource quotas provide constraints that limit aggregate resource consumption per project. This helps prevent resource starvation. When deploying your application, it is important to tune based on memory and CPU consumption, allocating enough resources for the application to function properly.",
      "severity": "medium",
      "title": "Ensure workloads use cluster resource requests and limits"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "There are two ways to enable resource requests and limits. To create either: A multi-project quota, defined by a ClusterResourceQuota object, allows quotas to be shared across multiple projects. Resources used in each selected project are aggregated and that aggregate is used to limit resources across all the selected projects. A resource quota, defined by a ResourceQuota object, provides constraints that limit aggregate resource consumption per project. It can limit the quantity of objects that can be created in a project by type, as well as the total amount of compute resources and storage that might be consumed by resources in that project. We want to make sure either a ClusterResourceQuota is used in a cluster or a ResourceQuota is used per namespaces.\n\nTo configure ClusterResourceQuota, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.9/applications/quotas/quotas-setting-across-multiple-projects.html )\n\nTo configure ResourceQuota Per Project, follow the directions in the documentation ( https://docs.openshift.com/container-platform/4.9/applications/quotas/quotas-setting-per-project.html )",
      "id": "xccdf_org.ssgproject.content_rule_resource_requests_quota_per_project",
      "instructions": "Verify that the every non-control plane namespace has an appropriate ResourceQuota.\n\nTo get all the non-control plane namespaces, you can do the\nfollowing command oc get  namespaces -o json | jq '[.items[] | select((.metadata.name | startswith(\"openshift\") | not) and (.metadata.name | startswith(\"kube-\") | not) and .metadata.name != \"default\") | .metadata.name ]'\n\nTo get all the non-control plane namespaces with a ResourceQuota, you can do the\nfollowing command oc get --all-namespaces resourcequota -o json | jq '[.items[] | select((.metadata.namespace | startswith(\"openshift\") | not) and (.metadata.namespace | startswith(\"kube-\") | not) and .metadata.namespace != \"default\") | .metadata.namespace] | unique'\n\nMake sure that the namespaces displayed in the commands of the commands match.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig-v1r1,ocp4-stig",
          "compliance.openshift.io/rule": "resource-requests-quota-per-project",
          "control.compliance.openshift.io/NIST-800-53": "SC-5;SC-5(1);SC-5(2);SI-16",
          "policies.open-cluster-management.io/controls": "SC-5,SC-5(1),SC-5(2),SI-16",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-resource-requests-quota-per-project",
        "namespace": "openshift-compliance",
        "resourceVersion": "76665",
        "uid": "49c2f77b-71ca-40ee-8604-ea084b7b4619"
      },
      "rationale": "Resource quotas provide constraints that limit aggregate resource consumption per project. This helps prevent resource starvation. When deploying your application, it is important to tune based on memory and CPU consumption, allocating enough resources for the application to function properly.",
      "severity": "medium",
      "title": "Ensure workloads use resource requests and limits per namespace"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift has an option to set the IP whitelist for Routes [1] when creating new Routes. All routes outside the openshift namespaces and the kube namespaces should use the IP whitelist annotations. Requests from IP addresses that are not in the whitelist are dropped. [1] https://docs.openshift.com/container-platform/latest/networking/routes/route-configuration.html#nw-route-specific-annotations_route-configuration",
      "id": "xccdf_org.ssgproject.content_rule_route_ip_whitelist",
      "instructions": "Run the following command to retrieve a list routes that does not have IP whitelist set::\n$  oc get routes --all-namespaces -o json | jq '[.items[] | select(.metadata.namespace | startswith(\"kube-\") or startswith(\"openshift-\") | not) | select(.metadata.annotations[\"haproxy.router.openshift.io/ip_whitelist\"] | not) | .metadata.name]'\nMake sure that there is output nothing in the result.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-high",
          "compliance.openshift.io/rule": "route-ip-whitelist",
          "control.compliance.openshift.io/NIST-800-53": "SC-7(5)",
          "policies.open-cluster-management.io/controls": "SC-7(5)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-route-ip-whitelist",
        "namespace": "openshift-compliance",
        "resourceVersion": "77353",
        "uid": "f5689739-8179-4397-b8a3-4cb0bdab0f71"
      },
      "rationale": "The usage of IP whitelist for Routes provides basic protection against unwanted access.",
      "severity": "medium",
      "title": "Ensure that all Routes has rate limit enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift Container Platform provides methods for communicating from outside the cluster with services running in the cluster. TLS must be used to protect these communications. OpenShift Routes provide the ability to configure the needed TLS settings. With these, one is able to configure that any request coming from the outside must use TLS. To verify this, ensure that every Route in the system has a policy of Disable or Redirect to ensure a secure endpoint is used. The aforementioned policy will be set in a Routes.spec.tls.insecureEdgeTerminationPolicy setting.",
      "id": "xccdf_org.ssgproject.content_rule_routes_protected_by_tls",
      "instructions": "Run the following command to retrieve the compliancesuites in the system:\n$ oc get routes --all-namespaces\nMake sure that every route object has either None or Redirect\nin the .spec.tls.insecureEdgeTerminationPolicy setting.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "routes-protected-by-tls",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4;CIP-003-8 R4.2;CIP-003-8 R5;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-4;AC-4(21);AC-17(3);SC-8;SC-8(1);SC-8(2);SI-4;SI-4(22)",
          "control.compliance.openshift.io/PCI-DSS": "Req-6.5.4",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4,CIP-003-8 R4.2,CIP-003-8 R5,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R7.1,AC-4,AC-4(21),AC-17(3),SC-8,SC-8(1),SC-8(2),SI-4,SI-4(22),Req-6.5.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-routes-protected-by-tls",
        "namespace": "openshift-compliance",
        "resourceVersion": "77357",
        "uid": "cddcc287-3e3f-4ef3-8118-d3278579abc5"
      },
      "rationale": "Using clear-text in communications coming to or from outside the cluster's network may leak sensitive information.",
      "severity": "medium",
      "title": "Ensure that all OpenShift Routes prefer TLS"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift has an option to set the rate limit for Routes [1] when creating new Routes. All routes outside the openshift namespaces and the kube namespaces should use the rate-limiting annotations. [1] https://docs.openshift.com/container-platform/4.9/networking/routes/route-configuration.html#nw-route-specific-annotations_route-configuration",
      "id": "xccdf_org.ssgproject.content_rule_routes_rate_limit",
      "instructions": "Run the following command to retrieve a list routes that does not have rate limit enabled:\n$  oc get routes --all-namespaces -o json | jq '[.items[] | select(.metadata.namespace | startswith(\"kube-\") or startswith(\"openshift-\") | not) | select(.metadata.annotations[\"haproxy.router.openshift.io/rate-limit-connections\"] == \"true\" | not) | .metadata.name]'\nMake sure that there is output nothing in the result.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-stig,ocp4-nerc-cip",
          "compliance.openshift.io/rule": "routes-rate-limit",
          "control.compliance.openshift.io/NIST-800-53": "SC-5;SC-5(1);SC-5(2)",
          "policies.open-cluster-management.io/controls": "SC-5,SC-5(1),SC-5(2)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-routes-rate-limit",
        "namespace": "openshift-compliance",
        "resourceVersion": "77364",
        "uid": "6a6f495d-8407-4f73-9331-c29a7aad4cd4"
      },
      "rationale": "The usage of rate limit for Routes provides basic protection against distributed denial-of-service (DDoS) attacks.",
      "severity": "medium",
      "title": "Ensure that all Routes has rate limit enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The Compliance Operator ( https://docs.openshift.com/container-platform/latest/security/compliance_operator/compliance-operator-understanding.html#compliance-operator-understanding ) scans the hosts and the platform (OCP) configurations for software flaws and improper configurations according to different compliance benchmarks. It uses OpenSCAP as a backend, which is a known and certified tool to do such scans.",
      "id": "xccdf_org.ssgproject.content_rule_scansettingbinding_exists",
      "instructions": "Run the following command to retrieve the scansettingbindings in the system:\n$ oc get scansettingbindings --all-namespaces\nMake sure the Compliance Operator is installed and there are\nscans running in the system.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-high,ocp4-pci-dss,ocp4-stig-v1r1,ocp4-moderate-rev-4,ocp4-pci-dss-3-2,ocp4-stig",
          "compliance.openshift.io/rule": "scansettingbinding-exists",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R1.3;CIP-003-8 R4.3;CIP-003-8 R6;CIP-004-6 4.1;CIP-004-6 4.2;CIP-004-6 R3;CIP-004-6 R4;CIP-004-6 R4.2;CIP-005-6 R1;CIP-005-6 R1.1;CIP-005-6 R1.2;CIP-007-3 R3;CIP-007-3 R3.1;CIP-007-3 R6.1;CIP-007-3 R8.4",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);RA-5;RA-5(5);SA-4(8)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.4",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R1.3,CIP-003-8 R4.3,CIP-003-8 R6,CIP-004-6 4.1,CIP-004-6 4.2,CIP-004-6 R3,CIP-004-6 R4,CIP-004-6 R4.2,CIP-005-6 R1,CIP-005-6 R1.1,CIP-005-6 R1.2,CIP-007-3 R3,CIP-007-3 R3.1,CIP-007-3 R6.1,CIP-007-3 R8.4,CM-6,CM-6(1),RA-5,RA-5(5),SA-4(8),Req-2.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scansettingbinding-exists",
        "namespace": "openshift-compliance",
        "resourceVersion": "77459",
        "uid": "3db014df-4037-4c73-b983-ca7eb28066ee"
      },
      "rationale": "Vulnerability scanning and risk management are important detective controls for all systems, to detect potential flaws and unauthorised access.",
      "severity": "medium",
      "title": "Ensure that Compliance Operator is scanning the cluster"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The Compliance Operator ( https://docs.openshift.com/container-platform/latest/security/compliance_operator/compliance-operator-understanding.html#compliance-operator-understanding ) scans the hosts and the platform (OCP) configurations for software flaws and improper configurations according to different compliance benchmarks. Compliance Operator allows its scans to be scheduled periodically using the ScanSetting Custom Resource.",
      "id": "xccdf_org.ssgproject.content_rule_scansettings_have_schedule",
      "instructions": "Run the following command to retrieve the scansettingbindings in the system:\noc get -nopenshift-compliance scansettings -ojson |  jq -r '[.items[]] | map(.schedule != \"\" and .schedule != null)'\nIf all scansettings that are defined set the schedule attribute, the above\nfilter will return 'true'. Run the following jq query to identify the non-compliance\nscansettings objects:\noc get scansettings -ojson | jq -r '[.items[] | select(.schedule != \"\" and .schedule != null) | .metadata.name]'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "scansettings-have-schedule",
          "control.compliance.openshift.io/NIST-800-53": "SI-6(b)",
          "policies.open-cluster-management.io/controls": "SI-6(b)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scansettings-have-schedule",
        "namespace": "openshift-compliance",
        "resourceVersion": "77464",
        "uid": "5049e777-c56a-4a8d-a8d2-24c65a0cebf1"
      },
      "rationale": "Without periodical scanning and verification, security functions may not operate correctly and this failure may go unnoticed within the container platform.",
      "severity": "medium",
      "title": "Ensure that Compliance Operator scans are running periodically"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should not enable more capabilities than needed as this opens the door for malicious use. To disable the capabilities, the appropriate Security Context Constraints (SCCs) should set all capabilities as * or a list of capabilities in requiredDropCapabilities.",
      "id": "xccdf_org.ssgproject.content_rule_scc_drop_container_capabilities",
      "instructions": "Inspect each SCC returned from running the following command:\n$ oc get scc\nNext, examine the outputs of the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nFor any role/clusterrole that reference the\nsecuritycontextconstraints resource with the resourceNames\nof the SCCs that do not list any requiredDropCapabilities, examine the\nassociated rolebindings to account for the users that are bound to the role.\nReview each SCC and determine that all capabilities are either\ncompletely disabled as a list entry under requiredDropCapabilities,\nor that all the un-required capabilities are dropped for containers and SCCs.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-4,ocp4-moderate-rev-4,ocp4-moderate,ocp4-cis-1-5,ocp4-pci-dss,ocp4-stig-v1r1,ocp4-cis,ocp4-high-rev-4,ocp4-stig,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-high",
          "compliance.openshift.io/rule": "scc-drop-container-capabilities",
          "control.compliance.openshift.io/CIS-OCP": "5.2.9",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.2.9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-drop-container-capabilities",
        "namespace": "openshift-compliance",
        "resourceVersion": "77466",
        "uid": "16f1598e-fd46-427f-93ed-c0d4f82164af"
      },
      "rationale": "By default, containers run with a default set of capabilities as assigned by the Container Runtime which can include dangerous or highly privileged capabilities. Capabilities should be dropped unless absolutely critical for the container to run software as added capabilities that are not required allow for malicious containers or attackers.",
      "severity": "medium",
      "title": "Drop Container Capabilities"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Containers should not enable more capabilites than needed as this opens the door for malicious use. To enable only the required capabilities, the appropriate Security Context Constraints (SCCs) should set capabilities as a list in allowedCapabilities.\n\nIn case an SCC outside the default allow list in the variable var-sccs-with-allowed-capabilities-regex is being flagged, create a TailoredProfile and add the additional SCC to the regular expression in the variable var-sccs-with-allowed-capabilities-regex. An example allowing an SCC named additional follows:\n\napiVersion: compliance.openshift.io/v1alpha1\nkind: TailoredProfile\nmetadata:\n name: cis-additional-scc\nspec:\n description: Allows an additional scc\n setValues:\n - name: upstream-ocp4-var-sccs-with-allowed-capabilities-regex\n   rationale: Allow our own custom SCC\n   value: ^privileged$|^hostnetwork-v2$|^restricted-v2$|^nonroot-v2$|^additional$\n extends: upstream-ocp4-cis\n title: Modified CIS allowing one more SCC\n\nFinally, reference this TailoredProfile in a ScanSettingBinding For more information on Tailoring the Compliance Operator, please consult the OpenShift documentation: https://docs.openshift.com/container-platform/4.12/security/compliance_operator/compliance-operator-tailor.html",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_container_allowed_capabilities",
      "instructions": "This rule checks the SCCs with allowedCapabilities set to non-null\nand fails if there are more such SCCs than those allowed in the variable\nnamed ocp4-var-sccs-with-allowed-capabilities-regex. To debug the rule,\ncheck the variable value, e.g:\n$ oc get variable ocp4-var-sccs-with-allowed-capabilities-regex  -ojsonpath='{.value}' \nThen use following command to list the SCCs that would fail the test:\n$ oc get scc -o json | jq '[.items[] | select(.metadata.name | test(\"^privileged$|^hostnetwork-v2$|^restricted-v2$|^nonroot-v2$\"; \"\") | not) | select(.allowedCapabilities != null) | .metadata.name]'\nPlease replace the regular expression in the test command with the value read from the variable\nocp4-var-sccs-with-allowed-capabilities-regex. You can read the variable\nvalue with:\n$ oc get variable ocp4-var-sccs-with-allowed-capabilities-regex -ojsonpath='{.value}' -n openshift-compliance",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-high,ocp4-cis-1-5,ocp4-stig-v1r1,ocp4-high-rev-4,ocp4-moderate,ocp4-stig,ocp4-e8,ocp4-cis-1-4,ocp4-cis,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "scc-limit-container-allowed-capabilities",
          "compliance.openshift.io/rule-variable": "var-sccs-with-allowed-capabilities-regex",
          "control.compliance.openshift.io/CIS-OCP": "5.2.8",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.2.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-container-allowed-capabilities",
        "namespace": "openshift-compliance",
        "resourceVersion": "77469",
        "uid": "3e512b10-81db-4ede-89e5-08f1b08b605d"
      },
      "rationale": "By default, containers run with a default set of capabilities as assigned by the Container Runtime which can include dangerous or highly privileged capabilities. Capabilities should be dropped unless absolutely critical for the container to run software as added capabilities that are not required allow for malicious containers or attackers.",
      "severity": "medium",
      "title": "Limit Container Capabilities"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should be allowed to use the hostPath volume type unless necessary. To prevent containers from using the host filesystem the appropriate Security Context Constraints (SCCs) should set allowHostDirVolumePlugin to false.",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_host_dir_volume_plugin",
      "instructions": "Inspect each SCC returned from running the following command:\n$ oc get scc\nReview each SCC for those that have allowHostDirVolumePlugin\nset to true.  Next, examine the outputs of the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nFor any role/clusterrole that reference the\nsecuritycontextconstraints resource with the resourceNames\nof the SCCs that have allowHostDirVolumePlugin, examine the associated\nrolebindings to account for the users that are bound to the role. Review the\naccount to determine if allowHostDirVolumePlugin is truly required.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-bsi,ocp4-stig-v1r1,ocp4-bsi-2022",
          "compliance.openshift.io/rule": "scc-limit-host-dir-volume-plugin",
          "control.compliance.openshift.io/CIS-OCP": "5.2.12",
          "control.compliance.openshift.io/NIST-800-53": "AC-6;AC-6(1)",
          "policies.open-cluster-management.io/controls": "AC-6,AC-6(1),5.2.12",
          "policies.open-cluster-management.io/standards": "NIST-800-53,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-host-dir-volume-plugin",
        "namespace": "openshift-compliance",
        "resourceVersion": "77472",
        "uid": "18fd04bf-26a3-46e6-a507-884a76274341"
      },
      "rationale": "hostPath volumes allow workloads to access the host filesystem from the workload. Access to the host filesystem can be used to escalate privileges and access resources such as keys or access tokens.",
      "severity": "medium",
      "title": "Limit Containers Ability to use the HostDir volume plugin"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should be limited to bind to non-privileged ports directly on the hosts. To prevent containers from binding to privileged ports on the host the appropriate Security Context Constraints (SCCs) should set allowHostPorts to false.",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_host_ports",
      "instructions": "Inspect each SCC returned from running the following command:\n$ oc get scc\nReview each SCC for those that have allowHostPorts set to true.\nNext, examine the outputs of the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nFor any role/clusterrole that reference the\nsecuritycontextconstraints resource with the resourceNames\nof the SCCs that have allowHostPorts, examine the associated\nrolebindings to account for the users that are bound to the role. Review the\naccount to determine if allowHostPorts is truly required.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "scc-limit-host-ports",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "policies.open-cluster-management.io/controls": "CM-6,CM-6(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-host-ports",
        "namespace": "openshift-compliance",
        "resourceVersion": "77475",
        "uid": "29f38ad3-1c75-4872-a130-3c48fc56aab8"
      },
      "rationale": "Privileged ports are those ports below 1024 and that require system privileges for their use. If containers are able to use these ports, the container must be run as a privileged user. The container platform must stop containers that try to map to these ports directly. Allowing non-privileged ports to be mapped to the container-privileged port is the allowable method when a certain port is needed. An example is mapping port 8080 externally to port 80 in the container.",
      "severity": "medium",
      "title": "Limit Containers Ability to bind to privileged ports"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should not be allowed access to the host's Interprocess Communication (IPC) namespace. To prevent containers from getting access to a host's IPC namespace, the appropriate Security Context Constraints (SCCs) should set allowHostIPC to false.",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_ipc_namespace",
      "instructions": "Inspect each SCC returned from running the following command:\n$ oc get scc\nReview each SCC for those that have allowHostIPC set to true.\nNext, examine the outputs of the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nFor any role/clusterrole that reference the\nsecuritycontextconstraints resource with the resourceNames\nof the SCCs that have allowHostIPC, examine the associated\nrolebindings to account for the users that are bound to the role. Review the\naccount to determine if allowHostIPC is truly required.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-bsi,ocp4-cis,ocp4-high,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-4,ocp4-pci-dss,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-moderate-rev-4,ocp4-bsi-2022,ocp4-high-rev-4,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "scc-limit-ipc-namespace",
          "control.compliance.openshift.io/CIS-OCP": "5.2.3",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.2.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-ipc-namespace",
        "namespace": "openshift-compliance",
        "resourceVersion": "77480",
        "uid": "bbbf5bcb-b8c1-4207-ba55-23bb1490ea4a"
      },
      "rationale": "A container running in the host's IPC namespace can use IPC to interact with processes outside the container potentially allowing an attacker to exploit a host process thereby enabling an attacker to exploit other services.",
      "severity": "medium",
      "title": "Limit Access to the Host IPC Namespace"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should not enable more capabilities than needed as this opens the door for malicious use. CAP_NET_RAW enables a container to launch a network attack on another container or cluster. To disable the CAP_NET_RAW capability, the appropriate Security Context Constraints (SCCs) should set NET_RAW in requiredDropCapabilities.",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_net_raw_capability",
      "instructions": "Inspect each SCC returned from running the following command:\n$ oc get scc\nReview each SCC for those that do not have NET_RAW or ALL set under requiredDropCapabilities.\nNext, examine the outputs of the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nFor any role/clusterrole that reference the\nsecuritycontextconstraints resource with the resourceNames\nof the SCCs that do not drop NET_RAW or ALL, examine the\nassociated rolebindings to account for the users that are bound to the role.\nReview each SCC and determine that either NET_RAW or ALL\nis either included as a list entry under requiredDropCapabilities,\nor that either NET_RAW or ALL is only enabled to a small\nset of containers and SCCs.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-stig,ocp4-bsi,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-high,ocp4-moderate-rev-4,ocp4-bsi-2022,ocp4-moderate,ocp4-high-rev-4,ocp4-pci-dss,ocp4-stig-v1r1,ocp4-cis",
          "compliance.openshift.io/rule": "scc-limit-net-raw-capability",
          "control.compliance.openshift.io/CIS-OCP": "5.2.7",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.2.7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-net-raw-capability",
        "namespace": "openshift-compliance",
        "resourceVersion": "77484",
        "uid": "a010bfcc-b1e5-4059-994d-bcb8a4ac11a8"
      },
      "rationale": "By default, containers run with a default set of capabilities as assigned by the Container Runtime which can include dangerous or highly privileged capabilities. If the CAP_NET_RAW is enabled, it may be misused by malicious containers or attackers.",
      "severity": "medium",
      "title": "Limit Use of the CAP_NET_RAW"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should not be allowed access to the host's network namespace. To prevent containers from getting access to a host's network namespace, the appropriate Security Context Constraints (SCCs) should set allowHostNetwork to false.",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_network_namespace",
      "instructions": "Inspect each SCC returned from running the following command:\n$ oc get scc\nReview each SCC for those that have allowHostNetwork set to true.\nNext, examine the outputs of the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nFor any role/clusterrole that reference the\nsecuritycontextconstraints resource with the resourceNames\nof the SCCs that have allowHostNetwork, examine the associated\nrolebindings to account for the users that are bound to the role. Review the\naccount to determine if allowHostNetwork is truly required.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-nerc-cip,ocp4-high,ocp4-bsi,ocp4-pci-dss,ocp4-bsi-2022,ocp4-moderate,ocp4-cis-1-4,ocp4-cis-1-5,ocp4-stig-v1r1,ocp4-cis,ocp4-stig,ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "scc-limit-network-namespace",
          "control.compliance.openshift.io/CIS-OCP": "5.2.4",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-network-namespace",
        "namespace": "openshift-compliance",
        "resourceVersion": "77488",
        "uid": "71f64739-42d0-4f21-8a3c-a774b502858e"
      },
      "rationale": "A container running in the host's network namespace could access the host network traffic to and from other pods potentially allowing an attacker to exploit pods and network traffic.",
      "severity": "medium",
      "title": "Limit Access to the Host Network Namespace"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should be limited to only the privileges required to run and should not be allowed to escalate their privileges. To prevent containers from escalating privileges, the appropriate Security Context Constraints (SCCs) should set allowPrivilegeEscalation to false.",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_privilege_escalation",
      "instructions": "Inspect each SCC returned from running the following command:\n$ oc get scc\nReview each SCC for those that have allowPrivilegeEscalation set to true.\nNext, examine the outputs of the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nFor any role/clusterrole that reference the\nsecuritycontextconstraints resource with the resourceNames\nof the SCCs that have allowPrivilegeEscalation, examine the associated\nrolebindings to account for the users that are bound to the role. Review the\naccount to determine if allowPrivilegeEscalation is truly required.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-e8,ocp4-cis,ocp4-stig,ocp4-cis-1-5,ocp4-nerc-cip,ocp4-high,ocp4-moderate-rev-4,ocp4-cis-1-4,ocp4-pci-dss,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate",
          "compliance.openshift.io/rule": "scc-limit-privilege-escalation",
          "control.compliance.openshift.io/CIS-OCP": "5.2.5",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-privilege-escalation",
        "namespace": "openshift-compliance",
        "resourceVersion": "77491",
        "uid": "d18cff9c-57ff-4c58-b5ce-4ca744699dfc"
      },
      "rationale": "Privileged containers have access to more of the Linux Kernel capabilities and devices. If a privileged container were compromised, an attacker would have full access to the container and host.",
      "severity": "medium",
      "title": "Limit Containers Ability to Escalate Privileges"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should be limited to only the privileges required to run. To prevent containers from running as privileged containers, the appropriate Security Context Constraints (SCCs) should set allowPrivilegedContainer to false.",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_privileged_containers",
      "instructions": "Inspect each SCC and the users and groups allowed to use it returned\nfrom running the following command:\noc get scc -ojson | jq '.items[]|select(.allowPrivilegedContainer)|.metadata.name,{\"Group:\":.groups},{\"User\":.users}'\n\nThe group \"system:authenticated\" is the default group for any\nauthenticated user, this group should only be associated with the\nrestricted profile. If this group is listed under any other SCC Policy,\nor the restricted SCC policy has been altered to allow any of the\nnon-permitted actions, this is a finding.\n\nNext, determine if there are any cluster roles or local roles that allow\nthe use of use of non-permitted SCC policies.  The following commands will\nprint the Role's name and namespace, followed by a list of resource names\nand if that resource is an SCC.\n\n> oc get clusterrole.rbac -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == (\"security.openshift.io\")) and (.resources[]? == (\"securitycontextconstraints\")) and (.verbs[]? == (\"use\"))))|.metadata.name,{\"scc\":(.rules[]?|select((.resources[]? == (\"securitycontextconstraints\"))).resourceNames[]?)}'\n\n> oc get role.rbac --all-namespaces -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == (\"security.openshift.io\")) and (.resources[]? == (\"securitycontextconstraints\")) and (.verbs[]? == (\"use\"))))|.metadata.name,{\"scc\":(.rules[]?|select((.resources[]? == (\"securitycontextconstraints\"))).resourceNames[]?)}'\n\nExcluding platform specific roles, identify any roles that allow use of non-permitted SCC policies for example the follow output shows that the role 'examplePrivilegedRole' allows use of the 'privileged' SCC.\n\n\nexamplePrivilegedRole\n{\n  \"scc\": \"privileged\"\n}\n\n\nFinally, determine if there are any role bindings to cluster or local\nroles that allow use of non-permitted SCCs.\n\n> oc get clusterrolebinding.rbac -ojson | jq -r '.items[]|select(.roleRef.kind == (\"ClusterRole\",\"Role\") and .roleRef.name == (\"[CLUSTER_ROLE_LIST]\"))|{ \"crb\": .metadata.name, \"roleRef\": .roleRef, \"subjects\": .subjects}'\n> oc get rolebinding.rbac --all-namespaces -ojson | jq -r '.items[]|select(.roleRef.kind == (\"ClusterRole\",\"Role\") and .roleRef.name == (\"[LOCAL_ROLE_LIST]\"))|{ \"crb\": .metadata.name, \"roleRef\": .roleRef, \"subjects\": .subjects}'\n\nWhere \"[CLUSTER_ROLE_LIST]\" and \"[LOCAL_ROLE_LIST]\" are\ncomma-separated lists of the roles allowing use of non-permitted SCC\npolicies as identified above. For example:\n\n\n... .roleRef.name == (\"system:openshift:scc:privileged\",\"system:openshift:scc:hostnetwork\",\"system:openshift:scc:hostaccess\") ...\n\n\nExcluding any platform namespaces (kube-*,openshift-*), if there are any rolebindings to roles that are not permitted, this is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-cis-1-5,ocp4-cis-1-4,ocp4-bsi-2022,ocp4-pci-dss-3-2,ocp4-stig,ocp4-bsi,ocp4-moderate-rev-4,ocp4-nerc-cip,ocp4-high,ocp4-cis,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-e8,ocp4-pci-dss",
          "compliance.openshift.io/rule": "scc-limit-privileged-containers",
          "control.compliance.openshift.io/CIS-OCP": "5.2.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.2.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-privileged-containers",
        "namespace": "openshift-compliance",
        "resourceVersion": "77496",
        "uid": "e4fc213f-a348-4491-be27-10f148ff02ff"
      },
      "rationale": "Privileged containers have access to all Linux Kernel capabilities and devices. If a privileged container were compromised, an attacker would have full access to the container and host.",
      "severity": "medium",
      "title": "Limit Privileged Container Use"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should not be allowed access to the host's process ID namespace. To prevent containers from getting access to a host's process ID namespace, the appropriate Security Context Constraints (SCCs) should set allowHostPID to false.",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_process_id_namespace",
      "instructions": "Inspect each SCC returned from running the following command:\n$ oc get scc\nReview each SCC for those that have allowHostPID set to true.\nNext, examine the outputs of the following commands:\n$ oc describe roles --all-namespaces\n$ oc describe clusterroles\nFor any role/clusterrole that reference the\nsecuritycontextconstraints resource with the resourceNames\nof the SCCs that have allowHostPID, examine the associated\nrolebindings to account for the users that are bound to the role. Review the\naccount to determine if allowHostPID is truly required.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-4,ocp4-bsi-2022,ocp4-cis,ocp4-cis-1-5,ocp4-high,ocp4-moderate-rev-4,ocp4-stig,ocp4-nerc-cip,ocp4-bsi,ocp4-pci-dss,ocp4-high-rev-4,ocp4-stig-v1r1",
          "compliance.openshift.io/rule": "scc-limit-process-id-namespace",
          "control.compliance.openshift.io/CIS-OCP": "5.2.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-process-id-namespace",
        "namespace": "openshift-compliance",
        "resourceVersion": "77501",
        "uid": "f66cea46-0b6d-4729-88ee-5ce85dbb3c99"
      },
      "rationale": "A container running in the host's PID namespace can inspect processes running outside the container which can be used to escalate privileges outside of the container.",
      "severity": "medium",
      "title": "Limit Access to the Host Process ID Namespace"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Containers should run as a random non-privileged user. To prevent containers from running as root user, the appropriate Security Context Constraints (SCCs) should set.runAsUser.type to MustRunAsRange.",
      "id": "xccdf_org.ssgproject.content_rule_scc_limit_root_containers",
      "instructions": "Inspect each SCC and the users and groups allowed to use it returned\nfrom running the following command:\noc get scc -ojson | jq '.items[]|select(.runAsUser.type != \"MustRunAsRange\" )|.metadata.name,{\"Group:\":.groups},{\"User\":.users}'\n\nThe group \"system:authenticated\" is the default group for any\nauthenticated user, this group should only be associated with the\nrestricted profile. If this group is listed under any other SCC Policy,\nor the restricted SCC policy has been altered to allow any of the\nnon-permitted actions, this is a finding.\n\nNext, determine if there are any cluster roles or local roles that allow\nthe use of use of non-permitted SCC policies.  The following commands will\nprint the Role's name and namespace, followed by a list of resource names\nand if that resource is an SCC.\n\n> oc get clusterrole.rbac -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == (\"security.openshift.io\")) and (.resources[]? == (\"securitycontextconstraints\")) and (.verbs[]? == (\"use\"))))|.metadata.name,{\"scc\":(.rules[]?|select((.resources[]? == (\"securitycontextconstraints\"))).resourceNames[]?)}'\n\n> oc get role.rbac --all-namespaces -ojson | jq -r '.items[]|select(.rules[]?|select( (.apiGroups[]? == (\"security.openshift.io\")) and (.resources[]? == (\"securitycontextconstraints\")) and (.verbs[]? == (\"use\"))))|.metadata.name,{\"scc\":(.rules[]?|select((.resources[]? == (\"securitycontextconstraints\"))).resourceNames[]?)}'\n\nExcluding platform specific roles, identify any roles that allow use of non-permitted SCC policies for example the follow output shows that the role 'examplePrivilegedRole' allows use of the 'privileged' SCC.\n\n\nexamplePrivilegedRole\n{\n  \"scc\": \"privileged\"\n}\n\n\nFinally, determine if there are any role bindings to cluster or local\nroles that allow use of non-permitted SCCs.\n\n> oc get clusterrolebinding.rbac -ojson | jq -r '.items[]|select(.roleRef.kind == (\"ClusterRole\",\"Role\") and .roleRef.name == (\"[CLUSTER_ROLE_LIST]\"))|{ \"crb\": .metadata.name, \"roleRef\": .roleRef, \"subjects\": .subjects}'\n> oc get rolebinding.rbac --all-namespaces -ojson | jq -r '.items[]|select(.roleRef.kind == (\"ClusterRole\",\"Role\") and .roleRef.name == (\"[LOCAL_ROLE_LIST]\"))|{ \"crb\": .metadata.name, \"roleRef\": .roleRef, \"subjects\": .subjects}'\n\nWhere \"[CLUSTER_ROLE_LIST]\" and \"[LOCAL_ROLE_LIST]\" are\ncomma-separated lists of the roles allowing use of non-permitted SCC\npolicies as identified above. For example:\n\n\n... .roleRef.name == (\"system:openshift:scc:privileged\",\"system:openshift:scc:hostnetwork\",\"system:openshift:scc:hostaccess\") ...\n\n\nExcluding any platform namespaces (kube-*,openshift-*), if there are any rolebindings to roles that are not permitted, this is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high-rev-4,ocp4-pci-dss-3-2,ocp4-e8,ocp4-stig-v1r1,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-high,ocp4-pci-dss,ocp4-cis-1-4,ocp4-cis,ocp4-bsi-2022,ocp4-stig,ocp4-bsi,ocp4-moderate-rev-4,ocp4-moderate",
          "compliance.openshift.io/rule": "scc-limit-root-containers",
          "control.compliance.openshift.io/CIS-OCP": "5.2.6",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.2.6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scc-limit-root-containers",
        "namespace": "openshift-compliance",
        "resourceVersion": "77502",
        "uid": "c5726ac7-a92e-44c6-a39c-3ff5f89462a9"
      },
      "rationale": "It is strongly recommended that containers running on OpenShift should support running as any arbitrary UID. OpenShift will then assign a random, non-privileged UID to the running container instance. This avoids the risk from containers running with specific uids that could map to host service accounts, or an even greater risk of running as root level service. OpenShift uses the default security context constraints (SCC), restricted, to prevent containers from running as root or other privileged user ids. Pods may be configured to use an scc policy that allows the container to run as a specific uid, including root(0) when approved. Only a cluster administrator may grant the change of an scc policy.",
      "severity": "medium",
      "title": "Limit Container Running As Root User"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface.",
      "id": "xccdf_org.ssgproject.content_rule_scheduler_no_bind_address",
      "instructions": "Run the following command:\noc get -nopenshift-kube-scheduler cm kube-scheduler-pod -ojson | jq -r '.data[\"pod.yaml\"]' | jq -r | grep bind-address\nThe output should be empty",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "scheduler-no-bind-address",
          "control.compliance.openshift.io/CIS-OCP": "1.4.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R5.1;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1);SC-8;SC-8(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R5.1,CIP-007-3 R6.1,CM-6,CM-6(1),SC-8,SC-8(1),Req-2.2,1.4.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scheduler-no-bind-address",
        "namespace": "openshift-compliance",
        "resourceVersion": "77505",
        "uid": "7d5759df-4eab-4eda-a2a4-6ec3941e0b75"
      },
      "rationale": "In OpenShift 4, The Kubernetes Scheduler operator manages and updates the Kubernetes Scheduler deployed on top of OpenShift. By default, the operator exposes metrics via metrics service. The metrics are collected from the Kubernetes Scheduler operator. Profiling data is sent to healthzPort, the port of the localhost healthz endpoint. Changing this value may disrupt components that monitor the kubelet health.",
      "severity": "medium",
      "title": "Ensure that the bind-address parameter is not used"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "The Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface.",
      "id": "xccdf_org.ssgproject.content_rule_scheduler_port_is_zero",
      "instructions": "Run the following command:\noc get -nopenshift-kube-scheduler cm kube-scheduler-pod -ojson | jq -r '.data[\"pod.yaml\"]' | jq -r '.spec.containers[] | select(.name == \"kube-scheduler\")' | jq -r '.args' | grep \\\\-\\\\-port\nThe output should return --port=0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/rule": "scheduler-port-is-zero",
          "control.compliance.openshift.io/CIS-OCP": "1.4.2",
          "policies.open-cluster-management.io/controls": "1.4.2",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scheduler-port-is-zero",
        "namespace": "openshift-compliance",
        "resourceVersion": "77506",
        "uid": "5e946dae-c01c-4bbf-8286-773e1afe2807"
      },
      "rationale": "In OpenShift 4, The Kubernetes Scheduler operator manages and updates the Kubernetes Scheduler deployed on top of OpenShift. By default, the operator exposes metrics via metrics service. The metrics are collected from the Kubernetes Scheduler operator. Profiling data is sent to healthzPort, the port of the localhost healthz endpoint. Changing this value may disrupt components that monitor the kubelet health.",
      "severity": "medium",
      "title": "Ensure that the port parameter is zero"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Do not bind the scheduler service to non-loopback insecure addresses.",
      "id": "xccdf_org.ssgproject.content_rule_scheduler_profiling_protected_by_rbac",
      "instructions": "In OpenShift 4, The Kubernetes Scheduler operator manages and updates the Kubernetes Scheduler deployed on top of OpenShift. By default, the operator exposes metrics via metrics service. The metrics are collected from the Kubernetes Scheduler operator. Profiling data is sent to `healthzPort`, the port of the localhost `healthz` endpoint. Changing this value may disrupt components that monitor the kubelet health. The default `healthz` `port` value is `10251`, and the `healthz` `bindAddress` is `127.0.0.1`\n\nTo ensure the collected data is not exploited, profiling endpoints are secured via RBAC (see cluster-debugger role). By default, the profiling endpoints are accessible only by users bound to `cluster-admin` or `cluster-debugger` role. Profiling can not be disabled.\n\nThe bind-address argument is not used. Both authentication and authorization are in place.\n\nRun the following command to verify the schedule endpoints:\n\n```\noc -n openshift-kube-scheduler describe endpoints\n```\n\nVerify the `bind-address` and `port` arguments are not used:\n\n```\noc -n openshift-kube-scheduler get cm kube-scheduler-pod -o json | jq -r '.data.\"pod.yaml\"' | jq '.spec.containers[]|select(.name==\"kube-scheduler\")|.args'\n```\n\nVerify the metrics endpoint is protected by RBAC.\n\nFirst, find the schedule pod information:\n\n```\noc project openshift-kube-scheduler\nexport POD=$(oc get pods -l app=openshift-kube-scheduler -o jsonpath='{.items[0].metadata.name}')\nexport POD_IP=$(oc get pods -l app=openshift-kube-scheduler -o jsonpath='{.items[0].status.podIP}')\nexport PORT=$(oc get pod $POD -o jsonpath='{.spec.containers[0].livenessProbe.httpGet.port}')\n```\n\nAttempt to make an insecure `GET` request to the metrics endpoint:\n\n```\noc rsh $POD curl https://$POD_IP:$PORT/metrics -k\n```\n\nEnsure an `HTTP 403` is returned.\n\nCreate a test service account:\n\n```\noc create sa permission-test-sa\n```\n\nGenerate a service account token and attempt to access the metrics endpoint:\n\n```\nexport SA_TOKEN=$(oc create token permission-test-sa)\noc rsh $POD curl https://$POD_IP:$PORT/metrics -H \"Authorization: Bearer $SA_TOKEN\" -k\n```\n\nVerify that an `HTTP 403` is returned.\n\nLogin as a cluster administrator and attempt to access the metrics endpoint:\n\n```\nexport CLUSTER_ADMIN_TOKEN=$(oc whoami -t)\noc rsh $POD curl https://$POD_IP:$PORT/metrics -H \"Authorization: Bearer $CLUSTER_ADMIN_TOKEN\" -k\n```\n\nVerify metrics output is returned. Unset environment variables used in the test and delete the test service account:\n\n```\nunset CLUSTER_ADMIN_TOKEN POD PORT SA_TOKEN POD_IP\noc delete sa permission-test-sa\n```",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-high,ocp4-high-rev-4,ocp4-cis,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-cis-1-4,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "scheduler-profiling-protected-by-rbac",
          "control.compliance.openshift.io/CIS-OCP": "1.4.1",
          "policies.open-cluster-management.io/controls": "1.4.1",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scheduler-profiling-protected-by-rbac",
        "namespace": "openshift-compliance",
        "resourceVersion": "77514",
        "uid": "e0c9404d-b096-47cd-a9f9-e8d81c5fbbe3"
      },
      "rationale": "The Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface",
      "severity": "medium",
      "title": "Verify that the scheduler API service is protected by RBAC"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Do not bind the scheduler service to non-loopback insecure addresses.",
      "id": "xccdf_org.ssgproject.content_rule_scheduler_service_protected_by_rbac",
      "instructions": "In OpenShift 4, The Kubernetes Scheduler operator manages and updates the Kubernetes Scheduler deployed on top of OpenShift. By default, the operator exposes metrics via metrics service. The metrics are collected from the Kubernetes Scheduler operator. Profiling data is sent to `healthzPort`, the port of the localhost `healthz` endpoint. Changing this value may disrupt components that monitor the kubelet health. The default `healthz` `port` value is `10251`, and the `healthz` `bindAddress` is `127.0.0.1`\n\nTo ensure the collected data is not exploited, profiling endpoints are secured via RBAC (see cluster-debugger role). By default, the profiling endpoints are accessible only by users bound to `cluster-admin` or `cluster-debugger` role. Profiling can not be disabled.\n\nThe bind-address argument is not used. Both authentication and authorization are in place.\n\nRun the following command to verify the schedule endpoints:\n\n```\noc -n openshift-kube-scheduler describe endpoints\n```\n\nVerify the `bind-address` and `port` arguments are not used:\n\n```\noc -n openshift-kube-scheduler get cm kube-scheduler-pod -o json | jq -r '.data.\"pod.yaml\"' | jq '.spec.containers[]|select(.name==\"kube-scheduler\")|.args'\n```\n\nVerify the metrics endpoint is protected by RBAC.\n\nFirst, find the schedule pod information:\n\n```\noc project openshift-kube-scheduler\nexport POD=$(oc get pods -l app=openshift-kube-scheduler -o jsonpath='{.items[0].metadata.name}')\nexport POD_IP=$(oc get pods -l app=openshift-kube-scheduler -o jsonpath='{.items[0].status.podIP}')\nexport PORT=$(oc get pod $POD -o jsonpath='{.spec.containers[0].livenessProbe.httpGet.port}')\n```\n\nAttempt to make an insecure `GET` request to the metrics endpoint:\n\n```\noc rsh $POD curl https://$POD_IP:$PORT/metrics -k\n```\n\nEnsure an `HTTP 403` is returned.\n\nCreate a test service account:\n\n```\noc create sa permission-test-sa\n```\n\nGenerate a service account token and attempt to access the metrics endpoint:\n\n```\nexport SA_TOKEN=$(oc create token permission-test-sa)\noc rsh $POD curl https://$POD_IP:$PORT/metrics -H \"Authorization: Bearer $SA_TOKEN\" -k\n```\n\nVerify that an `HTTP 403` is returned.\n\nLogin as a cluster administrator and attempt to access the metrics endpoint:\n\n```\nexport CLUSTER_ADMIN_TOKEN=$(oc whoami -t)\noc rsh $POD curl https://$POD_IP:$PORT/metrics -H \"Authorization: Bearer $CLUSTER_ADMIN_TOKEN\" -k\n```\n\nVerify metrics output is returned. Unset environment variables used in the test and delete the test service account:\n\n```\nunset CLUSTER_ADMIN_TOKEN POD PORT SA_TOKEN POD_IP\noc delete sa permission-test-sa\n```",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-high-rev-4,ocp4-cis,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-pci-dss,ocp4-cis-1-4,ocp4-high,ocp4-moderate,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "scheduler-service-protected-by-rbac",
          "control.compliance.openshift.io/CIS-OCP": "1.4.2",
          "policies.open-cluster-management.io/controls": "1.4.2",
          "policies.open-cluster-management.io/standards": "CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-scheduler-service-protected-by-rbac",
        "namespace": "openshift-compliance",
        "resourceVersion": "77516",
        "uid": "7d487be0-efbd-4481-94d5-497ba8e2b660"
      },
      "rationale": "The Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface",
      "severity": "medium",
      "title": "Verify that the scheduler API service is protected by RBAC"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Consider the use of an external secrets storage and management system, instead of using Kubernetes Secrets directly, if you have more complex secret management needs. Ensure the solution requires authentication to access secrets, has auditing of access to and use of secrets, and encrypts secrets. Some solutions also make it easier to rotate secrets.",
      "id": "xccdf_org.ssgproject.content_rule_secrets_consider_external_storage",
      "instructions": "Review the cluster configuration and determine if an appropriate secrets\nmanager has been configured.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-high,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-pci-dss,ocp4-moderate-rev-4,ocp4-cis,ocp4-stig,ocp4-cis-1-5",
          "compliance.openshift.io/rule": "secrets-consider-external-storage",
          "control.compliance.openshift.io/CIS-OCP": "5.4.2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.4.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-secrets-consider-external-storage",
        "namespace": "openshift-compliance",
        "resourceVersion": "77522",
        "uid": "d0cb148d-c956-48d2-904a-71930ac760ae"
      },
      "rationale": "Kubernetes supports secrets as first-class objects, but care needs to be taken to ensure that access to secrets is carefully limited. Using an external secrets provider can ease the management of access to secrets, especially where secrets are used across both Kubernetes and non-Kubernetes environments.",
      "severity": "medium",
      "title": "Consider external secret storage"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Secrets should be mounted as data volumes instead of environment variables.",
      "id": "xccdf_org.ssgproject.content_rule_secrets_no_environment_variables",
      "instructions": "To find workloads that use environment variables for secrets, run the following:\n$ oc get all -o jsonpath='{range .items[?(@..secretKeyRef)]} {.kind} {.metadata.namespace} {.metadata.name} {\"\\n\"}{end}' -A\nReview the output and ensure that workloads that can mount secrets as data\nvolumes use that instead of environment variables.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-stig,ocp4-nerc-cip,ocp4-cis-1-5,ocp4-moderate-rev-4,ocp4-moderate,ocp4-pci-dss-3-2,ocp4-pci-dss,ocp4-cis-1-4,ocp4-cis,ocp4-high-rev-4,ocp4-stig-v1r1,ocp4-high",
          "compliance.openshift.io/rule": "secrets-no-environment-variables",
          "control.compliance.openshift.io/CIS-OCP": "5.4.1",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6;CIP-004-6 R3;CIP-007-3 R6.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;CM-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CIP-004-6 R3,CIP-007-3 R6.1,CM-6,CM-6(1),Req-2.2,5.4.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS,CIS-OCP"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-secrets-no-environment-variables",
        "namespace": "openshift-compliance",
        "resourceVersion": "77521",
        "uid": "f5eebe3b-07fe-4dd1-bbe6-5515bccefd82"
      },
      "rationale": "Environment variables are subject and very susceptible to malicious hijacking methods by an adversary, as such, environment variables should never be used for secrets.",
      "severity": "medium",
      "title": "Do Not Use Environment Variables with Secrets"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "OpenShift StorageClasses can be configured to enable EBS encryption on EBS volumes that are used later as persistent volumes. By using EBS encryption, disk contents are encrypted using an AWS KMS key.",
      "id": "xccdf_org.ssgproject.content_rule_storageclass_encryption_enabled",
      "instructions": "Run the following command to retrieve if the EBS encryption is enabled:\n$ oc get storageclass -o json | jq \nMake sure that the result is an array of 'true' values.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-pci-dss",
          "compliance.openshift.io/rule": "storageclass-encryption-enabled",
          "control.compliance.openshift.io/PCI-DSS": "Req-3.4.1",
          "policies.open-cluster-management.io/controls": "Req-3.4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-storageclass-encryption-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76226",
        "uid": "87d60e12-b3f6-4402-a575-c1c8be000cee"
      },
      "rationale": "Enabling encryption on EBS storage used as PersistentVolumes help protect any card holder data that might be persisted on those EBS volumes. Only authorized AWS resources will be able, through IAM policies, to use the KMS key to eventually read or alter data on those volumes.",
      "severity": "high",
      "title": "Ensure that EBS volumes declared in storageclasses are encrypted"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Verify tls version for the openshift APIServer.",
      "id": "xccdf_org.ssgproject.content_rule_tls_version_check_apiserver",
      "instructions": "Run the following command to check for TLS version:\n$ oc get configmap config  -n openshift-apiserver -o json | grep -o VersionTLS[0-9]*\nMake sure that the result has a value of VersionTLSXX where XX is 12 or greater.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss,ocp4-pci-dss-3-2",
          "compliance.openshift.io/rule": "tls-version-check-apiserver",
          "control.compliance.openshift.io/PCI-DSS": "Req-4.1",
          "policies.open-cluster-management.io/controls": "Req-4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-tls-version-check-apiserver",
        "namespace": "openshift-compliance",
        "resourceVersion": "76668",
        "uid": "5f71f729-ca81-4709-abd8-c7072c1c73e2"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "medium",
      "title": "Ensure TLS v1.2 is minimum for Openshift APIServer"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that the Kubelet is configured to only use strong cryptographic ciphers. To set the cipher suites for the kubelet, create new or modify existing KubeletConfig object along these lines, one for every MachineConfigPool :\n\napiVersion: machineconfiguration.openshift.io/v1\n kind: KubeletConfig\n metadata:\n    name: kubelet-config-$pool\n spec:\n     machineConfigPoolSelector:\n         matchLabels:\n             pools.operator.machineconfiguration.openshift.io/$pool_name: \"\"\n     kubeletConfig:\n       tlsMinVersion: VersionTLS12",
      "id": "xccdf_org.ssgproject.content_rule_tls_version_check_masters_workers",
      "instructions": "Run the following command to check the TLS version used on master and worker nodes:\n$ sudo grep -oE VersionTLS1[2-9]{1} /etc/kubernetes/kubelet.conf \nMake sure that the result has a value of VersionTLSXX where XX is 12 or greater.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-node,ocp4-pci-dss-node-3-2",
          "compliance.openshift.io/rule": "tls-version-check-masters-workers",
          "control.compliance.openshift.io/PCI-DSS": "Req-4.1",
          "policies.open-cluster-management.io/controls": "Req-4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-tls-version-check-masters-workers",
        "namespace": "openshift-compliance",
        "resourceVersion": "76671",
        "uid": "c07778f6-d519-43e3-b83e-f2d6ee206d07"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "medium",
      "title": "Ensure TLS v1.2 is minimum for Openshift master and worker nodes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Platform",
      "description": "Verify tls version for the Openshift Router.",
      "id": "xccdf_org.ssgproject.content_rule_tls_version_check_router",
      "instructions": "Run the following command to check the TLS version for the openshift router:\n$  oc get deployment.apps/router-default -n openshift-ingress -o jsonpath='{.spec.template.spec.containers[0].env[?(@.name==\"SSL_MIN_VERSION\")].value}'\nMake sure that the result has a one of TLSvX.X where X.X is 1.2 or greater.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-pci-dss-3-2,ocp4-pci-dss",
          "compliance.openshift.io/rule": "tls-version-check-router",
          "control.compliance.openshift.io/PCI-DSS": "Req-4.1",
          "policies.open-cluster-management.io/controls": "Req-4.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-tls-version-check-router",
        "namespace": "openshift-compliance",
        "resourceVersion": "76675",
        "uid": "80f4e625-6413-4fee-96af-51868b600982"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "medium",
      "title": "Ensure TLS v1.2 is minimum for Openshift Router"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "no description",
      "id": "xccdf_org.ssgproject.content_rule_version_detect_in_hypershift",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/hide-tag": "true",
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-moderate-rev-4,ocp4-cis,ocp4-stig,ocp4-nerc-cip,ocp4-pci-dss-3-2,ocp4-cis-1-5,ocp4-cis-1-4,ocp4-pci-dss,ocp4-high-rev-4,ocp4-moderate,ocp4-stig-v1r1,ocp4-e8,ocp4-high,ocp4-bsi-2022,ocp4-bsi",
          "compliance.openshift.io/rule": "version-detect-in-hypershift"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-version-detect-in-hypershift",
        "namespace": "openshift-compliance",
        "resourceVersion": "76680",
        "uid": "c6a03466-c688-4ae5-a0cc-c45671d57a6e"
      },
      "rationale": "no rationale",
      "severity": "medium",
      "title": "This is a helper rule to fetch the required api resource for detecting HyperShift OCP version"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "no description",
      "id": "xccdf_org.ssgproject.content_rule_version_detect_in_ocp",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/hide-tag": "true",
          "compliance.openshift.io/image-digest": "pb-ocp4qx7xv",
          "compliance.openshift.io/profiles": "ocp4-e8,ocp4-bsi,ocp4-cis-1-5,ocp4-high,ocp4-pci-dss,ocp4-pci-dss-3-2,ocp4-bsi-2022,ocp4-stig,ocp4-stig-v1r1,ocp4-high-rev-4,ocp4-moderate,ocp4-nerc-cip,ocp4-cis-1-4,ocp4-cis,ocp4-moderate-rev-4",
          "compliance.openshift.io/rule": "version-detect-in-ocp"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "ocp4"
        },
        "name": "ocp4-version-detect-in-ocp",
        "namespace": "openshift-compliance",
        "resourceVersion": "76688",
        "uid": "fe7d5bd4-c9aa-4da3-b6c6-a715f97451c4"
      },
      "rationale": "no rationale",
      "severity": "medium",
      "title": "This is a helper rule to fetch the required api resource for detecting OCP version"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To specify the number of days after a password expires (which signifies inactivity) until an account is permanently disabled, add or correct the following line in /etc/default/useradd :\n\nINACTIVE= 35 \n\nIf a password is currently on the verge of expiration, then 35 day(s) remain(s) until the account is automatically disabled. However, if the password will not expire for another 60 days, then 60 days plus 35 day(s) could elapse until the account would be automatically disabled. See the useradd man page for more information.",
      "id": "xccdf_org.ssgproject.content_rule_account_disable_post_pw_expiration",
      "instructions": "To verify the INACTIVE setting, run the following command:\n$ grep \"INACTIVE\" /etc/default/useradd\nThe output should indicate the INACTIVE configuration option is set\nto an appropriate integer as shown in the example below:\n$ grep \"INACTIVE\" /etc/default/useradd\nINACTIVE=",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "account-disable-post-pw-expiration",
          "compliance.openshift.io/rule-variable": "var-account-disable-post-pw-expiration,var-account-disable-post-pw-expiration,var-account-disable-post-pw-expiration",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "IA-4(e);AC-2(3);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.1.4",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,IA-4(e),AC-2(3),CM-6(a),Req-8.1.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-account-disable-post-pw-expiration",
        "namespace": "openshift-compliance",
        "resourceVersion": "76890",
        "uid": "441cfc15-6a1b-4eeb-a44a-6179a21bd51b"
      },
      "rationale": "Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system. Disabling inactive accounts ensures that accounts which may not have been responsibly removed are not available to attackers who may have compromised their credentials. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.",
      "severity": "medium",
      "title": "Set Account Expiration Following Inactivity"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "PAM faillock locks an account due to excessive password failures, this event must be logged.",
      "id": "xccdf_org.ssgproject.content_rule_account_passwords_pam_faillock_audit",
      "instructions": "Verify the \"/etc/security/faillock.conf\" file is configured to log user name information when unsuccessful logon attempts occur:\n\n$ sudo grep audit /etc/security/faillock.conf\n\naudit",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "account-passwords-pam-faillock-audit",
          "control.compliance.openshift.io/NIST-800-53": "AC-7 (a)",
          "policies.open-cluster-management.io/controls": "AC-7 (a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-account-passwords-pam-faillock-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76811",
        "uid": "5e9538e0-6f56-4cd4-a387-ad56269d8fdc"
      },
      "rationale": "Without auditing of these events it may be harder or impossible to identify what an attacker did after an attack.",
      "severity": "medium",
      "title": "Account Lockouts Must Be Logged",
      "warning": "Without auditing of these events it may be harder or impossible to identify what an attacker did after an attack."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "By setting a `dir` in the faillock configuration account lockouts will persist across reboots.",
      "id": "xccdf_org.ssgproject.content_rule_account_passwords_pam_faillock_dir",
      "instructions": "Verify the \"/etc/security/faillock.conf\" file is configured use a non-default faillock directory to ensure contents persist after reboot:\n\n$ sudo grep 'dir =' /etc/security/faillock.conf\n\ndir = /var/log/faillock",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "account-passwords-pam-faillock-dir",
          "control.compliance.openshift.io/NIST-800-53": "AC-7 (ia)",
          "policies.open-cluster-management.io/controls": "AC-7 (ia)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-account-passwords-pam-faillock-dir",
        "namespace": "openshift-compliance",
        "resourceVersion": "76814",
        "uid": "a5212368-8c68-448b-b24a-e3d1c37c29d9"
      },
      "rationale": "Having lockouts persist across reboots ensures that account is only unlocked by an administrator. If the lockouts did not persist across reboots an attack could simply reboot the system to continue brute force attacks against the accounts on the system.",
      "severity": "medium",
      "title": "Account Lockouts Must Persist",
      "warning": "Having lockouts persist across reboots ensures that account is only unlocked by an administrator. If the lockouts did not persist across reboots an attack could simply reboot the system to continue brute force attacks against the accounts on the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure accounts on the system have unique names. To ensure all accounts have unique names, run the following command:\n\n$ sudo getent passwd | awk -F: '{ print $1}' | uniq -d\n\nIf a username is returned, change or delete the username.",
      "id": "xccdf_org.ssgproject.content_rule_account_unique_name",
      "instructions": "To verify all accounts have unique names, run the following command:\n$ sudo getent passwd | awk -F: '{ print $1}' | uniq -d\nNo output should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "account-unique-name",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.1.1",
          "policies.open-cluster-management.io/controls": "Req-8.1.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-account-unique-name",
        "namespace": "openshift-compliance",
        "resourceVersion": "76894",
        "uid": "d3b011cb-7be5-43c9-a03f-b2394dd5d9a0"
      },
      "rationale": "Unique usernames allow for accountability on the system.",
      "severity": "medium",
      "title": "Ensure All Accounts on the System Have Unique Names"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Implement an automated system for managing user accounts that minimizes the risk of errors, either intentional or deliberate. This system should integrate with an existing enterprise user management system, such as one based on Identity Management tools such as Active Directory, Kerberos, Directory Server, etc.",
      "id": "xccdf_org.ssgproject.content_rule_account_use_centralized_automated_auth",
      "instructions": "Verify that the system is integrated with a centralized authentication mechanism\nsuch as as Active Directory, Kerberos, Directory Server, etc. that has\nautomated account mechanisms in place.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "account-use-centralized-automated-auth"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-account-use-centralized-automated-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "76901",
        "uid": "bf59550a-8faa-4557-823a-ae5be9f8a4ed"
      },
      "rationale": "A comprehensive account management process that includes automation helps to ensure the accounts designated as requiring attention are consistently and promptly addressed. Enterprise environments make user account management challenging and complex. A user management process requiring administrators to manually address account management functions adds risk of potential oversight.",
      "severity": "medium",
      "title": "Use Centralized and Automated Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To ensure the logon failure delay controlled by /etc/login.defs is set properly, add or correct the FAIL_DELAY setting in /etc/login.defs to read as follows:\n\nFAIL_DELAY 4",
      "id": "xccdf_org.ssgproject.content_rule_accounts_logon_fail_delay",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 enforces a delay of at least  seconds between console logon prompts following a failed logon attempt with the following command:\n\n$ sudo grep -i \"FAIL_DELAY\" /etc/login.defs\nFAIL_DELAY",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-logon-fail-delay",
          "compliance.openshift.io/rule-variable": "var-accounts-fail-delay",
          "control.compliance.openshift.io/NIST-800-53": "AC-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-logon-fail-delay",
        "namespace": "openshift-compliance",
        "resourceVersion": "76991",
        "uid": "ac644412-3041-49cb-9424-9b5c04d7487b"
      },
      "rationale": "Increasing the time between a failed authentication attempt and re-prompting to enter credentials helps to slow a single-threaded brute force attack.",
      "severity": "medium",
      "title": "Ensure the Logon Failure Delay is Set Correctly in login.defs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Limiting the number of allowed users and sessions per user can limit risks related to Denial of Service attacks. This addresses concurrent sessions for a single account and does not address concurrent sessions by a single user via multiple accounts. To set the number of concurrent sessions per user add the following line in /etc/security/limits.conf or a file under /etc/security/limits.d/ :\n\n* hard maxlogins 1",
      "id": "xccdf_org.ssgproject.content_rule_accounts_max_concurrent_login_sessions",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 limits the number of concurrent sessions to\n\"\" for all\naccounts and/or account types with the following command:\n$ grep -r -s maxlogins /etc/security/limits.conf /etc/security/limits.d/*.conf\n/etc/security/limits.conf:* hard maxlogins 10\nThis can be set as a global domain (with the * wildcard) but may be set differently for multiple domains.\n      Is it the case that the \"maxlogins\" item is missing, commented out, or the value is set greater\nthan \"<sub idref=\"var_accounts_max_concurrent_login_sessions\" />\" and\nis not documented with the Information System Security Officer (ISSO) as an\noperational requirement for all domains that have the \"maxlogins\" item",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-max-concurrent-login-sessions",
          "compliance.openshift.io/rule-variable": "var-accounts-max-concurrent-login-sessions",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R5.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-10;CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R5.1,CIP-007-3 R5.1.2,AC-10,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-max-concurrent-login-sessions",
        "namespace": "openshift-compliance",
        "resourceVersion": "76993",
        "uid": "49fc413e-8c95-4d05-8ab7-0929b641eece"
      },
      "rationale": "Limiting simultaneous user logins can insulate the system from denial of service problems caused by excessive logins. Automated login processes operating improperly or maliciously may result in an exceptional number of simultaneous login sessions.",
      "severity": "low",
      "title": "Limit the Number of Concurrent Login Sessions Allowed Per User"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To specify password minimum age for new accounts, edit the file /etc/login.defs and add or correct the following line:\n\nPASS_MIN_DAYS 7 \n\nA value of 1 day is considered sufficient for many environments. The DoD requirement is 1. The profile requirement is 7.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_minimum_age_login_defs",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 enforces 24 hours/1 day as the minimum password lifetime for new user accounts.\n\nCheck for the value of \"PASS_MIN_DAYS\" in \"/etc/login.defs\" with the following command:\n\n$ grep -i pass_min_days /etc/login.defs\n\nPASS_MIN_DAYS",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-minimum-age-login-defs",
          "compliance.openshift.io/rule-variable": "var-accounts-minimum-age-login-defs,var-accounts-minimum-age-login-defs",
          "control.compliance.openshift.io/NIST-800-53": "IA-5(f);IA-5(1)(d);CM-6(a)",
          "policies.open-cluster-management.io/controls": "IA-5(f),IA-5(1)(d),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-minimum-age-login-defs",
        "namespace": "openshift-compliance",
        "resourceVersion": "76909",
        "uid": "a7a3d71d-d575-4100-9146-c7f37bc4fe71"
      },
      "rationale": "Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.\n\nSetting the minimum password age protects against users cycling back to a favorite password after satisfying the password reuse requirement.",
      "severity": "medium",
      "title": "Set Password Minimum Age"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "If any account other than root has a UID of 0, this misconfiguration should be investigated and the accounts other than root should be removed or have their UID changed.\n\nIf the account is associated with system commands or applications the UID should be changed to one greater than \"0\" but less than \"1000.\" Otherwise assign a UID greater than \"1000\" that has not already been assigned.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_no_uid_except_zero",
      "instructions": "Verify that only the \"root\" account has a UID \"0\" assignment with the\nfollowing command:\n$ awk -F: '$3 == 0 {print $1}' /etc/passwd\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-e8",
          "compliance.openshift.io/rule": "accounts-no-uid-except-zero",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "IA-2;AC-6(5);IA-4(b)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.5",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,IA-2,AC-6(5),IA-4(b),Req-8.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-no-uid-except-zero",
        "namespace": "openshift-compliance",
        "resourceVersion": "76963",
        "uid": "6e8d07f0-fff1-42b4-bbce-46cf06f2eab3"
      },
      "rationale": "An account has root authority if it has a UID of 0. Multiple accounts with a UID of 0 afford more opportunity for potential intruders to guess a password for a privileged account. Proper configuration of sudo is recommended to afford multiple system administrators access to root privileges in an accountable manner.",
      "severity": "high",
      "title": "Verify Only Root Has UID 0"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "If any password hashes are stored in /etc/passwd (in the second field, instead of an x or * ), the cause of this misconfiguration should be investigated. The account should have its password reset and the hash should be properly stored, or the account should be deleted entirely.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_password_all_shadowed",
      "instructions": "To check that no password hashes are stored in\n/etc/passwd, run the following command:\nawk '!/\\S:x|\\*/ {print}' /etc/passwd\nIf it produces any output, then a password hash is\nstored in /etc/passwd.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-password-all-shadowed",
          "control.compliance.openshift.io/NIST-800-53": "IA-5(h);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.2.1",
          "policies.open-cluster-management.io/controls": "IA-5(h),CM-6(a),Req-8.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-password-all-shadowed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76925",
        "uid": "cc57e3fb-7511-4f2f-8dd9-f0e3ead9f14b"
      },
      "rationale": "The hashes for all user account passwords should be stored in the file /etc/shadow and never in /etc/passwd , which is readable by all users.",
      "severity": "medium",
      "title": "Verify All Account Password Hashes are Shadowed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All users should have a password change date in the past.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_password_last_change_is_in_past",
      "instructions": "Verify that the interactive user account passwords last change time is not in the future\nThe following command should return no output\n$ sudo expiration=$(cat /etc/shadow|awk -F ':' '{print $3}');\nfor edate in ${expiration[@]}; do if [[ $edate > $(( $(date +%s)/86400 )) ]];\nthen echo \"Expiry date in future\";\nfi; done",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-password-last-change-is-in-past"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-password-last-change-is-in-past",
        "namespace": "openshift-compliance",
        "resourceVersion": "76929",
        "uid": "28cc21a1-7509-4623-94a5-a7220d87babe"
      },
      "rationale": "If a user recorded password change date is in the future then they could bypass any set password expiration.",
      "severity": "medium",
      "title": "Ensure all users last password change date is in the past",
      "warning": "If a user recorded password change date is in the future then they could bypass any set password expiration."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To specify password length requirements for new accounts, edit the file /etc/login.defs and add or correct the following line:\n\nPASS_MIN_LEN 15 \n\nThe DoD requirement is 15. The FISMA requirement is 12. The profile requirement is 15. If a program consults /etc/login.defs and also another PAM module (such as pam_pwquality ) during a password change operation, then the most restrictive must be satisfied. See PAM section for more information about enforcing password quality requirements.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_password_minlen_login_defs",
      "instructions": "To check the minimum password length, run the command:\n$ grep PASS_MIN_LEN /etc/login.defs\nThe DoD requirement is 15.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-minimal,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "accounts-password-minlen-login-defs",
          "compliance.openshift.io/rule-variable": "var-accounts-password-minlen-login-defs,var-accounts-password-minlen-login-defs",
          "control.compliance.openshift.io/NIST-800-53": "IA-5(f);IA-5(1)(a);CM-6(a)",
          "policies.open-cluster-management.io/controls": "IA-5(f),IA-5(1)(a),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-password-minlen-login-defs",
        "namespace": "openshift-compliance",
        "resourceVersion": "76916",
        "uid": "c32ea67f-02ba-4baa-805b-00f5be424bfe"
      },
      "rationale": "Requiring a minimum password length makes password cracking attacks more difficult by ensuring a larger search space. However, any security benefit from an onerous requirement must be carefully weighed against usability problems, support costs, or counterproductive behavior that may result.",
      "severity": "medium",
      "title": "Set Password Minimum Length in login.defs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The pam_pwquality module's minclass parameter controls requirements for usage of different character classes, or types, of character that must exist in a password before it is considered valid. For example, setting this value to three (3) requires that any password must have characters from at least three different categories in order to be approved. The default value is zero (0), meaning there are no required classes. There are four categories available:\n\n* Upper-case characters\n* Lower-case characters\n* Digits\n* Special characters (for example, punctuation)\n\nModify the minclass setting in /etc/security/pwquality.conf entry to require 3 differing categories of characters when changing passwords.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_minclass",
      "instructions": "Verify the value of the \"minclass\" option in \"/etc/security/pwquality.conf\" with the following command:\n\n$ grep minclass /etc/security/pwquality.conf\n\nminclass =",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-minimal,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "accounts-password-pam-minclass",
          "compliance.openshift.io/rule-variable": "var-password-pam-minclass",
          "control.compliance.openshift.io/NIST-800-53": "IA-5(c);IA-5(1)(a);CM-6(a);IA-5(4)",
          "policies.open-cluster-management.io/controls": "IA-5(c),IA-5(1)(a),CM-6(a),IA-5(4)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-password-pam-minclass",
        "namespace": "openshift-compliance",
        "resourceVersion": "76820",
        "uid": "fd8ab698-ee8e-4166-a3d3-c8619467104f"
      },
      "rationale": "Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nRequiring a minimum number of character categories makes password guessing attacks more difficult by ensuring a larger search space.",
      "severity": "medium",
      "title": "Ensure PAM Enforces Password Requirements - Minimum Different Categories"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To configure the number of retry prompts that are permitted per-session: Edit the pam_pwquality.so statement in /etc/pam.d/system-auth to show retry= 3 , or a lower value if site policy is more restrictive. The DoD requirement is a maximum of 3 prompts per session.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_retry",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 is configured to limit the \"pwquality\" retry option to .\n\n\nCheck for the use of the \"pwquality\" retry option in the PAM files with the following command:\n\n$ grep pam_pwquality /etc/pam.d/system-auth\n\n\npassword requisite pam_pwquality.so retry=",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-minimal,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "accounts-password-pam-retry",
          "compliance.openshift.io/rule-variable": "var-password-pam-retry",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-7(a);IA-5(4)",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-7(a),IA-5(4)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-password-pam-retry",
        "namespace": "openshift-compliance",
        "resourceVersion": "76822",
        "uid": "32e3d6b2-91d0-47cc-ba01-6fd606edd005"
      },
      "rationale": "Setting the password retry prompts that are permitted on a per-session basis to a low value requires some software, such as SSH, to re-connect. This can slow down and draw additional attention to some types of password-guessing attacks. Note that this is different from account lockout, which is provided by the pam_faillock module.",
      "severity": "medium",
      "title": "Ensure PAM Enforces Password Requirements - Authentication Retry Prompts Permitted Per-Session"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Configure the root account to enforce a 99999 -day maximum password lifetime restriction by running the following command:\n\n$ sudo chage -M 99999 root",
      "id": "xccdf_org.ssgproject.content_rule_accounts_password_set_max_life_root",
      "instructions": "Check whether the maximum time period for root account password is restricted to  days with the following commands:\n\n$ sudo awk -F: '$1 == \"root\" {print $1 \" \" $5}' /etc/shadow",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-minimal,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "accounts-password-set-max-life-root",
          "compliance.openshift.io/rule-variable": "var-accounts-maximum-age-root,var-accounts-maximum-age-root"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-password-set-max-life-root",
        "namespace": "openshift-compliance",
        "resourceVersion": "76917",
        "uid": "ed9b422e-bc1f-46c7-8abc-64efb56847a5"
      },
      "rationale": "Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.",
      "severity": "medium",
      "title": "Set Root Account Password Maximum Age"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To specify how many days prior to password expiration that a warning will be issued to users, edit the file /etc/login.defs and add or correct the following line:\n\nPASS_WARN_AGE 7 \n\nThe DoD requirement is 7. The profile requirement is 7.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_password_warn_age_login_defs",
      "instructions": "To check the password warning age, run the command:\n$ grep PASS_WARN_AGE /etc/login.defs\nThe DoD requirement is 7.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-password-warn-age-login-defs",
          "compliance.openshift.io/rule-variable": "var-accounts-password-warn-age-login-defs,var-accounts-password-warn-age-login-defs",
          "control.compliance.openshift.io/NIST-800-53": "IA-5(f);IA-5(1)(d);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.2.4",
          "policies.open-cluster-management.io/controls": "IA-5(f),IA-5(1)(d),CM-6(a),Req-8.2.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-password-warn-age-login-defs",
        "namespace": "openshift-compliance",
        "resourceVersion": "76921",
        "uid": "8a653773-aa63-4b9d-8494-85cadc9a8757"
      },
      "rationale": "Setting the password warning age enables users to make the change at a practical time.",
      "severity": "medium",
      "title": "Set Password Warning Age"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "PAM faillock locks an account due to excessive password failures, this event must be logged.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_audit",
      "instructions": "Verify the \"/etc/security/faillock.conf\" file is configured to log user name information when unsuccessful logon attempts occur:\n\n$ sudo grep audit /etc/security/faillock.conf\n\naudit",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-passwords-pam-faillock-audit",
          "control.compliance.openshift.io/NIST-800-53": "AC-7 (a)",
          "policies.open-cluster-management.io/controls": "AC-7 (a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-passwords-pam-faillock-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76816",
        "uid": "5537c36a-4c84-47a2-b09f-aa2c48252afb"
      },
      "rationale": "Without auditing of these events it may be harder or impossible to identify what an attacker did after an attack.",
      "severity": "medium",
      "title": "Account Lockouts Must Be Logged"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To configure polyinstantiated /tmp directories, first create the parent directories which will hold the polyinstantiation child directories. Use the following command:\n\n$ sudo mkdir --mode 000 /tmp/tmp-inst\n\nThen, add the following entry to /etc/security/namespace.conf :\n\n/tmp     /tmp/tmp-inst/            level      root,adm",
      "id": "xccdf_org.ssgproject.content_rule_accounts_polyinstantiated_tmp",
      "instructions": "Run the following command to ensure that /tmp is configured as a\npolyinstantiated directory:\n$ sudo grep /tmp /etc/security/namespace.conf\nThe output should return the following:\n/tmp     /tmp/tmp-inst/            level      root,adm",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "accounts-polyinstantiated-tmp"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-polyinstantiated-tmp",
        "namespace": "openshift-compliance",
        "resourceVersion": "77001",
        "uid": "ed661290-6fef-4980-8b2f-5b0c87251ef4"
      },
      "rationale": "Polyinstantiation of temporary directories is a proactive security measure which reduces chances of attacks that are made possible by /tmp directories being world-writable.",
      "severity": "low",
      "title": "Configure Polyinstantiation of /tmp Directories"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To configure polyinstantiated /tmp directories, first create the parent directories which will hold the polyinstantiation child directories. Use the following command:\n\n$ sudo mkdir --mode 000 /var/tmp/tmp-inst\n\nThen, add the following entry to /etc/security/namespace.conf :\n\n/var/tmp /var/tmp/tmp-inst/    level      root,adm",
      "id": "xccdf_org.ssgproject.content_rule_accounts_polyinstantiated_var_tmp",
      "instructions": "Run the following command to ensure that /var/tmp is configured as a\npolyinstantiated directory:\n$ sudo grep /var/tmp /etc/security/namespace.conf\nThe output should return the following:\n/var/tmp /var/tmp/tmp-inst/    level      root,adm",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "accounts-polyinstantiated-var-tmp"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-polyinstantiated-var-tmp",
        "namespace": "openshift-compliance",
        "resourceVersion": "77004",
        "uid": "9558160e-c07d-4837-976d-728375b58ab3"
      },
      "rationale": "Polyinstantiation of temporary directories is a proactive security measure which reduces chances of attacks that are made possible by /var/tmp directories being world-writable.",
      "severity": "low",
      "title": "Configure Polyinstantiation of /var/tmp Directories"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The root user should have a primary group of 0.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_root_gid_zero",
      "instructions": "To verify that root's primary group is zero run the following command:\n\n    grep '^root:' /etc/passwd | cut -d : -f 4\n\nThe command should return:\n\n0",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-root-gid-zero",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.1.1",
          "policies.open-cluster-management.io/controls": "Req-8.1.1",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-root-gid-zero",
        "namespace": "openshift-compliance",
        "resourceVersion": "76969",
        "uid": "1662a425-f6ab-4204-b54a-1a662ce74dff"
      },
      "rationale": "To help ensure that root-owned files are not inadvertently exposed to other users.",
      "severity": "high",
      "title": "Verify Root Has A Primary GID 0"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "For each element in root's path, run:\n\n# ls -ld DIR\n\nand ensure that write permissions are disabled for group and other.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_root_path_dirs_no_write",
      "instructions": "To ensure write permissions are disabled for group and other\n for each element in root's path, run the following command:\n# ls -ld DIR",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-root-path-dirs-no-write",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-root-path-dirs-no-write",
        "namespace": "openshift-compliance",
        "resourceVersion": "77033",
        "uid": "cd790a68-1d92-4191-976f-638a47a12ed2"
      },
      "rationale": "Such entries increase the risk that root could execute code provided by unprivileged users, and potentially malicious code.",
      "severity": "medium",
      "title": "Ensure that Root's Path Does Not Include World or Group-Writable Directories"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Setting the TMOUT option in /etc/profile ensures that all user sessions will terminate based on inactivity. The value of TMOUT should be exported and read only. The TMOUT setting in a file loaded by /etc/profile , e.g. /etc/profile.d/tmout.sh should read as follows:\n\ntypeset -xr TMOUT= 600 \n\nor\n\ndeclare -xr TMOUT= 600 \n\nUsing the typeset keyword is preferred for wider compatibility with ksh and other shells.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_tmout",
      "instructions": "Run the following command to ensure the TMOUT value is configured for all users\non the system:\n\n$ sudo grep TMOUT /etc/profile /etc/profile.d/*.sh\n\nThe output should return the following:\nTMOUT=",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "accounts-tmout",
          "compliance.openshift.io/rule-variable": "var-accounts-tmout,var-accounts-tmout",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-007-3 R5.1;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-12;SC-10;AC-2(5);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-007-3 R5.1,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-12,SC-10,AC-2(5),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-tmout",
        "namespace": "openshift-compliance",
        "resourceVersion": "77005",
        "uid": "0d2abc31-033f-45b1-b0d1-c7d7059da62b"
      },
      "rationale": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended.",
      "severity": "medium",
      "title": "Set Interactive Session Timeout"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%20/etc/bashrc%0A%0A%23%20System%20wide%20functions%20and%20aliases%0A%23%20Environment%20stuff%20goes%20in%20/etc/profile%0A%0A%23%20It%27s%20NOT%20a%20good%20idea%20to%20change%20this%20file%20unless%20you%20know%20what%20you%0A%23%20are%20doing.%20It%27s%20much%20better%20to%20create%20a%20custom.sh%20shell%20script%20in%0A%23%20/etc/profile.d/%20to%20make%20custom%20changes%20to%20your%20environment%2C%20as%20this%0A%23%20will%20prevent%20the%20need%20for%20merging%20in%20future%20updates.%0A%0A%23%20Prevent%20doublesourcing%0Aif%20%5B%20-z%20%22%24BASHRCSOURCED%22%20%5D%3B%20then%0A%20%20BASHRCSOURCED%3D%22Y%22%0A%0A%20%20%23%20are%20we%20an%20interactive%20shell%3F%0A%20%20if%20%5B%20%22%24PS1%22%20%5D%3B%20then%0A%20%20%20%20if%20%5B%20-z%20%22%24PROMPT_COMMAND%22%20%5D%3B%20then%0A%20%20%20%20%20%20case%20%24TERM%20in%0A%20%20%20%20%20%20xterm%2A%7Cvte%2A%29%0A%20%20%20%20%20%20%20%20if%20%5B%20-e%20/etc/sysconfig/bash-prompt-xterm%20%5D%3B%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20PROMPT_COMMAND%3D/etc/sysconfig/bash-prompt-xterm%0A%20%20%20%20%20%20%20%20elif%20%5B%20%22%24%7BVTE_VERSION%3A-0%7D%22%20-ge%203405%20%5D%3B%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20PROMPT_COMMAND%3D%22__vte_prompt_command%22%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20PROMPT_COMMAND%3D%27printf%20%22%5C033%5D0%3B%25s%40%25s%3A%25s%5C007%22%20%22%24%7BUSER%7D%22%20%22%24%7BHOSTNAME%25%25.%2A%7D%22%20%22%24%7BPWD/%23%24HOME/%5C~%7D%22%27%0A%20%20%20%20%20%20%20%20fi%0A%20%20%20%20%20%20%20%20%3B%3B%0A%20%20%20%20%20%20screen%2A%29%0A%20%20%20%20%20%20%20%20if%20%5B%20-e%20/etc/sysconfig/bash-prompt-screen%20%5D%3B%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20PROMPT_COMMAND%3D/etc/sysconfig/bash-prompt-screen%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20PROMPT_COMMAND%3D%27printf%20%22%5C033k%25s%40%25s%3A%25s%5C033%5C%5C%22%20%22%24%7BUSER%7D%22%20%22%24%7BHOSTNAME%25%25.%2A%7D%22%20%22%24%7BPWD/%23%24HOME/%5C~%7D%22%27%0A%20%20%20%20%20%20%20%20fi%0A%20%20%20%20%20%20%20%20%3B%3B%0A%20%20%20%20%20%20%2A%29%0A%20%20%20%20%20%20%20%20%5B%20-e%20/etc/sysconfig/bash-prompt-default%20%5D%20%26%26%20PROMPT_COMMAND%3D/etc/sysconfig/bash-prompt-default%0A%20%20%20%20%20%20%20%20%3B%3B%0A%20%20%20%20%20%20esac%0A%20%20%20%20fi%0A%20%20%20%20%23%20Turn%20on%20parallel%20history%0A%20%20%20%20shopt%20-s%20histappend%0A%20%20%20%20history%20-a%0A%20%20%20%20%23%20Turn%20on%20checkwinsize%0A%20%20%20%20shopt%20-s%20checkwinsize%0A%20%20%20%20%5B%20%22%24PS1%22%20%3D%20%22%5C%5Cs-%5C%5Cv%5C%5C%5C%24%20%22%20%5D%20%26%26%20PS1%3D%22%5B%5Cu%40%5Ch%20%5CW%5D%5C%5C%24%20%22%0A%20%20%20%20%23%20You%20might%20want%20to%20have%20e.g.%20tty%20in%20prompt%20%28e.g.%20more%20virtual%20machines%29%0A%20%20%20%20%23%20and%20console%20windows%0A%20%20%20%20%23%20If%20you%20want%20to%20do%20so%2C%20just%20add%20e.g.%0A%20%20%20%20%23%20if%20%5B%20%22%24PS1%22%20%5D%3B%20then%0A%20%20%20%20%23%20%20%20PS1%3D%22%5B%5Cu%40%5Ch%3A%5Cl%20%5CW%5D%5C%5C%24%20%22%0A%20%20%20%20%23%20fi%0A%20%20%20%20%23%20to%20your%20custom%20modification%20shell%20script%20in%20/etc/profile.d/%20directory%0A%20%20fi%0A%0A%20%20if%20%21%20shopt%20-q%20login_shell%20%3B%20then%20%23%20We%27re%20not%20a%20login%20shell%0A%20%20%20%20%23%20Need%20to%20redefine%20pathmunge%2C%20it%20gets%20undefined%20at%20the%20end%20of%20/etc/profile%0A%20%20%20%20pathmunge%20%28%29%20%7B%0A%20%20%20%20%20%20%20%20case%20%22%3A%24%7BPATH%7D%3A%22%20in%0A%20%20%20%20%20%20%20%20%20%20%20%20%2A%3A%22%241%22%3A%2A%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3B%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2A%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%5B%20%22%242%22%20%3D%20%22after%22%20%5D%20%3B%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20PATH%3D%24PATH%3A%241%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20PATH%3D%241%3A%24PATH%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fi%0A%20%20%20%20%20%20%20%20esac%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%20By%20default%2C%20we%20want%20umask%20to%20get%20set.%20This%20sets%20it%20for%20non-login%20shell.%0A%20%20%20%20%23%20Current%20threshold%20for%20system%20reserved%20uid/gids%20is%20200%0A%20%20%20%20%23%20You%20could%20check%20uidgid%20reservation%20validity%20in%0A%20%20%20%20%23%20/usr/share/doc/setup-%2A/uidgid%20file%0A%20%20%20%20if%20%5B%20%24UID%20-gt%20199%20%5D%20%26%26%20%5B%20%22%60id%20-gn%60%22%20%3D%20%22%60id%20-un%60%22%20%5D%3B%20then%0A%20%20%20%20%20%20%20umask%20027%0A%20%20%20%20else%0A%20%20%20%20%20%20%20umask%20027%0A%20%20%20%20fi%0A%0A%20%20%20%20SHELL%3D/bin/bash%0A%20%20%20%20%23%20Only%20display%20echos%20from%20profile.d%20scripts%20if%20we%20are%20no%20login%20shell%0A%20%20%20%20%23%20and%20interactive%20-%20otherwise%20just%20process%20them%20to%20set%20envvars%0A%20%20%20%20for%20i%20in%20/etc/profile.d/%2A.sh%3B%20do%0A%20%20%20%20%20%20%20%20if%20%5B%20-r%20%22%24i%22%20%5D%3B%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%5B%20%22%24PS1%22%20%5D%3B%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.%20%22%24i%22%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.%20%22%24i%22%20%3E/dev/null%0A%20%20%20%20%20%20%20%20%20%20%20%20fi%0A%20%20%20%20%20%20%20%20fi%0A%20%20%20%20done%0A%0A%20%20%20%20unset%20i%0A%20%20%20%20unset%20-f%20pathmunge%0A%20%20fi%0A%0Afi%0A%23%20vim%3Ats%3D4%3Asw%3D4%0A%0A%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/bashrc"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To ensure the default umask for users of the Bash shell is set properly, add or correct the umask setting in /etc/bashrc to read as follows:\n\numask 027",
      "id": "xccdf_org.ssgproject.content_rule_accounts_umask_etc_bashrc",
      "instructions": "Verify the umask setting is configured correctly in the /etc/bashrc file with the following command:\n\n$ sudo grep \"umask\" /etc/bashrc\n\numask",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "accounts-umask-etc-bashrc",
          "compliance.openshift.io/rule-variable": "var-accounts-user-umask",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-6(1);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-6(1),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-umask-etc-bashrc",
        "namespace": "openshift-compliance",
        "resourceVersion": "77055",
        "uid": "a3a1c471-6dec-483e-9a24-60b73c5b1351"
      },
      "rationale": "The umask value influences the permissions assigned to files when they are created. A misconfigured umask value could result in files with excessive permissions that can be read or written to by unauthorized users.",
      "severity": "medium",
      "title": "Ensure the Default Bash Umask is Set Correctly"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%20/etc/cshrc%0A%23%0A%23%20csh%20configuration%20for%20all%20shell%20invocations.%0A%0A%23%20By%20default%2C%20we%20want%20this%20to%20get%20set.%0A%23%20Even%20for%20non-interactive%2C%20non-login%20shells.%0A%23%20Current%20threshold%20for%20system%20reserved%20uid/gids%20is%20200%0A%23%20You%20could%20check%20uidgid%20reservation%20validity%20in%0A%23%20/usr/share/doc/setup-%2A/uidgid%20file%0Aif%20%28%24uid%20%3E%20199%20%26%26%20%22%60id%20-gn%60%22%20%3D%3D%20%22%60id%20-un%60%22%29%20then%0A%20%20%20%20umask%20027%0Aelse%0A%20%20%20%20umask%20027%0Aendif%0A%0Aif%20%28%24%3Fprompt%29%20then%0A%20%20if%20%28%24%3Ftcsh%29%20then%0A%20%20%20%20set%20promptchars%3D%27%24%23%27%0A%20%20%20%20set%20prompt%3D%27%5B%25n%40%25m%20%25c%5D%25%23%20%27%0A%20%20%20%20%23%20make%20completion%20work%20better%20by%20default%0A%20%20%20%20set%20autolist%0A%20%20else%0A%20%20%20%20set%20prompt%3D%5C%5B%24user%40%60hostname%20-s%60%5C%5D%5C%24%5C%20%0A%20%20endif%0Aendif%0A%0Aif%20%28%20%24%3Ftcsh%20%29%20then%0A%09bindkey%20%22%5E%5B%5B3~%22%20delete-char%0Aendif%0A%0Abindkey%20%22%5ER%22%20i-search-back%0Aset%20echo_style%20%3D%20both%0Aset%20histdup%20%3D%20erase%0Aset%20savehist%20%3D%20%281024%20merge%29%0A%0Aif%20%28%24%3Fprompt%29%20then%0A%20%20if%20%28%24%3FTERM%29%20then%0A%20%20%20%20switch%28%24TERM%29%0A%20%20%20%20%20%20case%20xterm%2A%3A%0A%20%20%20%20%20%20%20%20if%20%28%24%3Ftcsh%29%20then%0A%09%20%20set%20prompt%3D%27%25%7B%5C033%5D0%3B%25n%40%25m%3A%25c%5C007%25%7D%5B%25n%40%25m%20%25c%5D%25%23%20%27%0A%20%20%20%20%20%20%20%20endif%0A%20%20%20%20%20%20%20%20breaksw%0A%20%20%20%20%20%20case%20screen%3A%0A%20%20%20%20%20%20%20%20if%20%28%24%3Ftcsh%29%20then%0A%20%20%20%20%20%20%20%20%20%20set%20prompt%3D%27%25%7B%5C033k%25n%40%25m%3A%25c%5C033%5C%5C%25%7D%5B%25n%40%25m%20%25c%5D%25%23%20%27%0A%20%20%20%20%20%20%20%20endif%0A%20%20%20%20%20%20%20%20breaksw%0A%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20breaksw%0A%20%20%20%20endsw%0A%20%20endif%0Aendif%0A%0Asetenv%20MAIL%20%22/var/spool/mail/%24USER%22%0A%0A%23%20Check%20if%20we%20aren%27t%20a%20loginshell%20and%20do%20stuff%20if%20we%20aren%27t%0Aif%20%28%21%20%24%3Floginsh%29%20then%0A%20%20%20%20if%20%28%20-d%20/etc/profile.d%20%29%20then%0A%20%20%20%20%20%20%20%20set%20nonomatch%0A%20%20%20%20%20%20%20%20foreach%20i%20%28%20/etc/profile.d/%2A.csh%20%29%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%20-r%20%22%24i%22%20%29%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%28%24%3Fprompt%29%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20source%20%22%24i%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20source%20%22%24i%22%20%3E%26/dev/null%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20endif%0A%20%20%20%20%20%20%20%20%20%20%20%20endif%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20%20%20%20%20unset%20i%20nonomatch%0A%20%20%20%20endif%0Aendif%0A%0A%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/csh.cshrc"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To ensure the default umask for users of the C shell is set properly, add or correct the umask setting in /etc/csh.cshrc to read as follows:\n\numask 027",
      "id": "xccdf_org.ssgproject.content_rule_accounts_umask_etc_csh_cshrc",
      "instructions": "Verify the \"umask\" setting is configured correctly in the \"/etc/csh.cshrc\" file with the following command:\n\n$ grep umask /etc/csh.cshrc\n\numask 077\numask 077",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "accounts-umask-etc-csh-cshrc",
          "compliance.openshift.io/rule-variable": "var-accounts-user-umask",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-6(1);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-6(1),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-umask-etc-csh-cshrc",
        "namespace": "openshift-compliance",
        "resourceVersion": "77057",
        "uid": "331b6329-cc04-4d15-943a-ab81e0e491f7"
      },
      "rationale": "The umask value influences the permissions assigned to files when they are created. A misconfigured umask value could result in files with excessive permissions that can be read or written to by unauthorized users.",
      "severity": "medium",
      "title": "Ensure the Default C Shell Umask is Set Correctly"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To ensure the default umask controlled by /etc/login.defs is set properly, add or correct the UMASK setting in /etc/login.defs to read as follows:\n\nUMASK 027",
      "id": "xccdf_org.ssgproject.content_rule_accounts_umask_etc_login_defs",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 defines default permissions for all authenticated users in such a way that the user can only read and modify their own files with the following command:\n\n# grep -i umask /etc/login.defs\n\nUMASK",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "accounts-umask-etc-login-defs",
          "compliance.openshift.io/rule-variable": "var-accounts-user-umask",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-6(1);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-6(1),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-umask-etc-login-defs",
        "namespace": "openshift-compliance",
        "resourceVersion": "77052",
        "uid": "5371c936-9791-42e8-8a9f-fdec754c8bb9"
      },
      "rationale": "The umask value influences the permissions assigned to files when they are created. A misconfigured umask value could result in files with excessive permissions that can be read and written to by unauthorized users.",
      "severity": "medium",
      "title": "Ensure the Default Umask is Set Correctly in login.defs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%20/etc/profile%0A%0A%23%20System%20wide%20environment%20and%20startup%20programs%2C%20for%20login%20setup%0A%23%20Functions%20and%20aliases%20go%20in%20/etc/bashrc%0A%0A%23%20It%27s%20NOT%20a%20good%20idea%20to%20change%20this%20file%20unless%20you%20know%20what%20you%0A%23%20are%20doing.%20It%27s%20much%20better%20to%20create%20a%20custom.sh%20shell%20script%20in%0A%23%20/etc/profile.d/%20to%20make%20custom%20changes%20to%20your%20environment%2C%20as%20this%0A%23%20will%20prevent%20the%20need%20for%20merging%20in%20future%20updates.%0A%0Apathmunge%20%28%29%20%7B%0A%20%20%20%20case%20%22%3A%24%7BPATH%7D%3A%22%20in%0A%20%20%20%20%20%20%20%20%2A%3A%22%241%22%3A%2A%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%3B%3B%0A%20%20%20%20%20%20%20%20%2A%29%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%5B%20%22%242%22%20%3D%20%22after%22%20%5D%20%3B%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20PATH%3D%24PATH%3A%241%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20PATH%3D%241%3A%24PATH%0A%20%20%20%20%20%20%20%20%20%20%20%20fi%0A%20%20%20%20esac%0A%7D%0A%0A%0Aif%20%5B%20-x%20/usr/bin/id%20%5D%3B%20then%0A%20%20%20%20if%20%5B%20-z%20%22%24EUID%22%20%5D%3B%20then%0A%20%20%20%20%20%20%20%20%23%20ksh%20workaround%0A%20%20%20%20%20%20%20%20EUID%3D%60id%20-u%60%0A%20%20%20%20%20%20%20%20UID%3D%60id%20-ru%60%0A%20%20%20%20fi%0A%20%20%20%20USER%3D%22%60id%20-un%60%22%0A%20%20%20%20LOGNAME%3D%24USER%0A%20%20%20%20MAIL%3D%22/var/spool/mail/%24USER%22%0Afi%0A%0A%23%20Path%20manipulation%0Aif%20%5B%20%22%24EUID%22%20%3D%20%220%22%20%5D%3B%20then%0A%20%20%20%20pathmunge%20/usr/sbin%0A%20%20%20%20pathmunge%20/usr/local/sbin%0Aelse%0A%20%20%20%20pathmunge%20/usr/local/sbin%20after%0A%20%20%20%20pathmunge%20/usr/sbin%20after%0Afi%0A%0AHOSTNAME%3D%60/usr/bin/hostname%202%3E/dev/null%60%0AHISTSIZE%3D1000%0Aif%20%5B%20%22%24HISTCONTROL%22%20%3D%20%22ignorespace%22%20%5D%20%3B%20then%0A%20%20%20%20export%20HISTCONTROL%3Dignoreboth%0Aelse%0A%20%20%20%20export%20HISTCONTROL%3Dignoredups%0Afi%0A%0Aexport%20PATH%20USER%20LOGNAME%20MAIL%20HOSTNAME%20HISTSIZE%20HISTCONTROL%0A%0A%23%20By%20default%2C%20we%20want%20umask%20to%20get%20set.%20This%20sets%20it%20for%20login%20shell%0A%23%20Current%20threshold%20for%20system%20reserved%20uid/gids%20is%20200%0A%23%20You%20could%20check%20uidgid%20reservation%20validity%20in%0A%23%20/usr/share/doc/setup-%2A/uidgid%20file%0Aif%20%5B%20%24UID%20-gt%20199%20%5D%20%26%26%20%5B%20%22%60id%20-gn%60%22%20%3D%20%22%60id%20-un%60%22%20%5D%3B%20then%0A%20%20%20%20umask%20027%0Aelse%0A%20%20%20%20umask%20027%0Afi%0A%0Afor%20i%20in%20/etc/profile.d/%2A.sh%20/etc/profile.d/sh.local%20%3B%20do%0A%20%20%20%20if%20%5B%20-r%20%22%24i%22%20%5D%3B%20then%0A%20%20%20%20%20%20%20%20if%20%5B%20%22%24%7B-%23%2Ai%7D%22%20%21%3D%20%22%24-%22%20%5D%3B%20then%20%0A%20%20%20%20%20%20%20%20%20%20%20%20.%20%22%24i%22%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20.%20%22%24i%22%20%3E/dev/null%0A%20%20%20%20%20%20%20%20fi%0A%20%20%20%20fi%0Adone%0A%0Aunset%20i%0Aunset%20-f%20pathmunge%0A%0Aif%20%5B%20-n%20%22%24%7BBASH_VERSION-%7D%22%20%5D%20%3B%20then%0A%20%20%20%20%20%20%20%20if%20%5B%20-f%20/etc/bashrc%20%5D%20%3B%20then%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Bash%20login%20shells%20run%20only%20/etc/profile%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Bash%20non-login%20shells%20run%20only%20/etc/bashrc%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Check%20for%20double%20sourcing%20is%20done%20in%20/etc/bashrc.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.%20/etc/bashrc%0A%20%20%20%20%20%20%20fi%0Afi%0A%0A%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/profile"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To ensure the default umask controlled by /etc/profile is set properly, add or correct the umask setting in /etc/profile to read as follows:\n\numask 027 \n\nNote that /etc/profile also reads scrips within /etc/profile.d directory. These scripts are also valid files to set umask value. Therefore, they should also be considered during the check and properly remediated, if necessary.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_umask_etc_profile",
      "instructions": "Verify the umask setting is configured correctly in the /etc/profile file\nor scripts within /etc/profile.d directory with the following command:\n$ grep \"umask\" /etc/profile*\numask \n      Is it the case that the value for the \"umask\" parameter is not \"<sub idref=\"var_accounts_user_umask\" />\",",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "accounts-umask-etc-profile",
          "compliance.openshift.io/rule-variable": "var-accounts-user-umask",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-6(1);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-6(1),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-umask-etc-profile",
        "namespace": "openshift-compliance",
        "resourceVersion": "77068",
        "uid": "d5221c58-caa5-48fb-b130-0321275130c1"
      },
      "rationale": "The umask value influences the permissions assigned to files when they are created. A misconfigured umask value could result in files with excessive permissions that can be read or written to by unauthorized users.",
      "severity": "medium",
      "title": "Ensure the Default Umask is Set Correctly in /etc/profile"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Change the group owner of interactive users files to the group found in\n\n/etc/passwd\n\nfor the user. To change the group owner of a local interactive user home directory, use the following command:\n\n$ sudo chgrp USER_GROUP /home/ USER /. INIT_FILE\n\nThis rule ensures every initialization file related to an interactive user is group-owned by an interactive user.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_user_dot_group_ownership",
      "instructions": "To verify the local initialization files of all local interactive users are group-\nowned by the appropriate user, inspect the primary group of the respective\nusers in /etc/passwd and verify all initialization files under the\nrespective users home directory. Check the group owner of all local interactive users\ninitialization files.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "accounts-user-dot-group-ownership"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-user-dot-group-ownership",
        "namespace": "openshift-compliance",
        "resourceVersion": "77011",
        "uid": "5034c278-1351-46a4-904b-b3c6461252fc"
      },
      "rationale": "Local initialization files for interactive users are used to configure the user's shell environment upon logon. Malicious modification of these files could compromise accounts upon logon.",
      "severity": "medium",
      "title": "User Initialization Files Must Be Group-Owned By The Primary Group",
      "warning": "Local initialization files for interactive users are used to configure the user's shell environment upon logon. Malicious modification of these files could compromise accounts upon logon."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Set the owner of the user initialization files for interactive users to the primary owner with the following command:\n\n$ sudo chown USER /home/ USER /.*\n\nThis rule ensures every initialization file related to an interactive user is owned by an interactive user.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_user_dot_user_ownership",
      "instructions": "To verify all local initialization files for interactive users are owned by the\nprimary user, run the following command:\n$ sudo ls -al /home/USER/.*\nThe user initialization files should be owned by USER.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "accounts-user-dot-user-ownership"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-user-dot-user-ownership",
        "namespace": "openshift-compliance",
        "resourceVersion": "77014",
        "uid": "e2a593bc-9221-42df-9d63-51ef6a35ca81"
      },
      "rationale": "Local initialization files are used to configure the user's shell environment upon logon. Malicious modification of these files could compromise accounts upon logon.",
      "severity": "medium",
      "title": "User Initialization Files Must Be Owned By the Primary User",
      "warning": "Local initialization files are used to configure the user's shell environment upon logon. Malicious modification of these files could compromise accounts upon logon."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Change the group of a local interactive users files and directories to a group that the interactive user is a member of. To change the group owner of a local interactive users files and directories, use the following command:\n\n$ sudo chgrp USER_GROUP /home/ USER / FILE_DIR\n\nThis rule ensures every file or directory under the home directory related to an interactive user is group-owned by an interactive user.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_users_home_files_groupownership",
      "instructions": "To verify all files and directories in interactive user home directory are\ngroup-owned by a group the user is a member of, run the\nfollowing command:\n$ sudo ls -lLR /home/USER",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "accounts-users-home-files-groupownership"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-users-home-files-groupownership",
        "namespace": "openshift-compliance",
        "resourceVersion": "77017",
        "uid": "caea71c1-7642-498a-8934-89339931b711"
      },
      "rationale": "If a local interactive users files are group-owned by a group of which the user is not a member, unintended users may be able to access them.",
      "severity": "medium",
      "title": "All User Files and Directories In The Home Directory Must Be Group-Owned By The Primary Group",
      "warning": "If a local interactive users files are group-owned by a group of which the user is not a member, unintended users may be able to access them."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Either remove all files and directories from the system that do not have a valid user, or assign a valid user to all unowned files and directories. To assign a valid owner to a local interactive user's files and directories, use the following command:\n\n$ sudo chown -R USER /home/ USER\n\nThis rule ensures every file or directory under the home directory related to an interactive user is owned by an interactive user.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_users_home_files_ownership",
      "instructions": "To verify all files and directories in a local interactive user's\nhome directory have a valid owner, run the following command:\n$ sudo ls -lLR /home/USER",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "accounts-users-home-files-ownership"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-users-home-files-ownership",
        "namespace": "openshift-compliance",
        "resourceVersion": "77025",
        "uid": "a3fb3130-715d-4d21-bedf-583075b3f233"
      },
      "rationale": "If local interactive users do not own the files in their directories, unauthorized users may be able to access them. Additionally, if files are not owned by the user, this could be an indication of system compromise.",
      "severity": "medium",
      "title": "All User Files and Directories In The Home Directory Must Have a Valid Owner",
      "warning": "If local interactive users do not own the files in their directories, unauthorized users may be able to access them. Additionally, if files are not owned by the user, this could be an indication of system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Set the mode on files and directories in the local interactive user home directory with the following command:\n\n$ sudo chmod 0750 /home/ USER / FILE_DIR\n\nFiles that begin with a \".\" are excluded from this requirement.",
      "id": "xccdf_org.ssgproject.content_rule_accounts_users_home_files_permissions",
      "instructions": "To verify all files and directories contained in interactive user home\ndirectory, excluding local initialization files, have a mode of 0750,\nrun the following command:\n$ sudo ls -lLR /home/USER",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "accounts-users-home-files-permissions"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-accounts-users-home-files-permissions",
        "namespace": "openshift-compliance",
        "resourceVersion": "77021",
        "uid": "86d982d1-aeff-42cc-8934-20f8529f7f57"
      },
      "rationale": "If a local interactive user files have excessive permissions, unintended users may be able to access or modify them.",
      "severity": "medium",
      "title": "All User Files and Directories In The Home Directory Must Have Mode 0750 Or Less Permissive"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Run the following command to generate a new database:\n\n$ sudo /usr/sbin/aide --init\n\nBy default, the database will be written to the file /var/lib/aide/aide.db.new.gz. Storing the database, the configuration file /etc/aide.conf , and the binary /usr/sbin/aide (or hashes of these files), in a secure location (such as on read-only media) provides additional assurance about their integrity. The newly-generated database can be installed as follows:\n\n$ sudo cp /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\nTo initiate a manual check, run the following command:\n\n$ sudo /usr/sbin/aide --check\n\nIf this check produces any unexpected output, investigate.",
      "id": "xccdf_org.ssgproject.content_rule_aide_build_database",
      "instructions": "To find the location of the AIDE database file, run the following command:\n$ sudo ls -l DBDIR/database_file_name",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "aide-build-database",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-11.5",
          "policies.open-cluster-management.io/controls": "CM-6(a),Req-11.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-aide-build-database",
        "namespace": "openshift-compliance",
        "resourceVersion": "76555",
        "uid": "bc67711c-e585-4c85-9d21-27fd6583e97e"
      },
      "rationale": "For AIDE to be effective, an initial database of \"known-good\" information about files must be captured and it should be able to be verified against the installed files.",
      "severity": "medium",
      "title": "Build and Test AIDE Database"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Copenat%2Copenat2%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Copenat%2Copenat2%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Copenat%2Copenat2%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Copenat%2Copenat2%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-access%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-3-access-failed.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Ensure that unsuccessful attempts to access a file are audited. The following rules configure audit as described above:\n\n## Unsuccessful file access (any other opens) This has to go last.\n-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-access\n-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-access\n-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-access\n-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-access\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_access_failed",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-3-access-failed.rules\nThe output has to be exactly as follows:\n## Unsuccessful file access (any other opens) This has to go last.\n-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-access\n-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-access\n-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-access\n-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-access-failed",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-access-failed",
        "namespace": "openshift-compliance",
        "resourceVersion": "77696",
        "uid": "8aaeba63-7da5-4fb2-8e63-7931b8b4e5b5"
      },
      "rationale": "Unsuccessful attempts to access a file might be signs of malicious activity happening within the system. Auditing of such activities helps in their monitoring and investigation.",
      "severity": "medium",
      "title": "Configure auditing of unsuccessful file accesses"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%23%20Successful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A%23%23%20These%20next%20two%20are%20likely%20to%20result%20in%20a%20whole%20lot%20of%20events%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Copenat%2Copen_by_handle_at%20-F%20success%3D1%20-F%20auid%26gt%3B%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dsuccessful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Copenat%2Copen_by_handle_at%20-F%20success%3D1%20-F%20auid%26gt%3B%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dsuccessful-access"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-3-access-success.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Ensure that successful attempts to access a file are audited. The following rules configure audit as described above:\n\n## Successful file access (any other opens) This has to go last.\n## These next two are likely to result in a whole lot of events\n-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-access\n-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-access\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_access_success",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-3-access-success.rules\nThe output has to be exactly as follows:\n## Successful file access (any other opens) This has to go last.\n## These next two are likely to result in a whole lot of events\n-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-access\n-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-access-success",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-access-success",
        "namespace": "openshift-compliance",
        "resourceVersion": "77697",
        "uid": "833cf2eb-d1e7-471c-a5df-65bb9cc37c43"
      },
      "rationale": "Auditing of successful attempts to access a file helps in investigation of activities performed on the system.",
      "severity": "medium",
      "title": "Configure auditing of successful file accesses"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%23%20First%20rule%20-%20delete%20all%0A-D%0A%0A%23%23%20Increase%20the%20buffers%20to%20survive%20stress%20events.%0A%23%23%20Make%20this%20bigger%20for%20busy%20systems%0A-b%208192%0A%0A%23%23%20This%20determine%20how%20long%20to%20wait%20in%20burst%20of%20events%0A--backlog_wait_time%2060000%0A%0A%23%23%20Set%20failure%20mode%20to%20syslog%0A-f%201%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/10-base-config.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Perform basic configuration of Audit system. Make sure that any previously defined rules are cleared, the auditing system is configured to handle sudden bursts of events, and in cases of failure, messages are configured to be directed to system log. The following rules configure audit as described above:\n\n## First rule - delete all\n-D\n\n## Increase the buffers to survive stress events.\n## Make this bigger for busy systems\n-b 8192\n\n## This determine how long to wait in burst of events\n--backlog_wait_time 60000\n\n## Set failure mode to syslog\n-f 1\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load",
      "id": "xccdf_org.ssgproject.content_rule_audit_basic_configuration",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/10-base-config.rules\nThe output has to be exactly as follows:\n## First rule - delete all\n-D\n\n## Increase the buffers to survive stress events.\n## Make this bigger for busy systems\n-b 8192\n\n## This determine how long to wait in burst of events\n--backlog_wait_time 60000\n\n## Set failure mode to syslog\n-f 1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-basic-configuration",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-basic-configuration",
        "namespace": "openshift-compliance",
        "resourceVersion": "77699",
        "uid": "00f57d78-5c34-495a-87e7-2ef7ab80c234"
      },
      "rationale": "Without basic configurations, audit may not perform as expected. It may not be able to correctly handle events under stressful conditions, or log events in case of failure.",
      "severity": "medium",
      "title": "Configure basic parameters of Audit system",
      "warning": "Without basic configurations, audit may not perform as expected. It may not be able to correctly handle events under stressful conditions, or log events in case of failure."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-create%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-1-create-failed.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Ensure that unsuccessful attempts to create a file are audited. The following rules configure audit as described above:\n\n## Unsuccessful file creation (open with O_CREAT)\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_create_failed",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-1-create-failed.rules\nThe output has to be exactly as follows:\n## Unsuccessful file creation (open with O_CREAT)\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create\n-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-create",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-create-failed",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-create-failed",
        "namespace": "openshift-compliance",
        "resourceVersion": "77701",
        "uid": "692e917a-f303-480c-b4c6-82260eb2fe31"
      },
      "rationale": "Unsuccessful file creations might be a sign of a malicious action being performed on the system. Keeping log of such events helps in monitoring and investigation of such actions.",
      "severity": "medium",
      "title": "Configure auditing of unsuccessful file creations"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that successful attempts to create a file are audited. The following rules configure audit as described above:\n\n## Successful file creation (open with O_CREAT)\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&0100 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&0100 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b32 -S open -F a1&0100 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b32 -S creat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b64 -S creat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_create_success",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-1-create-success.rules\nThe output has to be exactly as follows:\n## Successful file creation (open with O_CREAT)\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&0100 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&0100 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b32 -S open -F a1&0100 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b32 -S creat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create\n-a always,exit -F arch=b64 -S creat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-create",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-create-success",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-create-success",
        "namespace": "openshift-compliance",
        "resourceVersion": "77705",
        "uid": "ae23b9df-b579-47c6-928d-4d29daa2b122"
      },
      "rationale": "Auditing of successful attempts to create a file helps in investigation of actions which happened on the system.",
      "severity": "medium",
      "title": "Configure auditing of successful file creations"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%23%20Unsuccessful%20file%20delete%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20unlink%2Cunlinkat%2Crename%2Crenameat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-delete%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20unlink%2Cunlinkat%2Crename%2Crenameat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-delete%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20unlink%2Cunlinkat%2Crename%2Crenameat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-delete%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20unlink%2Cunlinkat%2Crename%2Crenameat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-delete%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-4-delete-failed.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Ensure that unsuccessful attempts to delete a file are audited. The following rules configure audit as described above:\n\n## Unsuccessful file delete\n-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_delete_failed",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-4-delete-failed.rules\nThe output has to be exactly as follows:\n## Unsuccessful file delete\n-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-delete-failed",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-delete-failed",
        "namespace": "openshift-compliance",
        "resourceVersion": "77707",
        "uid": "bb80adf2-f4e2-4e9f-9144-e6cf6b111258"
      },
      "rationale": "Unsuccessful attempts to delete a file might be signs of malicious activities. Auditing of such events help in monitoring and investigating of such activities.",
      "severity": "medium",
      "title": "Configure auditing of unsuccessful file deletions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20Successful%20file%20delete%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20unlink%2Cunlinkat%2Crename%2Crenameat%20-F%20success%3D1%20-F%20auid%26gt%3B%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dsuccessful-delete%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20unlink%2Cunlinkat%2Crename%2Crenameat%20-F%20success%3D1%20-F%20auid%26gt%3B%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dsuccessful-delete }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-4-delete-success.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Ensure that successful attempts to delete a file are audited. The following rules configure audit as described above:\n\n## Successful file delete\n-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-delete\n-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-delete\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_delete_success",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-4-delete-success.rules\nThe output has to be exactly as follows:\n## Successful file delete\n-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-delete\n-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-delete",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-delete-success",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-delete-success",
        "namespace": "openshift-compliance",
        "resourceVersion": "77709",
        "uid": "0fdad1a8-e728-482e-865a-7514134fa3b9"
      },
      "rationale": "Auditing of successful attempts to delete a file may help in monitoring and investigation of activities performed on the system.",
      "severity": "medium",
      "title": "Configure auditing of successful file deletions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%23%20Make%20the%20loginuid%20immutable.%20This%20prevents%20tampering%20with%20the%20auid.%0A--loginuid-immutable%0A%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/11-loginuid.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Configure kernel to prevent modification of login UIDs once they are set. Changing login UIDs while this configuration is enforced requires special capabilities which are not available to unprivileged users. The following rules configure audit as described above:\n\n## Make the loginuid immutable. This prevents tampering with the auid.\n--loginuid-immutable\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load",
      "id": "xccdf_org.ssgproject.content_rule_audit_immutable_login_uids",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\n$ sudo cat /etc/audit/rules.d/11-loginuid.rules\nThe output has to be exactly as follows:\n## Make the loginuid immutable. This prevents tampering with the auid.\n--loginuid-immutable",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-immutable-login-uids",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-immutable-login-uids",
        "namespace": "openshift-compliance",
        "resourceVersion": "77714",
        "uid": "2db5dbd8-7094-48d8-85df-c8efdeec89fe"
      },
      "rationale": "If modification of login UIDs is not prevented, they can be changed by unprivileged users and make auditing complicated or impossible.",
      "severity": "medium",
      "title": "Configure immutable Audit login UIDs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccessful-modification%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-2-modify-failed.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Ensure that unsuccessful attempts to modify a file are audited. The following rules configure audit as described above:\n\n## Unsuccessful file modifications (open for write or truncate)\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_modify_failed",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-2-modify-failed.rules\nThe output has to be exactly as follows:\n## Unsuccessful file modifications (open for write or truncate)\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b32 -S truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification\n-a always,exit -F arch=b64 -S truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-modification",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-modify-failed",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-modify-failed",
        "namespace": "openshift-compliance",
        "resourceVersion": "77717",
        "uid": "ff71337f-f06a-4d3d-a474-b1e135d337a4"
      },
      "rationale": "Unsuccessful file modifications might be a sign of a malicious action being performed on the system. Auditing of such events helps in detection and investigation of such actions.",
      "severity": "medium",
      "title": "Configure auditing of unsuccessful file modifications"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that successful attempts to modify a file are audited. The following rules configure audit as described above:\n\n## Successful file modifications (open for write or truncate)\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&01003 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&01003 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b32 -S open -F a1&01003 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b64 -S open -F a1&01003 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b32 -S truncate,ftruncate -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b64 -S truncate,ftruncate -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_modify_success",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-2-modify-success.rules\nThe output has to be exactly as follows:\n## Successful file modifications (open for write or truncate)\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&01003 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&01003 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b32 -S open -F a1&01003 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b64 -S open -F a1&01003 -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b32 -S truncate,ftruncate -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification\n-a always,exit -F arch=b64 -S truncate,ftruncate -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-modification",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-modify-success",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-modify-success",
        "namespace": "openshift-compliance",
        "resourceVersion": "77722",
        "uid": "c4005d30-c5e4-4935-9624-6b311d1e3318"
      },
      "rationale": "Auditing of successful attempts to modify a file helps in investigation of actions which happened on the system.",
      "severity": "medium",
      "title": "Configure auditing of successful file modifications"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%23%20These%20rules%20watch%20for%20kernel%20module%20insertion.%20By%20monitoring%0A%23%23%20the%20syscall%2C%20we%20do%20not%20need%20any%20watches%20on%20programs.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20init_module%2Cfinit_module%20-F%20key%3Dmodule-load%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20init_module%2Cfinit_module%20-F%20key%3Dmodule-load%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20delete_module%20-F%20key%3Dmodule-unload%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20delete_module%20-F%20key%3Dmodule-unload%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/43-module-load.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Ensure that loading and unloading of kernel modules is audited. The following rules configure audit as described above:\n\n## These rules watch for kernel module insertion. By monitoring\n## the syscall, we do not need any watches on programs.\n-a always,exit -F arch=b32 -S init_module,finit_module -F key=module-load\n-a always,exit -F arch=b64 -S init_module,finit_module -F key=module-load\n-a always,exit -F arch=b32 -S delete_module -F key=module-unload\n-a always,exit -F arch=b64 -S delete_module -F key=module-unload\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load",
      "id": "xccdf_org.ssgproject.content_rule_audit_module_load",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/43-module-load.rules\nThe output has to be exactly as follows:\n## These rules watch for kernel module insertion. By monitoring\n## the syscall, we do not need any watches on programs.\n-a always,exit -F arch=b32 -S init_module,finit_module -F key=module-load\n-a always,exit -F arch=b64 -S init_module,finit_module -F key=module-load\n-a always,exit -F arch=b32 -S delete_module -F key=module-unload\n-a always,exit -F arch=b64 -S delete_module -F key=module-unload",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-module-load",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:45Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-module-load",
        "namespace": "openshift-compliance",
        "resourceVersion": "77723",
        "uid": "47ee2608-5a00-4d71-9d1d-eab546666b01"
      },
      "rationale": "Loading of a malicious kernel module introduces a risk to the system, as the module has access to sensitive data and perform actions at the operating system kernel level. Having such events audited helps in monitoring and investigating of malicious activities.",
      "severity": "medium",
      "title": "Configure auditing of loading and unloading of kernel modules"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%20the%20following%20rule%20files%20copied%20to%20%2Fetc%2Faudit%2Frules.d%3A%0A%23%23%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%0A%23%23%2030-ospp-v42-1-create-failed.rules%2C%2030-ospp-v42-1-create-success.rules%2C%0A%23%23%2030-ospp-v42-2-modify-failed.rules%2C%2030-ospp-v42-2-modify-success.rules%2C%0A%23%23%2030-ospp-v42-3-access-failed.rules%2C%2030-ospp-v42-3-access-success.rules%2C%0A%23%23%2030-ospp-v42-4-delete-failed.rules%2C%2030-ospp-v42-4-delete-success.rules%2C%0A%23%23%2030-ospp-v42-5-perm-change-failed.rules%2C%0A%23%23%2030-ospp-v42-5-perm-change-success.rules%2C%0A%23%23%2030-ospp-v42-6-owner-change-failed.rules%2C%0A%23%23%2030-ospp-v42-6-owner-change-success.rules%0A%23%23%0A%23%23%20original%20copies%20may%20be%20found%20in%20%2Fusr%2Fshare%2Faudit%2Fsample-rules%2F%0A%0A%0A%23%23%20User%20add%20delete%20modify.%20This%20is%20covered%20by%20pam.%20However%2C%20someone%20could%0A%23%23%20open%20a%20file%20and%20directly%20create%20or%20modify%20a%20user%2C%20so%20we%27ll%20watch%20passwd%20and%0A%23%23%20shadow%20for%20writes%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2603%20-F%20path%3D%2Fetc%2Fpasswd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2603%20-F%20path%3D%2Fetc%2Fpasswd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2603%20-F%20path%3D%2Fetc%2Fpasswd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2603%20-F%20path%3D%2Fetc%2Fpasswd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2603%20-F%20path%3D%2Fetc%2Fshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2603%20-F%20path%3D%2Fetc%2Fshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2603%20-F%20path%3D%2Fetc%2Fshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2603%20-F%20path%3D%2Fetc%2Fshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A%0A%23%23%20User%20enable%20and%20disable.%20This%20is%20entirely%20handled%20by%20pam.%0A%0A%23%23%20Group%20add%20delete%20modify.%20This%20is%20covered%20by%20pam.%20However%2C%20someone%20could%0A%23%23%20open%20a%20file%20and%20directly%20create%20or%20modify%20a%20user%2C%20so%20we%27ll%20watch%20group%20and%0A%23%23%20gshadow%20for%20writes%0A-a%20always%2Cexit%20-F%20path%3D%2Fetc%2Fpasswd%20-F%20perm%3Dwa%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A-a%20always%2Cexit%20-F%20path%3D%2Fetc%2Fshadow%20-F%20perm%3Dwa%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Duser-modify%0A-a%20always%2Cexit%20-F%20path%3D%2Fetc%2Fgroup%20-F%20perm%3Dwa%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dgroup-modify%0A-a%20always%2Cexit%20-F%20path%3D%2Fetc%2Fgshadow%20-F%20perm%3Dwa%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dgroup-modify%0A%0A%0A%23%23%20Use%20of%20special%20rights%20for%20config%20changes.%20This%20would%20be%20use%20of%20setuid%0A%23%23%20programs%20that%20relate%20to%20user%20accts.%20This%20is%20not%20all%20setuid%20apps%20because%0A%23%23%20requirements%20are%20only%20for%20ones%20that%20affect%20system%20configuration.%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fsbin%2Funix_chkpwd%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fsbin%2Fusernetctl%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fsbin%2Fuserhelper%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fsbin%2Fseunshare%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fbin%2Fmount%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fbin%2Fnewgrp%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fbin%2Fnewuidmap%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fbin%2Fgpasswd%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fbin%2Fnewgidmap%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fbin%2Fumount%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fbin%2Fpasswd%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fbin%2Fcrontab%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20path%3D%2Fusr%2Fbin%2Fat%20-F%20perm%3Dx%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dspecial-config-changes%0A%0A%23%23%20Privilege%20escalation%20via%20su%20or%20sudo.%20This%20is%20entirely%20handled%20by%20pam.%0A%0A%23%23%20Watch%20for%20configuration%20changes%20to%20privilege%20escalation.%0A-a%20always%2Cexit%20-F%20path%3D%2Fetc%2Fsudoers%20-F%20perm%3Dwa%20-F%20key%3Dspecial-config-changes%0A-a%20always%2Cexit%20-F%20dir%3D%2Fetc%2Fsudoers.d%2F%20-F%20perm%3Dwa%20-F%20key%3Dspecial-config-changes%0A%0A%23%23%20Audit%20log%20access%0A-a%20always%2Cexit%20-F%20dir%3D%2Fvar%2Flog%2Faudit%2F%20-F%20perm%3Dr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess-audit-trail%0A%23%23%20Attempts%20to%20Alter%20Process%20and%20Session%20Initiation%20Information%0A-a%20always%2Cexit%20-F%20path%3D%2Fvar%2Frun%2Futmp%20-F%20perm%3Dwa%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dsession%0A-a%20always%2Cexit%20-F%20path%3D%2Fvar%2Flog%2Fbtmp%20-F%20perm%3Dwa%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dsession%0A-a%20always%2Cexit%20-F%20path%3D%2Fvar%2Flog%2Fwtmp%20-F%20perm%3Dwa%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dsession%0A%0A%23%23%20Attempts%20to%20modify%20MAC%20controls%0A-a%20always%2Cexit%20-F%20dir%3D%2Fetc%2Fselinux%2F%20-F%20perm%3Dwa%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3DMAC-policy%0A%0A%23%23%20Software%20updates.%20This%20is%20entirely%20handled%20by%20rpm.%0A%0A%23%23%20System%20start%20and%20shutdown.%20This%20is%20entirely%20handled%20by%20systemd%0A%0A%23%23%20Kernel%20Module%20loading.%20This%20is%20handled%20in%2043-module-load.rules%0A%0A%23%23%20Application%20invocation.%20The%20requirements%20list%20an%20optional%20requirement%0A%23%23%20FPT_SRP_EXT.1%20Software%20Restriction%20Policies.%20This%20event%20is%20intended%20to%0A%23%23%20state%20results%20from%20that%20policy.%20This%20would%20be%20handled%20entirely%20by%0A%23%23%20that%20daemon.%0A%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Configure some basic Audit parameters specific for OSPP profile. In particular, configure Audit to watch for direct modification of files storing system user and group information, and usage of applications with special rights which can change system configuration. Further audited events include access to audit log it self, attempts to Alter Process and Session Initiation Information, and attempts to modify MAC controls. The following rules configure audit as described above:\n\n## The purpose of these rules is to meet the requirements for Operating\n## System Protection Profile (OSPP)v4.2. These rules depends on having\n## the following rule files copied to /etc/audit/rules.d:\n##\n## 10-base-config.rules, 11-loginuid.rules,\n## 30-ospp-v42-1-create-failed.rules, 30-ospp-v42-1-create-success.rules,\n## 30-ospp-v42-2-modify-failed.rules, 30-ospp-v42-2-modify-success.rules,\n## 30-ospp-v42-3-access-failed.rules, 30-ospp-v42-3-access-success.rules,\n## 30-ospp-v42-4-delete-failed.rules, 30-ospp-v42-4-delete-success.rules,\n## 30-ospp-v42-5-perm-change-failed.rules,\n## 30-ospp-v42-5-perm-change-success.rules,\n## 30-ospp-v42-6-owner-change-failed.rules,\n## 30-ospp-v42-6-owner-change-success.rules\n##\n## original copies may be found in /usr/share/audit/sample-rules/\n\n## User add delete modify. This is covered by pam. However, someone could\n## open a file and directly create or modify a user, so we'll watch passwd and\n## shadow for writes\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b64 -S open -F a1&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b64 -S open -F a1&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\n## User enable and disable. This is entirely handled by pam.\n\n## Group add delete modify. This is covered by pam. However, someone could\n## open a file and directly create or modify a user, so we'll watch group and\n## gshadow for writes\n-a always,exit -F path=/etc/passwd -F perm=wa -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F path=/etc/shadow -F perm=wa -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F path=/etc/group -F perm=wa -F auid>=1000 -F auid!=unset -F key=group-modify\n-a always,exit -F path=/etc/gshadow -F perm=wa -F auid>=1000 -F auid!=unset -F key=group-modify\n\n## Use of special rights for config changes. This would be use of setuid\n## programs that relate to user accts. This is not all setuid apps because\n## requirements are only for ones that affect system configuration.\n-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/sbin/usernetctl -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/sbin/seunshare -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/newuidmap -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/newgidmap -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/at -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/sbin/grub2-set-bootflag -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n\n## Privilege escalation via su or sudo. This is entirely handled by pam.\n## Special case for systemd-run. It is not audit aware, specifically watch it\n-a always,exit -F path=/usr/bin/systemd-run -F perm=x -F auid!=unset -F key=maybe-escalation\n## Special case for pkexec. It is not audit aware, specifically watch it\n-a always,exit -F path=/usr/bin/pkexec -F perm=x -F key=maybe-escalation\n\n## Watch for configuration changes to privilege escalation.\n-a always,exit -F path=/etc/sudoers -F perm=wa -F key=special-config-changes\n-a always,exit -F dir=/etc/sudoers.d/ -F perm=wa -F key=special-config-changes\n\n## Audit log access\n-a always,exit -F dir=/var/log/audit/ -F perm=r -F auid>=1000 -F auid!=unset -F key=access-audit-trail\n## Attempts to Alter Process and Session Initiation Information\n-a always,exit -F path=/var/run/utmp -F perm=wa -F auid>=1000 -F auid!=unset -F key=session\n-a always,exit -F path=/var/log/btmp -F perm=wa -F auid>=1000 -F auid!=unset -F key=session\n-a always,exit -F path=/var/log/wtmp -F perm=wa -F auid>=1000 -F auid!=unset -F key=session\n\n## Attempts to modify MAC controls\n-a always,exit -F dir=/etc/selinux/ -F perm=wa -F auid>=1000 -F auid!=unset -F key=MAC-policy\n\n## Software updates. This is entirely handled by rpm.\n\n## System start and shutdown. This is entirely handled by systemd\n\n## Kernel Module loading. This is handled in 43-module-load.rules\n\n## Application invocation. The requirements list an optional requirement\n## FPT_SRP_EXT.1 Software Restriction Policies. This event is intended to\n## state results from that policy. This would be handled entirely by\n## that daemon.\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_ospp_general",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42.rules\nThe output has to be exactly as follows:\n## The purpose of these rules is to meet the requirements for Operating\n## System Protection Profile (OSPP)v4.2. These rules depends on having\n## the following rule files copied to /etc/audit/rules.d:\n##\n## 10-base-config.rules, 11-loginuid.rules,\n## 30-ospp-v42-1-create-failed.rules, 30-ospp-v42-1-create-success.rules,\n## 30-ospp-v42-2-modify-failed.rules, 30-ospp-v42-2-modify-success.rules,\n## 30-ospp-v42-3-access-failed.rules, 30-ospp-v42-3-access-success.rules,\n## 30-ospp-v42-4-delete-failed.rules, 30-ospp-v42-4-delete-success.rules,\n## 30-ospp-v42-5-perm-change-failed.rules,\n## 30-ospp-v42-5-perm-change-success.rules,\n## 30-ospp-v42-6-owner-change-failed.rules,\n## 30-ospp-v42-6-owner-change-success.rules\n##\n## original copies may be found in /usr/share/audit/sample-rules/\n\n\n## User add delete modify. This is covered by pam. However, someone could\n## open a file and directly create or modify a user, so we'll watch passwd and\n## shadow for writes\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b64 -S open -F a1&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b32 -S openat,open_by_handle_at -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b64 -S openat,open_by_handle_at -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F arch=b64 -S open -F a1&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\n## User enable and disable. This is entirely handled by pam.\n\n## Group add delete modify. This is covered by pam. However, someone could\n## open a file and directly create or modify a user, so we'll watch group and\n## gshadow for writes\n-a always,exit -F path=/etc/passwd -F perm=wa -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F path=/etc/shadow -F perm=wa -F auid>=1000 -F auid!=unset -F key=user-modify\n-a always,exit -F path=/etc/group -F perm=wa -F auid>=1000 -F auid!=unset -F key=group-modify\n-a always,exit -F path=/etc/gshadow -F perm=wa -F auid>=1000 -F auid!=unset -F key=group-modify\n\n\n## Use of special rights for config changes. This would be use of setuid\n## programs that relate to user accts. This is not all setuid apps because\n## requirements are only for ones that affect system configuration.\n-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/sbin/usernetctl -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/sbin/seunshare -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/newuidmap -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/newgidmap -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/bin/at -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n-a always,exit -F path=/usr/sbin/grub2-set-bootflag -F perm=x -F auid>=1000 -F auid!=unset -F key=special-config-changes\n\n## Privilege escalation via su or sudo. This is entirely handled by pam.\n## Special case for systemd-run. It is not audit aware, specifically watch it\n-a always,exit -F path=/usr/bin/systemd-run -F perm=x -F auid!=unset -F key=maybe-escalation\n## Special case for pkexec. It is not audit aware, specifically watch it\n-a always,exit -F path=/usr/bin/pkexec -F perm=x -F key=maybe-escalation\n\n\n## Watch for configuration changes to privilege escalation.\n-a always,exit -F path=/etc/sudoers -F perm=wa -F key=special-config-changes\n-a always,exit -F dir=/etc/sudoers.d/ -F perm=wa -F key=special-config-changes\n\n## Audit log access\n-a always,exit -F dir=/var/log/audit/ -F perm=r -F auid>=1000 -F auid!=unset -F key=access-audit-trail\n## Attempts to Alter Process and Session Initiation Information\n-a always,exit -F path=/var/run/utmp -F perm=wa -F auid>=1000 -F auid!=unset -F key=session\n-a always,exit -F path=/var/log/btmp -F perm=wa -F auid>=1000 -F auid!=unset -F key=session\n-a always,exit -F path=/var/log/wtmp -F perm=wa -F auid>=1000 -F auid!=unset -F key=session\n\n## Attempts to modify MAC controls\n-a always,exit -F dir=/etc/selinux/ -F perm=wa -F auid>=1000 -F auid!=unset -F key=MAC-policy\n\n## Software updates. This is entirely handled by rpm.\n\n## System start and shutdown. This is entirely handled by systemd\n\n## Kernel Module loading. This is handled in 43-module-load.rules\n\n## Application invocation. The requirements list an optional requirement\n## FPT_SRP_EXT.1 Software Restriction Policies. This event is intended to\n## state results from that policy. This would be handled entirely by\n## that daemon.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-ospp-general",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-ospp-general",
        "namespace": "openshift-compliance",
        "resourceVersion": "77726",
        "uid": "bcbf1042-644f-4ac7-94db-2d66edd141fc"
      },
      "rationale": "Auditing of events listed in the description provides data for monitoring and investigation of potentially malicious events e.g. tampering with Audit logs, malicious access to files storing information about system users and groups etc.",
      "severity": "medium",
      "title": "Perform general configuration of Audit for OSPP"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that unsuccessful attempts to change an ownership of files or directories are audited. The following rules configure audit as described above:\n\n## Unsuccessful ownership change\n-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-owner-change\n-a always,exit -F arch=b64 -S lchown,fchown,chown,fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-owner-change\n-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-owner-change\n-a always,exit -F arch=b64 -S lchown,fchown,chown,fchownat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-owner-change\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_owner_change_failed",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-6-owner-change-failed.rules\nThe output has to be exactly as follows:\n## Unsuccessful ownership change\n-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-owner-change\n-a always,exit -F arch=b64 -S lchown,fchown,chown,fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-owner-change\n-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-owner-change\n-a always,exit -F arch=b64 -S lchown,fchown,chown,fchownat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-owner-change",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-owner-change-failed",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-owner-change-failed",
        "namespace": "openshift-compliance",
        "resourceVersion": "77729",
        "uid": "3d0e87d1-3ebe-4ee2-86f6-3e41f0635294"
      },
      "rationale": "Unsuccessful attempts to change an ownership of files or directories might be signs of a malicious activity. Having such events audited helps in monitoring and investigation of such activities.",
      "severity": "medium",
      "title": "Configure auditing of unsuccessful ownership changes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that successful attempts to change an ownership of files or directories are audited. The following rules configure audit as described above:\n\n## Successful ownership change\n-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-owner-change\n-a always,exit -F arch=b64 -S lchown,fchown,chown,fchownat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-owner-change\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_owner_change_success",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-6-owner-change-success.rules\nThe output has to be exactly as follows:\n## Successful ownership change\n-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-owner-change\n-a always,exit -F arch=b64 -S lchown,fchown,chown,fchownat -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-owner-change",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-owner-change-success",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-owner-change-success",
        "namespace": "openshift-compliance",
        "resourceVersion": "77732",
        "uid": "fe5021ce-2e26-43a8-be02-d5902d3eaa36"
      },
      "rationale": "Auditing of successful ownership changes of files or directories helps in monitoring or investingating of activities performed on the system.",
      "severity": "medium",
      "title": "Configure auditing of successful ownership changes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that unsuccessful attempts to change file or directory permissions are audited. The following rules configure audit as described above:\n\n## Unsuccessful permission change\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-perm-change\n-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-perm-change\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-perm-change\n-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-perm-change\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_perm_change_failed",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-5-perm-change-failed.rules\nThe output has to be exactly as follows:\n## Unsuccessful permission change\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-perm-change\n-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-perm-change\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-perm-change\n-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-perm-change",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-perm-change-failed",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-perm-change-failed",
        "namespace": "openshift-compliance",
        "resourceVersion": "77738",
        "uid": "14eac36c-ba8f-4805-bb4d-35ff6a8d1469"
      },
      "rationale": "Unsuccessful attempts to change permissions of files or directories might be signs of malicious activity. Having such events audited helps in monitoring and investigation of such activities.",
      "severity": "medium",
      "title": "Configure auditing of unsuccessful permission changes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that successful attempts to modify permissions of files or directories are audited. The following rules configure audit as described above:\n\n## Successful permission change\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-perm-change\n-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-perm-change\n\nLoad new Audit rules into kernel by running:\n\naugenrules --load\n\nNote: This rule uses a special set of Audit rules to comply with OSPP 4.2.1. You may reuse this rule in different profiles. If you decide to do so, it is recommended that you inspect contents of the file closely and make sure that they are alligned with your needs.",
      "id": "xccdf_org.ssgproject.content_rule_audit_perm_change_success",
      "instructions": "To verify that the Audit is correctly configured according to recommended rules, check the content of the file with the following command:\ncat /etc/audit/rules.d/30-ospp-v42-5-perm-change-success.rules\nThe output has to be exactly as follows:\n## Successful permission change\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-perm-change\n-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=1 -F auid>=1000 -F auid!=unset -F key=successful-perm-change",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-perm-change-success",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(a)",
          "policies.open-cluster-management.io/controls": "AU-2(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-perm-change-success",
        "namespace": "openshift-compliance",
        "resourceVersion": "77743",
        "uid": "c0e2c08a-b469-4965-a0ae-331b27c02cc9"
      },
      "rationale": "Auditing successful file or directory permission changes helps in monitoring and investigating of activities performed on the system.",
      "severity": "medium",
      "title": "Configure auditing of successful permission changes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/init%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_init_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/init -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/init -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_privileged_commands_init",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"init\" command with the following command:\n\n$ sudo auditctl -l | grep init\n\n-a always,exit -F path=/init -F perm=x -F auid>=1000 -F auid!=unset -k privileged-init",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-privileged-commands-init",
          "control.compliance.openshift.io/NIST-800-53": "AU-12(c)",
          "policies.open-cluster-management.io/controls": "AU-12(c)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-privileged-commands-init",
        "namespace": "openshift-compliance",
        "resourceVersion": "77473",
        "uid": "53ccc18b-e4a6-4c4b-9d40-887a6f5767e9"
      },
      "rationale": "Misuse of the init command may cause availability issues for the system.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - init"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/poweroff%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_poweroff_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/poweroff -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/poweroff -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_privileged_commands_poweroff",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"poweroff\" command with the following command:\n\n$ sudo auditctl -l | grep poweroff\n\n-a always,exit -F path=/poweroff -F perm=x -F auid>=1000 -F auid!=unset -k privileged-poweroff",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-privileged-commands-poweroff",
          "control.compliance.openshift.io/NIST-800-53": "AU-12(c)",
          "policies.open-cluster-management.io/controls": "AU-12(c)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-privileged-commands-poweroff",
        "namespace": "openshift-compliance",
        "resourceVersion": "77476",
        "uid": "e295d37c-401c-4822-87d4-6f510c52ccc2"
      },
      "rationale": "Misuse of the poweroff command may cause availability issues for the system.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - poweroff"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/reboot%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_reboot_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/reboot -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/reboot -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_privileged_commands_reboot",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"reboot\" command with the following command:\n\n$ sudo auditctl -l | grep reboot\n\n-a always,exit -F path=/reboot -F perm=x -F auid>=1000 -F auid!=unset -k privileged-reboot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-privileged-commands-reboot",
          "control.compliance.openshift.io/NIST-800-53": "AU-12(c)",
          "policies.open-cluster-management.io/controls": "AU-12(c)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-privileged-commands-reboot",
        "namespace": "openshift-compliance",
        "resourceVersion": "77478",
        "uid": "1fe20a5d-7200-4a69-9f27-aee47d738e42"
      },
      "rationale": "Misuse of the reboot command may cause availability issues for the system.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - reboot"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/shutdown%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_shutdown_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/shutdown -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/shutdown -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_privileged_commands_shutdown",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"shutdown\" command with the following command:\n\n$ sudo auditctl -l | grep shutdown\n\n-a always,exit -F path=/shutdown -F perm=x -F auid>=1000 -F auid!=unset -k privileged-shutdown",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-privileged-commands-shutdown",
          "control.compliance.openshift.io/NIST-800-53": "AU-12(c)",
          "policies.open-cluster-management.io/controls": "AU-12(c)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-privileged-commands-shutdown",
        "namespace": "openshift-compliance",
        "resourceVersion": "77481",
        "uid": "75481576-b862-4b63-aa8d-c482f4bffe24"
      },
      "rationale": "Misuse of the shutdown command may cause availability issues for the system.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - shutdown"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20chmod%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20chmod%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-chmod_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S chmod -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S chmod -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chmod",
      "instructions": "To determine if the system is configured to audit calls to the\nchmod system call, run the following command:\n$ sudo grep \"chmod\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-nerc-cip,rhcos4-e8,rhcos4-high,rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-chmod",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-chmod",
        "namespace": "openshift-compliance",
        "resourceVersion": "77198",
        "uid": "a1961f43-d626-4ecc-90a6-2a84ebf1ff77"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - chmod",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20chown%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20chown%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-chown_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chown",
      "instructions": "To determine if the system is configured to audit calls to the\nchown system call, run the following command:\n$ sudo grep \"chown\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-stig-v1r1,rhcos4-anssi-bp28-enhanced,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-moderate,rhcos4-stig,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-e8",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-chown",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-chown",
        "namespace": "openshift-compliance",
        "resourceVersion": "77200",
        "uid": "c57fe76e-e4d7-4190-bc8e-9691fc9dd9c3"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - chown",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchmod%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchmod%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fchmod_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmod",
      "instructions": "To determine if the system is configured to audit calls to the\nfchmod system call, run the following command:\n$ sudo grep \"fchmod\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-fchmod",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-fchmod",
        "namespace": "openshift-compliance",
        "resourceVersion": "77204",
        "uid": "ad11c77f-2902-4d53-a1af-32c302205a53"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - fchmod",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchmodat%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchmodat%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fchmodat_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmodat",
      "instructions": "To determine if the system is configured to audit calls to the\nfchmodat system call, run the following command:\n$ sudo grep \"fchmodat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-stig,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-fchmodat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-fchmodat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77209",
        "uid": "6fedf438-12df-4bdc-a862-e03635a7fb4a"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - fchmodat",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchown%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchown%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fchown_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchown",
      "instructions": "To determine if the system is configured to audit calls to the\nfchown system call, run the following command:\n$ sudo grep \"fchown\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-fchown",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-fchown",
        "namespace": "openshift-compliance",
        "resourceVersion": "77213",
        "uid": "9dbdcd50-463f-4c86-9993-3f0592cf17ce"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - fchown",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchownat%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchownat%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fchownat_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchownat",
      "instructions": "To determine if the system is configured to audit calls to the\nfchownat system call, run the following command:\n$ sudo grep \"fchownat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-moderate-rev-4,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-anssi-bp28-high,rhcos4-stig,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-fchownat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-fchownat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77216",
        "uid": "a1d1dd0f-f876-470c-84ae-0366228536ec"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - fchownat",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fremovexattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fremovexattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fremovexattr_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root.\n\nIf the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S fremovexattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fremovexattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S fremovexattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fremovexattr -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fremovexattr",
      "instructions": "To determine if the system is configured to audit calls to the\nfremovexattr system call, run the following command:\n$ sudo grep \"fremovexattr\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-anssi-bp28-enhanced,rhcos4-stig,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-fremovexattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-fremovexattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77220",
        "uid": "876948ba-eb79-45c9-90ef-bfe2095425f6"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - fremovexattr",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fsetxattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fsetxattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fsetxattr_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S fsetxattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fsetxattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S fsetxattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S fsetxattr -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fsetxattr",
      "instructions": "To determine if the system is configured to audit calls to the\nfsetxattr system call, run the following command:\n$ sudo grep \"fsetxattr\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-stig-v1r1,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-fsetxattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-fsetxattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77223",
        "uid": "7a0f7fff-2163-46aa-8988-55d2252ae2d5"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - fsetxattr",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20lchown%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20lchown%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-lchown_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lchown",
      "instructions": "To determine if the system is configured to audit calls to the\nlchown system call, run the following command:\n$ sudo grep \"lchown\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-high,rhcos4-nerc-cip,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-lchown",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-lchown",
        "namespace": "openshift-compliance",
        "resourceVersion": "77228",
        "uid": "a7428b40-951f-4980-a744-2b0d49581ec0"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - lchown",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20lremovexattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20lremovexattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-lremovexattr_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root.\n\nIf the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S lremovexattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S lremovexattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S lremovexattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S lremovexattr -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lremovexattr",
      "instructions": "To determine if the system is configured to audit calls to the\nlremovexattr system call, run the following command:\n$ sudo grep \"lremovexattr\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-anssi-bp28-high,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-stig,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-lremovexattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-lremovexattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77231",
        "uid": "fae4c77d-1dd2-458d-8cab-f63894dc00d4"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - lremovexattr",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20lsetxattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20lsetxattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-lsetxattr_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S lsetxattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S lsetxattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S lsetxattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S lsetxattr -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lsetxattr",
      "instructions": "To determine if the system is configured to audit calls to the\nlsetxattr system call, run the following command:\n$ sudo grep \"lsetxattr\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4,rhcos4-anssi-bp28-high,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-lsetxattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-lsetxattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77234",
        "uid": "79c85d74-0f66-4b3a-a8fb-89cd9ab8d02a"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - lsetxattr",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20removexattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20removexattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-removexattr_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root.\n\nIf the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S removexattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S removexattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_removexattr",
      "instructions": "To determine if the system is configured to audit calls to the\nremovexattr system call, run the following command:\n$ sudo grep \"removexattr\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-removexattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-removexattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77237",
        "uid": "67815775-acf7-4d94-946a-3c1cac88de7c"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - removexattr",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20setxattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20setxattr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-setxattr_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file permission changes for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S setxattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S setxattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S setxattr -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S setxattr -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_setxattr",
      "instructions": "To determine if the system is configured to audit calls to the\nsetxattr system call, run the following command:\n$ sudo grep \"setxattr\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-setxattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-setxattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77240",
        "uid": "f61ae3ba-fa43-4fc3-8879-1899ef0654ff"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - setxattr",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -a%20always%2Cexit%20-F%20arch%3Db32%20-S%20umount%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20umount%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-umount_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file system umount changes. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S umount -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S umount -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_umount",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 generates an audit record for all uses of the \"umount\" and system call.\nTo determine if the system is configured to audit calls to the\n\"umount\" system call, run the following command:\n$ sudo grep \"umount\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line like the following.\n-a always,exit -F arch=b32 -S umount -F auid>=1000 -F auid!=unset -k privileged-umount",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-umount"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-umount",
        "namespace": "openshift-compliance",
        "resourceVersion": "77245",
        "uid": "62e21500-8302-45e8-851f-961fb2ab9ad5"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - umount",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20umount2%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20umount2%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-umount2_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file system umount2 changes. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S umount2 -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S umount2 -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S umount2 -F auid>=1000 -F auid!=unset -F key=perm_mod\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S umount2 -F auid>=1000 -F auid!=unset -F key=perm_mod",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_umount2",
      "instructions": "To determine if the system is configured to audit calls to the\numount2 system call, run the following command:\n$ sudo grep \"umount2\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-rules-dac-modification-umount2"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-dac-modification-umount2",
        "namespace": "openshift-compliance",
        "resourceVersion": "77251",
        "uid": "7f2b5584-28c0-403e-b7d7-6817ff80d653"
      },
      "rationale": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Discretionary Access Controls - umount2",
      "warning": "The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2603%20-F%20path%3D/etc/group%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2603%20-F%20path%3D/etc/group%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_group_open_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/group file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/group -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/group -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S open -F a1&03 -F path=/etc/group -F auid>=1000 -F auid!=unset -F key=modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_group_open",
      "instructions": "To determine if the system is configured to audit calls to the\nopen system call, run the following command:\n$ sudo grep \"open\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-etc-group-open",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-group-open",
        "namespace": "openshift-compliance",
        "resourceVersion": "77092",
        "uid": "b4bc5e75-ef5f-43fe-bd9c-5a7152e7cd3c"
      },
      "rationale": "Creation of groups through direct edition of /etc/group could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via open syscall - /etc/group",
      "warning": "Creation of groups through direct edition of /etc/group could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open_by_handle_at%20-F%20a2%2603%20-F%20path%3D/etc/group%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open_by_handle_at%20-F%20a2%2603%20-F%20path%3D/etc/group%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_group_open_by_handle_at_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/group file for all group and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&03 -F path=/etc/group -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&03 -F path=/etc/group -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&03 -F path=/etc/group -F auid>=1000 -F auid!=unset -F key=modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_group_open_by_handle_at",
      "instructions": "To determine if the system is configured to audit calls to the\nopen_by_handle_at system call, run the following command:\n$ sudo grep \"open_by_handle_at\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-etc-group-open-by-handle-at",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-group-open-by-handle-at",
        "namespace": "openshift-compliance",
        "resourceVersion": "77083",
        "uid": "dfe2c728-914f-4a0f-a0ec-bd58c5115ebf"
      },
      "rationale": "Creation of groups through direct edition of /etc/group could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via open_by_handle_at syscall - /etc/group",
      "warning": "Creation of groups through direct edition of /etc/group could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%20-F%20a2%2603%20-F%20path%3D/etc/group%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%20-F%20a2%2603%20-F%20path%3D/etc/group%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_group_openat_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/group file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S openat -F a2&03 -F path=/etc/group -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S openat -F a2&03 -F path=/etc/group -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S openat -F a2&03 -F path=/etc/group -F auid>=1000 -F auid!=unset -F key=modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_group_openat",
      "instructions": "To determine if the system is configured to audit calls to the\nopenat system call, run the following command:\n$ sudo grep \"openat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-etc-group-openat",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-group-openat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77089",
        "uid": "0666225e-9344-4180-a7a3-674d5d11eccd"
      },
      "rationale": "Creation of groups through direct edition of /etc/group could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via openat syscall - /etc/group",
      "warning": "Creation of groups through direct edition of /etc/group could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2603%20-F%20path%3D/etc/gshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2603%20-F%20path%3D/etc/gshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_gshadow_open_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/gshadow file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/gshadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/gshadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S open -F a1&03 -F path=/etc/gshadow -F auid>=1000 -F auid!=unset -F key=user-modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_gshadow_open",
      "instructions": "To determine if the system is configured to audit calls to the\nopen system call, run the following command:\n$ sudo grep \"open\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-etc-gshadow-open",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-gshadow-open",
        "namespace": "openshift-compliance",
        "resourceVersion": "77094",
        "uid": "a9d3d840-bc53-4f9c-9f1a-52e24751d989"
      },
      "rationale": "Creation of users through direct edition of /etc/gshadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via open syscall - /etc/gshadow",
      "warning": "Creation of users through direct edition of /etc/gshadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open_by_handle_at%20-F%20a2%2603%20-F%20path%3D/etc/gshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open_by_handle_at%20-F%20a2%2603%20-F%20path%3D/etc/gshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_gshadow_open_by_handle_at_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/gshadow file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&03 -F path=/etc/gshadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&03 -F path=/etc/gshadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&03 -F path=/etc/gshadow -F auid>=1000 -F auid!=unset -F key=user-modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_gshadow_open_by_handle_at",
      "instructions": "To determine if the system is configured to audit calls to the\nopen_by_handle_at system call, run the following command:\n$ sudo grep \"open_by_handle_at\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-etc-gshadow-open-by-handle-at",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-gshadow-open-by-handle-at",
        "namespace": "openshift-compliance",
        "resourceVersion": "77097",
        "uid": "6abcaca6-705b-4fcf-b047-f03d19fbffde"
      },
      "rationale": "Creation of users through direct edition of /etc/gshadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via open_by_handle_at syscall - /etc/gshadow",
      "warning": "Creation of users through direct edition of /etc/gshadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%20-F%20a2%2603%20-F%20path%3D/etc/gshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%20-F%20a2%2603%20-F%20path%3D/etc/gshadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_gshadow_openat_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/gshadow file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S openat -F a2&03 -F path=/etc/gshadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S openat -F a2&03 -F path=/etc/gshadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S openat -F a2&03 -F path=/etc/gshadow -F auid>=1000 -F auid!=unset -F key=user-modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_gshadow_openat",
      "instructions": "To determine if the system is configured to audit calls to the\nopenat system call, run the following command:\n$ sudo grep \"openat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-etc-gshadow-openat",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-gshadow-openat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77100",
        "uid": "07de454a-84e1-4a8c-8153-e5e6abc7c5ef"
      },
      "rationale": "Creation of users through direct edition of /etc/gshadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via openat syscall - /etc/gshadow",
      "warning": "Creation of users through direct edition of /etc/gshadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2603%20-F%20path%3D/etc/passwd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2603%20-F%20path%3D/etc/passwd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_passwd_open_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/passwd file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S open -F a1&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_passwd_open",
      "instructions": "To determine if the system is configured to audit calls to the\nopen system call, run the following command:\n$ sudo grep \"open\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-etc-passwd-open",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-passwd-open",
        "namespace": "openshift-compliance",
        "resourceVersion": "77112",
        "uid": "89030224-9757-4004-8620-550e7f3a5983"
      },
      "rationale": "Creation of users through direct edition of /etc/passwd could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via open syscall - /etc/passwd",
      "warning": "Creation of users through direct edition of /etc/passwd could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open_by_handle_at%20-F%20a2%2603%20-F%20path%3D/etc/passwd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open_by_handle_at%20-F%20a2%2603%20-F%20path%3D/etc/passwd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_passwd_open_by_handle_at_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/passwd file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_passwd_open_by_handle_at",
      "instructions": "To determine if the system is configured to audit calls to the\nopen_by_handle_at system call, run the following command:\n$ sudo grep \"open_by_handle_at\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-etc-passwd-open-by-handle-at",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-passwd-open-by-handle-at",
        "namespace": "openshift-compliance",
        "resourceVersion": "77109",
        "uid": "8a2b7ea2-941d-49fb-8dd3-f1e58d444deb"
      },
      "rationale": "Creation of users through direct edition of /etc/passwd could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via open_by_handle_at syscall - /etc/passwd",
      "warning": "Creation of users through direct edition of /etc/passwd could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%20-F%20a2%2603%20-F%20path%3D/etc/passwd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%20-F%20a2%2603%20-F%20path%3D/etc/passwd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_passwd_openat_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/passwd file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S openat -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S openat -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S openat -F a2&03 -F path=/etc/passwd -F auid>=1000 -F auid!=unset -F key=modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_passwd_openat",
      "instructions": "To determine if the system is configured to audit calls to the\nopenat system call, run the following command:\n$ sudo grep \"openat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-etc-passwd-openat",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-passwd-openat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77114",
        "uid": "48ca5550-88c2-4f46-a20f-56b3a5a8c2e4"
      },
      "rationale": "Creation of users through direct edition of /etc/passwd could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via openat syscall - /etc/passwd",
      "warning": "Creation of users through direct edition of /etc/passwd could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2603%20-F%20path%3D/etc/shadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2603%20-F%20path%3D/etc/shadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_shadow_open_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/shadow file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open -F a1&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S open -F a1&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_shadow_open",
      "instructions": "To determine if the system is configured to audit calls to the\nopen system call, run the following command:\n$ sudo grep \"open\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-etc-shadow-open",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-shadow-open",
        "namespace": "openshift-compliance",
        "resourceVersion": "77117",
        "uid": "a636820b-7768-4332-a81a-a7940e344dae"
      },
      "rationale": "Creation of users through direct edition of /etc/shadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via open syscall - /etc/shadow",
      "warning": "Creation of users through direct edition of /etc/shadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open_by_handle_at%20-F%20a2%2603%20-F%20path%3D/etc/shadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open_by_handle_at%20-F%20a2%2603%20-F%20path%3D/etc/shadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_shadow_open_by_handle_at_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/shadow file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_shadow_open_by_handle_at",
      "instructions": "To determine if the system is configured to audit calls to the\nopen_by_handle_at system call, run the following command:\n$ sudo grep \"open_by_handle_at\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-etc-shadow-open-by-handle-at",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:28Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-shadow-open-by-handle-at",
        "namespace": "openshift-compliance",
        "resourceVersion": "77119",
        "uid": "f5fea098-4b5a-4ca4-89bc-b4704dfb3041"
      },
      "rationale": "Creation of users through direct edition of /etc/shadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via open_by_handle_at syscall - /etc/shadow",
      "warning": "Creation of users through direct edition of /etc/shadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%20-F%20a2%2603%20-F%20path%3D/etc/shadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%20-F%20a2%2603%20-F%20path%3D/etc/shadow%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dmodify%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etc_shadow_openat_path_syscall.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect write events to /etc/shadow file for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S openat -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S openat -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S openat -F a2&03 -F path=/etc/shadow -F auid>=1000 -F auid!=unset -F key=user-modify",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_etc_shadow_openat",
      "instructions": "To determine if the system is configured to audit calls to the\nopenat system call, run the following command:\n$ sudo grep \"openat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-etc-shadow-openat",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-etc-shadow-openat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77127",
        "uid": "16d70cfb-ab7e-4c97-a3b5-e2ca16c40cd4"
      },
      "rationale": "Creation of users through direct edition of /etc/shadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information via openat syscall - /etc/shadow",
      "warning": "Creation of users through direct edition of /etc/shadow could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/chcon%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_chcon_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect any execution attempt of the chcon command for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/chcon -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F path=/usr/bin/chcon -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_execution_chcon",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"chcon\" command with the following command:\n\n$ sudo auditctl -l | grep chcon\n\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=unset -k perm_mod",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-e8,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-execution-chcon",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-execution-chcon",
        "namespace": "openshift-compliance",
        "resourceVersion": "77254",
        "uid": "74c2dcc5-874a-46a0-9dc6-214154734f83"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Record Any Attempts to Run chcon"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/restorecon%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_restorecon_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect any execution attempt of the restorecon command for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/restorecon -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F path=/usr/sbin/restorecon -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_execution_restorecon",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"restorecon\" command with the following command:\n\n$ sudo auditctl -l | grep restorecon\n\n-a always,exit -F path=/usr/sbin/restorecon -F perm=x -F auid>=1000 -F auid!=unset -k privileged-restorecon",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-e8,rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-execution-restorecon",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-execution-restorecon",
        "namespace": "openshift-compliance",
        "resourceVersion": "77260",
        "uid": "d64791bf-20a2-4a9e-b7be-42bfef9b1dac"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Record Any Attempts to Run restorecon"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/semanage%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_semanage_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect any execution attempt of the semanage command for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/semanage -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F path=/usr/sbin/semanage -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_execution_semanage",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"semanage\" command with the following command:\n\n$ sudo auditctl -l | grep semanage\n\n-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-e8,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-rules-execution-semanage",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:32Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-execution-semanage",
        "namespace": "openshift-compliance",
        "resourceVersion": "77265",
        "uid": "70eec314-8b0c-4ede-b208-afac44d4c29c"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Record Any Attempts to Run semanage"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/setfiles%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_setfiles_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect any execution attempt of the setfiles command for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/setfiles -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F path=/usr/sbin/setfiles -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_execution_setfiles",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"setfiles\" command with the following command:\n\n$ sudo auditctl -l | grep setfiles\n\n-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-execution-setfiles",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-execution-setfiles",
        "namespace": "openshift-compliance",
        "resourceVersion": "77268",
        "uid": "63fd794c-cc2f-4080-a246-1e546c24b8b2"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Record Any Attempts to Run setfiles"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/setsebool%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_setsebool_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect any execution attempt of the setsebool command for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/setsebool -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F path=/usr/sbin/setsebool -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_execution_setsebool",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"setsebool\" command with the following command:\n\n$ sudo auditctl -l | grep setsebool\n\n-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=unset -k privileged",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-execution-setsebool",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-execution-setsebool",
        "namespace": "openshift-compliance",
        "resourceVersion": "77273",
        "uid": "3b40cc05-1981-4a5d-8df0-215ae27421b4"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Record Any Attempts to Run setsebool"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/seunshare%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_seunshare_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect any execution attempt of the seunshare command for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/seunshare -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F path=/usr/sbin/seunshare -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_execution_seunshare",
      "instructions": "To verify that execution of the command is being audited, run the following command:\n$ sudo grep \"path=/usr/sbin/seunshare\" /etc/audit/audit.rules /etc/audit/rules.d/*\nThe output should return something similar to:\n-a always,exit -F path=/usr/sbin/seunshare -F auid>=1000 -F auid!=unset -F key=privileged",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-execution-seunshare",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-execution-seunshare",
        "namespace": "openshift-compliance",
        "resourceVersion": "77281",
        "uid": "5ab89865-c09d-4555-97af-762a47ebb6ca"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Record Any Attempts to Run seunshare"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "At a minimum the audit system should collect file deletion events for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d , setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S rmdir,unlink,unlinkat,rename,renameat -F auid>=1000 -F auid!=unset -F key=delete\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S rmdir,unlink,unlinkat,rename -S renameat -F auid>=1000 -F auid!=unset -F key=delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events",
      "instructions": "To determine if the system is configured to audit calls to the\nrmdir system call, run the following command:\n$ sudo grep \"rmdir\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.\nTo determine if the system is configured to audit calls to the\nunlink system call, run the following command:\n$ sudo grep \"unlink\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.\nTo determine if the system is configured to audit calls to the\nunlinkat system call, run the following command:\n$ sudo grep \"unlinkat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.\nTo determine if the system is configured to audit calls to the\nrename system call, run the following command:\n$ sudo grep \"rename\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.\nTo determine if the system is configured to audit calls to the\nrenameat system call, run the following command:\n$ sudo grep \"renameat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-rules-file-deletion-events",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-file-deletion-events",
        "namespace": "openshift-compliance",
        "resourceVersion": "77278",
        "uid": "19ddd3c4-586f-4730-af34-21dbe5019d51"
      },
      "rationale": "Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as, detecting malicious processes that attempt to delete log files to conceal their presence.",
      "severity": "medium",
      "title": "Ensure auditd Collects File Deletion Events by User",
      "warning": "Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as, detecting malicious processes that attempt to delete log files to conceal their presence."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20rename%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20rename%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-rename-file-deletion-events.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file deletion events for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d , setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S rename -F auid>=1000 -F auid!=unset -F key=delete\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S rename -F auid>=1000 -F auid!=unset -F key=delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_rename",
      "instructions": "To determine if the system is configured to audit calls to the\nrename system call, run the following command:\n$ sudo grep \"rename\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-enhanced,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-file-deletion-events-rename",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-file-deletion-events-rename",
        "namespace": "openshift-compliance",
        "resourceVersion": "77286",
        "uid": "d2c8c729-09ff-4324-9325-7486a109b27e"
      },
      "rationale": "Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as, detecting malicious processes that attempt to delete log files to conceal their presence.",
      "severity": "medium",
      "title": "Ensure auditd Collects File Deletion Events by User - rename"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20renameat%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20renameat%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-renameat-file-deletion-events.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file deletion events for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d , setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S renameat -F auid>=1000 -F auid!=unset -F key=delete\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S renameat -F auid>=1000 -F auid!=unset -F key=delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_renameat",
      "instructions": "To determine if the system is configured to audit calls to the\nrenameat system call, run the following command:\n$ sudo grep \"renameat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-file-deletion-events-renameat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-file-deletion-events-renameat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77289",
        "uid": "18653d4f-2c16-420d-bd29-a2b554f2f0f7"
      },
      "rationale": "Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as, detecting malicious processes that attempt to delete log files to conceal their presence.",
      "severity": "medium",
      "title": "Ensure auditd Collects File Deletion Events by User - renameat"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20rmdir%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20rmdir%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-rmdir-file-deletion-events.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file deletion events for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d , setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S rmdir -F auid>=1000 -F auid!=unset -F key=delete\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S rmdir -F auid>=1000 -F auid!=unset -F key=delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_rmdir",
      "instructions": "To determine if the system is configured to audit calls to the\nrmdir system call, run the following command:\n$ sudo grep \"rmdir\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "audit-rules-file-deletion-events-rmdir",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-file-deletion-events-rmdir",
        "namespace": "openshift-compliance",
        "resourceVersion": "77291",
        "uid": "b3f495fe-215d-4ed3-b2ab-bd7b27befcdd"
      },
      "rationale": "Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as, detecting malicious processes that attempt to delete log files to conceal their presence.",
      "severity": "medium",
      "title": "Ensure auditd Collects File Deletion Events by User - rmdir"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20unlink%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20unlink%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-unlink-file-deletion-events.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file deletion events for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d , setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S unlink -F auid>=1000 -F auid!=unset -F key=delete\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S unlink -F auid>=1000 -F auid!=unset -F key=delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_unlink",
      "instructions": "To determine if the system is configured to audit calls to the\nunlink system call, run the following command:\n$ sudo grep \"unlink\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-rules-file-deletion-events-unlink",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-file-deletion-events-unlink",
        "namespace": "openshift-compliance",
        "resourceVersion": "77296",
        "uid": "0650a912-35e9-418c-bbeb-e91d0770f5f5"
      },
      "rationale": "Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as, detecting malicious processes that attempt to delete log files to conceal their presence.",
      "severity": "medium",
      "title": "Ensure auditd Collects File Deletion Events by User - unlink"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20unlinkat%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20unlinkat%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Ddelete%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-unlinkat-file-deletion-events.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect file deletion events for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d , setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S unlinkat -F auid>=1000 -F auid!=unset -F key=delete\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S unlinkat -F auid>=1000 -F auid!=unset -F key=delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_unlinkat",
      "instructions": "To determine if the system is configured to audit calls to the\nunlinkat system call, run the following command:\n$ sudo grep \"unlinkat\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-high,rhcos4-stig-v1r1,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-file-deletion-events-unlinkat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-file-deletion-events-unlinkat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77298",
        "uid": "00596810-0dc2-4198-a9b7-89ca3e1298a0"
      },
      "rationale": "Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as, detecting malicious processes that attempt to delete log files to conceal their presence.",
      "severity": "medium",
      "title": "Ensure auditd Collects File Deletion Events by User - unlinkat"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Configure audit to meet requirements for Operating System Protection Profile (OSPP) v4.2.1. Audit defines groups of rules in /usr/share/doc/audit/rules to satisfy specific policies. To fulfill requirements for compliance with OSPP v4.2.1, the following files are necessary:\n\n* /usr/share/doc/audit/rules/10-base-config.rules\n* /usr/share/doc/audit/rules/11-loginuid.rules\n* /usr/share/doc/audit/rules/30-ospp-v42.rules\n* /usr/share/doc/audit/rules/43-module-load.rules\n\nCopy the files from /usr/share/doc/audit/rules to /etc/audit/rules.d :\n\ncp /usr/share/doc/audit*/rules/{10-base-config,11-loginuid,30-ospp-v42,43-module-load}.rules /etc/audit/rules.d/",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_for_ospp",
      "instructions": "To verify that audit is configured for OSPP v4.2.1, run the following commands:\nfor file in \"10-base-config\" \"11-loginuid\" \"30-ospp-v42\" \"43-module-load\";do diff /etc/audit/rules.d/$file.rules /usr/share/doc/audit*/rules/$file.rules; done\n\nIf the system is configured properly, no lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-rules-for-ospp",
          "control.compliance.openshift.io/NIST-800-53": "NONE",
          "policies.open-cluster-management.io/controls": "NONE",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-for-ospp",
        "namespace": "openshift-compliance",
        "resourceVersion": "77745",
        "uid": "fd32e67e-e7d3-4cf3-ac08-3d596067817a"
      },
      "rationale": "The audit rules defined in /usr/share/doc/audit/rules are the recommended way to meet compliance with OSPP v4.2.1.",
      "severity": "medium",
      "title": "Configure audit according to OSPP requirements",
      "warning": "The audit rules defined in /usr/share/doc/audit/rules are the recommended way to meet compliance with OSPP v4.2.1."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-e%202%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/90-immutable.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d in order to make the auditd configuration immutable:\n\n-e 2\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file in order to make the auditd configuration immutable:\n\n-e 2\n\nWith this setting, a reboot will be required to change any audit rules.",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_immutable",
      "instructions": "Verify the audit system prevents unauthorized changes with the following command:\n\n$ sudo grep \"^\\s*[^#]\" /etc/audit/audit.rules | tail -1\n-e 2",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig,rhcos4-anssi-bp28-high,rhcos4-high,rhcos4-stig-v1r1,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-immutable",
          "control.compliance.openshift.io/NIST-800-53": "AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.2",
          "policies.open-cluster-management.io/controls": "AC-6(9),CM-6(a),Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-immutable",
        "namespace": "openshift-compliance",
        "resourceVersion": "77129",
        "uid": "3bb8ac1b-eb47-4de4-bd25-07bef1249180"
      },
      "rationale": "Making the audit configuration immutable prevents accidental as well as malicious modification of the audit rules, although it may be problematic if legitimate changes are needed during system operation.",
      "severity": "medium",
      "title": "Make the auditd Configuration Immutable"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To capture kernel module loading and unloading events, use following lines, setting ARCH to either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:\n\n-a always,exit -F arch= ARCH -S init_module,finit_module,delete_module -F key=modules\n\nThe place to add the lines depends on a way auditd daemon is configured. If it is configured to use the augenrules program (the default), add the lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility, add the lines to file /etc/audit/audit.rules.",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading",
      "instructions": "To determine if the system is configured to audit calls to the\ninit_module system call, run the following command:\n$ sudo grep \"init_module\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.\nTo determine if the system is configured to audit calls to the\nfinit_module system call, run the following command:\n$ sudo grep \"finit_module\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.\nTo determine if the system is configured to audit calls to the\ndelete_module system call, run the following command:\n$ sudo grep \"delete_module\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-rules-kernel-module-loading",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-kernel-module-loading",
        "namespace": "openshift-compliance",
        "resourceVersion": "77438",
        "uid": "39152b16-a828-446b-964a-ff18e34ac64c"
      },
      "rationale": "The addition/removal of kernel modules can be used to alter the behavior of the kernel and potentially introduce malicious code into kernel space. It is important to have an audit trail of modules that have been introduced into the kernel.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on Kernel Module Loading and Unloading"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20delete_module%20-k%20module-change%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20delete_module%20-k%20module-change%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-kernel-module-loading-delete.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To capture kernel module unloading events, use following line, setting ARCH to either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:\n\n-a always,exit -F arch= ARCH -S delete_module -F key=modules\n\nPlace to add the line depends on a way auditd daemon is configured. If it is configured to use the augenrules program (the default), add the line to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility, add the line to file /etc/audit/audit.rules.",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading_delete",
      "instructions": "To determine if the system is configured to audit calls to the\ndelete_module system call, run the following command:\n$ sudo grep \"delete_module\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-e8,rhcos4-high,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-kernel-module-loading-delete",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-kernel-module-loading-delete",
        "namespace": "openshift-compliance",
        "resourceVersion": "77447",
        "uid": "5522c34a-d16a-4862-9679-015832c31c5a"
      },
      "rationale": "The removal of kernel modules can be used to alter the behavior of the kernel and potentially introduce malicious code into kernel space. It is important to have an audit trail of modules that have been introduced into the kernel.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on Kernel Module Unloading - delete_module"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20finit_module%20-k%20module-change%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20finit_module%20-k%20module-change%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-kernel-module-loading-finit.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d to capture kernel module loading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch= ARCH -S finit_module -F key=modules\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file in order to capture kernel module loading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch= ARCH -S finit_module -F key=modules",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading_finit",
      "instructions": "To determine if the system is configured to audit calls to the\nfinit_module system call, run the following command:\n$ sudo grep \"finit_module\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-e8,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-kernel-module-loading-finit",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-kernel-module-loading-finit",
        "namespace": "openshift-compliance",
        "resourceVersion": "77451",
        "uid": "6f09c1c4-22eb-4e40-81db-9ac4753fd309"
      },
      "rationale": "The addition/removal of kernel modules can be used to alter the behavior of the kernel and potentially introduce malicious code into kernel space. It is important to have an audit trail of modules that have been introduced into the kernel.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on Kernel Module Loading and Unloading - finit_module"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20init_module%20-k%20module-change%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20init_module%20-k%20module-change%0A"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-kernel-module-loading-init.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To capture kernel module loading events, use following line, setting ARCH to either b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:\n\n-a always,exit -F arch= ARCH -S init_module -F key=modules\n\nPlace to add the line depends on a way auditd daemon is configured. If it is configured to use the augenrules program (the default), add the line to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility, add the line to file /etc/audit/audit.rules.",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading_init",
      "instructions": "To determine if the system is configured to audit calls to the\ninit_module system call, run the following command:\n$ sudo grep \"init_module\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-kernel-module-loading-init",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-kernel-module-loading-init",
        "namespace": "openshift-compliance",
        "resourceVersion": "77455",
        "uid": "deab7669-c240-4422-9f1a-bc5fd905c12e"
      },
      "rationale": "The addition of kernel modules can be used to alter the behavior of the kernel and potentially introduce malicious code into kernel space. It is important to have an audit trail of modules that have been introduced into the kernel.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on Kernel Module Loading - init_module"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The audit system already collects login information for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d in order to watch for attempted manual edits of files involved in storing logon events:\n\n-w /var/log/tallylog -p wa -k logins\n-w /var/log/faillock -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file in order to watch for unattempted manual edits of files involved in storing logon events:\n\n-w /var/log/tallylog -p wa -k logins\n-w /var/log/faillock -p wa -k logins\n-w /var/log/lastlog -p wa -k logins",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_login_events",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8",
          "compliance.openshift.io/rule": "audit-rules-login-events",
          "compliance.openshift.io/rule-variable": "var-accounts-passwords-pam-faillock-dir,var-accounts-passwords-pam-faillock-dir",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.3",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-login-events",
        "namespace": "openshift-compliance",
        "resourceVersion": "77460",
        "uid": "142e975f-53dc-4b41-97a2-657e5a68356d"
      },
      "rationale": "Manual editing of these files may indicate nefarious activity, such as an attacker attempting to remove evidence of an intrusion.",
      "severity": "medium",
      "title": "Record Attempts to Alter Logon and Logout Events",
      "warning": "Manual editing of these files may indicate nefarious activity, such as an attacker attempting to remove evidence of an intrusion."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-w%20{{ %7B%7B.var_accounts_passwords_pam_faillock_dir%7D%7D }}%20-p%20wa%20-k%20logins%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-audit_rules_login_events_faillock.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system already collects login information for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d in order to watch for attempted manual edits of files involved in storing logon events:\n\n-w /var/log/faillock -p wa -k logins\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file in order to watch for unattempted manual edits of files involved in storing logon events:\n\n-w /var/log/faillock -p wa -k logins",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_login_events_faillock",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates audit records for all account creations, modifications, disabling, and termination events that affect \"/etc/security/opasswd\" with the following command:\n\n$ sudo auditctl -l | grep \n\n-w  -p wa -k logins",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-high-rev-4,rhcos4-anssi-bp28-high,rhcos4-e8,rhcos4-moderate,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-login-events-faillock",
          "compliance.openshift.io/rule-variable": "var-accounts-passwords-pam-faillock-dir,var-accounts-passwords-pam-faillock-dir",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.3",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-login-events-faillock",
        "namespace": "openshift-compliance",
        "resourceVersion": "77462",
        "uid": "bbab0287-cf59-413e-9132-fe13093515f0"
      },
      "rationale": "Manual editing of these files may indicate nefarious activity, such as an attacker attempting to remove evidence of an intrusion.",
      "severity": "medium",
      "title": "Record Attempts to Alter Logon and Logout Events - faillock"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-w%20/var/log/lastlog%20-p%20wa%20-k%20logins%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-audit_rules_login_events_lastlog.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system already collects login information for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d in order to watch for attempted manual edits of files involved in storing logon events:\n\n-w /var/log/lastlog -p wa -k logins\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file in order to watch for unattempted manual edits of files involved in storing logon events:\n\n-w /var/log/lastlog -p wa -k logins",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_login_events_lastlog",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates audit records for all account creations, modifications, disabling, and termination events that affect \"/var/log/lastlog\" with the following command:\n\n$ sudo auditctl -l | grep /var/log/lastlog\n\n-w /var/log/lastlog -p wa -k logins",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-stig,rhcos4-anssi-bp28-high,rhcos4-e8,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-login-events-lastlog",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.3",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-login-events-lastlog",
        "namespace": "openshift-compliance",
        "resourceVersion": "77465",
        "uid": "85f7b6e1-4d92-4d68-9013-5b67084477b9"
      },
      "rationale": "Manual editing of these files may indicate nefarious activity, such as an attacker attempting to remove evidence of an intrusion.",
      "severity": "medium",
      "title": "Record Attempts to Alter Logon and Logout Events - lastlog"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-w%20/var/log/tallylog%20-p%20wa%20-k%20logins%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-audit_rules_login_events_tallylog.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system already collects login information for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d in order to watch for attempted manual edits of files involved in storing logon events:\n\n-w /var/log/tallylog -p wa -k logins\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file in order to watch for unattempted manual edits of files involved in storing logon events:\n\n-w /var/log/tallylog -p wa -k logins",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_login_events_tallylog",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates audit records for all account creations, modifications, disabling, and termination events that affect \"/var/log/tallylog\" with the following command:\n\n$ sudo auditctl -l | grep /var/log/tallylog\n\n-w /var/log/tallylog -p wa -k logins",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-login-events-tallylog",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.3",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-login-events-tallylog",
        "namespace": "openshift-compliance",
        "resourceVersion": "77468",
        "uid": "c12ea5d7-e15b-4bad-af4d-e62decda5b71"
      },
      "rationale": "Manual editing of these files may indicate nefarious activity, such as an attacker attempting to remove evidence of an intrusion.",
      "severity": "medium",
      "title": "Record Attempts to Alter Logon and Logout Events - tallylog"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -w%20/etc/selinux/%20-p%20wa%20-k%20MAC-policy%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etcselinux-wa-MAC-policy.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-w /etc/selinux/ -p wa -k MAC-policy\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-w /etc/selinux/ -p wa -k MAC-policy",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_mac_modification",
      "instructions": "To determine if the system is configured to audit changes to its SELinux\nconfiguration files, run the following command:\n$ sudo auditctl -l | grep \"dir=/etc/selinux\"\nIf the system is configured to watch for changes to its SELinux\nconfiguration, a line should be returned (including\nperm=wa indicating permissions that are watched).",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-mac-modification",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-mac-modification",
        "namespace": "openshift-compliance",
        "resourceVersion": "77131",
        "uid": "7b301bad-c4f9-420c-8a6c-ec5fadba863b"
      },
      "rationale": "The system's mandatory access policy (SELinux) should not be arbitrarily changed by anything other than administrator action. All changes to MAC policy should be audited.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Mandatory Access Controls"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-w /usr/share/selinux/ -p wa -k MAC-policy\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-w /usr/share/selinux/ -p wa -k MAC-policy",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_mac_modification_usr_share",
      "instructions": "To determine if the system is configured to audit changes to its SELinux\nconfiguration files, run the following command:\n$ sudo auditctl -l | grep \"dir=/usr/share/selinux\"\nIf the system is configured to watch for changes to its SELinux\nconfiguration, a line should be returned (including\nperm=wa indicating permissions that are watched).",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-rules-mac-modification-usr-share",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-mac-modification-usr-share",
        "namespace": "openshift-compliance",
        "resourceVersion": "77134",
        "uid": "026e213b-cf64-4622-bc52-c9ebafaeef28"
      },
      "rationale": "The system's mandatory access policy (SELinux) should not be arbitrarily changed by anything other than administrator action. All changes to MAC policy should be audited.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Mandatory Access Controls in usr/share"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20mount%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20mount%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dperm_mod%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-mount_dac_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect media exportation events for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d , setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S mount -F auid>=1000 -F auid!=unset -F key=export\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S mount -F auid>=1000 -F auid!=unset -F key=export",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_media_export",
      "instructions": "To determine if the system is configured to audit calls to the\nmount system call, run the following command:\n$ sudo grep \"mount\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-rules-media-export",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.7",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-media-export",
        "namespace": "openshift-compliance",
        "resourceVersion": "77136",
        "uid": "8fe3a8f2-cc49-46be-ae6f-3722e79ae3d7"
      },
      "rationale": "The unauthorized exportation of data to external media could result in an information leak where classified information, Privacy Act information, and intellectual property could be lost. An audit trail should be created each time a filesystem is mounted to help identify and guard against information loss.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on Exporting to Media (successful)"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20sethostname%2Csetdomainname%20-F%20key%3Daudit_rules_networkconfig_modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20sethostname%2Csetdomainname%20-F%20key%3Daudit_rules_networkconfig_modification%0A-w%20/etc/issue%20-p%20wa%20-k%20audit_rules_networkconfig_modification%0A-w%20/etc/issue.net%20-p%20wa%20-k%20audit_rules_networkconfig_modification%0A-w%20/etc/hosts%20-p%20wa%20-k%20audit_rules_networkconfig_modification%0A-w%20/etc/sysconfig/network%20-p%20wa%20-k%20audit_rules_networkconfig_modification%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-audit_rules_networkconfig_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d , setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S sethostname,setdomainname -F key=audit_rules_networkconfig_modification\n-w /etc/issue -p wa -k audit_rules_networkconfig_modification\n-w /etc/issue.net -p wa -k audit_rules_networkconfig_modification\n-w /etc/hosts -p wa -k audit_rules_networkconfig_modification\n-w /etc/sysconfig/network -p wa -k audit_rules_networkconfig_modification\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file, setting ARCH to either b32 or b64 as appropriate for your system:\n\n-a always,exit -F arch=ARCH -S sethostname,setdomainname -F key=audit_rules_networkconfig_modification\n-w /etc/issue -p wa -k audit_rules_networkconfig_modification\n-w /etc/issue.net -p wa -k audit_rules_networkconfig_modification\n-w /etc/hosts -p wa -k audit_rules_networkconfig_modification\n-w /etc/sysconfig/network -p wa -k audit_rules_networkconfig_modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_networkconfig_modification",
      "instructions": "To determine if the system is configured to audit changes to its network configuration,\nrun the following command:\nauditctl -l | grep -E '(/etc/issue|/etc/issue.net|/etc/hosts|/etc/sysconfig/network)'\n\nIf the system is configured to watch for network configuration changes, a line should be returned for\neach file specified (and perm=wa should be indicated for each).",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-networkconfig-modification",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.5",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.5.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-networkconfig-modification",
        "namespace": "openshift-compliance",
        "resourceVersion": "77142",
        "uid": "d5190e9c-0d89-463e-9858-7bd84e48f7a4"
      },
      "rationale": "The network environment should not be modified by anything other than administrator action. Any change to network parameters should be audited.",
      "severity": "medium",
      "title": "Record Events that Modify the System's Network Environment"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The audit system should collect information about usage of privileged commands for all users. These are commands with suid or sgid bits on and they are specially risky in local block device partitions not mounted with noexec and nosuid options. Therefore, these partitions should be first identified by the following command:\n\nfindmnt -n -l -k -it $(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,) | grep -Pv \"noexec|nosuid\"\n\nFor all partitions listed by the previous command, it is necessary to search for setuid / setgid programs using the following command:\n\n$ sudo find PARTITION -xdev -perm /6000 -type f 2>/dev/null\n\nFor each setuid / setgid program identified by the previous command, an audit rule must be present in the appropriate place using the following line structure:\n\n-a always,exit -F path= PROG_PATH -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup, add the line to a file with suffix.rules in the /etc/audit/rules.d directory, replacing the PROG_PATH part with the full path of that setuid / setgid identified program. If the auditd daemon is configured to use the auditctl utility instead, add the line to the /etc/audit/audit.rules file, also replacing the PROG_PATH part with the full path of that setuid / setgid identified program.",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands",
      "instructions": "To verify that auditing of privileged command use is configured, run the following command\nto search privileged commands in relevant partitions and check if they are covered by auditd\nrules:\n\nFILTER_NODEV=$(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,)\nPARTITIONS=$(findmnt -n -l -k -it $FILTER_NODEV | grep -Pv \"noexec|nosuid\" | awk '{ print $1 }')\nfor PARTITION in $PARTITIONS; do\n  for PRIV_CMD in $(find \"${PARTITION}\" -xdev -perm /6000 -type f 2>/dev/null); do\n    grep -qr \"${PRIV_CMD}\" /etc/audit/rules.d /etc/audit/audit.rules &&\n      printf \"OK: ${PRIV_CMD}\\n\" || printf \"WARNING - rule not found for: ${PRIV_CMD}\\n\"\n  done\ndone\n\nThe output should not contain any WARNING.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.2",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands",
        "namespace": "openshift-compliance",
        "resourceVersion": "77489",
        "uid": "f9bc63f5-1a63-4289-bbf1-8f28432bbf02"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern that can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands",
      "warning": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern that can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/at%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_at_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/at -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/at -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_at",
      "instructions": "To verify that auditing of privileged command use is configured, run the\nfollowing command:\n$ sudo grep '\\bat\\b' /etc/audit/audit.rules /etc/audit/rules.d/*\nIt should return a relevant line in the audit rules.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-at",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-at",
        "namespace": "openshift-compliance",
        "resourceVersion": "77493",
        "uid": "3778e9e7-c9d5-4cc6-9e5a-3a8672223658"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - at"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/chage%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_chage_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_chage",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"chage\" command with the following command:\n\n$ sudo auditctl -l | grep chage\n\n-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-chage",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-chage",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-chage",
        "namespace": "openshift-compliance",
        "resourceVersion": "77495",
        "uid": "8c1be757-203d-47a2-8a0b-fba60bd9e6df"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - chage"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/chsh%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_chsh_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/chsh -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/chsh -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_chsh",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"chsh\" command with the following command:\n\n$ sudo auditctl -l | grep chsh\n\n-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=unset -k privileged-chsh",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-chsh",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-chsh",
        "namespace": "openshift-compliance",
        "resourceVersion": "77499",
        "uid": "9ae9f758-88b3-4dbd-a429-ca1677d32e50"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - chsh"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/crontab%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_crontab_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/crontab -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/crontab -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_crontab",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"crontab\" command with the following command:\n\n$ sudo auditctl -l | grep crontab\n\n-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=unset -k privileged-crontab",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-crontab",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:38Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-crontab",
        "namespace": "openshift-compliance",
        "resourceVersion": "77500",
        "uid": "497a265a-8035-4400-be9e-6224884243f3"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - crontab"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/libexec/dbus-1/dbus-daemon-launch-helper-1%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_libexec_dbus-1_dbus-daemon-launch-helper-1_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path= /usr/libexec/dbus-1/dbus-daemon-launch-helper-1 -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path= /usr/libexec/dbus-1/dbus-daemon-launch-helper-1 -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_dbus_daemon_launch_helper",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"/usr/libexec/dbus-1/dbus-daemon-launch-helper-1\" command with the following command:\n\n$ sudo auditctl -l | grep /usr/libexec/dbus-1/dbus-daemon-launch-helper-1\n\n-a always,exit -F path=/usr/bin//usr/libexec/dbus-1/dbus-daemon-launch-helper-1 -F perm=x -F auid>=1000 -F auid!=unset -k privileged-/usr/libexec/dbus-1/dbus-daemon-launch-helper-1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-dbus-daemon-launch-helper"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-dbus-daemon-launch-helper",
        "namespace": "openshift-compliance",
        "resourceVersion": "77509",
        "uid": "276b85fc-6568-46eb-9bcf-f24fafb09516"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - dbus helper"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/fusermount%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_fusermount_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/fusermount -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/fusermount -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_fusermount",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"fusermount\" command with the following command:\n\n$ sudo auditctl -l | grep fusermount\n\n-a always,exit -F path=/usr/bin/fusermount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-fusermount",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-fusermount"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-fusermount",
        "namespace": "openshift-compliance",
        "resourceVersion": "77511",
        "uid": "e01a52bd-038a-4a58-8ef0-db55b885684a"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - fusermount"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/fusermount3%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_fusermount3_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/fusermount3 -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/fusermount3 -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_fusermount3",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"fusermount3\" command with the following command:\n\n$ sudo auditctl -l | grep fusermount3\n\n-a always,exit -F path=/usr/bin/fusermount3 -F perm=x -F auid>=1000 -F auid!=unset -k privileged-fusermount3",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-fusermount3"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-fusermount3",
        "namespace": "openshift-compliance",
        "resourceVersion": "77510",
        "uid": "2e4bd4b0-7d6a-4ce8-8c3b-f9faa16057b3"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - fusermount3"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/gpasswd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_gpasswd_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_gpasswd",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"gpasswd\" command with the following command:\n\n$ sudo auditctl -l | grep gpasswd\n\n-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-gpasswd",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-gpasswd",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-gpasswd",
        "namespace": "openshift-compliance",
        "resourceVersion": "77520",
        "uid": "afc70067-a6cd-4017-bc00-9222bdfe2a5c"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - gpasswd"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/grub2-set-bootflag%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_grub2-set-bootflag_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/grub2-set-bootflag -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path= /usr/sbin/grub2-set-bootflag-F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_grub2_set_bootflag",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"/usr/sbin/grub2-set-bootflag\" command with the following command:\n\n$ sudo auditctl -l | grep /usr/sbin/grub2-set-bootflag\n\n-a always,exit -F path=/usr/bin//usr/sbin/grub2-set-bootflag -F perm=x -F auid>=1000 -F auid!=unset -k privileged-/usr/sbin/grub2-set-bootflag",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-grub2-set-bootflag"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-grub2-set-bootflag",
        "namespace": "openshift-compliance",
        "resourceVersion": "77517",
        "uid": "95fb8e23-004e-441e-b4f6-f894a0541afa"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - grub2_set_bootflag"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/mount%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_mount_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_mount",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"mount\" command with the following command:\n\n$ sudo auditctl -l | grep mount\n\n-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-mount",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-mount",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-mount",
        "namespace": "openshift-compliance",
        "resourceVersion": "77534",
        "uid": "6a6d6c72-934c-4104-873d-d93837efa2d1"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - mount"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/mount.nfs%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_mount.nfs_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/mount.nfs -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path= /usr/sbin/mount.nfs perm_x }}}-F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_mount_nfs",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"/usr/sbin/mount.nfs\" command with the following command:\n\n$ sudo auditctl -l | grep /usr/sbin/mount.nfs\n\n-a always,exit -F path=/usr/bin//usr/sbin/mount.nfs -F perm=x -F auid>=1000 -F auid!=unset -k privileged-/usr/sbin/mount.nfs",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-mount-nfs"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-mount-nfs",
        "namespace": "openshift-compliance",
        "resourceVersion": "77535",
        "uid": "401e08ad-254b-4bcd-9096-757b6049eb1d"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - mount.nfs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/newgidmap%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_newgidmap_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/newgidmap -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/newgidmap -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_newgidmap",
      "instructions": "To verify that auditing of privileged command use is configured, run the\nfollowing command:\n$ sudo grep newgidmap /etc/audit/audit.rules /etc/audit/rules.d/*\nIt should return a relevant line in the audit rules.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-newgidmap",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:39Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-newgidmap",
        "namespace": "openshift-compliance",
        "resourceVersion": "77523",
        "uid": "38b6b8e3-35a8-4c4a-a2aa-ebd8e5aa8ac5"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - newgidmap"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/newgrp%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_newgrp_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_newgrp",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"newgrp\" command with the following command:\n\n$ sudo auditctl -l | grep newgrp\n\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -k privileged-newgrp",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-newgrp",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-newgrp",
        "namespace": "openshift-compliance",
        "resourceVersion": "77553",
        "uid": "194919fc-7725-4a9f-9d77-635d887958e3"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - newgrp"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/newuidmap%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_newuidmap_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/newuidmap -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/newuidmap -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_newuidmap",
      "instructions": "To verify that auditing of privileged command use is configured, run the\nfollowing command:\n$ sudo grep newuidmap /etc/audit/audit.rules /etc/audit/rules.d/*\nIt should return a relevant line in the audit rules.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-newuidmap",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-newuidmap",
        "namespace": "openshift-compliance",
        "resourceVersion": "77543",
        "uid": "27653f53-3494-4ed2-aeed-cc07dedfcb4a"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - newuidmap"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/pam_timestamp_check%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_pam_timestamp_check_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/pam_timestamp_check\n-F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/pam_timestamp_check\n-F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_pam_timestamp_check",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"pam_timestamp_check\" command with the following command:\n\n$ sudo auditctl -l | grep pam_timestamp_check\n\n-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=unset -k privileged-pam_timestamp_check",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-pam-timestamp-check",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-pam-timestamp-check",
        "namespace": "openshift-compliance",
        "resourceVersion": "77552",
        "uid": "8a39cc23-55bb-4e34-ace8-479cfdbb6d32"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - pam_timestamp_check"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/passwd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_passwd_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_passwd",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"passwd\" command with the following command:\n\n$ sudo auditctl -l | grep passwd\n\n-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-passwd",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-passwd",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-passwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "77561",
        "uid": "436e59e6-7a74-450d-a0db-25fd1ef5a134"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - passwd"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/pkexec%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_pkexec_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/pkexec -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/pkexec -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_pkexec",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"pkexec\" command with the following command:\n\n$ sudo auditctl -l | grep pkexec\n\n-a always,exit -F path=/usr/bin/pkexec -F perm=x -F auid>=1000 -F auid!=unset -k privileged-pkexec",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-pkexec"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-pkexec",
        "namespace": "openshift-compliance",
        "resourceVersion": "77555",
        "uid": "dae29c41-4e0e-481e-9303-9dad7942c96a"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - pkexec"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/lib/polkit-1/polkit-agent-helper-1%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_lib_polkit-1_polkit-agent-helper-1_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path= /usr/lib/polkit-1/polkit-agent-helper-1-F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path= /usr/lib/polkit-1/polkit-agent-helper-1-F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_polkit_helper",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"/usr/lib/polkit-1/polkit-agent-helper-1\" command with the following command:\n\n$ sudo auditctl -l | grep /usr/lib/polkit-1/polkit-agent-helper-1\n\n-a always,exit -F path=/usr/bin//usr/lib/polkit-1/polkit-agent-helper-1 -F perm=x -F auid>=1000 -F auid!=unset -k privileged-/usr/lib/polkit-1/polkit-agent-helper-1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-polkit-helper"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-polkit-helper",
        "namespace": "openshift-compliance",
        "resourceVersion": "77579",
        "uid": "fb59117f-8a9a-4a87-b1aa-33b5bd3ffa58"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - polkit helper"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/postdrop%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_postdrop_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/postdrop -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/postdrop -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_postdrop",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"postdrop\" command with the following command:\n\n$ sudo auditctl -l | grep postdrop\n\n-a always,exit -F path=/usr/bin/postdrop -F perm=x -F auid>=1000 -F auid!=unset -k privileged-postdrop",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-postdrop",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-postdrop",
        "namespace": "openshift-compliance",
        "resourceVersion": "77565",
        "uid": "b6dfb680-e023-4571-9aa0-d92fd497cb95"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - postdrop"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/postqueue%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_postqueue_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/postqueue -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/postqueue -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_postqueue",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"postqueue\" command with the following command:\n\n$ sudo auditctl -l | grep postqueue\n\n-a always,exit -F path=/usr/bin/postqueue -F perm=x -F auid>=1000 -F auid!=unset -k privileged-postqueue",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-postqueue",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-postqueue",
        "namespace": "openshift-compliance",
        "resourceVersion": "77558",
        "uid": "22d9fbda-1383-46df-b977-af6e6fc82118"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - postqueue"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/libexec/pt_chown%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_libexec_pt_chown_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/libexec/pt_chown -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/libexec/pt_chown -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_pt_chown",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"pt_chown\" command with the following command:\n\n$ sudo auditctl -l | grep pt_chown\n\n-a always,exit -F path=/usr/libexec/pt_chown -F perm=x -F auid>=1000 -F auid!=unset -k privileged-pt_chown",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-pt-chown",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-pt-chown",
        "namespace": "openshift-compliance",
        "resourceVersion": "77560",
        "uid": "8c278dd2-20cf-4d9b-9bef-2bef0b18e99a"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - pt_chown"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/libexec/openssh/ssh-keysign%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_libexec_openssh_ssh-keysign_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_ssh_keysign",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"ssh-keysign\" command with the following command:\n\n$ sudo auditctl -l | grep ssh-keysign\n\n-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh-keysign",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-ssh-keysign",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-ssh-keysign",
        "namespace": "openshift-compliance",
        "resourceVersion": "77593",
        "uid": "0244aade-c87c-40e5-b916-bee5a5ed7712"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - ssh-keysign"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/libexec/sssd/krb5_child%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_libexec_sssd_krb5_child_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/libexec/sssd/krb5_child -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/libexec/sssd/krb5_child -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sssd_krb5_child",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"/usr/libexec/sssd/krb5_child\" command with the following command:\n\n$ sudo auditctl -l | grep /usr/libexec/sssd/krb5_child\n\n-a always,exit -F path=/usr/bin//usr/libexec/sssd/krb5_child -F perm=x -F auid>=1000 -F auid!=unset -k privileged-/usr/libexec/sssd/krb5_child",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-sssd-krb5-child"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-sssd-krb5-child",
        "namespace": "openshift-compliance",
        "resourceVersion": "77570",
        "uid": "fc4b7a42-60aa-4fba-be03-36e1fccb47aa"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - sssd_krb5_child"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/libexec/sssd/ldap_child%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_libexec_sssd_ldap_child_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/libexec/sssd/ldap_child -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/libexec/sssd/ldap_child -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sssd_ldap_child",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"/usr/libexec/sssd/ldap_child\" command with the following command:\n\n$ sudo auditctl -l | grep /usr/libexec/sssd/ldap_child\n\n-a always,exit -F path=/usr/bin//usr/libexec/sssd/ldap_child -F perm=x -F auid>=1000 -F auid!=unset -k privileged-/usr/libexec/sssd/ldap_child",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-sssd-ldap-child"
        },
        "creationTimestamp": "2024-03-05T15:02:40Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-sssd-ldap-child",
        "namespace": "openshift-compliance",
        "resourceVersion": "77578",
        "uid": "8ce28e42-927c-4bc1-bf12-29cd76f3c6ab"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - sssd_ldap_child"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/libexec/sssd/proxy_child%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_libexec_sssd_proxy_child_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/libexec/sssd/proxy_child -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/libexec/sssd/proxy_child -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sssd_proxy_child",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"/usr/libexec/sssd/proxy_child\" command with the following command:\n\n$ sudo auditctl -l | grep /usr/libexec/sssd/proxy_child\n\n-a always,exit -F path=/usr/bin//usr/libexec/sssd/proxy_child -F perm=x -F auid>=1000 -F auid!=unset -k privileged-/usr/libexec/sssd/proxy_child",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-sssd-proxy-child"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-sssd-proxy-child",
        "namespace": "openshift-compliance",
        "resourceVersion": "77588",
        "uid": "51320491-1460-4479-a423-493de86a8b63"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - sssd_proxy_child"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/libexec/sssd/selinux_child%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_libexec_sssd_selinux_child_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/libexec/sssd/selinux_child -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/libexec/sssd/selinux_child -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sssd_selinux_child",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"/usr/libexec/sssd/selinux_child\" command with the following command:\n\n$ sudo auditctl -l | grep /usr/libexec/sssd/selinux_child\n\n-a always,exit -F path=/usr/bin//usr/libexec/sssd/selinux_child -F perm=x -F auid>=1000 -F auid!=unset -k privileged-/usr/libexec/sssd/selinux_child",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-sssd-selinux-child"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-sssd-selinux-child",
        "namespace": "openshift-compliance",
        "resourceVersion": "77580",
        "uid": "9fb5b261-1751-4868-b868-68e270ce70ff"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - sssd_selinux_child"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/su%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_su_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_su",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"su\" command with the following command:\n\n$ sudo auditctl -l | grep su\n\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=unset -k privileged-su",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-su",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-su",
        "namespace": "openshift-compliance",
        "resourceVersion": "77584",
        "uid": "e1699268-af0e-4b4a-8878-e6a1899d5b36"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - su"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/sudo%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_sudo_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sudo",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"sudo\" command with the following command:\n\n$ sudo auditctl -l | grep sudo\n\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -k privileged-sudo",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-high-rev-4,rhcos4-stig,rhcos4-anssi-bp28-high,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-sudo",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-sudo",
        "namespace": "openshift-compliance",
        "resourceVersion": "77589",
        "uid": "8f33f18a-6955-47c5-b790-f3e23788a2b5"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - sudo"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/sudoedit%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_sudoedit_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/sudoedit -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/sudoedit -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sudoedit",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"sudoedit\" command with the following command:\n\n$ sudo auditctl -l | grep sudoedit\n\n-a always,exit -F path=/usr/bin/sudoedit -F perm=x -F auid>=1000 -F auid!=unset -k privileged-sudoedit",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-sudoedit",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-sudoedit",
        "namespace": "openshift-compliance",
        "resourceVersion": "77587",
        "uid": "cf3ce38e-9d1e-4f07-aed7-7d3545e01950"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - sudoedit"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/umount%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_umount_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_umount",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"umount\" command with the following command:\n\n$ sudo auditctl -l | grep umount\n\n-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-umount",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-umount",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-umount",
        "namespace": "openshift-compliance",
        "resourceVersion": "77592",
        "uid": "cff5c583-1177-40d9-972e-e3775a1620f2"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - umount"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/unix_chkpwd%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_unix_chkpwd_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_unix_chkpwd",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"unix_chkpwd\" command with the following command:\n\n$ sudo auditctl -l | grep unix_chkpwd\n\n-a always,exit -F path=/usr/bin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix_chkpwd",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-unix-chkpwd",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-3;AU-3.1;AU-12(a);AU-12(c);AU-12.1(ii);AU-12.1(iv);AC-6(9);CM-6(a);MA-4(1)(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,CIP-007-3 R6.5,AC-2(4),AU-2(d),AU-3,AU-3.1,AU-12(a),AU-12(c),AU-12.1(ii),AU-12.1(iv),AC-6(9),CM-6(a),MA-4(1)(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-unix-chkpwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "77597",
        "uid": "5ee7e697-c362-4f9f-bcbc-3177743d6cb4"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - unix_chkpwd"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/userhelper%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_userhelper_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/userhelper -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/userhelper -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_userhelper",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"userhelper\" command with the following command:\n\n$ sudo auditctl -l | grep userhelper\n\n-a always,exit -F path=/usr/bin/userhelper -F perm=x -F auid>=1000 -F auid!=unset -k privileged-userhelper",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-userhelper",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-userhelper",
        "namespace": "openshift-compliance",
        "resourceVersion": "77602",
        "uid": "35e71922-b8fa-47a4-aaef-4fd6ef23f2a4"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - userhelper"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/sbin/usernetctl%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_sbin_usernetctl_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/sbin/usernetctl -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/sbin/usernetctl -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_usernetctl",
      "instructions": "To verify that auditing of privileged command use is configured, run the\nfollowing command:\n$ sudo grep usernetctl /etc/audit/audit.rules /etc/audit/rules.d/*\nIt should return a relevant line in the audit rules.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-usernetctl",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-usernetctl",
        "namespace": "openshift-compliance",
        "resourceVersion": "77614",
        "uid": "92183951-8d36-4177-921c-d89bf679436e"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - usernetctl"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/libexec/utempter%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_libexec_utempter_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path= /usr/libexec/utempter -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path= /usr/libexec/utempter -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_utempter",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"/usr/libexec/utempter\" command with the following command:\n\n$ sudo auditctl -l | grep /usr/libexec/utempter\n\n-a always,exit -F path=/usr/bin//usr/libexec/utempter -F perm=x -F auid>=1000 -F auid!=unset -k privileged-/usr/libexec/utempter",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-utempter"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-utempter",
        "namespace": "openshift-compliance",
        "resourceVersion": "77609",
        "uid": "16b09935-7072-4690-98ba-007f2fc293ec"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - utempter"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20path%3D/usr/bin/write%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dprivileged%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-usr_bin_write_execution.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect the execution of privileged commands for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add a line of the following form to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F path=/usr/bin/write -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add a line of the following form to /etc/audit/audit.rules :\n\n-a always,exit -F path=/usr/bin/write -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_write",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to audit the execution of the \"write\" command with the following command:\n\n$ sudo auditctl -l | grep write\n\n-a always,exit -F path=/usr/bin/write -F perm=x -F auid>=1000 -F auid!=unset -k privileged-write",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-privileged-commands-write"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-privileged-commands-write",
        "namespace": "openshift-compliance",
        "resourceVersion": "77613",
        "uid": "9c637155-c21f-4688-a23c-5bf2a5288b89"
      },
      "rationale": "Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider and advanced persistent threats.\n\nPrivileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity.",
      "severity": "medium",
      "title": "Ensure auditd Collects Information on the Use of Privileged Commands - write"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A-w%20/var/run/utmp%20-p%20wa%20-k%20session%0A-w%20/var/log/btmp%20-p%20wa%20-k%20session%0A-w%20/var/log/wtmp%20-p%20wa%20-k%20session%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-audit-session-events.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system already collects process information for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d in order to watch for attempted manual edits of files involved in storing such process information:\n\n-w /var/run/utmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file in order to watch for attempted manual edits of files involved in storing such process information:\n\n-w /var/run/utmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n-w /var/log/wtmp -p wa -k session",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_session_events",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-high-rev-4,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-session-events",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.3",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-session-events",
        "namespace": "openshift-compliance",
        "resourceVersion": "77146",
        "uid": "a12b2b1b-5f95-4001-aef5-f355c3181aee"
      },
      "rationale": "Manual editing of these files may indicate nefarious activity, such as an attacker attempting to remove evidence of an intrusion.",
      "severity": "medium",
      "title": "Record Attempts to Alter Process and Session Initiation Information"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -w%20/etc/sudoers.d/%20-p%20wa%20-k%20actions%0A-w%20/etc/sudoers%20-p%20wa%20-k%20actions%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-audit-sysadmin-actions.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect administrator actions for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-w /etc/sudoers -p wa -k actions\n-w /etc/sudoers.d/ -p wa -k actions\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-w /etc/sudoers -p wa -k actions\n-w /etc/sudoers.d/ -p wa -k actions",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_sysadmin_actions",
      "instructions": "To verify that auditing is configured for system administrator actions, run the following command:\n$ sudo auditctl -l | grep \"watch=/etc/sudoers\\|watch=/etc/sudoers.d\\|-w /etc/sudoers\\|-w /etc/sudoers.d\"",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-moderate,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-sysadmin-actions",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(7)(b);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.2;Req-10.2.5.b",
          "policies.open-cluster-management.io/controls": "AC-2(7)(b),AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.2,Req-10.2.5.b",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-sysadmin-actions",
        "namespace": "openshift-compliance",
        "resourceVersion": "77148",
        "uid": "f36e79f6-492c-4b32-a26d-3fedfccdc557"
      },
      "rationale": "The actions taken by system administrators should be audited to keep a record of what was executed on the system, as well as, for accountability purposes.",
      "severity": "medium",
      "title": "Ensure auditd Collects System Administrator Actions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -a%20always%2Cexit%20-F%20arch%3Db64%20-S%20adjtimex%20-k%20audit_time_rules%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20adjtimex%20-k%20audit_time_rules%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-syscall-adjtimex.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S adjtimex -F key=audit_time_rules\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S adjtimex -F key=audit_time_rules\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S adjtimex -F key=audit_time_rules\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S adjtimex -F key=audit_time_rules\n\nThe -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:\n\n-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_time_adjtimex",
      "instructions": "To determine if the system is configured to audit calls to the\nadjtimex system call, run the following command:\n$ sudo grep \"adjtimex\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-time-adjtimex",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.2.b",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.4.2.b",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:41Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-time-adjtimex",
        "namespace": "openshift-compliance",
        "resourceVersion": "77604",
        "uid": "748e99cb-e791-44d1-8ec0-aa5b661cd9b0"
      },
      "rationale": "Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.",
      "severity": "medium",
      "title": "Record attempts to alter time through adjtimex"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -a%20always%2Cexit%20-F%20arch%3Db64%20-S%20clock_settime%20-F%20a0%3D0x0%20-k%20time-change%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20clock_settime%20-F%20a0%3D0x0%20-k%20time-change%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-syscall-clock-settime.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -F key=time-change\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S clock_settime -F a0=0x0 -F key=time-change\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -F key=time-change\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S clock_settime -F a0=0x0 -F key=time-change\n\nThe -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:\n\n-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_time_clock_settime",
      "instructions": "To determine if the system is configured to audit calls to the\nclock_settime system call, run the following command:\n$ sudo grep \"clock_settime\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-time-clock-settime",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.2.b",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.4.2.b",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-time-clock-settime",
        "namespace": "openshift-compliance",
        "resourceVersion": "77616",
        "uid": "3ce8490c-eceb-4d9e-abb4-eab353b64408"
      },
      "rationale": "Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.",
      "severity": "medium",
      "title": "Record Attempts to Alter Time Through clock_settime"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -a%20always%2Cexit%20-F%20arch%3Db64%20-S%20settimeofday%20-k%20audit_time_rules%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20settimeofday%20-k%20audit_time_rules%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-syscall-settimeofday.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S settimeofday -F key=audit_time_rules\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S settimeofday -F key=audit_time_rules\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S settimeofday -F key=audit_time_rules\n\nIf the system is 64 bit then also add the following line:\n\n-a always,exit -F arch=b64 -S settimeofday -F key=audit_time_rules\n\nThe -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls:\n\n-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_time_settimeofday",
      "instructions": "To determine if the system is configured to audit calls to the\nsettimeofday system call, run the following command:\n$ sudo grep \"settimeofday\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-time-settimeofday",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.2.b",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.4.2.b",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-time-settimeofday",
        "namespace": "openshift-compliance",
        "resourceVersion": "77619",
        "uid": "533db7fc-48cc-46b4-a475-ec0befa8ec34"
      },
      "rationale": "Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.",
      "severity": "medium",
      "title": "Record attempts to alter time through settimeofday"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -a%20always%2Cexit%20-F%20arch%3Db64%20-S%20stime%20-k%20audit_time_rules%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20stime%20-k%20audit_time_rules%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-syscall-stime.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d for both 32 bit and 64 bit systems:\n\n-a always,exit -F arch=b32 -S stime -F key=audit_time_rules\n\nSince the 64 bit version of the \"stime\" system call is not defined in the audit lookup table, the corresponding \"-F arch=b64\" form of this rule is not expected to be defined on 64 bit systems (the aforementioned \"-F arch=b32\" stime rule form itself is sufficient for both 32 bit and 64 bit systems). If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file for both 32 bit and 64 bit systems:\n\n-a always,exit -F arch=b32 -S stime -F key=audit_time_rules\n\nSince the 64 bit version of the \"stime\" system call is not defined in the audit lookup table, the corresponding \"-F arch=b64\" form of this rule is not expected to be defined on 64 bit systems (the aforementioned \"-F arch=b32\" stime rule form itself is sufficient for both 32 bit and 64 bit systems). The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined system calls:\n\n-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=audit_time_rules",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_time_stime",
      "instructions": "If the system is not configured to audit time changes, this is a finding.\nIf the system is 64-bit only, this is not applicable\nocil: |\nTo determine if the system is configured to audit calls to the\nstime system call, run the following command:\n$ sudo grep \"stime\" /etc/audit/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "audit-rules-time-stime",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.2.b",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.4.2.b",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-time-stime",
        "namespace": "openshift-compliance",
        "resourceVersion": "77622",
        "uid": "737a2882-6b28-40e7-b366-fba8f0a06988"
      },
      "rationale": "Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.",
      "severity": "medium",
      "title": "Record Attempts to Alter Time Through stime"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -w%20/etc/localtime%20-p%20wa%20-k%20audit_time_rules%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-etclocaltime-wa-audit_time_rules.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following line to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-w /etc/localtime -p wa -k audit_time_rules\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following line to /etc/audit/audit.rules file:\n\n-w /etc/localtime -p wa -k audit_time_rules\n\nThe -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport and should always be used.",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_time_watch_localtime",
      "instructions": "To determine if the system is configured to audit attempts to\nalter time via the /etc/localtime file, run the following\ncommand:\n$ sudo auditctl -l | grep \"watch=/etc/localtime\"\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "audit-rules-time-watch-localtime",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.2.b",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.4.2.b",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-time-watch-localtime",
        "namespace": "openshift-compliance",
        "resourceVersion": "77623",
        "uid": "b28005a6-a53b-4302-9b65-9325338bc951"
      },
      "rationale": "Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited.",
      "severity": "medium",
      "title": "Record Attempts to Alter the localtime File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "At a minimum the audit system should collect unauthorized file accesses for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification",
      "instructions": "To verify that the audit system collects unauthorized file accesses, run the following commands:\n$ sudo grep EACCES /etc/audit/audit.rules\n$ sudo grep EPERM /etc/audit/audit.rules",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:33Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification",
        "namespace": "openshift-compliance",
        "resourceVersion": "77302",
        "uid": "9cd1fd0f-05b3-439a-a08d-d307ebb6293e"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Ensure auditd Collects Unauthorized Access Attempts to Files (unsuccessful)",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20chmod%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20chmod%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20chmod%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20chmod%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-chmod_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file permission change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S chmod -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S chmod -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S chmod -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S chmod -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_chmod",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the chmod system call, run the following command:\n$ sudo grep \"chmod\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-chmod",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-chmod",
        "namespace": "openshift-compliance",
        "resourceVersion": "77306",
        "uid": "d169de4f-f86b-448b-9205-fdd8646180f5"
      },
      "rationale": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Permission Changes to Files - chmod",
      "warning": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20chown%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20chown%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20chown%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20chown%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-chown_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file ownership change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S chown -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S chown -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S chown -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S chown -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_chown",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the chown system call, run the following command:\n$ sudo grep \"chown\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-chown",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-chown",
        "namespace": "openshift-compliance",
        "resourceVersion": "77310",
        "uid": "ec6f4832-3fa0-4ecd-8eb5-b9774b6196da"
      },
      "rationale": "Unsuccessful attempts to change ownership of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Ownership Changes to Files - chown",
      "warning": "Unsuccessful attempts to change ownership of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect unauthorized file accesses for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_creat",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the creat system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r creat /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep creat /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-creat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-creat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77318",
        "uid": "8813ce66-11e5-44e4-8486-62258ab8fb3c"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Access Attempts to Files - creat",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchmod%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchmod%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchmod%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchmod%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fchmod_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file permission change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S fchmod -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S fchmod -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S fchmod -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S fchmod -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_fchmod",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the fchmod system call, run the following command:\n$ sudo grep \"fchmod\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-fchmod",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-fchmod",
        "namespace": "openshift-compliance",
        "resourceVersion": "77321",
        "uid": "288fd6e7-fdc9-4431-a55a-a5daf48c65fc"
      },
      "rationale": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Permission Changes to Files - fchmod",
      "warning": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchmodat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchmodat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchmodat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchmodat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fchmodat_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file permission change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S fchmodat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S fchmodat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S fchmodat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S fchmodat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_fchmodat",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the fchmodat system call, run the following command:\n$ sudo grep \"fchmodat\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-fchmodat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-fchmodat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77322",
        "uid": "a4f24904-1965-457b-9e0a-d36121cdbe17"
      },
      "rationale": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Permission Changes to Files - fchmodat",
      "warning": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchown%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchown%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchown%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchown%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fchown_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file ownership change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S fchown -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S fchown -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S fchown -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S fchown -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_fchown",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the fchown system call, run the following command:\n$ sudo grep \"fchown\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-fchown",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-fchown",
        "namespace": "openshift-compliance",
        "resourceVersion": "77325",
        "uid": "b7152d6e-8663-48fd-8a8b-d558440c20d8"
      },
      "rationale": "Unsuccessful attempts to change ownership of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Ownership Changes to Files - fchown",
      "warning": "Unsuccessful attempts to change ownership of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchownat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fchownat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchownat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fchownat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fchownat_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file ownership change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S fchownat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S fchownat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_fchownat",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the fchownat system call, run the following command:\n$ sudo grep \"fchownat\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-fchownat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-fchownat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77328",
        "uid": "66bda01b-886d-46b7-90dc-b9b7ed2a2862"
      },
      "rationale": "Unsuccessful attempts to change ownership of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Ownership Changes to Files - fchownat",
      "warning": "Unsuccessful attempts to change ownership of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fremovexattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fremovexattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fremovexattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fremovexattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fremovexattr_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file permission change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S fremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S fremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S fremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S fremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_fremovexattr",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the fremovexattr system call, run the following command:\n$ sudo grep \"fremovexattr\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-fremovexattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-fremovexattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77336",
        "uid": "a6678122-1182-424a-9d1e-962c965df7b2"
      },
      "rationale": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Permission Changes to Files - fremovexattr",
      "warning": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fsetxattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20fsetxattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fsetxattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20fsetxattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-fsetxattr_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file permission change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S fsetxattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S fsetxattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S fsetxattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S fsetxattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_fsetxattr",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the fsetxattr system call, run the following command:\n$ sudo grep \"fsetxattr\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-fsetxattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-fsetxattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77340",
        "uid": "542abf1f-89a3-48b0-b381-77ce203f44f2"
      },
      "rationale": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Permission Changes to Files - fsetxattr",
      "warning": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect unauthorized file accesses for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_ftruncate",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the ftruncate system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r ftruncate /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep ftruncate /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-moderate-rev-4,rhcos4-stig,rhcos4-high,rhcos4-high-rev-4,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-ftruncate",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:34Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-ftruncate",
        "namespace": "openshift-compliance",
        "resourceVersion": "77342",
        "uid": "9115e835-511e-4935-99e3-ba53a6601759"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Access Attempts to Files - ftruncate",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20lchown%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20lchown%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20lchown%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20lchown%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-lchown_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file ownership change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S lchown -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S lchown -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S lchown -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S lchown -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_lchown",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the lchown system call, run the following command:\n$ sudo grep \"lchown\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-lchown",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-lchown",
        "namespace": "openshift-compliance",
        "resourceVersion": "77345",
        "uid": "008ade7a-4d70-4680-aaa0-bf0a6e2f2712"
      },
      "rationale": "Unsuccessful attempts to change ownership of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Ownership Changes to Files - lchown",
      "warning": "Unsuccessful attempts to change ownership of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20lremovexattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20lremovexattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20lremovexattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20lremovexattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-lremovexattr_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file permission change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S lremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S lremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S lremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S lremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_lremovexattr",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the lremovexattr system call, run the following command:\n$ sudo grep \"lremovexattr\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-lremovexattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-lremovexattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77348",
        "uid": "054067d1-16d3-4251-b651-42fb0d266779"
      },
      "rationale": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Permission Changes to Files - lremovexattr",
      "warning": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20lsetxattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20lsetxattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20lsetxattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20lsetxattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-lsetxattr_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file permission change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S lsetxattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S lsetxattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S lsetxattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S lsetxattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_lsetxattr",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the lsetxattr system call, run the following command:\n$ sudo grep \"lsetxattr\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-lsetxattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-lsetxattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77355",
        "uid": "479bd6a9-dea5-4b4b-9273-6be5c042a806"
      },
      "rationale": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Permission Changes to Files - lsetxattr",
      "warning": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect unauthorized file accesses for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the open system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r open /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep open /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-enhanced,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-open",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-open",
        "namespace": "openshift-compliance",
        "resourceVersion": "77358",
        "uid": "ba458288-abbb-465e-b637-5681cb73e711"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Access Attempts to Files - open",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect unauthorized file accesses for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_by_handle_at",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the open_by_handle_at system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r open_by_handle_at /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep open_by_handle_at /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-open-by-handle-at",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-open-by-handle-at",
        "namespace": "openshift-compliance",
        "resourceVersion": "77363",
        "uid": "c0918adf-c0b0-4f57-8505-c5ed7ac32896"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Access Attempts to Files - open_by_handle_at",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unauthorized file accesses for all users and root. The open_by_handle_at syscall can be used to create new files when O_CREAT flag is specified. The following auidt rules will asure that unsuccessful attempts to create a file via open_by_handle_at syscall are collected. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rules below to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rules below to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_by_handle_at_o_creat",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to create files using the open_by_handle_at system call with O_CREAT flag.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r open_by_handle_at /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep open_by_handle_at /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-open-by-handle-at-o-creat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-open-by-handle-at-o-creat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77367",
        "uid": "f843fd21-91b9-44d6-9c76-501bc49f8ae0"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Creation Attempts to Files - open_by_handle_at O_CREAT",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect detailed unauthorized file accesses for all users and root. The open_by_handle_at syscall can be used to modify files if called for write operation of with O_TRUNC_WRITE flag. The following auidt rules will asure that unsuccessful attempts to modify a file via open_by_handle_at syscall are collected. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rules below to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rules below to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_by_handle_at_o_trunc_write",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to modify files using the open_by_handle_at system call with O_TRUNC_WRITE flag.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r open_by_handle_at /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep open_by_handle_at /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-open-by-handle-at-o-trunc-write",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-open-by-handle-at-o-trunc-write",
        "namespace": "openshift-compliance",
        "resourceVersion": "77371",
        "uid": "2f135658-5d6f-4c16-b263-a222aac37c20"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Modification Attempts to Files - open_by_handle_at O_TRUNC_WRITE",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The audit system should collect detailed unauthorized file accesses for all users and root. To correctly identify unsuccessful creation, unsuccessful modification and unsuccessful access of files via open_by_handle_at syscall the audit rules collecting these events need to be in certain order. The more specific rules need to come before the less specific rules. The reason for that is that more specific rules cover a subset of events covered in the less specific rules, thus, they need to come before to not be overshadowed by less specific rules, which match a bigger set of events. Make sure that rules for unsuccessful calls of open_by_handle_at syscall are in the order shown below. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), check the order of rules below in a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, check the order of rules below in /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b32 -S open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b64 -S open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_by_handle_at_rule_order",
      "instructions": "Verify that rules for unsuccessful calls of the open_by_handle_at syscall are in the order shown below.\n\n    If the auditd daemon is configured to use the \"augenrules\" program to read audit rules during daemon startup (the default), check the order of rules below in a file with suffix \".rules\" in the directory \"/etc/audit/rules.d\".\n    If the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, check the order of rules below in \"/etc/audit/audit.rules\" file.\n\n    -a always,exit -F arch=b32 -S open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b32 -S open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b32 -S open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b32 -S open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n    -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n\n    If the system is 64 bit then also add the following lines:\n\n    -a always,exit -F arch=b64 -S open_by_handle_at -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b64 -S open_by_handle_at -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b64 -S open_by_handle_at -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b64 -S open_by_handle_at -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n    -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-open-by-handle-at-rule-order",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-open-by-handle-at-rule-order",
        "namespace": "openshift-compliance",
        "resourceVersion": "77379",
        "uid": "a233d88f-a05e-426b-a61c-d485f1ee6809"
      },
      "rationale": "The more specific rules cover a subset of events covered by the less specific rules. By ordering them from more specific to less specific, it is assured that the less specific rule will not catch events better recorded by the more specific rule.",
      "severity": "medium",
      "title": "Ensure auditd Unauthorized Access Attempts To open_by_handle_at Are Ordered Correctly"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unauthorized file accesses for all users and root. The open syscall can be used to create new files when O_CREAT flag is specified. The following auidt rules will asure that unsuccessful attempts to create a file via open syscall are collected. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rules below to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rules below to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_o_creat",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to create files using the open system call with O_CREAT flag.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r open /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep open /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-open-o-creat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-open-o-creat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77383",
        "uid": "1a13c804-3ead-4255-9738-d0c015f7b46a"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Creation Attempts to Files - open O_CREAT",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect detailed unauthorized file accesses for all users and root. The open syscall can be used to modify files if called for write operation of with O_TRUNC_WRITE flag. The following auidt rules will asure that unsuccessful attempts to modify a file via open syscall are collected. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rules below to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rules below to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_o_trunc_write",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to modify files using the open system call with O_TRUNC_WRITE flag.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r open /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep open /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-open-o-trunc-write",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:35Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-open-o-trunc-write",
        "namespace": "openshift-compliance",
        "resourceVersion": "77385",
        "uid": "9213295f-1970-45a7-a372-9fd3f34c04e9"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Modification Attempts to Files - open O_TRUNC_WRITE",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The audit system should collect detailed unauthorized file accesses for all users and root. To correctly identify unsuccessful creation, unsuccessful modification and unsuccessful access of files via open syscall the audit rules collecting these events need to be in certain order. The more specific rules need to come before the less specific rules. The reason for that is that more specific rules cover a subset of events covered in the less specific rules, thus, they need to come before to not be overshadowed by less specific rules, which match a bigger set of events. Make sure that rules for unsuccessful calls of open syscall are in the order shown below. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), check the order of rules below in a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, check the order of rules below in /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_rule_order",
      "instructions": "Verify that rules for unsuccessful calls of the open syscall are in the order shown below.\n\n    If the auditd daemon is configured to use the \"augenrules\" program to read audit rules during daemon startup (the default), check the order of rules below in a file with suffix \".rules\" in the directory \"/etc/audit/rules.d\".\n    If the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, check the order of rules below in \"/etc/audit/audit.rules\" file.\n\n    -a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b32 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b32 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n    -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n\n    If the system is 64 bit then also add the following lines:\n\n    -a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b64 -S open -F a1&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b64 -S open -F a1&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n    -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-open-rule-order",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-open-rule-order",
        "namespace": "openshift-compliance",
        "resourceVersion": "77390",
        "uid": "819cba61-3f0b-4381-924c-12e38573bcf6"
      },
      "rationale": "The more specific rules cover a subset of events covered by the less specific rules. By ordering them from more specific to less specific, it is assured that the less specific rule will not catch events better recorded by the more specific rule.",
      "severity": "medium",
      "title": "Ensure auditd Rules For Unauthorized Attempts To open Are Ordered Correctly"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect unauthorized file accesses for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_openat",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the openat system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r openat /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep openat /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-high,rhcos4-nerc-cip,rhcos4-high,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-openat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-openat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77398",
        "uid": "faea6558-23fd-49bf-93af-9e26409a73cd"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Access Attempts to Files - openat",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unauthorized file accesses for all users and root. The openat syscall can be used to create new files when O_CREAT flag is specified. The following auidt rules will asure that unsuccessful attempts to create a file via openat syscall are collected. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rules below to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rules below to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S openat -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S openat -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S openat -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S openat -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_openat_o_creat",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to create files using the openat system call with O_CREAT flag.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r openat /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep openat /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S openat -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S openat -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S openat -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S openat -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-openat-o-creat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-openat-o-creat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77405",
        "uid": "df692ca1-2474-439a-a795-5bed0ee556fb"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Creation Attempts to Files - openat O_CREAT",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect detailed unauthorized file accesses for all users and root. The openat syscall can be used to modify files if called for write operation of with O_TRUNC_WRITE flag. The following auidt rules will asure that unsuccessful attempts to modify a file via openat syscall are collected. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rules below to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rules below to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S openat -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b32 -S openat -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S openat -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b64 -S openat -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_openat_o_trunc_write",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to modify files using the openat system call with O_TRUNC_WRITE flag.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r openat /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep openat /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S openat -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S openat -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S openat -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S openat -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-openat-o-trunc-write",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-openat-o-trunc-write",
        "namespace": "openshift-compliance",
        "resourceVersion": "77409",
        "uid": "d2eb5cc8-f2af-43a2-96d0-e1b8af0917fa"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Modification Attempts to Files - openat O_TRUNC_WRITE",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The audit system should collect detailed unauthorized file accesses for all users and root. To correctly identify unsuccessful creation, unsuccessful modification and unsuccessful access of files via openat syscall the audit rules collecting these events need to be in certain order. The more specific rules need to come before the less specific rules. The reason for that is that more specific rules cover a subset of events covered in the less specific rules, thus, they need to come before to not be overshadowed by less specific rules, which match a bigger set of events. Make sure that rules for unsuccessful calls of openat syscall are in the order shown below. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), check the order of rules below in a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, check the order of rules below in /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S openat -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S openat -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b32 -S openat -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b32 -S openat -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S openat -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S openat -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n-a always,exit -F arch=b64 -S openat -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b64 -S openat -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_openat_rule_order",
      "instructions": "Verify that rules for unsuccessful calls of the openat syscall are in the order shown below.\n\n    If the auditd daemon is configured to use the \"augenrules\" program to read audit rules during daemon startup (the default), check the order of rules below in a file with suffix \".rules\" in the directory \"/etc/audit/rules.d\".\n    If the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, check the order of rules below in \"/etc/audit/audit.rules\" file.\n\n    -a always,exit -F arch=b32 -S openat -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b32 -S openat -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b32 -S openat -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b32 -S openat -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n    -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n\n    If the system is 64 bit then also add the following lines:\n\n    -a always,exit -F arch=b64 -S openat -F a2&0100 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b64 -S openat -F a2&0100 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-create\n    -a always,exit -F arch=b64 -S openat -F a2&01003 -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b64 -S openat -F a2&01003 -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-modification\n    -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-access\n    -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-openat-rule-order",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-openat-rule-order",
        "namespace": "openshift-compliance",
        "resourceVersion": "77413",
        "uid": "c82e7613-a641-4caa-b3d0-d4c1fa7f94b0"
      },
      "rationale": "The more specific rules cover a subset of events covered by the less specific rules. By ordering them from more specific to less specific, it is assured that the less specific rule will not catch events better recorded by the more specific rule.",
      "severity": "medium",
      "title": "Ensure auditd Rules For Unauthorized Attempts To openat Are Ordered Correctly"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20removexattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20removexattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20removexattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20removexattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-removexattr_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file permission change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S removexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S removexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S removexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S removexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_removexattr",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the removexattr system call, run the following command:\n$ sudo grep \"removexattr\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-removexattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-removexattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77415",
        "uid": "16c91c3a-1dde-4f61-90d3-358d92690b8c"
      },
      "rationale": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Permission Changes to Files - removexattr",
      "warning": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20rename%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20rename%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20rename%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20rename%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-rename_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file deletion attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S rename -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b32 -S rename -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S rename -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b64 -S rename -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_rename",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the rename system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r rename /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep rename /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S rename -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b64 -S rename -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b32 -S rename -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b64 -S rename -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful-delete",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-rename",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-rename",
        "namespace": "openshift-compliance",
        "resourceVersion": "77419",
        "uid": "810f664d-cf93-4b9c-9d24-4f5fd1474186"
      },
      "rationale": "Unsuccessful attempts to delete files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Delete Attempts to Files - rename",
      "warning": "Unsuccessful attempts to delete files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20renameat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20renameat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20renameat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20renameat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-renameat_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file deletion attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S renameat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b32 -S renameat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S renameat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b64 -S renameat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_renameat",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the renameat system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r renameat /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep renameat /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S renameat -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b64 -S renameat -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b32 -S renameat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b64 -S renameat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful-delete",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-renameat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-renameat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77424",
        "uid": "5fbbca1b-f0e6-4a31-9a8a-6f3072304b90"
      },
      "rationale": "Unsuccessful attempts to delete files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Delete Attempts to Files - renameat",
      "warning": "Unsuccessful attempts to delete files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20setxattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20setxattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20setxattr%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20setxattr%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-setxattr_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file permission change attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S setxattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b32 -S setxattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S setxattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change\n-a always,exit -F arch=b64 -S setxattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_setxattr",
      "instructions": "To determine if the system is configured to audit unsuccessful calls\nto the setxattr system call, run the following command:\n$ sudo grep \"setxattr\" /etc/audit.*\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-setxattr",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:36Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-setxattr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77428",
        "uid": "d87013fc-69f4-4b80-9aa2-80a0fe42e4e1"
      },
      "rationale": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Permission Changes to Files - setxattr",
      "warning": "Unsuccessful attempts to change permissions of files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%23%20This%20content%20is%20a%20section%20of%20an%20Audit%20config%20snapshot%20recommended%20for%20Red%2520Hat%2520Enterprise%2520Linux%2520CoreOS%25204%20systems%20that%20target%20OSPP%20compliance.%0A%23%23%20The%20following%20content%20has%20been%20retreived%20on%202019-03-11%20from%3A%20https%3A//github.com/linux-audit/audit-userspace/blob/master/rules/30-ospp-v42.rules%0A%0A%23%23%20The%20purpose%20of%20these%20rules%20is%20to%20meet%20the%20requirements%20for%20Operating%0A%23%23%20System%20Protection%20Profile%20%28OSPP%29v4.2.%20These%20rules%20depends%20on%20having%0A%23%23%2010-base-config.rules%2C%2011-loginuid.rules%2C%20and%2043-module-load.rules%20installed.%0A%0A%23%23%20Unsuccessful%20file%20creation%20%28open%20with%20O_CREAT%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%260100%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20creat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-create%0A%0A%23%23%20Unsuccessful%20file%20modifications%20%28open%20for%20write%20or%20truncate%29%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20openat%2Copen_by_handle_at%20-F%20a2%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%20-F%20a1%2601003%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20truncate%2Cftruncate%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-modification%0A%0A%23%23%20Unsuccessful%20file%20access%20%28any%20other%20opens%29%20This%20has%20to%20go%20last.%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20open%2Ccreat%2Ctruncate%2Cftruncate%2Copenat%2Copen_by_handle_at%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Dunsuccesful-access }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-ospp-v42-remediation.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "At a minimum, the audit system should collect unauthorized file accesses for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d :\n\n-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file:\n\n-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=access\n-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=access",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_truncate",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the truncate system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r truncate /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep truncate /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=unset -k access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-moderate,rhcos4-stig,rhcos4-stig-v1r1,rhcos4-high-rev-4,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-truncate",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-truncate",
        "namespace": "openshift-compliance",
        "resourceVersion": "77433",
        "uid": "a4375f68-d935-49e2-8384-a97514cf3b6f"
      },
      "rationale": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Access Attempts to Files - truncate",
      "warning": "Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20unlink%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20unlink%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20unlink%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20unlink%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-unlink_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file deletion attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S unlink -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b32 -S unlink -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S unlink -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b64 -S unlink -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_unlink",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the unlink system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r unlink /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep unlink /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S unlink -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b64 -S unlink -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b32 -S unlink -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b64 -S unlink -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful-delete",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-unlink",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-unlink",
        "namespace": "openshift-compliance",
        "resourceVersion": "77432",
        "uid": "8639d1a2-0ddc-4d01-853e-db8b212b6cb5"
      },
      "rationale": "Unsuccessful attempts to delete files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Delete Attempts to Files - unlink",
      "warning": "Unsuccessful attempts to delete files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20unlinkat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db64%20-S%20unlinkat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20unlinkat%20-F%20exit%3D-EACCES%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A-a%20always%2Cexit%20-F%20arch%3Db32%20-S%20unlinkat%20-F%20exit%3D-EPERM%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-unlinkat_audit_rules_unsuccessful_file_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect unsuccessful file deletion attempts for all users and root. If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file.\n\n-a always,exit -F arch=b32 -S unlinkat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b32 -S unlinkat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n\nIf the system is 64 bit then also add the following lines:\n\n-a always,exit -F arch=b64 -S unlinkat -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete\n-a always,exit -F arch=b64 -S unlinkat -F exit=-EPERM -F auid>=1000 -F auid!=unset -F key=unsuccessful-delete",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_unlinkat",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates an audit record for unsuccessful attempts to use the unlinkat system call.\n\nIf the auditd daemon is configured to use the \"augenrules\" program to to read audit rules during daemon startup (the default), run the following command:\n\n$ sudo grep -r unlinkat /etc/audit/rules.d\n\nIf the auditd daemon is configured to use the \"auditctl\" utility to read audit rules during daemon startup, run the following command:\n\n$ sudo grep unlinkat /etc/audit/audit.rules\n\nThe output should be the following:\n\n-a always,exit -F arch=b32 -S unlinkat -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b64 -S unlinkat -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b32 -S unlinkat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful-delete\n-a always,exit -F arch=b64 -S unlinkat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful-delete",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-unsuccessful-file-modification-unlinkat",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4;Req-10.2.1",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),CM-6(a),Req-10.2.4,Req-10.2.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:37Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-unsuccessful-file-modification-unlinkat",
        "namespace": "openshift-compliance",
        "resourceVersion": "77435",
        "uid": "8c797d2f-eb05-4a1a-ab6c-453a24a8e208"
      },
      "rationale": "Unsuccessful attempts to delete files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.",
      "severity": "medium",
      "title": "Record Unsuccessful Delete Attempts to Files - unlinkat",
      "warning": "Unsuccessful attempts to delete files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-w%20/etc/group%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A-w%20/etc/passwd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A-w%20/etc/gshadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A-w%20/etc/shadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A-w%20/etc/security/opasswd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/75-audit_rules_usergroup_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d , in order to capture events that modify account changes:\n\n-w /etc/group -p wa -k audit_rules_usergroup_modification\n-w /etc/passwd -p wa -k audit_rules_usergroup_modification\n-w /etc/gshadow -p wa -k audit_rules_usergroup_modification\n-w /etc/shadow -p wa -k audit_rules_usergroup_modification\n-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file, in order to capture events that modify account changes:\n\n-w /etc/group -p wa -k audit_rules_usergroup_modification\n-w /etc/passwd -p wa -k audit_rules_usergroup_modification\n-w /etc/gshadow -p wa -k audit_rules_usergroup_modification\n-w /etc/shadow -p wa -k audit_rules_usergroup_modification\n-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification",
      "instructions": "To determine if the system is configured to audit account changes,\nrun the following command:\nauditctl -l | grep -E '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)'\nIf the system is configured to watch for account changes, lines should be returned for\neach file specified (and with perm=wa for each).",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-usergroup-modification",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.5",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-usergroup-modification",
        "namespace": "openshift-compliance",
        "resourceVersion": "77154",
        "uid": "545a467a-5682-4e31-ad37-fadc0c15ecb6"
      },
      "rationale": "In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information",
      "warning": "In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-w%20/etc/group%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-etc_group_usergroup_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d , in order to capture events that modify account changes:\n\n-w /etc/group -p wa -k audit_rules_usergroup_modification\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file, in order to capture events that modify account changes:\n\n-w /etc/group -p wa -k audit_rules_usergroup_modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_group",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates audit records for all account creations, modifications, disabling, and termination events that affect \"/etc/group\" with the following command:\n\n$ sudo auditctl -l | grep -E '(/etc/group)'\n\n-w /etc/group -p wa -k identity",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-usergroup-modification-group",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.5",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:29Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-usergroup-modification-group",
        "namespace": "openshift-compliance",
        "resourceVersion": "77152",
        "uid": "c52abbe2-624f-4d96-9bb9-5d9547150077"
      },
      "rationale": "In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information - /etc/group"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-w%20/etc/gshadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-etc_gshadow_usergroup_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d , in order to capture events that modify account changes:\n\n-w /etc/gshadow -p wa -k audit_rules_usergroup_modification\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file, in order to capture events that modify account changes:\n\n-w /etc/gshadow -p wa -k audit_rules_usergroup_modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_gshadow",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates audit records for all account creations, modifications, disabling, and termination events that affect \"/etc/gshadow\" with the following command:\n\n$ sudo auditctl -l | grep -E '(/etc/gshadow)'\n\n-w /etc/gshadow -p wa -k identity\n\nIf the command does not return a line, or the line is commented out, this is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-usergroup-modification-gshadow",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.5",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-usergroup-modification-gshadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "77160",
        "uid": "d84c970d-564c-4496-8ae1-9673d2c32383"
      },
      "rationale": "In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information - /etc/gshadow"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-w%20/etc/security/opasswd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-etc_security_opasswd_usergroup_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d , in order to capture events that modify account changes:\n\n-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file, in order to capture events that modify account changes:\n\n-w /etc/security/opasswd -p wa -k audit_rules_usergroup_modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_opasswd",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates audit records for all account creations, modifications, disabling, and termination events that affect \"/etc/security/opasswd\" with the following command:\n\n$ sudo auditctl -l | grep -E '(/etc/security/opasswd)'\n\n-w /etc/security/opasswd -p wa -k identity",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-stig,rhcos4-moderate,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-stig-v1r1,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "audit-rules-usergroup-modification-opasswd",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.5",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-usergroup-modification-opasswd",
        "namespace": "openshift-compliance",
        "resourceVersion": "77163",
        "uid": "e80ad49e-2e9b-49c1-a310-1ad06ba7c6fe"
      },
      "rationale": "In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information - /etc/security/opasswd"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-w%20/etc/passwd%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-etc_passwd_usergroup_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d , in order to capture events that modify account changes:\n\n-w /etc/passwd -p wa -k audit_rules_usergroup_modification\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file, in order to capture events that modify account changes:\n\n-w /etc/passwd -p wa -k audit_rules_usergroup_modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_passwd",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates audit records for all account creations, modifications, disabling, and termination events that affect \"/etc/passwd\" with the following command:\n\n$  sudo auditctl -l | grep -E '(/etc/passwd)'\n\n-w /etc/passwd -p wa -k identity",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-stig-v1r1,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig",
          "compliance.openshift.io/rule": "audit-rules-usergroup-modification-passwd",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.5",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-usergroup-modification-passwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "77167",
        "uid": "5bfaf1f8-37b8-4d1c-b320-7fa824051b71"
      },
      "rationale": "In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information - /etc/passwd"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,-w%20/etc/shadow%20-p%20wa%20-k%20audit_rules_usergroup_modification%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-etc_shadow_usergroup_modification.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the following lines to a file with suffix.rules in the directory /etc/audit/rules.d , in order to capture events that modify account changes:\n\n-w /etc/shadow -p wa -k audit_rules_usergroup_modification\n\nIf the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the following lines to /etc/audit/audit.rules file, in order to capture events that modify account changes:\n\n-w /etc/shadow -p wa -k audit_rules_usergroup_modification",
      "id": "xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_shadow",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 generates audit records for all account creations, modifications, disabling, and termination events that affect \"/etc/passwd with the following command:\n\n$  sudo auditctl -l | grep -E '(/etc/shadow)'\n\n-w /etc/shadow -p wa -k identity",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "audit-rules-usergroup-modification-shadow",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R2.2.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(4);AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.5",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R2.2.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,AC-2(4),AU-2(d),AU-12(c),AC-6(9),CM-6(a),Req-10.2.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-audit-rules-usergroup-modification-shadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "77170",
        "uid": "ed9df880-407c-4078-9b9c-11c277bad0cc"
      },
      "rationale": "In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy.",
      "severity": "medium",
      "title": "Record Events that Modify User/Group Information - /etc/shadow"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Configure the audispd plugin to off-load audit records onto a different system or media from the system being audited. Set the remote_server option in\n\n/etc/audit/audisp-remote.conf\n\nwith an IP address or hostname of the system that the audispd plugin should send audit records to. For example\n\nremote_server = logcollector",
      "id": "xccdf_org.ssgproject.content_rule_auditd_audispd_configure_remote_server",
      "instructions": "To verify the audispd plugin off-loads audit records onto a different system or\nmedia from the system being audited, run the following command:\n$ sudo grep -i remote_server /etc/audit/audisp-remote.conf\nThe output should return something similar to\nremote_server =",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "auditd-audispd-configure-remote-server",
          "compliance.openshift.io/rule-variable": "var-audispd-remote-server"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-audispd-configure-remote-server",
        "namespace": "openshift-compliance",
        "resourceVersion": "77625",
        "uid": "d20603f1-04ea-4cdf-b979-b663e8c30933"
      },
      "rationale": "Information stored in one location is vulnerable to accidental or incidental deletion or alteration.Off-loading is a common process in information systems with limited audit storage capacity.",
      "severity": "medium",
      "title": "Configure audispd Plugin To Send Logs To Remote Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Configure the action the operating system takes if the disk the audit records are written to becomes full. Edit the file /etc/audit/audisp-remote.conf. Add or modify the following line, substituting ACTION appropriately:\n\ndisk_full_action = ACTION\n\nSet this value to single to cause the system to switch to single user mode for corrective action. Acceptable values also include syslog and halt. For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_audispd_disk_full_action",
      "instructions": "Inspect /etc/audit/audisp-remote.conf and locate the following line to\ndetermine if the system is configured to either send to syslog, switch to single user mode,\nor halt when the disk is full:\n$ sudo grep -i disk_full_action /etc/audit/audisp-remote.conf\nThe output should return something similar to:\ndisk_full_action = single\nAcceptable values also include syslog and halt.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "auditd-audispd-disk-full-action",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-audispd-disk-full-action",
        "namespace": "openshift-compliance",
        "resourceVersion": "77627",
        "uid": "0732d0df-0fa0-4d04-9940-b411a791e045"
      },
      "rationale": "Taking appropriate action in case of a filled audit storage volume will minimize the possibility of losing audit records.",
      "severity": "medium",
      "title": "Configure audispd's Plugin disk_full_action When Disk Is Full"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Configure the operating system to encrypt the transfer of off-loaded audit records onto a different system or media from the system being audited. Uncomment the enable_krb5 option in\n\n/etc/audit/audisp-remote.conf\n\n, and set it with the following line:\n\nenable_krb5 = yes",
      "id": "xccdf_org.ssgproject.content_rule_auditd_audispd_encrypt_sent_records",
      "instructions": "To verify the audispd plugin encrypts audit records off-loaded onto a different\nsystem or media from the system being audited, run the following command:\n\n$ sudo grep -i enable_krb5 /etc/audit/audisp-remote.conf\nThe output should return the following:\nenable_krb5 = yes",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "auditd-audispd-encrypt-sent-records",
          "control.compliance.openshift.io/NIST-800-53": "AU-9(3);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-9(3),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-audispd-encrypt-sent-records",
        "namespace": "openshift-compliance",
        "resourceVersion": "77631",
        "uid": "d94e7fd7-a6a7-45ed-9ba6-46e4e51f665b"
      },
      "rationale": "Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Off-loading is a common process in information systems with limited audit storage capacity.",
      "severity": "medium",
      "title": "Encrypt Audit Records Sent With audispd Plugin"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Configure the action the operating system takes if there is an error sending audit records to a remote system. Edit the file /etc/audit/audisp-remote.conf. Add or modify the following line, substituting ACTION appropriately:\n\nnetwork_failure_action = ACTION\n\nSet this value to single to cause the system to switch to single user mode for corrective action. Acceptable values also include syslog and halt. For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. This profile configures the action to be single.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_audispd_network_failure_action",
      "instructions": "Inspect /etc/audit/audisp-remote.conf and locate the following line to\ndetermine if the system is configured to perform a correct action according to the policy:\n$ sudo grep -i network_failure_action /etc/audit/audisp-remote.conf\nThe output should return:\nnetwork_failure_action =",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "auditd-audispd-network-failure-action",
          "compliance.openshift.io/rule-variable": "var-audispd-network-failure-action",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-audispd-network-failure-action",
        "namespace": "openshift-compliance",
        "resourceVersion": "77635",
        "uid": "29b39ffb-11ca-40e9-86d5-f91b98023024"
      },
      "rationale": "Taking appropriate action when there is an error sending audit records to a remote system will minimize the possibility of losing audit records.",
      "severity": "medium",
      "title": "Configure audispd's Plugin network_failure_action On Network Failure"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To configure the auditd service to use the syslog plug-in of the audispd audit event multiplexor, set the active line in /etc/audit/plugins.d/syslog.conf to yes. Restart the auditd service:\n\n$ sudo service auditd restart",
      "id": "xccdf_org.ssgproject.content_rule_auditd_audispd_syslog_plugin_activated",
      "instructions": "To verify the audispd's syslog plugin is active, run the following command:\n$ sudo grep active /etc/audit/plugins.d/syslog.conf\nIf the plugin is active, the output will show yes.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "auditd-audispd-syslog-plugin-activated",
          "control.compliance.openshift.io/NIST-800-53": "AU-4(1);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.3",
          "policies.open-cluster-management.io/controls": "AU-4(1),CM-6(a),Req-10.5.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:42Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-audispd-syslog-plugin-activated",
        "namespace": "openshift-compliance",
        "resourceVersion": "77637",
        "uid": "2d870402-cc5e-4a70-b5d7-9ad94ccc41ee"
      },
      "rationale": "The auditd service does not include the ability to send audit records to a centralized server for management directly. It does, however, include a plug-in for audit event multiplexor (audispd) to pass audit records to the local syslog server.",
      "severity": "medium",
      "title": "Configure auditd to use audispd's syslog plugin"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The auditd service can be configured to take an action when there is a disk error. Edit the file /etc/audit/auditd.conf. Add or modify the following line, substituting ACTION appropriately:\n\ndisk_error_action = ACTION\n\nSet this value to single to cause the system to switch to single-user mode for corrective action. Acceptable values also include syslog , exec , single , and halt. For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for ACTION are described in the auditd.conf man page.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_disk_error_action",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when an audit processing failure occurs.\n\nCheck that Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when an audit processing failure occurs with the following command:\n\n$ sudo grep disk_error_action /etc/audit/auditd.conf\n\ndisk_error_action = \n\nIf the value of the \"disk_error_action\" option is not \"SYSLOG\", \"SINGLE\", or \"HALT\", or the line is commented out, ask the system administrator to indicate how the system takes appropriate action when an audit process failure occurs.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high",
          "compliance.openshift.io/rule": "auditd-data-disk-error-action",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-disk-error-action",
        "namespace": "openshift-compliance",
        "resourceVersion": "77640",
        "uid": "0861d635-5ff7-4688-9712-7613764a40cf"
      },
      "rationale": "Taking appropriate action in case of disk errors will minimize the possibility of losing audit records.",
      "severity": "medium",
      "title": "Configure auditd Disk Error Action on Disk Error"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The auditd service can be configured to take an action when there is a disk error. Edit the file /etc/audit/auditd.conf. Add or modify the following line, substituting ACTION appropriately:\n\ndisk_error_action = ACTION\n\nSet this value to single to cause the system to switch to single-user mode for corrective action. Acceptable values also include syslog , exec , single , and halt. For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for ACTION are described in the auditd.conf man page.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_disk_error_action_stig",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when an audit processing failure occurs.\n\nCheck that Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when an audit processing failure occurs with the following command:\n\n$ sudo grep disk_error_action /etc/audit/auditd.conf\n\ndisk_error_action = HALT\n\nIf the value of the \"disk_error_action\" option is not \"SYSLOG\", \"SINGLE\", or \"HALT\", or the line is commented out, ask the system administrator to indicate how the system takes appropriate action when an audit process failure occurs.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "auditd-data-disk-error-action-stig",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-disk-error-action-stig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77643",
        "uid": "be49f946-29f5-4cde-88f4-7b024b7bf83b"
      },
      "rationale": "Taking appropriate action in case of disk errors will minimize the possibility of losing audit records.",
      "severity": "medium",
      "title": "Configure auditd Disk Error Action on Disk Error"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The auditd service can be configured to take an action when disk space is running low but prior to running out of space completely. Edit the file /etc/audit/auditd.conf. Add or modify the following line, substituting ACTION appropriately:\n\ndisk_full_action = ACTION\n\nSet this value to single to cause the system to switch to single-user mode for corrective action. Acceptable values also include syslog , exec , single , and halt. For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for ACTION are described in the auditd.conf man page.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_disk_full_action",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when the audit storage volume is full.\n\nCheck that Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when the audit storage volume is full with the following command:\n\n$ sudo grep disk_full_action /etc/audit/auditd.conf\n\ndisk_full_action = \n\nIf the value of the \"disk_full_action\" option is not \"SYSLOG\", \"SINGLE\", or \"HALT\", or the line is commented out, ask the system administrator to indicate how the system takes appropriate action when an audit storage volume is full.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "auditd-data-disk-full-action",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-disk-full-action",
        "namespace": "openshift-compliance",
        "resourceVersion": "77646",
        "uid": "381cde87-8f74-438a-aab3-944f1837e09b"
      },
      "rationale": "Taking appropriate action in case of a filled audit storage volume will minimize the possibility of losing audit records.",
      "severity": "medium",
      "title": "Configure auditd Disk Full Action when Disk Space Is Full"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The auditd service can be configured to take an action when disk space is running low but prior to running out of space completely. Edit the file /etc/audit/auditd.conf. Add or modify the following line, substituting ACTION appropriately:\n\ndisk_full_action = ACTION\n\nSet this value to single to cause the system to switch to single-user mode for corrective action. Acceptable values also include syslog , single , and halt. For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for ACTION are described in the auditd.conf man page.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_disk_full_action_stig",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when the audit storage volume is full.\n\nCheck that Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when the audit storage volume is full with the following command:\n\n$ sudo grep disk_full_action /etc/audit/auditd.conf\n\ndisk_full_action = \n\nIf the value of the \"disk_full_action\" option is not \"SYSLOG\", \"SINGLE\", or \"HALT\", or the line is commented out, ask the system administrator to indicate how the system takes appropriate action when an audit storage volume is full.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "auditd-data-disk-full-action-stig",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-disk-full-action-stig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77651",
        "uid": "b428e55b-62db-43da-8512-0bb15e6da414"
      },
      "rationale": "Taking appropriate action in case of a filled audit storage volume will minimize the possibility of losing audit records.",
      "severity": "medium",
      "title": "Configure auditd Disk Full Action when Disk Space Is Full"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The auditd service can be configured to send email to a designated account in certain situations. Add or correct the following line in /etc/audit/auditd.conf to ensure that administrators are notified via email for those situations:\n\naction_mail_acct = root",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_retention_action_mail_acct",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to notify the SA and/or ISSO (at a minimum) in the event of an audit processing failure with the following command:\n\n$ sudo grep action_mail_acct /etc/audit/auditd.conf\n\naction_mail_acct =",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "auditd-data-retention-action-mail-acct",
          "compliance.openshift.io/rule-variable": "var-auditd-action-mail-acct",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R1.3;CIP-003-8 R3;CIP-003-8 R3.1;CIP-003-8 R3.2;CIP-003-8 R3.3;CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "IA-5(1);AU-5(a);AU-5(2);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7.a",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R1.3,CIP-003-8 R3,CIP-003-8 R3.1,CIP-003-8 R3.2,CIP-003-8 R3.3,CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,IA-5(1),AU-5(a),AU-5(2),CM-6(a),Req-10.7.a",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-retention-action-mail-acct",
        "namespace": "openshift-compliance",
        "resourceVersion": "77652",
        "uid": "3f905510-5be2-4718-977c-e0aa9994fc19"
      },
      "rationale": "Email sent to the root account is typically aliased to the administrators of the system, who can take appropriate action.",
      "severity": "medium",
      "title": "Configure auditd mail_acct Action on Low Disk Space"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The auditd service can be configured to take an action when disk space is running low but prior to running out of space completely. Edit the file /etc/audit/auditd.conf. Add or modify the following line, substituting ACTION appropriately:\n\nadmin_space_left_action = ACTION\n\nSet this value to single to cause the system to switch to single user mode for corrective action. Acceptable values also include suspend and halt. For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for ACTION are described in the auditd.conf man page.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_retention_admin_space_left_action",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 is configured to take action in the event of allocated audit record storage volume reaches 95 percent of the repository maximum audit record storage capacity with the following command:\n\n$ sudo grep admin_space_left_action /etc/audit/auditd.conf\n\nadmin_space_left_action = single\n\nIf the value of the \"admin_space_left_action\" is not set to \"single\", or if the line is commented out, ask the System Administrator to indicate how the system is providing real-time alerts to the SA and ISSO.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "auditd-data-retention-admin-space-left-action",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-retention-admin-space-left-action",
        "namespace": "openshift-compliance",
        "resourceVersion": "77657",
        "uid": "a277a82c-ded0-4489-8b5e-3af361ab4a09"
      },
      "rationale": "Administrators should be made aware of an inability to record audit records. If a separate partition or logical volume of adequate size is used, running low on space for audit records should never occur.",
      "severity": "medium",
      "title": "Configure auditd admin_space_left Action on Low Disk Space"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The auditd service can be configured to synchronously write audit event data to disk. Add or correct the following line in /etc/audit/auditd.conf to ensure that audit event data is fully synchronized with the log files on the disk:\n\nflush = data",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_retention_flush",
      "instructions": "Inspect /etc/audit/auditd.conf and locate the following line to\ndetermine if the system is configured to synchronize audit event data\nwith the log files on the disk:\n$ sudo grep flush /etc/audit/auditd.conf\nflush = DATA\nAcceptable values are DATA, and SYNC. The setting is\ncase-insensitive.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-e8",
          "compliance.openshift.io/rule": "auditd-data-retention-flush",
          "compliance.openshift.io/rule-variable": "var-auditd-flush",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-004-6 R3.3;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AU-11;CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-004-6 R3.3,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CIP-007-3 R6.5,AU-11,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-retention-flush",
        "namespace": "openshift-compliance",
        "resourceVersion": "77661",
        "uid": "f397e6f5-2984-4805-a71c-ed4e1cd4c114"
      },
      "rationale": "Audit data should be synchronously written to disk to ensure log integrity. These parameters assure that all audit event data is fully synchronized with the log files on the disk.",
      "severity": "medium",
      "title": "Configure auditd flush priority"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Determine the amount of audit data (in megabytes) which should be retained in each log file. Edit the file /etc/audit/auditd.conf. Add or modify the following line, substituting the correct value of 6 for STOREMB :\n\nmax_log_file = STOREMB\n\nSet the value to 6 (MB) or higher for general-purpose systems. Larger values, of course, support retention of even more audit data.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file",
      "instructions": "Inspect /etc/audit/auditd.conf and locate the following line to\ndetermine how much data the system will retain in each audit log file:\n$ sudo grep max_log_file /etc/audit/auditd.conf\nmax_log_file = 6",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "auditd-data-retention-max-log-file",
          "compliance.openshift.io/rule-variable": "var-auditd-max-log-file",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-004-6 R3.3;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AU-11;CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-004-6 R3.3,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CIP-007-3 R6.5,AU-11,CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-retention-max-log-file",
        "namespace": "openshift-compliance",
        "resourceVersion": "77664",
        "uid": "3bc40505-dece-421a-a5cc-76d7433ef28b"
      },
      "rationale": "The total storage for audit log files must be large enough to retain log information over the period required. This is a function of the maximum log file size and the number of logs retained.",
      "severity": "medium",
      "title": "Configure auditd Max Log File Size"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The default action to take when the logs reach their maximum size is to rotate the log files, discarding the oldest one. To configure the action taken by auditd , add or correct the line in /etc/audit/auditd.conf :\n\nmax_log_file_action = ACTION\n\nPossible values for ACTION are described in the auditd.conf man page. These include:\n\n* ignore\n* syslog\n* suspend\n* rotate\n* keep_logs\n\nSet the ACTION to rotate. The setting is case-insensitive.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file_action",
      "instructions": "Verify that the SA and ISSO (at a minimum) are notified when the audit storage volume is full.\n\nCheck which action Red Hat Enterprise Linux CoreOS 4 takes when the audit storage volume is full with the following command:\n\n$ sudo grep max_log_file_action /etc/audit/auditd.conf\nmax_log_file_action =",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "auditd-data-retention-max-log-file-action",
          "compliance.openshift.io/rule-variable": "var-auditd-max-log-file-action",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-retention-max-log-file-action",
        "namespace": "openshift-compliance",
        "resourceVersion": "77666",
        "uid": "0695390b-f866-4ac2-a153-db119528ca9c"
      },
      "rationale": "Automatically rotating logs (by setting this to rotate ) minimizes the chances of the system unexpectedly running out of disk space by being overwhelmed with log data. However, for systems that must never discard log data, or which use external processes to transfer it and reclaim space, keep_logs can be employed.",
      "severity": "medium",
      "title": "Configure auditd max_log_file_action Upon Reaching Maximum Log Size"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The default action to take when the logs reach their maximum size is to rotate the log files, discarding the oldest one. To configure the action taken by auditd , add or correct the line in /etc/audit/auditd.conf :\n\nmax_log_file_action = ACTION\n\nPossible values for ACTION are described in the auditd.conf man page. These include:\n\n* ignore\n* syslog\n* suspend\n* rotate\n* keep_logs\n\nSet the ACTION to rotate to ensure log rotation occurs. This is the default. The setting is case-insensitive.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file_action_stig",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when the audit files have reached maximum size.\n\nCheck that Red Hat Enterprise Linux CoreOS 4 takes the appropriate action when the audit files have reached maximum size with the following command:\n\n$ sudo grep max_log_file_action /etc/audit/auditd.conf\n\nmax_log_file_action =",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "auditd-data-retention-max-log-file-action-stig",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:43Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-retention-max-log-file-action-stig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77667",
        "uid": "e51f1fa3-27ef-404c-a229-3e49b9bcdea6"
      },
      "rationale": "Automatically rotating logs (by setting this to rotate ) minimizes the chances of the system unexpectedly running out of disk space by being overwhelmed with log data. However, for systems that must never discard log data, or which use external processes to transfer it and reclaim space, keep_logs can be employed.",
      "severity": "medium",
      "title": "Configure auditd max_log_file_action Upon Reaching Maximum Log Size"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Determine how many log files auditd should retain when it rotates logs. Edit the file /etc/audit/auditd.conf. Add or modify the following line, substituting NUMLOGS with the correct value of 5 :\n\nnum_logs = NUMLOGS\n\nSet the value to 5 for general-purpose systems. Note that values less than 2 result in no log rotation.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_retention_num_logs",
      "instructions": "Inspect /etc/audit/auditd.conf and locate the following line to\ndetermine how many logs the system is configured to retain after rotation:\n$ sudo grep num_logs /etc/audit/auditd.conf\nnum_logs = 5",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "auditd-data-retention-num-logs",
          "compliance.openshift.io/rule-variable": "var-auditd-num-logs",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-004-6 R3.3;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AU-11;CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-004-6 R3.3,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CIP-007-3 R6.5,AU-11,CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-retention-num-logs",
        "namespace": "openshift-compliance",
        "resourceVersion": "77671",
        "uid": "9c9f399d-2cb7-4751-929c-50825edca8f4"
      },
      "rationale": "The total storage for audit log files must be large enough to retain log information over the period required. This is a function of the maximum log file size and the number of logs retained.",
      "severity": "medium",
      "title": "Configure auditd Number of Logs Retained"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The auditd service can be configured to take an action when disk space is running low but prior to running out of space completely. Edit the file /etc/audit/auditd.conf. Add or modify the following line, substituting SIZE_in_MB appropriately:\n\nspace_left = SIZE_in_MB\n\nSet this value to the appropriate size in Megabytes cause the system to notify the user of an issue.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_retention_space_left",
      "instructions": "Inspect /etc/audit/auditd.conf and locate the following line to\ndetermine if the system is configured correctly:\nspace_left SIZE_in_MB",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "auditd-data-retention-space-left",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-retention-space-left",
        "namespace": "openshift-compliance",
        "resourceVersion": "77674",
        "uid": "f59213c1-5984-4a45-88ea-9d02129c86bc"
      },
      "rationale": "Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption.",
      "severity": "medium",
      "title": "Configure auditd space_left on Low Disk Space"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The auditd service can be configured to take an action when disk space starts to run low. Edit the file /etc/audit/auditd.conf. Modify the following line, substituting ACTION appropriately:\n\nspace_left_action = ACTION\n\nPossible values for ACTION are described in the auditd.conf man page. These include:\n\n* syslog\n* email\n* exec\n* suspend\n* single\n* halt\n\nSet this to email (instead of the default, which is suspend ) as it is more likely to get prompt attention. Acceptable values also include suspend , single , and halt.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_data_retention_space_left_action",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 notifies the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity with the following command:\n\n$ sudo grep -w space_left_action /etc/audit/auditd.conf\n\nspace_left_action = \n\nIf the value of the \"space_left_action\" is not set to \"\", or if the line is commented out, ask the System Administrator to indicate how the system is providing real-time alerts to the SA and ISSO.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "auditd-data-retention-space-left-action",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(b);AU-5(2);AU-5(1);AU-5(4);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "AU-5(b),AU-5(2),AU-5(1),AU-5(4),CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-data-retention-space-left-action",
        "namespace": "openshift-compliance",
        "resourceVersion": "77676",
        "uid": "57aadb22-c92c-4604-948d-067339a56912"
      },
      "rationale": "Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption.",
      "severity": "medium",
      "title": "Configure auditd space_left Action on Low Disk Space"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure Audit daemon to issue an explicit flush to disk command after writing 50 records, set freq to 50 in /etc/audit/auditd.conf.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_freq",
      "instructions": "To verify that Audit Daemon is configured to flush to disk after\nevery  records, run the following command:\n$ sudo grep freq /etc/audit/auditd.conf\nThe output should return the following:\nfreq =",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "auditd-freq",
          "compliance.openshift.io/rule-variable": "var-auditd-freq",
          "control.compliance.openshift.io/NIST-800-53": "CM-6",
          "policies.open-cluster-management.io/controls": "CM-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-freq",
        "namespace": "openshift-compliance",
        "resourceVersion": "77679",
        "uid": "0e6c44db-f00d-4cb8-bb94-6cfbb4398928"
      },
      "rationale": "If option freq isn't set to 50 , the flush to disk may happen after higher number of records, increasing the danger of audit loss.",
      "severity": "medium",
      "title": "Set number of records to cause an explicit flush to audit logs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure Audit daemon to include local events in Audit logs, set local_events to yes in /etc/audit/auditd.conf. This is the default setting.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_local_events",
      "instructions": "To verify that Audit Daemon is configured to include local events, run the\nfollowing command:\n$ sudo grep local_events /etc/audit/auditd.conf\nThe output should return the following:\nlocal_events = yes",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "auditd-local-events",
          "control.compliance.openshift.io/NIST-800-53": "CM-6",
          "policies.open-cluster-management.io/controls": "CM-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-local-events",
        "namespace": "openshift-compliance",
        "resourceVersion": "77681",
        "uid": "52ae40f5-bddc-43d4-9987-24869d9f2cc1"
      },
      "rationale": "If option local_events isn't set to yes only events from network will be aggregated.",
      "severity": "medium",
      "title": "Include Local Events in Audit Logs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure Audit daemon to resolve all uid, gid, syscall, architecture, and socket address information before writing the events to disk, set log_format to ENRICHED in /etc/audit/auditd.conf.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_log_format",
      "instructions": "To verify that Audit Daemon is configured to resolve all uid, gid, syscall,\narchitecture, and socket address information before writing the event to disk,\nrun the following command:\n$ sudo grep log_format /etc/audit/auditd.conf\nThe output should return the following:\nlog_format = ENRICHED",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "auditd-log-format",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;AU-3",
          "policies.open-cluster-management.io/controls": "CM-6,AU-3",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-log-format",
        "namespace": "openshift-compliance",
        "resourceVersion": "77683",
        "uid": "ef8888b5-37b2-45d3-8054-d7e37da2b17f"
      },
      "rationale": "If option log_format isn't set to ENRICHED , the audit records will be stored in a format exactly as the kernel sends them.",
      "severity": "low",
      "title": "Resolve information before writing to audit logs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure Audit daemon to use a unique identifier as computer node name in the audit events, set name_format to hostname in /etc/audit/auditd.conf.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_name_format",
      "instructions": "To verify that Audit Daemon is configured to record the computer node\nname in the audit events, run the following command:\n$ sudo grep name_format /etc/audit/auditd.conf\nThe output should return the following:\nname_format =",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "auditd-name-format",
          "compliance.openshift.io/rule-variable": "var-auditd-name-format",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;AU-3",
          "policies.open-cluster-management.io/controls": "CM-6,AU-3",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-name-format",
        "namespace": "openshift-compliance",
        "resourceVersion": "77686",
        "uid": "25ee1cde-b130-4b09-9528-52ce9b90e96f"
      },
      "rationale": "If option name_format is left at its default value of none , audit events from different computers may be hard to distinguish.",
      "severity": "medium",
      "title": "Set type of computer node name logging in audit logs",
      "warning": "If option name_format is left at its default value of none , audit events from different computers may be hard to distinguish."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The audit system should have an action setup in the event the internal event queue becomes full. To setup an overflow action edit /etc/audit/auditd.conf. Set overflow_action to one of the following values: syslog , single , halt.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_overflow_action",
      "instructions": "Verify the audit system is configured to take an appropriate action when the internal event queue is full:\n$ sudo grep -i overflow_action /etc/audit/auditd.conf\n\nThe output should contain overflow_action = syslog\n\nIf the value of the \"overflow_action\" option is not set to syslog,\nsingle, halt or the line is commented out, ask the System Administrator\nto indicate how the audit logs are off-loaded to a different system or media.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "auditd-overflow-action",
          "control.compliance.openshift.io/NIST-800-53": "AU-4(1)",
          "policies.open-cluster-management.io/controls": "AU-4(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-overflow-action",
        "namespace": "openshift-compliance",
        "resourceVersion": "77688",
        "uid": "352fdb9d-7b03-474d-97da-370a18c0b768"
      },
      "rationale": "The audit system should have an action setup in the event the internal event queue becomes full so that no data is lost.",
      "severity": "medium",
      "title": "Appropriate Action Must be Setup When the Internal Audit Event Queue is Full"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20audit%20daemon%0A%23%0A%0Alocal_events%20%3D%20yes%0Awrite_logs%20%3D%20yes%0Alog_file%20%3D%20/var/log/audit/audit.log%0Alog_group%20%3D%20root%0Alog_format%20%3D%20ENRICHED%0Aflush%20%3D%20%7B%7B.var_auditd_flush%7D%7D%0Afreq%20%3D%2050%0Amax_log_file%20%3D%20%7B%7B.var_auditd_max_log_file%7D%7D%0Anum_logs%20%3D%20%7B%7B.var_auditd_num_logs%7D%7D%0Apriority_boost%20%3D%204%0Aname_format%20%3D%20hostname%0A%23%23name%20%3D%20mydomain%0Amax_log_file_action%20%3D%20%7B%7B.var_auditd_max_log_file_action%7D%7D%0Aspace_left%20%3D%20%7B%7B.var_auditd_space_left%7D%7D%0Aspace_left_action%20%3D%20%7B%7B.var_auditd_space_left_action%7D%7D%0Averify_email%20%3D%20yes%0Aaction_mail_acct%20%3D%20%7B%7B.var_auditd_action_mail_acct%7D%7D%0Aadmin_space_left%20%3D%2050%0Aadmin_space_left_action%20%3D%20syslog%0Adisk_full_action%20%3D%20%7B%7B.var_auditd_disk_full_action%7D%7D%0Adisk_error_action%20%3D%20%7B%7B.var_auditd_disk_error_action%7D%7D%0Ause_libwrap%20%3D%20yes%0A%23%23tcp_listen_port%20%3D%2060%0Atcp_listen_queue%20%3D%205%0Atcp_max_per_addr%20%3D%201%0A%23%23tcp_client_ports%20%3D%201024-65535%0Atcp_client_max_idle%20%3D%200%0Atransport%20%3D%20TCP%0Akrb5_principal%20%3D%20auditd%0A%23%23krb5_key_file%20%3D%20/etc/audit/audit.key%0Adistribute_network%20%3D%20no%0Aq_depth%20%3D%20400%0Aoverflow_action%20%3D%20syslog%0Amax_restarts%20%3D%2010%0Aplugin_dir%20%3D%20/etc/audit/plugins.d }}"
                      },
                      "mode": 416,
                      "overwrite": true,
                      "path": "/etc/audit/auditd.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure Audit daemon to write Audit logs to the disk, set write_logs to yes in /etc/audit/auditd.conf. This is the default setting.",
      "id": "xccdf_org.ssgproject.content_rule_auditd_write_logs",
      "instructions": "To verify that Audit Daemon is configured to write logs to the disk, run the\nfollowing command:\n$ sudo grep write_logs /etc/audit/auditd.conf\nThe output should return the following:\nwrite_logs = yes",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "auditd-write-logs",
          "control.compliance.openshift.io/NIST-800-53": "CM-6",
          "policies.open-cluster-management.io/controls": "CM-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:44Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-auditd-write-logs",
        "namespace": "openshift-compliance",
        "resourceVersion": "77693",
        "uid": "f4b43d90-f657-4ecc-84b7-617afdb6a06e"
      },
      "rationale": "If write_logs isn't set to yes , the Audit logs will not be written to the disk.",
      "severity": "medium",
      "title": "Write Audit Logs to the Disk"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To prevent Avahi from publishing its records, edit /etc/avahi/avahi-daemon.conf and ensure the following line appears in the [publish] section:\n\ndisable-publishing=yes",
      "id": "xccdf_org.ssgproject.content_rule_avahi_disable_publishing",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "avahi-disable-publishing",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-avahi-disable-publishing",
        "namespace": "openshift-compliance",
        "resourceVersion": "78423",
        "uid": "2937bcb6-1daf-4f81-9eb1-de103779dcb5"
      },
      "rationale": "This helps ensure that no record will be published by Avahi.",
      "severity": "low",
      "title": "Disable Avahi Publishing"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "metadata": {
              "labels": {
                "machineconfiguration.openshift.io/role": "worker"
              },
              "name": "75-banner-etc-issue"
            },
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,You%20are%20accessing%20a%20U.S.%20Government%20%28USG%29%20Information%20System%20%28IS%29%20that%20is%20%0Aprovided%20for%20USG-authorized%20use%20only.%20By%20using%20this%20IS%20%28which%20includes%20any%20%0Adevice%20attached%20to%20this%20IS%29%2C%20you%20consent%20to%20the%20following%20conditions%3A%0A%0A-The%20USG%20routinely%20intercepts%20and%20monitors%20communications%20on%20this%20IS%20for%20%0Apurposes%20including%2C%20but%20not%20limited%20to%2C%20penetration%20testing%2C%20COMSEC%20monitoring%2C%20%0Anetwork%20operations%20and%20defense%2C%20personnel%20misconduct%20%28PM%29%2C%20law%20enforcement%20%0A%28LE%29%2C%20and%20counterintelligence%20%28CI%29%20investigations.%0A%0A-At%20any%20time%2C%20the%20USG%20may%20inspect%20and%20seize%20data%20stored%20on%20this%20IS.%0A%0A-Communications%20using%2C%20or%20data%20stored%20on%2C%20this%20IS%20are%20not%20private%2C%20are%20subject%20%0Ato%20routine%20monitoring%2C%20interception%2C%20and%20search%2C%20and%20may%20be%20disclosed%20or%20used%20%0Afor%20any%20USG-authorized%20purpose.%0A%0A-This%20IS%20includes%20security%20measures%20%28e.g.%2C%20authentication%20and%20access%20controls%29%20%0Ato%20protect%20USG%20interests--not%20for%20your%20personal%20benefit%20or%20privacy.%0A%0A-Notwithstanding%20the%20above%2C%20using%20this%20IS%20does%20not%20constitute%20consent%20to%20PM%2C%20LE%20%0Aor%20CI%20investigative%20searching%20or%20monitoring%20of%20the%20content%20of%20privileged%20%0Acommunications%2C%20or%20work%20product%2C%20related%20to%20personal%20representation%20or%20services%20%0Aby%20attorneys%2C%20psychotherapists%2C%20or%20clergy%2C%20and%20their%20assistants.%20Such%20%0Acommunications%20and%20work%20product%20are%20private%20and%20confidential.%20See%20User%20%0AAgreement%20for%20details."
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/issue.d/legal-notice"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system login banner create a file under /etc/issue.d The DoD required text is either:\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\n\nOR:\n\nI've read & consent to terms in IS user agreem't.\n\nTo address this, please create a Machineconfig object with the appropriate text in a drop-in file in /etc/issue.d/. Do not try to edit /etc/issue directly as this is a symlink provided by the Operating System.\n\nFor example, if you're using the DoD required text, the manifest would look as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-etc-issue\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,You%20are%20accessing%20a%20U.S.%20Government%20%28USG%29%20Information%20System%20%28IS%29%20that%20is%20%0Aprovided%20for%20USG-authorized%20use%20only.%20By%20using%20this%20IS%20%28which%20includes%20any%20%0Adevice%20attached%20to%20this%20IS%29%2C%20you%20consent%20to%20the%20following%20conditions%3A%0A%0A-The%20USG%20routinely%20intercepts%20and%20monitors%20communications%20on%20this%20IS%20for%20%0Apurposes%20including%2C%20but%20not%20limited%20to%2C%20penetration%20testing%2C%20COMSEC%20monitoring%2C%20%0Anetwork%20operations%20and%20defense%2C%20personnel%20misconduct%20%28PM%29%2C%20law%20enforcement%20%0A%28LE%29%2C%20and%20counterintelligence%20%28CI%29%20investigations.%0A%0A-At%20any%20time%2C%20the%20USG%20may%20inspect%20and%20seize%20data%20stored%20on%20this%20IS.%0A%0A-Communications%20using%2C%20or%20data%20stored%20on%2C%20this%20IS%20are%20not%20private%2C%20are%20subject%20%0Ato%20routine%20monitoring%2C%20interception%2C%20and%20search%2C%20and%20may%20be%20disclosed%20or%20used%20%0Afor%20any%20USG-authorized%20purpose.%0A%0A-This%20IS%20includes%20security%20measures%20%28e.g.%2C%20authentication%20and%20access%20controls%29%20%0Ato%20protect%20USG%20interests--not%20for%20your%20personal%20benefit%20or%20privacy.%0A%0A-Notwithstanding%20the%20above%2C%20using%20this%20IS%20does%20not%20constitute%20consent%20to%20PM%2C%20LE%20%0Aor%20CI%20investigative%20searching%20or%20monitoring%20of%20the%20content%20of%20privileged%20%0Acommunications%2C%20or%20work%20product%2C%20related%20to%20personal%20representation%20or%20services%20%0Aby%20attorneys%2C%20psychotherapists%2C%20or%20clergy%2C%20and%20their%20assistants.%20Such%20%0Acommunications%20and%20work%20product%20are%20private%20and%20confidential.%20See%20User%20%0AAgreement%20for%20details.\n       mode: 0644\n       path: /etc/issue.d/legal-notice\n       overwrite: true\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_banner_etc_issue",
      "instructions": "To check if the system login banner is compliant,\nrun the following command:\n$ cat /etc/issue",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "banner-etc-issue",
          "control.compliance.openshift.io/NIST-800-53": "AC-8(a);AC-8(c)",
          "policies.open-cluster-management.io/controls": "AC-8(a),AC-8(c)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-banner-etc-issue",
        "namespace": "openshift-compliance",
        "resourceVersion": "76771",
        "uid": "51acac41-aeef-4e23-82f3-225772ffbd81"
      },
      "rationale": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.",
      "severity": "medium",
      "title": "Modify the System Login Banner"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To configure the system login banner edit /etc/issue.net. Replace the default text with a message compliant with the local site policy or a legal disclaimer. The DoD required text is either:\n\nYou are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\n\nOR:\n\nI've read & consent to terms in IS user agreem't.",
      "id": "xccdf_org.ssgproject.content_rule_banner_etc_issue_net",
      "instructions": "To check if the system login banner is compliant, run the following command:\n$ cat /etc/issue.net",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "banner-etc-issue-net"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-banner-etc-issue-net",
        "namespace": "openshift-compliance",
        "resourceVersion": "76764",
        "uid": "993014f4-e426-4f01-a70b-c9c9374ac2b8"
      },
      "rationale": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.",
      "severity": "medium",
      "title": "Modify the System Login Banner for Remote Connections"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Configure the system boot firmware (historically called BIOS on PC systems) to disallow booting from USB drives.",
      "id": "xccdf_org.ssgproject.content_rule_bios_disable_usb_boot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "bios-disable-usb-boot",
          "control.compliance.openshift.io/NIST-800-53": "MP-7;CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "MP-7,CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-bios-disable-usb-boot",
        "namespace": "openshift-compliance",
        "resourceVersion": "78294",
        "uid": "716e56af-6694-4bbb-9ceb-460e4840b17b"
      },
      "rationale": "Booting a system from a USB device would allow an attacker to circumvent any security measures provided by the operating system. Attackers could mount partitions and modify the configuration of the OS.",
      "severity": "unknown",
      "title": "Disable Booting from USB Devices in Boot Firmware"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Reboot the system and enter the BIOS or Setup configuration menu. Navigate the BIOS configuration menu and make sure that the option is enabled. The setting may be located under a Security section. Look for Execute Disable (XD) on Intel-based systems and No Execute (NX) on AMD-based systems.",
      "id": "xccdf_org.ssgproject.content_rule_bios_enable_execution_restrictions",
      "instructions": "Verify the NX (no-execution) bit flag is set on the system.\n\nCheck that the no-execution bit flag is set with the following commands:\n\n$ sudo dmesg | grep NX\n\n[ 0.000000] NX (Execute Disable) protection: active\n\nIf \"dmesg\" does not show \"NX (Execute Disable) protection\" active, check the cpuinfo settings with the following command:\n\n$ sudo grep flags /proc/cpuinfo\nflags : fpu vme de pse tsc ms nx rdtscp lm constant_ts\n\nThe output should contain the \"nx\" flag.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "bios-enable-execution-restrictions",
          "control.compliance.openshift.io/NIST-800-53": "SC-39;CM-6(a)",
          "policies.open-cluster-management.io/controls": "SC-39,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-bios-enable-execution-restrictions",
        "namespace": "openshift-compliance",
        "resourceVersion": "78393",
        "uid": "b4a1d84f-3432-4558-8ca3-1ba89458a06b"
      },
      "rationale": "Computers with the ability to prevent this type of code execution frequently put an option in the BIOS that will allow users to turn the feature on or off at will.",
      "severity": "medium",
      "title": "Enable NX or XD Support in the BIOS"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%20Allow%20for%20extra%20configuration%20files.%20This%20is%20useful%0A%23%20for%20admins%20specifying%20their%20own%20NTP%20servers%0Ainclude%20/etc/chrony.d/%2A.conf%0A%0A%23%20Set%20chronyd%20as%20client-only.%0Aport%200%0A%0A%23%20Disable%20chronyc%20from%20the%20network%0Acmdport%200%0A%0A%23%20Record%20the%20rate%20at%20which%20the%20system%20clock%20gains/losses%20time.%0Adriftfile%20/var/lib/chrony/drift%0A%0A%23%20Allow%20the%20system%20clock%20to%20be%20stepped%20in%20the%20first%20three%20updates%0A%23%20if%20its%20offset%20is%20larger%20than%201%20second.%0Amakestep%201.0%203%0A%0A%23%20Enable%20kernel%20synchronization%20of%20the%20real-time%20clock%20%28RTC%29.%0Artcsync%0A%0A%23%20Enable%20hardware%20timestamping%20on%20all%20interfaces%20that%20support%20it.%0A%23hwtimestamp%20%2A%0A%0A%23%20Increase%20the%20minimum%20number%20of%20selectable%20sources%20required%20to%20adjust%0A%23%20the%20system%20clock.%0A%23minsources%202%0A%0A%23%20Allow%20NTP%20client%20access%20from%20local%20network.%0A%23allow%20192.168.0.0/16%0A%0A%23%20Serve%20time%20even%20if%20not%20synchronized%20to%20a%20time%20source.%0A%23local%20stratum%2010%0A%0A%23%20Require%20authentication%20%28nts%20or%20key%20option%29%20for%20all%20NTP%20sources.%0A%23authselectmode%20require%0A%0A%23%20Specify%20file%20containing%20keys%20for%20NTP%20authentication.%0Akeyfile%20/etc/chrony.keys%0A%0A%23%20Insert/delete%20leap%20seconds%20by%20slewing%20instead%20of%20stepping.%0A%23leapsecmode%20slew%0A%0A%23%20Get%20TAI-UTC%20offset%20and%20leap%20seconds%20from%20the%20system%20tz%20database.%0Aleapsectz%20right/UTC%0A%0A%23%20Specify%20directory%20for%20log%20files.%0Alogdir%20/var/log/chrony%0A%0A%23%20Select%20which%20information%20is%20logged.%0A%23log%20measurements%20statistics%20tracking }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.conf"
                    },
                    {
                      "contents": {
                        "source": "data:,"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/.mco-keep"
                    },
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20ntp%20server%0A%23%20%7B%7B.var_multiple_time_servers%7D%7D%20we%20have%20to%20put%20variable%20array%20name%20here%20for%20mutilines%20remediation%0A%7B%7B%24var_time_service_set_maxpoll%3A%3D.var_time_service_set_maxpoll%7D%7D%0A%7B%7Brange%20%24element%3A%3D.var_multiple_time_servers%7CtoArrayByComma%7D%7Dserver%20%7B%7B%24element%7D%7D%20minpoll%204%20maxpoll%20%7B%7B%24var_time_service_set_maxpoll%7D%7D%0A%7B%7Bend%7D%7D }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/ntp-server.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The port option in /etc/chrony.conf can be set to 0 to make chrony daemon to never open any listening port for server operation and to operate strictly in a client-only mode.",
      "id": "xccdf_org.ssgproject.content_rule_chronyd_client_only",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 disables the chrony daemon from acting as a server with the following command:\n$ grep -w port /etc/chrony.conf\nport 0",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "chronyd-client-only",
          "control.compliance.openshift.io/NIST-800-53": "AU-8(1);AU-12(1)",
          "policies.open-cluster-management.io/controls": "AU-8(1),AU-12(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-chronyd-client-only",
        "namespace": "openshift-compliance",
        "resourceVersion": "78466",
        "uid": "443c0239-21e3-4bad-9f3a-84f9867c9725"
      },
      "rationale": "In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems. Operating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component. To support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.",
      "severity": "low",
      "title": "Disable chrony daemon from acting as server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%20Allow%20for%20extra%20configuration%20files.%20This%20is%20useful%0A%23%20for%20admins%20specifying%20their%20own%20NTP%20servers%0Ainclude%20/etc/chrony.d/%2A.conf%0A%0A%23%20Set%20chronyd%20as%20client-only.%0Aport%200%0A%0A%23%20Disable%20chronyc%20from%20the%20network%0Acmdport%200%0A%0A%23%20Record%20the%20rate%20at%20which%20the%20system%20clock%20gains/losses%20time.%0Adriftfile%20/var/lib/chrony/drift%0A%0A%23%20Allow%20the%20system%20clock%20to%20be%20stepped%20in%20the%20first%20three%20updates%0A%23%20if%20its%20offset%20is%20larger%20than%201%20second.%0Amakestep%201.0%203%0A%0A%23%20Enable%20kernel%20synchronization%20of%20the%20real-time%20clock%20%28RTC%29.%0Artcsync%0A%0A%23%20Enable%20hardware%20timestamping%20on%20all%20interfaces%20that%20support%20it.%0A%23hwtimestamp%20%2A%0A%0A%23%20Increase%20the%20minimum%20number%20of%20selectable%20sources%20required%20to%20adjust%0A%23%20the%20system%20clock.%0A%23minsources%202%0A%0A%23%20Allow%20NTP%20client%20access%20from%20local%20network.%0A%23allow%20192.168.0.0/16%0A%0A%23%20Serve%20time%20even%20if%20not%20synchronized%20to%20a%20time%20source.%0A%23local%20stratum%2010%0A%0A%23%20Require%20authentication%20%28nts%20or%20key%20option%29%20for%20all%20NTP%20sources.%0A%23authselectmode%20require%0A%0A%23%20Specify%20file%20containing%20keys%20for%20NTP%20authentication.%0Akeyfile%20/etc/chrony.keys%0A%0A%23%20Insert/delete%20leap%20seconds%20by%20slewing%20instead%20of%20stepping.%0A%23leapsecmode%20slew%0A%0A%23%20Get%20TAI-UTC%20offset%20and%20leap%20seconds%20from%20the%20system%20tz%20database.%0Aleapsectz%20right/UTC%0A%0A%23%20Specify%20directory%20for%20log%20files.%0Alogdir%20/var/log/chrony%0A%0A%23%20Select%20which%20information%20is%20logged.%0A%23log%20measurements%20statistics%20tracking }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.conf"
                    },
                    {
                      "contents": {
                        "source": "data:,"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/.mco-keep"
                    },
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20ntp%20server%0A%23%20%7B%7B.var_multiple_time_servers%7D%7D%20we%20have%20to%20put%20variable%20array%20name%20here%20for%20mutilines%20remediation%0A%7B%7B%24var_time_service_set_maxpoll%3A%3D.var_time_service_set_maxpoll%7D%7D%0A%7B%7Brange%20%24element%3A%3D.var_multiple_time_servers%7CtoArrayByComma%7D%7Dserver%20%7B%7B%24element%7D%7D%20minpoll%204%20maxpoll%20%7B%7B%24var_time_service_set_maxpoll%7D%7D%0A%7B%7Bend%7D%7D }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/ntp-server.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The cmdport option in /etc/chrony.conf can be set to 0 to stop chrony daemon from listening on the UDP port 323 for management connections made by chronyc.",
      "id": "xccdf_org.ssgproject.content_rule_chronyd_no_chronyc_network",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 disables network management of the chrony daemon with the following command:\n$ grep -w cmdport /etc/chrony.conf\ncmdport 0",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "chronyd-no-chronyc-network",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(1)",
          "policies.open-cluster-management.io/controls": "CM-7(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-chronyd-no-chronyc-network",
        "namespace": "openshift-compliance",
        "resourceVersion": "78468",
        "uid": "1eb2afc6-ba75-4a53-a2bb-e1957bb79d51"
      },
      "rationale": "Minimizing the exposure of the server functionality of the chrony daemon diminishes the attack surface.",
      "severity": "low",
      "title": "Disable network management of chrony daemon"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%20Allow%20for%20extra%20configuration%20files.%20This%20is%20useful%0A%23%20for%20admins%20specifying%20their%20own%20NTP%20servers%0Ainclude%20/etc/chrony.d/%2A.conf%0A%0A%23%20Set%20chronyd%20as%20client-only.%0Aport%200%0A%0A%23%20Disable%20chronyc%20from%20the%20network%0Acmdport%200%0A%0A%23%20Record%20the%20rate%20at%20which%20the%20system%20clock%20gains/losses%20time.%0Adriftfile%20/var/lib/chrony/drift%0A%0A%23%20Allow%20the%20system%20clock%20to%20be%20stepped%20in%20the%20first%20three%20updates%0A%23%20if%20its%20offset%20is%20larger%20than%201%20second.%0Amakestep%201.0%203%0A%0A%23%20Enable%20kernel%20synchronization%20of%20the%20real-time%20clock%20%28RTC%29.%0Artcsync%0A%0A%23%20Enable%20hardware%20timestamping%20on%20all%20interfaces%20that%20support%20it.%0A%23hwtimestamp%20%2A%0A%0A%23%20Increase%20the%20minimum%20number%20of%20selectable%20sources%20required%20to%20adjust%0A%23%20the%20system%20clock.%0A%23minsources%202%0A%0A%23%20Allow%20NTP%20client%20access%20from%20local%20network.%0A%23allow%20192.168.0.0/16%0A%0A%23%20Serve%20time%20even%20if%20not%20synchronized%20to%20a%20time%20source.%0A%23local%20stratum%2010%0A%0A%23%20Require%20authentication%20%28nts%20or%20key%20option%29%20for%20all%20NTP%20sources.%0A%23authselectmode%20require%0A%0A%23%20Specify%20file%20containing%20keys%20for%20NTP%20authentication.%0Akeyfile%20/etc/chrony.keys%0A%0A%23%20Insert/delete%20leap%20seconds%20by%20slewing%20instead%20of%20stepping.%0A%23leapsecmode%20slew%0A%0A%23%20Get%20TAI-UTC%20offset%20and%20leap%20seconds%20from%20the%20system%20tz%20database.%0Aleapsectz%20right/UTC%0A%0A%23%20Specify%20directory%20for%20log%20files.%0Alogdir%20/var/log/chrony%0A%0A%23%20Select%20which%20information%20is%20logged.%0A%23log%20measurements%20statistics%20tracking }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.conf"
                    },
                    {
                      "contents": {
                        "source": "data:,"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/.mco-keep"
                    },
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20ntp%20server%0A%23%20%7B%7B.var_multiple_time_servers%7D%7D%20we%20have%20to%20put%20variable%20array%20name%20here%20for%20mutilines%20remediation%0A%7B%7B%24var_time_service_set_maxpoll%3A%3D.var_time_service_set_maxpoll%7D%7D%0A%7B%7Brange%20%24element%3A%3D.var_multiple_time_servers%7CtoArrayByComma%7D%7Dserver%20%7B%7B%24element%7D%7D%20minpoll%204%20maxpoll%20%7B%7B%24var_time_service_set_maxpoll%7D%7D%0A%7B%7Bend%7D%7D }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/ntp-server.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The maxpoll should be configured to 10 in /etc/ntp.conf or /etc/chrony.conf to continuously poll time servers. To configure maxpoll in /etc/ntp.conf or /etc/chrony.conf add the following after each `server`, `pool` or `peer` entry:\n\nmaxpoll 10 \n\nto\n\nserver\n\ndirectives. If using chrony any\n\npool\n\ndirectives should be configured too. If no server or pool directives are configured, the rule evaluates to pass.\n\nNote that if the remediation shipping with this content is being used, the *MachineConfig* shipped does not include reference NTP servers to point to. It is up to the admin to set these which will vary depending on the cluster's requirements.\n\nThe aforementioned remediation does include the directory /etc/chrony.d which would allow the creation of configuration files to set these servers.\n\nIf we'd like to set a configuration like the following:\n\npool 2.rhel.pool.ntp.org iburst\n\nserver 0.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 1.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 2.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 3.rhel.pool.ntp.org minpoll 4 maxpoll 10\n\nThis could be done with to the following manifest:\n\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-chrony-servers\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,pool%202.rhel.pool.ntp.org%20iburst%0A%0Aserver%200.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%201.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%202.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%203.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010\n       mode: 0600\n       path: /etc/chrony.d/10-rhel-pool-and-servers.conf\n       overwrite: true\n\nNote that this needs to be done for each\n\nMachineConfigPool",
      "id": "xccdf_org.ssgproject.content_rule_chronyd_or_ntpd_set_maxpoll",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 is securely comparing internal information system clocks at a regular interval with an NTP server with the following command:\n$ sudo grep maxpoll /etc/ntp.conf /etc/chrony.conf\nserver [ntp.server.name] iburst maxpoll .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "chronyd-or-ntpd-set-maxpoll",
          "compliance.openshift.io/rule-variable": "var-time-service-set-maxpoll,var-time-service-set-maxpoll",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-8(1)(b);AU-12(1)",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-8(1)(b),AU-12(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-chronyd-or-ntpd-set-maxpoll",
        "namespace": "openshift-compliance",
        "resourceVersion": "78469",
        "uid": "159e90c9-a99f-4de4-97e9-5904d1e821ad"
      },
      "rationale": "Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside the configured acceptable allowance (drift) may be inaccurate. Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network. Organizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).",
      "severity": "medium",
      "title": "Configure Time Service Maxpoll Interval"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%20Allow%20for%20extra%20configuration%20files.%20This%20is%20useful%0A%23%20for%20admins%20specifying%20their%20own%20NTP%20servers%0Ainclude%20/etc/chrony.d/%2A.conf%0A%0A%23%20Set%20chronyd%20as%20client-only.%0Aport%200%0A%0A%23%20Disable%20chronyc%20from%20the%20network%0Acmdport%200%0A%0A%23%20Record%20the%20rate%20at%20which%20the%20system%20clock%20gains/losses%20time.%0Adriftfile%20/var/lib/chrony/drift%0A%0A%23%20Allow%20the%20system%20clock%20to%20be%20stepped%20in%20the%20first%20three%20updates%0A%23%20if%20its%20offset%20is%20larger%20than%201%20second.%0Amakestep%201.0%203%0A%0A%23%20Enable%20kernel%20synchronization%20of%20the%20real-time%20clock%20%28RTC%29.%0Artcsync%0A%0A%23%20Enable%20hardware%20timestamping%20on%20all%20interfaces%20that%20support%20it.%0A%23hwtimestamp%20%2A%0A%0A%23%20Increase%20the%20minimum%20number%20of%20selectable%20sources%20required%20to%20adjust%0A%23%20the%20system%20clock.%0A%23minsources%202%0A%0A%23%20Allow%20NTP%20client%20access%20from%20local%20network.%0A%23allow%20192.168.0.0/16%0A%0A%23%20Serve%20time%20even%20if%20not%20synchronized%20to%20a%20time%20source.%0A%23local%20stratum%2010%0A%0A%23%20Require%20authentication%20%28nts%20or%20key%20option%29%20for%20all%20NTP%20sources.%0A%23authselectmode%20require%0A%0A%23%20Specify%20file%20containing%20keys%20for%20NTP%20authentication.%0Akeyfile%20/etc/chrony.keys%0A%0A%23%20Insert/delete%20leap%20seconds%20by%20slewing%20instead%20of%20stepping.%0A%23leapsecmode%20slew%0A%0A%23%20Get%20TAI-UTC%20offset%20and%20leap%20seconds%20from%20the%20system%20tz%20database.%0Aleapsectz%20right/UTC%0A%0A%23%20Specify%20directory%20for%20log%20files.%0Alogdir%20/var/log/chrony%0A%0A%23%20Select%20which%20information%20is%20logged.%0A%23log%20measurements%20statistics%20tracking }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.conf"
                    },
                    {
                      "contents": {
                        "source": "data:,"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/.mco-keep"
                    },
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20ntp%20server%0A%23%20%7B%7B.var_multiple_time_servers%7D%7D%20we%20have%20to%20put%20variable%20array%20name%20here%20for%20mutilines%20remediation%0A%7B%7B%24var_time_service_set_maxpoll%3A%3D.var_time_service_set_maxpoll%7D%7D%0A%7B%7Brange%20%24element%3A%3D.var_multiple_time_servers%7CtoArrayByComma%7D%7Dserver%20%7B%7B%24element%7D%7D%20minpoll%204%20maxpoll%20%7B%7B%24var_time_service_set_maxpoll%7D%7D%0A%7B%7Bend%7D%7D }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/ntp-server.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Depending on specific functional requirements of a concrete production environment, the Red Hat Enterprise Linux CoreOS 4 system can be configured to utilize the services of the chronyd NTP daemon (the default), or services of the ntpd NTP daemon. Refer to https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-configuring_ntp_using_the_chrony_suite for more detailed comparison of the features of both of the choices, and for further guidance how to choose between the two NTP daemons.\n\nAdditional NTP servers can be specified for time synchronization. To do so, perform the following:\n\n* if the system is configured to use the chronyd as the NTP daemon (the default), edit the file /etc/chrony.conf as follows,\n* if the system is configured to use the ntpd as the NTP daemon, edit the file /etc/ntp.conf as documented below.\n\nAdd additional lines of the following form, substituting the IP address or hostname of a remote NTP server for ntpserver :\n\nserver ntpserver\n\nNote that if the remediation shipping with this content is being used, the *MachineConfig* shipped does not include reference NTP servers to point to. It is up to the admin to set these which will vary depending on the cluster's requirements.\n\nThe aforementioned remediation does include the directory /etc/chrony.d which would allow the creation of configuration files to set these servers.\n\nIf we'd like to set a configuration like the following:\n\npool 2.rhel.pool.ntp.org iburst\n\nserver 0.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 1.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 2.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 3.rhel.pool.ntp.org minpoll 4 maxpoll 10\n\nThis could be done with to the following manifest:\n\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-chrony-servers\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,pool%202.rhel.pool.ntp.org%20iburst%0A%0Aserver%200.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%201.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%202.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%203.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010\n       mode: 0600\n       path: /etc/chrony.d/10-rhel-pool-and-servers.conf\n       overwrite: true\n\nNote that this needs to be done for each\n\nMachineConfigPool",
      "id": "xccdf_org.ssgproject.content_rule_chronyd_or_ntpd_specify_multiple_servers",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "chronyd-or-ntpd-specify-multiple-servers",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-8(1)(a);AU-8(2);AU-12(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.3",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-8(1)(a),AU-8(2),AU-12(1),Req-10.4.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-chronyd-or-ntpd-specify-multiple-servers",
        "namespace": "openshift-compliance",
        "resourceVersion": "78471",
        "uid": "a61c9bf1-3047-4e5b-ab09-a164b7119565"
      },
      "rationale": "Specifying additional NTP servers increases the availability of accurate time data, in the event that one of the specified servers becomes unavailable. This is typical for a system acting as an NTP server for other systems.",
      "severity": "medium",
      "title": "Specify Additional Remote NTP Servers"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%20Allow%20for%20extra%20configuration%20files.%20This%20is%20useful%0A%23%20for%20admins%20specifying%20their%20own%20NTP%20servers%0Ainclude%20/etc/chrony.d/%2A.conf%0A%0A%23%20Set%20chronyd%20as%20client-only.%0Aport%200%0A%0A%23%20Disable%20chronyc%20from%20the%20network%0Acmdport%200%0A%0A%23%20Record%20the%20rate%20at%20which%20the%20system%20clock%20gains/losses%20time.%0Adriftfile%20/var/lib/chrony/drift%0A%0A%23%20Allow%20the%20system%20clock%20to%20be%20stepped%20in%20the%20first%20three%20updates%0A%23%20if%20its%20offset%20is%20larger%20than%201%20second.%0Amakestep%201.0%203%0A%0A%23%20Enable%20kernel%20synchronization%20of%20the%20real-time%20clock%20%28RTC%29.%0Artcsync%0A%0A%23%20Enable%20hardware%20timestamping%20on%20all%20interfaces%20that%20support%20it.%0A%23hwtimestamp%20%2A%0A%0A%23%20Increase%20the%20minimum%20number%20of%20selectable%20sources%20required%20to%20adjust%0A%23%20the%20system%20clock.%0A%23minsources%202%0A%0A%23%20Allow%20NTP%20client%20access%20from%20local%20network.%0A%23allow%20192.168.0.0/16%0A%0A%23%20Serve%20time%20even%20if%20not%20synchronized%20to%20a%20time%20source.%0A%23local%20stratum%2010%0A%0A%23%20Require%20authentication%20%28nts%20or%20key%20option%29%20for%20all%20NTP%20sources.%0A%23authselectmode%20require%0A%0A%23%20Specify%20file%20containing%20keys%20for%20NTP%20authentication.%0Akeyfile%20/etc/chrony.keys%0A%0A%23%20Insert/delete%20leap%20seconds%20by%20slewing%20instead%20of%20stepping.%0A%23leapsecmode%20slew%0A%0A%23%20Get%20TAI-UTC%20offset%20and%20leap%20seconds%20from%20the%20system%20tz%20database.%0Aleapsectz%20right/UTC%0A%0A%23%20Specify%20directory%20for%20log%20files.%0Alogdir%20/var/log/chrony%0A%0A%23%20Select%20which%20information%20is%20logged.%0A%23log%20measurements%20statistics%20tracking }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.conf"
                    },
                    {
                      "contents": {
                        "source": "data:,"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/.mco-keep"
                    },
                    {
                      "contents": {
                        "source": "data:,{{ %23%0A%23%20This%20file%20controls%20the%20configuration%20of%20the%20ntp%20server%0A%23%20%7B%7B.var_multiple_time_servers%7D%7D%20we%20have%20to%20put%20variable%20array%20name%20here%20for%20mutilines%20remediation%0A%7B%7B%24var_time_service_set_maxpoll%3A%3D.var_time_service_set_maxpoll%7D%7D%0A%7B%7Brange%20%24element%3A%3D.var_multiple_time_servers%7CtoArrayByComma%7D%7Dserver%20%7B%7B%24element%7D%7D%20minpoll%204%20maxpoll%20%7B%7B%24var_time_service_set_maxpoll%7D%7D%0A%7B%7Bend%7D%7D }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/chrony.d/ntp-server.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Depending on specific functional requirements of a concrete production environment, the Red Hat Enterprise Linux CoreOS 4 system can be configured to utilize the services of the chronyd NTP daemon (the default), or services of the ntpd NTP daemon. Refer to https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-configuring_ntp_using_the_chrony_suite for more detailed comparison of the features of both of the choices, and for further guidance how to choose between the two NTP daemons.\n\nTo specify a remote NTP server for time synchronization, perform the following:\n\n* if the system is configured to use the chronyd as the NTP daemon (the default), edit the file /etc/chrony.conf as follows,\n* if the system is configured to use the ntpd as the NTP daemon, edit the file /etc/ntp.conf as documented below.\n\nAdd or correct the following lines, substituting the IP or hostname of a remote NTP server for ntpserver :\n\nserver ntpserver\n\nThis instructs the NTP software to contact that remote server to obtain time data.\n\nNote that if the remediation shipping with this content is being used, the *MachineConfig* shipped does not include reference NTP servers to point to. It is up to the admin to set these which will vary depending on the cluster's requirements.\n\nThe aforementioned remediation does include the directory /etc/chrony.d which would allow the creation of configuration files to set these servers.\n\nIf we'd like to set a configuration like the following:\n\npool 2.rhel.pool.ntp.org iburst\n\nserver 0.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 1.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 2.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 3.rhel.pool.ntp.org minpoll 4 maxpoll 10\n\nThis could be done with to the following manifest:\n\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-chrony-servers\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,pool%202.rhel.pool.ntp.org%20iburst%0A%0Aserver%200.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%201.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%202.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%203.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010\n       mode: 0600\n       path: /etc/chrony.d/10-rhel-pool-and-servers.conf\n       overwrite: true\n\nNote that this needs to be done for each\n\nMachineConfigPool",
      "id": "xccdf_org.ssgproject.content_rule_chronyd_or_ntpd_specify_remote_server",
      "instructions": "To verify that a remote NTP service is configured for time synchronization,\nopen the following file:\n\n/etc/chrony.conf in the case the system in question is\nconfigured to use the chronyd as the NTP daemon (default setting)\n/etc/ntp.conf in the case the system in question is configured\nto use the ntpd as the NTP daemon\n\nIn the file, there should be a section similar to the following:\nserver ntpserver",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "chronyd-or-ntpd-specify-remote-server",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-8(1)(a);AU-8(2);AU-12(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.1;Req-10.4.3",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-8(1)(a),AU-8(2),AU-12(1),Req-10.4.1,Req-10.4.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-chronyd-or-ntpd-specify-remote-server",
        "namespace": "openshift-compliance",
        "resourceVersion": "78473",
        "uid": "98b1eaff-6212-42f0-859b-4344b8eb80c7"
      },
      "rationale": "Synchronizing with an NTP server makes it possible to collate system logs from multiple sources or correlate computer events with real time events.",
      "severity": "medium",
      "title": "Specify a Remote NTP Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Check that Chrony only has time sources configured with the server directive.",
      "id": "xccdf_org.ssgproject.content_rule_chronyd_server_directive",
      "instructions": "Run the following command and verify that time sources are only configured with server directive:\n# grep -E \"^(server|pool)\" /etc/chrony.conf\nA line with the appropriate server should be returned, any line returned starting with pool is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "chronyd-server-directive"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-chronyd-server-directive",
        "namespace": "openshift-compliance",
        "resourceVersion": "78474",
        "uid": "6a16a23c-c9fe-495d-8255-494bf099aea8"
      },
      "rationale": "Depending on the infrastructure being used the pool directive may not be supported.",
      "severity": "medium",
      "title": "Ensure Chrony is only configured with the server directive",
      "warning": "Depending on the infrastructure being used the pool directive may not be supported."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Chrony is a daemon which implements the Network Time Protocol (NTP). It is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on chrony can be found at http://chrony.tuxfamily.org/. Chrony can be configured to be a client and/or a server. Add or edit server or pool lines to /etc/chrony.conf as appropriate:\n\nserver \n\nMultiple servers may be configured.",
      "id": "xccdf_org.ssgproject.content_rule_chronyd_specify_remote_server",
      "instructions": "Run the following command and verify remote server is configured properly:\n# grep -E \"^(server|pool)\" /etc/chrony.conf",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "chronyd-specify-remote-server",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-8(1)(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.3",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-8(1)(a),Req-10.4.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-chronyd-specify-remote-server",
        "namespace": "openshift-compliance",
        "resourceVersion": "78476",
        "uid": "c2645016-6444-4eba-bffa-99d717e086dd"
      },
      "rationale": "If chrony is in use on the system proper configuration is vital to ensuring time synchronization is working properly.",
      "severity": "medium",
      "title": "A remote time server for Chrony is configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The tmux terminal multiplexer is used to implement automatic session locking. It should be started from /etc/bashrc or drop-in files within /etc/profile.d/.",
      "id": "xccdf_org.ssgproject.content_rule_configure_bashrc_exec_tmux",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 shell initialization file is configured to start each shell with the tmux terminal multiplexer.\n\nDetermine the location of the tmux script with the following command:\n\n$ sudo grep tmux /etc/bashrc /etc/profile.d/*\n\n/etc/profile.d/tmux.sh:  case \"$name\" in (sshd|login) exec tmux ;; esac\n\nReview the tmux script by using the following example:\n\n$ cat /etc/profile.d/tmux.sh\n\nif [ \"$PS1\" ]; then\nparent=$(ps -o ppid= -p $$)\nname=$(ps -o comm= -p $parent)\ncase \"$name\" in (sshd|login) exec tmux ;; esac\nfi\n\nIf the shell file is not configured as the example above, is commented out, or is missing, this is a finding.\n\nDetermine if tmux is currently running with the following command:\n\n$ sudo ps all | grep tmux | grep -v grep",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "configure-bashrc-exec-tmux"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-bashrc-exec-tmux",
        "namespace": "openshift-compliance",
        "resourceVersion": "76872",
        "uid": "13fafa2b-8dc9-4995-9560-04f9530a5791"
      },
      "rationale": "Unlike bash itself, the tmux terminal multiplexer provides a mechanism to lock sessions after period of inactivity. A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence.",
      "severity": "medium",
      "title": "Support session locking with tmux"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Crypto Policies provide a centralized control over crypto algorithms usage of many packages. BIND is supported by crypto policy, but the BIND configuration may be set up to ignore it. To check that Crypto Policies settings are configured correctly, ensure that the /etc/named.conf includes the appropriate configuration: In the options section of /etc/named.conf , make sure that the following line is not commented out or superseded by later includes: include \"/etc/crypto-policies/back-ends/bind.config\";",
      "id": "xccdf_org.ssgproject.content_rule_configure_bind_crypto_policy",
      "instructions": "To verify that BIND uses the system crypto policy, check out that the BIND config file\n/etc/named.conf contains the include \"/etc/crypto-policies/back-ends/bind.config\";\ndirective:\n$ sudo grep 'include \"/etc/crypto-policies/back-ends/bind.config\";' /etc/named.conf\nVerify that the directive is at the bottom of the options section of the config file.\n      Is it the case that BIND is installed and the BIND config file doesn't contain the",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "configure-bind-crypto-policy",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-13;SC-12(2);SC-12(3)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-13,SC-12(2),SC-12(3)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-bind-crypto-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "76593",
        "uid": "e5a07d9b-ee81-4c6a-a01e-976b295b2e36"
      },
      "rationale": "Overriding the system crypto policy makes the behavior of the BIND service violate expectations, and makes system configuration more fragmented.",
      "severity": "high",
      "title": "Configure BIND to use System Crypto Policy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "systemd": {
                  "units": [
                    {
                      "contents": "[Unit]\nBefore=kubelet.service\n[Service]\nType=oneshot\nExecStart=update-crypto-policies --set {{.var_system_crypto_policy}}\nRemainAfterExit=yes\n[Install]\nWantedBy=multi-user.target\n",
                      "enabled": true,
                      "name": "configure-crypto-policy.service"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system cryptography policy to use ciphers only from the DEFAULT policy, create a MachineConfig as follows:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 50-master-configure-crypto-policy\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n       - name: configure-crypto-policy.service\n         enabled: true\n         contents: |\n           [Unit]\n           Before=kubelet.service\n           [Service]\n           Type=oneshot\n           ExecStart=update-crypto-policies --set DEFAULT RemainAfterExit=yes\n           [Install]\n           WantedBy=multi-user.target\n\nThis will configure the crypto policy appropriately in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).\n\nThe rule checks if settings for selected crypto policy are configured as expected. Configuration files in the /etc/crypto-policies/back-ends are either symlinks to correct files provided by Crypto-policies package or they are regular files in case crypto policy customizations are applied. Crypto policies may be customized by crypto policy modules, in which case it is delimited from the base policy using a colon.",
      "id": "xccdf_org.ssgproject.content_rule_configure_crypto_policy",
      "instructions": "To verify that cryptography policy has been configured correctly, run the\nfollowing command:\n$ update-crypto-policies --show\nThe output should return .\nRun the command to check if the policy is correctly applied:\n$ update-crypto-policies --is-applied\nThe output should be The configured policy is applied.\nMoreover, check if settings for selected crypto policy are as expected.\nList all libraries for which it holds that their crypto policies do not have symbolic link in /etc/crypto-policies/back-ends.\n$ ls -l /etc/crypto-policies/back-ends/ | grep '^[^l]' | tail -n +2 | awk -F' ' '{print $NF}' | awk -F'.' '{print $1}' | sort\nSubsequently, check if matching libraries have drop in files in the /etc/crypto-policies/local.d directory.\n$ ls /etc/crypto-policies/local.d/ | awk -F'-' '{print $1}' | uniq | sort\nOutputs of two previous commands should match.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "configure-crypto-policy",
          "compliance.openshift.io/rule-variable": "var-system-crypto-policy,var-system-crypto-policy",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1;CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);AC-17(2);CM-6(a);MA-4(6);SC-13;SC-12(2);SC-12(3)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CIP-007-3 R7.1,AC-17(a),AC-17(2),CM-6(a),MA-4(6),SC-13,SC-12(2),SC-12(3)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-crypto-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "76597",
        "uid": "9f1e870a-10f6-4f46-ab64-d71516e036a4"
      },
      "rationale": "Centralized cryptographic policies simplify applying secure ciphers across an operating system and the applications that run on that operating system. Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data.",
      "severity": "high",
      "title": "Configure System Cryptography Policy",
      "warning": "Centralized cryptographic policies simplify applying secure ciphers across an operating system and the applications that run on that operating system. Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Crypto Policies provide a centralized control over crypto algorithms usage of many packages. Kerberos is supported by crypto policy, but it's configuration may be set up to ignore it. To check that Crypto Policies settings for Kerberos are configured correctly, examine that there is a symlink at /etc/krb5.conf.d/crypto-policies targeting /etc/cypto-policies/back-ends/krb5.config. If the symlink exists, Kerberos is configured to use the system-wide crypto policy settings.",
      "id": "xccdf_org.ssgproject.content_rule_configure_kerberos_crypto_policy",
      "instructions": "Check that the symlink exists and target the correct Kerberos crypto policy, with the following command:\nfile /etc/krb5.conf.d/crypto-policies\nIf command ouput shows the following line, Kerberos is configured to use the system-wide crypto policy.\n/etc/krb5.conf.d/crypto-policies: symbolic link to /etc/crypto-policies/back-ends/krb5.config",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "configure-kerberos-crypto-policy",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-13;SC-12(2);SC-12(3)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-13,SC-12(2),SC-12(3)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-kerberos-crypto-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "76586",
        "uid": "ddc71064-0ce4-4c6c-83dd-b147a49d50a1"
      },
      "rationale": "Overriding the system crypto policy makes the behavior of Kerberos violate expectations, and makes system configuration more fragmented.",
      "severity": "high",
      "title": "Configure Kerberos to use System Crypto Policy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Crypto Policies provide a centralized control over crypto algorithms usage of many packages. Libreswan is supported by system crypto policy, but the Libreswan configuration may be set up to ignore it. To check that Crypto Policies settings are configured correctly, ensure that the /etc/ipsec.conf includes the appropriate configuration file. In /etc/ipsec.conf , make sure that the following line is not commented out or superseded by later includes: include /etc/crypto-policies/back-ends/libreswan.config",
      "id": "xccdf_org.ssgproject.content_rule_configure_libreswan_crypto_policy",
      "instructions": "Verify that the IPSec service uses the system crypto policy.\n\nIf the ipsec service is not installed is not applicable.\n\nCheck to see if the \"IPsec\" service is active with the following command:\n\n$ systemctl status ipsec\n\nipsec.service - Internet Key Exchange (IKE) Protocol Daemon for IPsec\nLoaded: loaded (/usr/lib/systemd/system/ipsec.service; disabled)\nActive: inactive (dead)\n\nIf the \"IPsec\" service is active, check to see if it is using the system crypto policy with the following command:\n\n$ sudo grep include /etc/ipsec.conf /etc/ipsec.d/*.conf\n\n/etc/ipsec.conf:include /etc/crypto-policies/back-ends/libreswan.config",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "configure-libreswan-crypto-policy",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);MA-4(6);SC-13;SC-12(2);SC-12(3)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CM-6(a),MA-4(6),SC-13,SC-12(2),SC-12(3),Req-2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-libreswan-crypto-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "76584",
        "uid": "f73c7bd3-da45-42c5-b0dc-738ccded532c"
      },
      "rationale": "Overriding the system crypto policy makes the behavior of the Libreswan service violate expectations, and makes system configuration more fragmented.",
      "severity": "high",
      "title": "Configure Libreswan to use System Crypto Policy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Crypto Policies provide a centralized control over crypto algorithms usage of many packages. OpenSSL is supported by crypto policy, but the OpenSSL configuration may be set up to ignore it. To check that Crypto Policies settings are configured correctly, you have to examine the OpenSSL config file available under /etc/pki/tls/openssl.cnf. This file has the ini format, and it enables crypto policy support if there is a [ crypto_policy ] section that contains the.include /etc/crypto-policies/back-ends/opensslcnf.config directive.",
      "id": "xccdf_org.ssgproject.content_rule_configure_openssl_crypto_policy",
      "instructions": "To verify that OpenSSL uses the system crypto policy, check out that the OpenSSL config file\n/etc/pki/tls/openssl.cnf contains the [ crypto_policy ] section with the\n.include /etc/crypto-policies/back-ends/opensslcnf.config directive:\n\n$ sudo grep '\\.include\\s* /etc/crypto-policies/back-ends/opensslcnf.config$' /etc/pki/tls/openssl.cnf.\n      Is it the case that the OpenSSL config file doesn't contain the whole section,",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "configure-openssl-crypto-policy",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1;CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);AC-17(2);CM-6(a);MA-4(6);SC-13;SC-12(2);SC-12(3)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CIP-007-3 R7.1,AC-17(a),AC-17(2),CM-6(a),MA-4(6),SC-13,SC-12(2),SC-12(3),Req-2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-openssl-crypto-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "76594",
        "uid": "5cdd7558-d039-469d-86ce-f55719fe3546"
      },
      "rationale": "Overriding the system crypto policy makes the behavior of the Java runtime violates expectations, and makes system configuration more fragmented.",
      "severity": "medium",
      "title": "Configure OpenSSL library to use System Crypto Policy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Crypto Policies provide a centralized control over crypto algorithms usage of many packages. SSH is supported by crypto policy, but the SSH configuration may be set up to ignore it. To check that Crypto Policies settings are configured correctly, ensure that the CRYPTO_POLICY variable is either commented or not set at all in the /etc/sysconfig/sshd.",
      "id": "xccdf_org.ssgproject.content_rule_configure_ssh_crypto_policy",
      "instructions": "Verify that sshd isn't configured to ignore the system wide cryptographic policy.\n\nCheck that the CRYPTO_POLICY variable is not set or is commented out in the\n/etc/sysconfig/sshd.\n\nRun the following command:\n\n$ sudo grep CRYPTO_POLICY /etc/sysconfig/sshd",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8,rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "configure-ssh-crypto-policy",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1;CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);AC-17(2);CM-6(a);MA-4(6);SC-13",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CIP-007-3 R7.1,AC-17(a),AC-17(2),CM-6(a),MA-4(6),SC-13,Req-2.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-ssh-crypto-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "76600",
        "uid": "f3330286-4ff9-482b-9700-651aab049aa4"
      },
      "rationale": "Overriding the system crypto policy makes the behavior of the SSH service violate expectations, and makes system configuration more fragmented.",
      "severity": "medium",
      "title": "Configure SSH to use System Crypto Policy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable console screen locking in tmux terminal multiplexer after a period of inactivity, the lock-after-time option has to be set to a value greater than 0 and less than or equal to 900 in /etc/tmux.conf.",
      "id": "xccdf_org.ssgproject.content_rule_configure_tmux_lock_after_time",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 initiates a session lock after 15 minutes of inactivity.\n\nCheck the value of the system inactivity timeout with the following command:\n\n$ grep -i lock-after-time /etc/tmux.conf\n\nset -g lock-after-time 900\n\nThen, verify that the /etc/tmux.conf file can be read by other users than root:\n\n$ sudo ls -al /etc/tmux.conf",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "configure-tmux-lock-after-time"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-tmux-lock-after-time",
        "namespace": "openshift-compliance",
        "resourceVersion": "76875",
        "uid": "3bf3baf8-e718-47c3-ac91-f1c2e4db8d24"
      },
      "rationale": "Locking the session after a period of inactivity limits the potential exposure if the session is left unattended.",
      "severity": "medium",
      "title": "Configure tmux to lock session after inactivity"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable console screen locking in tmux terminal multiplexer, the vlock command must be configured to be used as a locking mechanism. Add the following line to /etc/tmux.conf :\n\nset -g lock-command vlock\n\n. The console can now be locked with the following key combination:\n\nctrl+b :lock-session",
      "id": "xccdf_org.ssgproject.content_rule_configure_tmux_lock_command",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 enables the user to initiate a session lock with the following command:\n\n$ grep lock-command /etc/tmux.conf\n\nset -g lock-command vlock\n\nThen, verify that the /etc/tmux.conf file can be read by other users than root:\n\n$ sudo ls -al /etc/tmux.conf",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "configure-tmux-lock-command",
          "control.compliance.openshift.io/NIST-800-53": "AC-11(a);AC-11(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-11(a),AC-11(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-tmux-lock-command",
        "namespace": "openshift-compliance",
        "resourceVersion": "76883",
        "uid": "720e8bc9-d8c3-48fd-8621-499f7d8bfb65"
      },
      "rationale": "The tmux package allows for a session lock to be implemented and configured. However, the session lock is implemented by an external command. The tmux default configuration does not contain an effective session lock.",
      "severity": "medium",
      "title": "Configure the tmux Lock Command"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "metadata": {
              "annotations": {
                "complianceascode.io/depends-on": "xccdf_org.ssgproject.content_rule_package_usbguard_installed",
                "complianceascode.io/ocp-version": ">=4.7.0"
              }
            },
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%0A%23%20Rule%20set%20file%20path.%0A%23%0A%23%20The%20USBGuard%20daemon%20will%20use%20this%20file%20to%20load%20the%20policy%0A%23%20rule%20set%20from%20it%20and%20to%20write%20new%20rules%20received%20via%20the%0A%23%20IPC%20interface.%0A%23%0A%23%20RuleFile%3D/path/to/rules.conf%0A%23%0ARuleFile%3D/etc/usbguard/rules.conf%0A%0A%23%0A%23%20Rule%20set%20folder%20path.%0A%23%0A%23%20The%20USBGuard%20daemon%20will%20use%20this%20folder%20to%20load%20the%20policy%0A%23%20rule%20set%20from%20it%20and%20to%20write%20new%20rules%20received%20via%20the%0A%23%20IPC%20interface.%20Usually%2C%20we%20set%20the%20option%20to%0A%23%20/etc/usbguard/rules.d/.%20The%20USBGuard%20daemon%20is%20supposed%20to%0A%23%20behave%20like%20any%20other%20standard%20Linux%20daemon%20therefore%20it%0A%23%20loads%20rule%20files%20in%20alpha-numeric%20order.%20File%20names%20inside%0A%23%20RuleFolder%20directory%20should%20start%20with%20a%20two-digit%20number%0A%23%20prefix%20indicating%20the%20position%2C%20in%20which%20the%20rules%20are%0A%23%20scanned%20by%20the%20daemon.%0A%23%0A%23%20RuleFolder%3D/path/to/rulesfolder/%0A%23%0ARuleFolder%3D/etc/usbguard/rules.d/%0A%0A%23%0A%23%20Implicit%20policy%20target.%0A%23%0A%23%20How%20to%20treat%20devices%20that%20don%27t%20match%20any%20rule%20in%20the%0A%23%20policy.%20One%20of%3A%0A%23%0A%23%20%2A%20allow%20%20-%20authorize%20the%20device%0A%23%20%2A%20block%20%20-%20block%20the%20device%0A%23%20%2A%20reject%20-%20remove%20the%20device%0A%23%0AImplicitPolicyTarget%3Dblock%0A%0A%23%0A%23%20Present%20device%20policy.%0A%23%0A%23%20How%20to%20treat%20devices%20that%20are%20already%20connected%20when%20the%0A%23%20daemon%20starts.%20One%20of%3A%0A%23%0A%23%20%2A%20allow%20%20%20%20%20%20%20%20-%20authorize%20every%20present%20device%0A%23%20%2A%20block%20%20%20%20%20%20%20%20-%20deauthorize%20every%20present%20device%0A%23%20%2A%20reject%20%20%20%20%20%20%20-%20remove%20every%20present%20device%0A%23%20%2A%20keep%20%20%20%20%20%20%20%20%20-%20just%20sync%20the%20internal%20state%20and%20leave%20it%0A%23%20%2A%20apply-policy%20-%20evaluate%20the%20ruleset%20for%20every%20present%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20device%0A%23%0APresentDevicePolicy%3Dapply-policy%0A%0A%23%0A%23%20Present%20controller%20policy.%0A%23%0A%23%20How%20to%20treat%20USB%20controllers%20that%20are%20already%20connected%0A%23%20when%20the%20daemon%20starts.%20One%20of%3A%0A%23%0A%23%20%2A%20allow%20%20%20%20%20%20%20%20-%20authorize%20every%20present%20device%0A%23%20%2A%20block%20%20%20%20%20%20%20%20-%20deauthorize%20every%20present%20device%0A%23%20%2A%20reject%20%20%20%20%20%20%20-%20remove%20every%20present%20device%0A%23%20%2A%20keep%20%20%20%20%20%20%20%20%20-%20just%20sync%20the%20internal%20state%20and%20leave%20it%0A%23%20%2A%20apply-policy%20-%20evaluate%20the%20ruleset%20for%20every%20present%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20device%0A%23%0APresentControllerPolicy%3Dkeep%0A%0A%23%0A%23%20Inserted%20device%20policy.%0A%23%0A%23%20How%20to%20treat%20USB%20devices%20that%20are%20already%20connected%0A%23%20%2Aafter%2A%20the%20daemon%20starts.%20One%20of%3A%0A%23%0A%23%20%2A%20block%20%20%20%20%20%20%20%20-%20deauthorize%20every%20present%20device%0A%23%20%2A%20reject%20%20%20%20%20%20%20-%20remove%20every%20present%20device%0A%23%20%2A%20apply-policy%20-%20evaluate%20the%20ruleset%20for%20every%20present%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20device%0A%23%0AInsertedDevicePolicy%3Dapply-policy%0A%0A%23%0A%23%20Control%20which%20devices%20are%20authorized%20by%20default.%0A%23%0A%23%20The%20USBGuard%20daemon%20modifies%20some%20the%20default%20authorization%20state%20attributes%0A%23%20of%20controller%20devices.%20This%20setting%2C%20enables%20you%20to%20define%20what%20value%20the%0A%23%20default%20authorization%20is%20set%20to.%0A%23%0A%23%20%2A%20keep%20%20%20%20%20%20%20%20%20-%20do%20not%20change%20the%20authorization%20state%0A%23%20%2A%20none%20%20%20%20%20%20%20%20%20-%20every%20new%20device%20starts%20out%20deauthorized%0A%23%20%2A%20all%20%20%20%20%20%20%20%20%20%20-%20every%20new%20device%20starts%20out%20authorized%0A%23%20%2A%20internal%20%20%20%20%20-%20internal%20devices%20start%20out%20authorized%2C%20external%20devices%20start%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20out%20deauthorized%20%28this%20requires%20the%20ACPI%20tables%20to%20properly%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%20internal%20devices%2C%20and%20kernel%20support%29%0A%23%0A%23AuthorizedDefault%3Dnone%0A%0A%23%0A%23%20Restore%20controller%20device%20state.%0A%23%0A%23%20The%20USBGuard%20daemon%20modifies%20some%20attributes%20of%20controller%0A%23%20devices%20like%20the%20default%20authorization%20state%20of%20new%20child%20device%0A%23%20instances.%20Using%20this%20setting%2C%20you%20can%20control%20whether%20the%0A%23%20daemon%20will%20try%20to%20restore%20the%20attribute%20values%20to%20the%20state%0A%23%20before%20modification%20on%20shutdown.%0A%23%0A%23%20SECURITY%20CONSIDERATIONS%3A%20If%20set%20to%20true%2C%20the%20USB%20authorization%0A%23%20policy%20could%20be%20bypassed%20by%20performing%20some%20sort%20of%20attack%20on%20the%0A%23%20daemon%20%28via%20a%20local%20exploit%20or%20via%20a%20USB%20device%29%20to%20make%20it%20shutdown%0A%23%20and%20restore%20to%20the%20operating-system%20default%20state%20%28known%20to%20be%20permissive%29.%0A%23%0ARestoreControllerDeviceState%3Dfalse%0A%0A%23%0A%23%20Device%20manager%20backend%0A%23%0A%23%20Which%20device%20manager%20backend%20implementation%20to%20use.%20One%20of%3A%0A%23%0A%23%20%2A%20uevent%20%20%20-%20Netlink%20based%20implementation%20which%20uses%20sysfs%20to%20scan%20for%20present%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20devices%20and%20an%20uevent%20netlink%20socket%20for%20receiving%20USB%20device%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20related%20events.%0A%23%20%2A%20umockdev%20-%20umockdev%20based%20device%20manager%20capable%20of%20simulating%20devices%20based%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20on%20umockdev-record%20files.%20Useful%20for%20testing.%0A%23%0ADeviceManagerBackend%3Duevent%0A%0A%23%21%21%21%20WARNING%3A%20It%27s%20good%20practice%20to%20set%20at%20least%20one%20of%20the%20%21%21%21%0A%23%21%21%21%20%20%20%20%20%20%20%20%20%20two%20options%20bellow.%20If%20none%20of%20them%20are%20set%2C%20%20%21%21%21%0A%23%21%21%21%20%20%20%20%20%20%20%20%20%20the%20daemon%20will%20accept%20IPC%20connections%20from%20%20%20%21%21%21%0A%23%21%21%21%20%20%20%20%20%20%20%20%20%20anyone%2C%20thus%20allowing%20anyone%20to%20modify%20the%20%20%20%20%21%21%21%0A%23%21%21%21%20%20%20%20%20%20%20%20%20%20rule%20set%20and%20%28de%29authorize%20USB%20devices.%20%20%20%20%20%20%20%21%21%21%0A%0A%23%0A%23%20Users%20allowed%20to%20use%20the%20IPC%20interface.%0A%23%0A%23%20A%20space%20delimited%20list%20of%20usernames%20that%20the%20daemon%20will%0A%23%20accept%20IPC%20connections%20from.%0A%23%0A%23%20IPCAllowedUsers%3Dusername1%20username2%20...%0A%23%0AIPCAllowedUsers%3Droot%0A%0A%23%0A%23%20Groups%20allowed%20to%20use%20the%20IPC%20interface.%0A%23%0A%23%20A%20space%20delimited%20list%20of%20groupnames%20that%20the%20daemon%20will%0A%23%20accept%20IPC%20connections%20from.%0A%23%0A%23%20IPCAllowedGroups%3Dgroupname1%20groupname2%20...%0A%23%0AIPCAllowedGroups%3Dwheel%0A%0A%23%0A%23%20IPC%20access%20control%20definition%20files%20path.%0A%23%0A%23%20The%20files%20at%20this%20location%20will%20be%20interpreted%20by%20the%20daemon%0A%23%20as%20access%20control%20definition%20files.%20The%20%28base%29name%20of%20a%20file%0A%23%20should%20be%20in%20the%20form%3A%0A%23%0A%23%20%20%20%5Buser%5D%5B%3A%3Cgroup%3E%5D%0A%23%0A%23%20and%20should%20contain%20lines%20in%20the%20form%3A%0A%23%0A%23%20%20%20%3Csection%3E%3D%5Bprivilege%5D%20...%0A%23%0A%23%20This%20way%20each%20file%20defines%20who%20is%20able%20to%20connect%20to%20the%20IPC%0A%23%20bus%20and%20what%20privileges%20he%20has.%0A%23%0AIPCAccessControlFiles%3D/etc/usbguard/IPCAccessControl.d/%0A%0A%23%0A%23%20Generate%20device%20specific%20rules%20including%20the%20%22via-port%22%0A%23%20attribute.%0A%23%0A%23%20This%20option%20modifies%20the%20behavior%20of%20the%20allowDevice%0A%23%20action.%20When%20instructed%20to%20generate%20a%20permanent%20rule%2C%0A%23%20the%20action%20can%20generate%20a%20port%20specific%20rule.%20Because%0A%23%20some%20systems%20have%20unstable%20port%20numbering%2C%20the%20generated%0A%23%20rule%20might%20not%20match%20the%20device%20after%20rebooting%20the%20system.%0A%23%0A%23%20If%20set%20to%20false%2C%20the%20generated%20rule%20will%20still%20contain%0A%23%20the%20%22parent-hash%22%20attribute%20which%20also%20defines%20an%20association%0A%23%20to%20the%20parent%20device.%20See%20usbguard-rules.conf%285%29%20for%20more%0A%23%20details.%0A%23%0ADeviceRulesWithPort%3Dfalse%0A%0A%23%0A%23%20USBGuard%20Audit%20events%20log%20backend%0A%23%0A%23%20One%20of%3A%0A%23%0A%23%20%2A%20FileAudit%20-%20Log%20audit%20events%20into%20a%20file%20specified%20by%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20AuditFilePath%20setting%20%28see%20below%29%0A%23%20%2A%20LinuxAudit%20-%20Log%20audit%20events%20using%20the%20Linux%20Audit%0A%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20subsystem%20%28using%20audit_log_user_message%29%0A%23%0AAuditBackend%3DLinuxAudit%0A%0A%23%0A%23%20USBGuard%20audit%20events%20log%20file%20path.%0A%23%0A%23AuditFilePath%3D/var/log/usbguard/usbguard-audit.log%0A%0A%23%0A%23%20Hides%20personally%20identifiable%20information%20such%20as%20device%20serial%20numbers%20and%0A%23%20hashes%20of%20descriptors%20%28which%20include%20the%20serial%20number%29%20from%20audit%20entries.%0A%23%0A%23HidePII%3Dfalse }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/usbguard/usbguard-daemon.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure USBGuard daemon to log via Linux Audit (as opposed directly to a file), AuditBackend option in /etc/usbguard/usbguard-daemon.conf needs to be set to LinuxAudit.",
      "id": "xccdf_org.ssgproject.content_rule_configure_usbguard_auditbackend",
      "instructions": "To verify that Linux Audit logging is enabled for the USBGuard daemon,\nrun the following command:\n$ sudo grep AuditBackend /etc/usbguard/usbguard-daemon.conf\nThe output should be\nAuditBackend=LinuxAudit",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "configure-usbguard-auditbackend",
          "control.compliance.openshift.io/NIST-800-53": "AU-2;CM-8(3);IA-3",
          "policies.open-cluster-management.io/controls": "AU-2,CM-8(3),IA-3",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-usbguard-auditbackend",
        "namespace": "openshift-compliance",
        "resourceVersion": "78584",
        "uid": "7c5d15b1-4537-4ab0-b1bd-69ba86e5369d"
      },
      "rationale": "Using the Linux Audit logging allows for centralized trace of events.",
      "severity": "low",
      "title": "Log USBGuard daemon audit events using Linux Audit"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The operating system must conduct backups of user data contained in the operating system. The operating system provides utilities for automating backups of user data. Commercial and open-source products are also available.",
      "id": "xccdf_org.ssgproject.content_rule_configure_user_data_backups",
      "instructions": "Verify that the system backups user data.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "configure-user-data-backups"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-configure-user-data-backups",
        "namespace": "openshift-compliance",
        "resourceVersion": "76616",
        "uid": "746b8bdb-af2f-4c08-ae4c-dd62ecbdb434"
      },
      "rationale": "Operating system backup is a critical step in maintaining data assurance and availability. User-level information is data generated by information system and/or application users. Backups shall be consistent with organizational recovery time and recovery point objectives.",
      "severity": "medium",
      "title": "Configure Backups of User Data"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%20%20This%20file%20is%20part%20of%20systemd.%0A%23%0A%23%20%20systemd%20is%20free%20software%3B%20you%20can%20redistribute%20it%20and/or%20modify%20it%0A%23%20%20under%20the%20terms%20of%20the%20GNU%20Lesser%20General%20Public%20License%20as%20published%20by%0A%23%20%20the%20Free%20Software%20Foundation%3B%20either%20version%202.1%20of%20the%20License%2C%20or%0A%23%20%20%28at%20your%20option%29%20any%20later%20version.%0A%23%0A%23%20Entries%20in%20this%20file%20show%20the%20compile%20time%20defaults.%0A%23%20You%20can%20change%20settings%20by%20editing%20this%20file.%0A%23%20Defaults%20can%20be%20restored%20by%20simply%20deleting%20this%20file.%0A%23%0A%23%20See%20coredump.conf%285%29%20for%20details.%0A%0A%5BCoredump%5D%0A%23Storage%3Dexternal%0A%23Compress%3Dyes%0A%23ProcessSizeMax%3D2G%0A%23ExternalSizeMax%3D2G%0A%23JournalSizeMax%3D767M%0A%23MaxUse%3D%0A%23KeepFree%3D%0AStorage%3Dnone%0AProcessSizeMax%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/systemd/coredump.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The ProcessSizeMax option in [Coredump] section of /etc/systemd/coredump.conf specifies the maximum size in bytes of a core which will be processed. Core dumps exceeding this size may be stored, but the backtrace will not be generated.",
      "id": "xccdf_org.ssgproject.content_rule_coredump_disable_backtraces",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 disables core dump backtraces by issuing the following command:\n\n$ grep -i process /etc/systemd/coredump.conf\n\nProcessSizeMax=0",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "coredump-disable-backtraces",
          "control.compliance.openshift.io/NIST-800-53": "CM-6",
          "control.compliance.openshift.io/PCI-DSS": "Req-3.2",
          "policies.open-cluster-management.io/controls": "CM-6,Req-3.2",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coredump-disable-backtraces",
        "namespace": "openshift-compliance",
        "resourceVersion": "78382",
        "uid": "95d27053-9fbd-4e2a-874a-962def01f863"
      },
      "rationale": "A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers or system operators trying to debug problems. Enabling core dumps on production systems is not recommended, however there may be overriding operational requirements to enable advanced debuging. Permitting temporary enablement of core dumps during such situations should be reviewed through local needs and policy.",
      "severity": "medium",
      "title": "Disable core dump backtraces",
      "warning": "A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers or system operators trying to debug problems. Enabling core dumps on production systems is not recommended, however there may be overriding operational requirements to enable advanced debuging. Permitting temporary enablement of core dumps during such situations should be reviewed through local needs and policy."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%20%20This%20file%20is%20part%20of%20systemd.%0A%23%0A%23%20%20systemd%20is%20free%20software%3B%20you%20can%20redistribute%20it%20and/or%20modify%20it%0A%23%20%20under%20the%20terms%20of%20the%20GNU%20Lesser%20General%20Public%20License%20as%20published%20by%0A%23%20%20the%20Free%20Software%20Foundation%3B%20either%20version%202.1%20of%20the%20License%2C%20or%0A%23%20%20%28at%20your%20option%29%20any%20later%20version.%0A%23%0A%23%20Entries%20in%20this%20file%20show%20the%20compile%20time%20defaults.%0A%23%20You%20can%20change%20settings%20by%20editing%20this%20file.%0A%23%20Defaults%20can%20be%20restored%20by%20simply%20deleting%20this%20file.%0A%23%0A%23%20See%20coredump.conf%285%29%20for%20details.%0A%0A%5BCoredump%5D%0A%23Storage%3Dexternal%0A%23Compress%3Dyes%0A%23ProcessSizeMax%3D2G%0A%23ExternalSizeMax%3D2G%0A%23JournalSizeMax%3D767M%0A%23MaxUse%3D%0A%23KeepFree%3D%0AStorage%3Dnone%0AProcessSizeMax%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/systemd/coredump.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The Storage option in [Coredump] sectionof /etc/systemd/coredump.conf can be set to none to disable storing core dumps permanently.",
      "id": "xccdf_org.ssgproject.content_rule_coredump_disable_storage",
      "instructions": "Verify Red Hat Enterprise Linux CoreOS 4 disables storing core dumps for all users by issuing the following command:\n\n$ grep -i storage /etc/systemd/coredump.conf\n\nStorage=none",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "coredump-disable-storage",
          "control.compliance.openshift.io/NIST-800-53": "CM-6",
          "control.compliance.openshift.io/PCI-DSS": "Req-3.2",
          "policies.open-cluster-management.io/controls": "CM-6,Req-3.2",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coredump-disable-storage",
        "namespace": "openshift-compliance",
        "resourceVersion": "78384",
        "uid": "e7642a7e-0287-4ded-952b-e8e5a7eb0e5b"
      },
      "rationale": "A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers or system operators trying to debug problems. Enabling core dumps on production systems is not recommended, however there may be overriding operational requirements to enable advanced debuging. Permitting temporary enablement of core dumps during such situations should be reviewed through local needs and policy.",
      "severity": "medium",
      "title": "Disable storing core dump",
      "warning": "A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers or system operators trying to debug problems. Enabling core dumps on production systems is not recommended, however there may be overriding operational requirements to enable advanced debuging. Permitting temporary enablement of core dumps during such situations should be reviewed through local needs and policy."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                }
              },
              "kernelArguments": [
                "audit_backlog_limit=8192"
              ]
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To improve the kernel capacity to queue all log events, even those which occurred prior to the audit daemon, add the argument audit_backlog_limit=8192 to all BLS (Boot Loader Specification) entries ('options' line) for the Linux operating system in /boot/loader/entries/*.conf.",
      "id": "xccdf_org.ssgproject.content_rule_coreos_audit_backlog_limit_kernel_argument",
      "instructions": "Inspect the form of all the BLS (Boot Loader Specification) entries\n('options' line) in /boot/loader/entries/*.conf. If they include\naudit=1, then auditing is enabled at boot time.\n\nTo ensure audit_backlog_limit=8192 is configured on the installed kernel, add\nthe kernel argument via a MachineConfig object to the appropriate\npools.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "coreos-audit-backlog-limit-kernel-argument",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coreos-audit-backlog-limit-kernel-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77075",
        "uid": "c7da4ecc-cdb5-4f96-9831-2f8d06a956de"
      },
      "rationale": "audit_backlog_limit sets the queue length for audit events awaiting transfer to the audit daemon. Until the audit daemon is up and running, all log messages are stored in this queue. If the queue is overrun during boot process, the action defined by audit failure flag is taken.",
      "severity": "medium",
      "title": "Extend Audit Backlog Limit for the Audit Daemon"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                }
              },
              "kernelArguments": [
                "audit=1"
              ]
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To ensure all processes can be audited, even those which start prior to the audit daemon, add the argument audit=1 to all BLS (Boot Loader Specification) entries ('options' line) for the Linux operating system in /boot/loader/entries/*.conf.",
      "id": "xccdf_org.ssgproject.content_rule_coreos_audit_option",
      "instructions": "Inspect the form of BLS (Boot Loader Specification) options lines for the Linux operating system\nin /boot/loader/entries/*.conf. If they include audit=1, then auditing\nis enabled at boot time.\n# grep 'options.*audit=1.*' /boot/loader/entires/*.conf",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "coreos-audit-option",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R3.3;CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(1);AU-14(1);AU-10;CM-6(a);IR-5(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.3",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R3.3,CIP-007-3 R7.1,AC-17(1),AU-14(1),AU-10,CM-6(a),IR-5(1),Req-10.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coreos-audit-option",
        "namespace": "openshift-compliance",
        "resourceVersion": "77081",
        "uid": "eeb19323-e5ee-4804-8d20-60a7f6349aef"
      },
      "rationale": "Each process on the system carries an \"auditable\" flag which indicates whether its activities can be audited. Although auditd takes care of enabling this for all processes which launch after it does, adding the kernel argument ensures it is set for every process during boot.",
      "severity": "medium",
      "title": "Enable Auditing for Processes Which Start Prior to the Audit Daemon"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Red Hat Enterprise Linux CoreOS 4 systems support an \"interactive boot\" option that can be used to prevent services from being started. On a Red Hat Enterprise Linux CoreOS 4 system, interactive boot can be enabled by providing a 1 , yes , true , or on value to the systemd.confirm_spawn kernel argument.",
      "id": "xccdf_org.ssgproject.content_rule_coreos_disable_interactive_boot",
      "instructions": "Inspect /proc/cmdline for any instances of\nsystemd.confirm_spawn=(1|yes|true|on) in the kernel boot arguments.\nPresence of a systemd.confirm_spawn=(1|yes|true|on) indicates\nthat interactive boot is enabled at boot time.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "coreos-disable-interactive-boot",
          "control.compliance.openshift.io/NIST-800-53": "SC-2(1);CM-6(a)",
          "policies.open-cluster-management.io/controls": "SC-2(1),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coreos-disable-interactive-boot",
        "namespace": "openshift-compliance",
        "resourceVersion": "76837",
        "uid": "4aa994da-95ad-4bde-a70d-3e89cad394b0"
      },
      "rationale": "Using interactive boot, the console user could disable auditing, firewalls, or other services, weakening system security.",
      "severity": "medium",
      "title": "Verify that Interactive Boot is Disabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SELinux can be disabled at boot time by disabling it via a kernel argument. Remove any instances of selinux=0 from the kernel arguments in that file to prevent SELinux from being disabled at boot.",
      "id": "xccdf_org.ssgproject.content_rule_coreos_enable_selinux_kernel_argument",
      "instructions": "Inspect /proc/cmdline for any instances of selinux=0\nin the kernel boot arguments.  Presence of selinux=0 indicates\nthat SELinux is disabled at boot time.\n\nIf it would be disabled anywhere, make sure to enable it via a\nMachineConfig object.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-bsi-2022,rhcos4-bsi,rhcos4-high-rev-4,rhcos4-high,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "coreos-enable-selinux-kernel-argument",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;AC-3(3)(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-3,AC-3(3)(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coreos-enable-selinux-kernel-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "78404",
        "uid": "139f31d6-2d75-4478-a147-32397bed7d9c"
      },
      "rationale": "Disabling a major host protection feature, such as SELinux, at boot time prevents it from confining system services at boot time. Further, it increases the chances that it will remain off during system operation.",
      "severity": "medium",
      "title": "Ensure SELinux Not Disabled in the kernel arguments"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                }
              },
              "kernelArguments": [
                "nousb"
              ]
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "All USB support can be disabled by adding the nousb argument to the kernel's boot loader configuration. To do so, Add the nousb kernel argument via a MachineConfig object.",
      "id": "xccdf_org.ssgproject.content_rule_coreos_nousb_kernel_argument",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "coreos-nousb-kernel-argument",
          "control.compliance.openshift.io/NIST-800-53": "MP-7;CM-6(a)",
          "policies.open-cluster-management.io/controls": "MP-7,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coreos-nousb-kernel-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "78296",
        "uid": "3eadac5e-80b5-4b3a-8339-5468f4041a9c"
      },
      "rationale": "Disabling the USB subsystem within the Linux kernel at system boot will protect against potentially malicious USB devices, although it is only practical in specialized systems.",
      "severity": "medium",
      "title": "Disable Kernel Support for USB via Bootloader Configuration",
      "warning": "Disabling the USB subsystem within the Linux kernel at system boot will protect against potentially malicious USB devices, although it is only practical in specialized systems."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                }
              },
              "kernelArguments": [
                "page_poison=1"
              ]
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To enable poisoning of free pages, add the argument page_poison=1 to all BLS (Boot Loader Specification) entries ('options' line) for the Linux operating system in /boot/loader/entries/*.conf.",
      "id": "xccdf_org.ssgproject.content_rule_coreos_page_poison_kernel_argument",
      "instructions": "Inspect the form of all the BLS (Boot Loader Specification) entries\n('options' line) in /boot/loader/entries/*.conf. If they include\npage_poison=1, then page poisoning is enabled at boot time.\n\nTo ensure page_poison=1 is configured on the installed kernel, add\nthe kernel argument via a MachineConfig object to the appropriate\npools.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "coreos-page-poison-kernel-argument",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coreos-page-poison-kernel-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "78395",
        "uid": "b9144c4c-ce3c-4ea8-a6ff-88230bdb3003"
      },
      "rationale": "Poisoning writes an arbitrary value to freed pages, so any modification or reference to that page after being freed or before being initialized will be detected and prevented. This prevents many types of use-after-free vulnerabilities at little performance cost. Also prevents leak of data and detection of corrupted memory.",
      "severity": "medium",
      "title": "Enable page allocator poisoning"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                }
              },
              "kernelArguments": [
                "pti=on"
              ]
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To enable Kernel page-table isolation, add the argument pti=on to all BLS (Boot Loader Specification) entries ('options' line) for the Linux operating system in /boot/loader/entries/*.conf.",
      "id": "xccdf_org.ssgproject.content_rule_coreos_pti_kernel_argument",
      "instructions": "Inspect the form of all the BLS (Boot Loader Specification) entries\n('options' line) in /boot/loader/entries/*.conf. If they include\npti=on, then Kernel page-table isolation is enabled at boot time.\n\nTo ensure pti=on is configured on the installed kernel, add\nthe kernel argument via a MachineConfig object to the appropriate\npools.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "coreos-pti-kernel-argument",
          "control.compliance.openshift.io/NIST-800-53": "SI-16",
          "policies.open-cluster-management.io/controls": "SI-16",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coreos-pti-kernel-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77747",
        "uid": "ebc86576-25b4-4b1a-a861-bd374cc6b011"
      },
      "rationale": "Kernel page-table isolation is a kernel feature that mitigates the Meltdown security vulnerability and hardens the kernel against attempts to bypass kernel address space layout randomization (KASLR).",
      "severity": "high",
      "title": "Enable Kernel Page-Table Isolation (KPTI)"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                }
              },
              "kernelArguments": [
                "slub_debug=P"
              ]
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To enable poisoning of SLUB/SLAB objects, add the argument slub_debug=P to all BLS (Boot Loader Specification) entries ('options' line) for the Linux operating system in /boot/loader/entries/*.conf.",
      "id": "xccdf_org.ssgproject.content_rule_coreos_slub_debug_kernel_argument",
      "instructions": "Inspect the form of all the BLS (Boot Loader Specification) entries\n('options' line) in /boot/loader/entries/*.conf. If they include\nslub_debug=P, then SLUB/SLAB poisoning is enabled at boot time.\n\nTo ensure slub_debug=P is configured on the installed kernel, add\nthe kernel argument via a MachineConfig object to the appropriate\npools.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "coreos-slub-debug-kernel-argument",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coreos-slub-debug-kernel-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "78397",
        "uid": "9459a49b-ee7e-40de-b41a-0a596aa8bc66"
      },
      "rationale": "Poisoning writes an arbitrary value to freed objects, so any modification or reference to that object after being freed or before being initialized will be detected and prevented. This prevents many types of use-after-free vulnerabilities at little performance cost. Also prevents leak of data and detection of corrupted memory.",
      "severity": "medium",
      "title": "Enable SLUB/SLAB allocator poisoning"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                }
              },
              "kernelArguments": [
                "vsyscall=none"
              ]
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To disable use of virtual syscalls, add the argument vsyscall=none to all BLS (Boot Loader Specification) entries ('options' line) for the Linux operating system in /boot/loader/entries/*.conf.",
      "id": "xccdf_org.ssgproject.content_rule_coreos_vsyscall_kernel_argument",
      "instructions": "Inspect the form of all the BLS (Boot Loader Specification) entries\n('options' line) in /boot/loader/entries/*.conf. If they include\nvsyscall=none, then virtual syscalls are not enabled at boot time.\n\nTo ensure vsyscall=none is configured on the installed kernel, add\nthe kernel argument via a MachineConfig object to the appropriate\npools.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "coreos-vsyscall-kernel-argument",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-coreos-vsyscall-kernel-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77751",
        "uid": "776d055b-b19d-4633-b220-cc53cbcad0d8"
      },
      "rationale": "Virtual Syscalls provide an opportunity of attack for a user who has control of the return instruction pointer.",
      "severity": "medium",
      "title": "Disable vsyscalls"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Create the file /etc/dhcp/dhclient.conf , and add an appropriate setting for each of the ten configuration settings which can be obtained via DHCP. For each setting, do one of the following:\n\nIf the setting should not be configured remotely by the DHCP server, select an appropriate static value, and add the line:\n\nsupersede setting value ;\n\nIf the setting should be configured remotely by the DHCP server, add the lines:\n\nrequest setting ;\nrequire setting ;\n\nFor example, suppose the DHCP server should provide only the IP address itself and the subnet mask. Then the entire file should look like:\n\nsupersede domain-name \"example.com\";\nsupersede domain-name-servers 192.168.1.2;\nsupersede nis-domain \"\";\nsupersede nis-servers \"\";\nsupersede ntp-servers \"ntp.example.com \";\nsupersede routers 192.168.1.1;\nsupersede time-offset -18000;\nrequest subnet-mask;\nrequire subnet-mask;",
      "id": "xccdf_org.ssgproject.content_rule_dhcp_client_restrict_options",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "dhcp-client-restrict-options"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-dhcp-client-restrict-options",
        "namespace": "openshift-compliance",
        "resourceVersion": "78437",
        "uid": "b390df53-824c-4a85-a467-8294f9c4dbb7"
      },
      "rationale": "By default, the DHCP client program, dhclient, requests and applies ten configuration options (in addition to the IP address) from the DHCP server. subnet-mask, broadcast-address, time-offset, routers, domain-name, domain-name-servers, host-name, nis-domain, nis-servers, and ntp-servers. Many of the options requested and applied by dhclient may be the same for every system on a network. It is recommended that almost all configuration options be assigned statically, and only options which must vary on a host-by-host basis be assigned via DHCP. This limits the damage which can be done by a rogue DHCP server. If appropriate for your site, it is also possible to supersede the host-name directive in /etc/dhcp/dhclient.conf , establishing a static hostname for the system. However, dhclient does not use the host name option provided by the DHCP server (instead using the value provided by a reverse DNS lookup).",
      "severity": "unknown",
      "title": "Minimize the DHCP-Configured Options",
      "warning": "By default, the DHCP client program, dhclient, requests and applies ten configuration options (in addition to the IP address) from the DHCP server. subnet-mask, broadcast-address, time-offset, routers, domain-name, domain-name-servers, host-name, nis-domain, nis-servers, and ntp-servers. Many of the options requested and applied by dhclient may be the same for every system on a network. It is recommended that almost all configuration options be assigned statically, and only options which must vary on a host-by-host basis be assigned via DHCP. This limits the damage which can be done by a rogue DHCP server. If appropriate for your site, it is also possible to supersede the host-name directive in /etc/dhcp/dhclient.conf , establishing a static hostname for the system. However, dhclient does not use the host name option provided by the DHCP server (instead using the value provided by a reverse DNS lookup)."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Edit /etc/dhcp/dhcpd.conf. Examine each address range section within the file, and ensure that the following options are not defined unless there is an operational need to provide this information via DHCP:\n\noption domain-name\noption domain-name-servers\noption nis-domain\noption nis-servers\noption ntp-servers\noption routers\noption time-offset",
      "id": "xccdf_org.ssgproject.content_rule_dhcp_server_minimize_served_info",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "dhcp-server-minimize-served-info",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-dhcp-server-minimize-served-info",
        "namespace": "openshift-compliance",
        "resourceVersion": "78438",
        "uid": "f4048bdf-e285-4b25-8fd4-081cd9821a27"
      },
      "rationale": "Because the configuration information provided by the DHCP server could be maliciously provided to clients by a rogue DHCP server, the amount of information provided via DHCP should be minimized. Remove these definitions from the DHCP server configuration to ensure that legitimate clients do not unnecessarily rely on DHCP for this information.",
      "severity": "unknown",
      "title": "Minimize Served Information",
      "warning": "Because the configuration information provided by the DHCP server could be maliciously provided to clients by a rogue DHCP server, the amount of information provided via DHCP should be minimized. Remove these definitions from the DHCP server configuration to ensure that legitimate clients do not unnecessarily rely on DHCP for this information."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "/bin\n/sbin\n/usr/bin\n/usr/sbin\n/usr/local/bin\n/usr/local/sbin\n\nAll these directories should be owned by the root user. If any directory DIR in these directories is found to be owned by a user other than root, correct its ownership with the following command:\n\n$ sudo chown root DIR",
      "id": "xccdf_org.ssgproject.content_rule_dir_ownership_binary_dirs",
      "instructions": "System executables are stored in the following directories by default:\n/bin\n/sbin\n/usr/bin\n/usr/local/bin\n/usr/local/sbin\n/usr/sbin\nFor each of these directories, run the following command to find files\nnot owned by root:\n$ sudo find -L DIR/ ! -user root -type d -exec chown root {} \\;",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "dir-ownership-binary-dirs"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-dir-ownership-binary-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "78278",
        "uid": "895cef4e-7891-4f3e-93d2-5d00f3eddcbe"
      },
      "rationale": "System binaries are executed by privileged users as well as system services, and restrictive permissions are necessary to ensure that their execution of these programs cannot be co-opted.",
      "severity": "medium",
      "title": "Verify that System Executable Have Root Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System-wide shared library files, which are linked to executables during process load time or run time, are stored in the following directories by default:\n\n/lib\n/lib64\n/usr/lib\n/usr/lib64\n\nKernel modules, which can be added to the kernel during runtime, are also stored in /lib/modules. All files in these directories should be owned by the root user. If the directories, is found to be owned by a user other than root correct its ownership with the following command:\n\n$ sudo chown root DIR",
      "id": "xccdf_org.ssgproject.content_rule_dir_ownership_library_dirs",
      "instructions": "Verify the system-wide shared library directories are owned by \"root\" with the following command:\n\n$ sudo find /lib /lib64 /usr/lib /usr/lib64 ! -user root -type d -exec stat -c \"%n %U\" '{}' \\;",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "dir-ownership-library-dirs",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(6);CM-5(6).1",
          "policies.open-cluster-management.io/controls": "CM-5(6),CM-5(6).1",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-dir-ownership-library-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "78279",
        "uid": "a7ec13c3-ecd0-4b7e-b07a-406f82e3562d"
      },
      "rationale": "Files from shared library directories are loaded into the address space of processes (including privileged ones) or of the kernel itself at runtime. Proper ownership of library directories is necessary to protect the integrity of the system.",
      "severity": "medium",
      "title": "Verify that Shared Library Directories Have Root Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System executables are stored in the following directories by default:\n\n/bin\n/sbin\n/usr/bin\n/usr/sbin\n/usr/local/bin\n/usr/local/sbin\n\nThese directories should not be group-writable or world-writable. If any directory DIR in these directories is found to be group-writable or world-writable, correct its permission with the following command:\n\n$ sudo chmod go-w DIR",
      "id": "xccdf_org.ssgproject.content_rule_dir_permissions_binary_dirs",
      "instructions": "System executables are stored in the following directories by default:\n/bin\n/sbin\n/usr/bin\n/usr/sbin\n/usr/local/bin\n/usr/local/sbin\nTo find system executables directories that are group-writable or\nworld-writable, run the following command for each directory DIR\nwhich contains system executables:\n$ sudo find -L DIR -perm /022 -type d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "dir-permissions-binary-dirs"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-dir-permissions-binary-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "78280",
        "uid": "f44732dc-6839-4f5a-9dfe-e69209b5bf23"
      },
      "rationale": "System binaries are executed by privileged users, as well as system services, and restrictive permissions are necessary to ensure execution of these programs cannot be co-opted.",
      "severity": "medium",
      "title": "Verify that System Executable Directories Have Restrictive Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System-wide shared library directories, which contain are linked to executables during process load time or run time, are stored in the following directories by default:\n\n/lib\n/lib64\n/usr/lib\n/usr/lib64\n\nKernel modules, which can be added to the kernel during runtime, are stored in /lib/modules. All sub-directories in these directories should not be group-writable or world-writable. If any file in these directories is found to be group-writable or world-writable, correct its permission with the following command:\n\n$ sudo chmod go-w DIR",
      "id": "xccdf_org.ssgproject.content_rule_dir_permissions_library_dirs",
      "instructions": "Shared libraries are stored in the following directories:\n/lib\n/lib64\n/usr/lib\n/usr/lib64\n\nTo find shared libraries that are group-writable or world-writable,\nrun the following command for each directory DIR which contains shared libraries:\n$ sudo find -L DIR -perm /022 -type d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "dir-permissions-library-dirs",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R6",
          "control.compliance.openshift.io/NIST-800-53": "CM-5;CM-5(6);CM-5(6).1",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R6,CM-5,CM-5(6),CM-5(6).1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-dir-permissions-library-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "78281",
        "uid": "af086c1d-6ee2-4a5d-8dc9-6be4d90c46c3"
      },
      "rationale": "If the operating system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process. This requirement applies to operating systems with software libraries that are accessible and configurable, as in the case of interpreted languages. Software libraries also include privileged programs which execute with escalated privileges. Only qualified and authorized individuals must be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.",
      "severity": "medium",
      "title": "Verify that Shared Library Directories Have Restrictive Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "When the so-called 'sticky bit' is set on a directory, only the owner of a given file may remove that file from the directory. Without the sticky bit, any user with write access to a directory may remove any file in the directory. Setting the sticky bit prevents users from removing each other's files. In cases where there is no reason for a directory to be world-writable, a better solution is to remove that permission rather than to set the sticky bit. However, if a directory is used by a particular application, consult that application's documentation instead of blindly changing modes.\n\nTo set the sticky bit on a world-writable directory DIR , run the following command:\n\n$ sudo chmod +t DIR",
      "id": "xccdf_org.ssgproject.content_rule_dir_perms_world_writable_sticky_bits",
      "instructions": "Verify that all world-writable directories have the sticky bit set. The following command will list any world-writeable directories that do not have the sticky bit set.\n\n> for node in $(oc get node -oname); do oc debug $node -- chroot /host /bin/bash -c 'echo -n \"$HOSTNAME \"; find / -type d \\( -perm -0002 -a ! -perm -1000 ! -path \"/var/lib/containers/*\" ! -path \"/var/lib/kubelet/pods/*\" ! -path \"/sysroot/ostree/deploy/*\" \\) -print 2>/dev/null' 2>/dev/null; done\n\nIf there are any directories listed in the results, this is a finding.\nfixtext: |-\nFix the directory permissions, by either removing world-writeable permission, or setting the sticky bit\n\n> oc debug node/ -- chroot /host /bin/bash -c 'chmod XXXX '\n\nwhere\n  node_name: The name of the node to connect to (oc get node)\n  XXXX:  Either 1777 (sticky bit) or 0755 (remove group and world write permission)\n  : The directory on which to correct the permissions\nsrg_requirement:\nA sticky bit must be set on all Red Hat Enterprise Linux CoreOS 4 public directories to prevent unauthorized and unintended information transferred via shared system resources.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-minimal",
          "compliance.openshift.io/rule": "dir-perms-world-writable-sticky-bits",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-dir-perms-world-writable-sticky-bits",
        "namespace": "openshift-compliance",
        "resourceVersion": "78198",
        "uid": "83950281-29f2-4043-83be-9e7f75ae21c0"
      },
      "rationale": "Failing to set the sticky bit on public directories allows unauthorized users to delete files in the directory structure.\n\nThe only authorized public directories are those temporary directories supplied with the system, or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system, by users for temporary file storage (such as /tmp ), and for directories requiring global read/write access.",
      "severity": "medium",
      "title": "Verify that All World-Writable Directories Have Sticky Bits Set",
      "warning": "Failing to set the sticky bit on public directories allows unauthorized users to delete files in the directory structure.\n\nThe only authorized public directories are those temporary directories supplied with the system, or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system, by users for temporary file storage (such as /tmp ), and for directories requiring global read/write access."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System commands are stored in the following directories: by default:\n\n/bin \n/sbin \n/usr/bin \n/usr/sbin \n/usr/local/bin \n/usr/local/sbin\n\nAll these directories should have root user as a group owner. If any system command directory is not group owned by a user other than root correct its ownership with the following command:\n\n$ sudo chgrp root DIR",
      "id": "xccdf_org.ssgproject.content_rule_dir_system_commands_group_root_owned",
      "instructions": "System commands are stored in the following directories:\n/bin \n/sbin \n/usr/bin \n/usr/sbin \n/usr/local/bin \n/usr/local/sbin\nFor each of these directories, run the following command to find directories not\nowned by root:\n$ sudo find -L $DIR ! -group root -type d -exec chgrp root {} \\;",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "dir-system-commands-group-root-owned",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(6);CM-5(6).1",
          "policies.open-cluster-management.io/controls": "CM-5(6),CM-5(6).1",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-dir-system-commands-group-root-owned",
        "namespace": "openshift-compliance",
        "resourceVersion": "78199",
        "uid": "bbfa52ef-23f5-466a-8eed-5bc8f136ca24"
      },
      "rationale": "If the operating system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process. This requirement applies to operating systems with software libraries that are accessible and configurable, as in the case of interpreted languages. Software libraries also include privileged programs which execute with escalated privileges. Only qualified and authorized individuals must be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.",
      "severity": "medium",
      "title": "Verify that system commands directories have root as a group owner"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System commands are stored in the following directories by default:\n\n/bin \n/sbin \n/usr/bin \n/usr/sbin \n/usr/local/bin \n/usr/local/sbin\n\nAll these directories should be owned by the root user. If any system command directory is not owned by a user other than root correct its ownership with the following command:\n\n$ sudo chown root DIR",
      "id": "xccdf_org.ssgproject.content_rule_dir_system_commands_root_owned",
      "instructions": "System commands are stored in the following directories:\n/bin \n/sbin \n/usr/bin \n/usr/sbin \n/usr/local/bin \n/usr/local/sbin\nFor each of these directories, run the following command to find directories not\nowned by root:\n$ sudo find -L $DIR ! -user root -type d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "dir-system-commands-root-owned",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(6);CM-5(6).1",
          "policies.open-cluster-management.io/controls": "CM-5(6),CM-5(6).1",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-dir-system-commands-root-owned",
        "namespace": "openshift-compliance",
        "resourceVersion": "78200",
        "uid": "4adf0626-ece4-41a2-9ee5-df768ef1686f"
      },
      "rationale": "If the operating system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process. This requirement applies to operating systems with software libraries that are accessible and configurable, as in the case of interpreted languages. Software libraries also include privileged programs which execute with escalated privileges. Only qualified and authorized individuals must be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.",
      "severity": "medium",
      "title": "Verify that system commands directories have root ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ -a%20always%2Cexit%20-F%20dir%3D/var/log/audit/%20-F%20perm%3Dr%20-F%20auid%3E%3D1000%20-F%20auid%21%3Dunset%20-F%20key%3Daccess-audit-trail%0A }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/audit/rules.d/30-access-var-log-audit.rules"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The audit system should collect access events to read audit log directory. The following audit rule will assure that access to audit log directory are collected.\n\n-a always,exit -F dir=/var/log/audit/ -F perm=r -F auid>=1000 -F auid!=unset -F key=access-audit-trail\n\nIf the auditd daemon is configured to use the augenrules program to read audit rules during daemon startup (the default), add the rule to a file with suffix.rules in the directory /etc/audit/rules.d. If the auditd daemon is configured to use the auditctl utility to read audit rules during daemon startup, add the rule to /etc/audit/audit.rules file.",
      "id": "xccdf_org.ssgproject.content_rule_directory_access_var_log_audit",
      "instructions": "To determine if the system is configured to audit accesses to\n/var/log/audit directory, run the following command:\n$ sudo grep \"dir=/var/log/audit\" /etc/audit/audit.rules\nIf the system is configured to audit this activity, it will return a line.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "directory-access-var-log-audit",
          "control.compliance.openshift.io/NIST-800-53": "AU-2(d);AU-12(c);AC-6(9);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AU-2(d),AU-12(c),AC-6(9),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-access-var-log-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "77173",
        "uid": "0b2fd516-7bb1-4044-b897-97ff9c9bb706"
      },
      "rationale": "Attempts to read the logs should be recorded, suspicious access to audit log files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise.'",
      "severity": "medium",
      "title": "Record Access Events to Audit Log Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/ipsec.d , run the command:\n\n$ sudo chgrp root /etc/ipsec.d",
      "id": "xccdf_org.ssgproject.content_rule_directory_groupowner_etc_ipsecd",
      "instructions": "To check the group ownership of /etc/ipsec.d,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ipsec.d\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "directory-groupowner-etc-ipsecd"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-groupowner-etc-ipsecd",
        "namespace": "openshift-compliance",
        "resourceVersion": "78041",
        "uid": "e0cd325a-87d6-4f34-9c70-3ff9ca847638"
      },
      "rationale": "The ownership of the /etc/ipsec.d directory by the root group is important because this directory hosts Libreswan configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the Libreswan configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/ipsec.d Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/iptables , run the command:\n\n$ sudo chgrp root /etc/iptables",
      "id": "xccdf_org.ssgproject.content_rule_directory_groupowner_etc_iptables",
      "instructions": "To check the group ownership of /etc/iptables,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/iptables\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "directory-groupowner-etc-iptables"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-groupowner-etc-iptables",
        "namespace": "openshift-compliance",
        "resourceVersion": "78069",
        "uid": "623565eb-9949-4106-a440-52207de1b555"
      },
      "rationale": "The ownership of the /etc/iptables directory by the root group is important because this directory hosts iptables configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the iptables configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/iptables Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/nftables , run the command:\n\n$ sudo chgrp root /etc/nftables",
      "id": "xccdf_org.ssgproject.content_rule_directory_groupowner_etc_nftables",
      "instructions": "To check the group ownership of /etc/nftables,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/nftables\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "directory-groupowner-etc-nftables"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-groupowner-etc-nftables",
        "namespace": "openshift-compliance",
        "resourceVersion": "78165",
        "uid": "d7ed8d2a-338d-4707-b7ac-bc0c75349e88"
      },
      "rationale": "The ownership of the /etc/nftables directory by the root group is important because this directory hosts nftables configuration. Protection of this directory is critical for system security. Assigning the ownership to root ensures exclusive control of the nftables configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/nftables Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/selinux , run the command:\n\n$ sudo chgrp root /etc/selinux",
      "id": "xccdf_org.ssgproject.content_rule_directory_groupowner_etc_selinux",
      "instructions": "To check the group ownership of /etc/selinux,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/selinux\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "directory-groupowner-etc-selinux"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-groupowner-etc-selinux",
        "namespace": "openshift-compliance",
        "resourceVersion": "78406",
        "uid": "7ee6df72-1175-464a-b37a-cdb1674929a3"
      },
      "rationale": "The ownership of the /etc/selinux directory by the root group is important because this directory hosts SELinux configuration. Protection of this directory is critical for system security. Assigning the ownership to root ensures exclusive control of the SELinux configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/selinux Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/sudoers.d , run the command:\n\n$ sudo chgrp root /etc/sudoers.d",
      "id": "xccdf_org.ssgproject.content_rule_directory_groupowner_etc_sudoersd",
      "instructions": "To check the group ownership of /etc/sudoers.d,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/sudoers.d\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-groupowner-etc-sudoersd"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-groupowner-etc-sudoersd",
        "namespace": "openshift-compliance",
        "resourceVersion": "76669",
        "uid": "4b2c595a-8c9c-4757-9f04-57a60e9891c9"
      },
      "rationale": "The ownership of the /etc/sudoers.d directory by the root group is important because this directory hosts sudo configuration. Protection of this directory is critical for system security. Assigning the ownership to root ensures exclusive control of the sudo configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/sudoers.d Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/sysctl.d , run the command:\n\n$ sudo chgrp root /etc/sysctl.d",
      "id": "xccdf_org.ssgproject.content_rule_directory_groupowner_etc_sysctld",
      "instructions": "To check the group ownership of /etc/sysctl.d,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/sysctl.d\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-groupowner-etc-sysctld"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-groupowner-etc-sysctld",
        "namespace": "openshift-compliance",
        "resourceVersion": "78282",
        "uid": "8faeb036-a179-4863-91b6-a69225b9c01a"
      },
      "rationale": "The ownership of the /etc/sysctl.d directory by the root group is important because this directory hosts kernel configuration. Protection of this directory is critical for system security. Assigning the ownership to root ensures exclusive control of the kernel configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/sysctl.d Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/ipsec.d , run the command:\n\n$ sudo chown root /etc/ipsec.d",
      "id": "xccdf_org.ssgproject.content_rule_directory_owner_etc_ipsecd",
      "instructions": "To check the ownership of /etc/ipsec.d,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ipsec.d\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-owner-etc-ipsecd"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-owner-etc-ipsecd",
        "namespace": "openshift-compliance",
        "resourceVersion": "78044",
        "uid": "e4d25a7f-38ef-4769-be00-49b2197ac75d"
      },
      "rationale": "The ownership of the /etc/ipsec.d directory by the root user is important because this directory hosts Libreswan configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the Libreswan configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/ipsec.d Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/iptables , run the command:\n\n$ sudo chown root /etc/iptables",
      "id": "xccdf_org.ssgproject.content_rule_directory_owner_etc_iptables",
      "instructions": "To check the ownership of /etc/iptables,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/iptables\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-owner-etc-iptables"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-owner-etc-iptables",
        "namespace": "openshift-compliance",
        "resourceVersion": "78071",
        "uid": "d4b53e1b-5829-41c0-9461-6a8584c38652"
      },
      "rationale": "The ownership of the /etc/iptables directory by the root user is important because this directory hosts iptables configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the iptables configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/iptables Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/nftables , run the command:\n\n$ sudo chown root /etc/nftables",
      "id": "xccdf_org.ssgproject.content_rule_directory_owner_etc_nftables",
      "instructions": "To check the ownership of /etc/nftables,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/nftables\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-owner-etc-nftables"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-owner-etc-nftables",
        "namespace": "openshift-compliance",
        "resourceVersion": "78169",
        "uid": "c10d4b79-23e2-4e20-bf63-be9f871e8036"
      },
      "rationale": "The ownership of the /etc/nftables directory by the root user is important because this directory hosts nftables configuration. Protection of this directory is critical for system security. Assigning the ownership to root ensures exclusive control of the nftables configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/nftables Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/selinux , run the command:\n\n$ sudo chown root /etc/selinux",
      "id": "xccdf_org.ssgproject.content_rule_directory_owner_etc_selinux",
      "instructions": "To check the ownership of /etc/selinux,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/selinux\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-owner-etc-selinux"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-owner-etc-selinux",
        "namespace": "openshift-compliance",
        "resourceVersion": "78408",
        "uid": "8758cf61-a72b-4d7d-9a03-9672166d48b9"
      },
      "rationale": "The ownership of the /etc/selinux directory by the root user is important because this directory hosts SELinux configuration. Protection of this directory is critical for system security. Assigning the ownership to root ensures exclusive control of the SELinux configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/selinux Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/sudoers.d , run the command:\n\n$ sudo chown root /etc/sudoers.d",
      "id": "xccdf_org.ssgproject.content_rule_directory_owner_etc_sudoersd",
      "instructions": "To check the ownership of /etc/sudoers.d,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/sudoers.d\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "directory-owner-etc-sudoersd"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-owner-etc-sudoersd",
        "namespace": "openshift-compliance",
        "resourceVersion": "76679",
        "uid": "1c4cfe65-8a6d-4b36-8c1f-219dc91d0741"
      },
      "rationale": "The ownership of the /etc/sudoers.d directory by the root user is important because this directory hosts sudo configuration. Protection of this directory is critical for system security. Assigning the ownership to root ensures exclusive control of the sudo configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/sudoers.d Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/sysctl.d , run the command:\n\n$ sudo chown root /etc/sysctl.d",
      "id": "xccdf_org.ssgproject.content_rule_directory_owner_etc_sysctld",
      "instructions": "To check the ownership of /etc/sysctl.d,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/sysctl.d\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-owner-etc-sysctld"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-owner-etc-sysctld",
        "namespace": "openshift-compliance",
        "resourceVersion": "78284",
        "uid": "6fc1960d-4243-4509-92fb-202b952ce709"
      },
      "rationale": "The ownership of the /etc/sysctl.d directory by the root user is important because this directory hosts kernel configuration. Protection of this directory is critical for system security. Assigning the ownership to root ensures exclusive control of the kernel configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/sysctl.d Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/ipsec.d , run the command:\n\n$ sudo chmod 0700 /etc/ipsec.d",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_etc_ipsecd",
      "instructions": "To check the permissions of /etc/ipsec.d,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/ipsec.d\nIf properly configured, the output should indicate the following permissions:\n0700",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-permissions-etc-ipsecd"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-permissions-etc-ipsecd",
        "namespace": "openshift-compliance",
        "resourceVersion": "78046",
        "uid": "6dc5b8a1-88a2-4f0e-9906-fb57fe64cfe0"
      },
      "rationale": "Setting correct permissions on the /etc/ipsec.d directory is important because this directory hosts Libreswan configuration. Protection of this directory is critical for system security. Restricting the permissions ensures exclusive control of the Libreswan configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/ipsec.d Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/iptables , run the command:\n\n$ sudo chmod 0600 /etc/iptables",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_etc_iptables",
      "instructions": "To check the permissions of /etc/iptables,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/iptables\nIf properly configured, the output should indicate the following permissions:\n0600",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-permissions-etc-iptables"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-permissions-etc-iptables",
        "namespace": "openshift-compliance",
        "resourceVersion": "78073",
        "uid": "0b5b10c7-f2bd-4aa4-80f8-1ac1761be301"
      },
      "rationale": "Setting correct permissions on the /etc/iptables directory is important because this directory hosts iptables configuration. Protection of this directory is critical for system security. Restricting the permissions ensures exclusive control of the iptables configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/iptables Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/nftables , run the command:\n\n$ sudo chmod 0700 /etc/nftables",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_etc_nftables",
      "instructions": "To check the permissions of /etc/nftables,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/nftables\nIf properly configured, the output should indicate the following permissions:\n0700",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "directory-permissions-etc-nftables"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-permissions-etc-nftables",
        "namespace": "openshift-compliance",
        "resourceVersion": "78171",
        "uid": "9bb9ab21-755f-4e41-9da1-093099ff9bd8"
      },
      "rationale": "Setting correct permissions on the /etc/nftables directory is important because this directory hosts nftables configuration. Protection of this directory is critical for system security. Restricting the permissions ensures exclusive control of the nftables configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/nftables Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/selinux , run the command:\n\n$ sudo chmod 0755 /etc/selinux",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_etc_selinux",
      "instructions": "To check the permissions of /etc/selinux,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/selinux\nIf properly configured, the output should indicate the following permissions:\n0755",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "directory-permissions-etc-selinux"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-permissions-etc-selinux",
        "namespace": "openshift-compliance",
        "resourceVersion": "78409",
        "uid": "d212d6e1-3eb2-4525-8c24-f9604d2854d7"
      },
      "rationale": "Setting correct permissions on the /etc/selinux directory is important because this directory hosts SELinux configuration. Protection of this directory is critical for system security. Restricting the permissions ensures exclusive control of the SELinux configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/selinux Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/sudoers.d , run the command:\n\n$ sudo chmod 0750 /etc/sudoers.d",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_etc_sudoersd",
      "instructions": "To check the permissions of /etc/sudoers.d,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/sudoers.d\nIf properly configured, the output should indicate the following permissions:\n0750",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "directory-permissions-etc-sudoersd"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-permissions-etc-sudoersd",
        "namespace": "openshift-compliance",
        "resourceVersion": "76687",
        "uid": "3e74e4a4-353c-4652-baa2-f7a1ea29535f"
      },
      "rationale": "Setting correct permissions on the /etc/sudoers.d directory is important because this directory hosts sudo configuration. Protection of this directory is critical for system security. Restricting the permissions ensures exclusive control of the sudo configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/sudoers.d Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/sysctl.d , run the command:\n\n$ sudo chmod 0755 /etc/sysctl.d",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_etc_sysctld",
      "instructions": "To check the permissions of /etc/sysctl.d,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/sysctl.d\nIf properly configured, the output should indicate the following permissions:\n0755",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "directory-permissions-etc-sysctld"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-permissions-etc-sysctld",
        "namespace": "openshift-compliance",
        "resourceVersion": "78285",
        "uid": "b0a50a78-77a7-4228-a5a7-2d65a16892ec"
      },
      "rationale": "Setting correct permissions on the /etc/sysctl.d directory is important because this directory hosts kernel configuration. Protection of this directory is critical for system security. Restricting the permissions ensures exclusive control of the kernel configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/sysctl.d Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "If log_group in /etc/audit/auditd.conf is set to a group other than the root group account, change the mode of the audit log files with the following command:\n\n$ sudo chmod 0750 /var/log/audit\n\nOtherwise, change the mode of the audit log files with the following command:\n\n$ sudo chmod 0700 /var/log/audit",
      "id": "xccdf_org.ssgproject.content_rule_directory_permissions_var_log_audit",
      "instructions": "Verify the audit log directories have a correct mode or less permissive mode.\n\nFind the location of the audit logs:\n\n$ sudo grep \"^log_file\" /etc/audit/auditd.conf\n\n\nFind the group that owns audit logs:\n\n$ sudo grep \"^log_group\" /etc/audit/auditd.conf\n\n\nRun the following command to check the mode of the system audit logs:\n\n$ sudo stat -c \"%a %n\" [audit_log_directory]\n\nReplace \"[audit_log_directory]\" to the correct audit log directory path, by default this location is \"/var/log/audit\".\n\n\nIf the log_group is \"root\" or is not set, the correct permissions are 0700, otherwise they are 0750.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "directory-permissions-var-log-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.2;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-004-6 R3.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.2,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-004-6 R3.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CIP-007-3 R6.5,CM-6(a),AC-6(1),AU-9",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-directory-permissions-var-log-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "77178",
        "uid": "423aad0b-2766-43fd-97d4-f4c9ebbe1705"
      },
      "rationale": "If users can write to audit logs, audit trails can be modified or destroyed.",
      "severity": "medium",
      "title": "System Audit Logs Must Have Mode 0750 or Less Permissive"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,CtrlAltDelBurstAction%3Dnone"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/systemd/system.conf.d/disable_ctrlaltdelete_burstaction.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "By default, SystemD will reboot the system if the Ctrl-Alt-Del key sequence is pressed Ctrl-Alt-Delete more than 7 times in 2 seconds.\n\nTo configure the system to ignore the CtrlAltDelBurstAction setting, create a MachineConfig similar to the following:\n\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-disable-ctrlaltdel-burstaction\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   storage:\n     files:\n     - contents:\n         source: data:,CtrlAltDelBurstAction%3Dnone\n       mode: 0644\n       path: /etc/systemd/system.conf.d/disable_ctrlaltdelete_burstaction.conf\n       overwrite: true\nEOF\n\nThis will add the relevant configuration to /etc/systemd/system.conf.d/ , thus configuring Systemd apropriately.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_disable_ctrlaltdel_burstaction",
      "instructions": "To ensure the system is configured to ignore the Ctrl-Alt-Del setting,\nenter the following command:\n$ sudo grep -i ctrlaltdelburstaction /etc/systemd/system.conf\nThe output should return:\nCtrlAltDelBurstAction=none",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "disable-ctrlaltdel-burstaction",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-disable-ctrlaltdel-burstaction",
        "namespace": "openshift-compliance",
        "resourceVersion": "76840",
        "uid": "88b6cff1-45a1-42b4-a546-d3aa5e4d1a4a"
      },
      "rationale": "A locally logged-in user who presses Ctrl-Alt-Del, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of mixed OS environment, this can create the risk of short-term loss of availability of systems due to unintentional reboot.",
      "severity": "high",
      "title": "Disable Ctrl-Alt-Del Burst Action",
      "warning": "A locally logged-in user who presses Ctrl-Alt-Del, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of mixed OS environment, this can create the risk of short-term loss of availability of systems due to unintentional reboot."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "systemd": {
                  "units": [
                    {
                      "mask": true,
                      "name": "ctrl-alt-del.target"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "By default, SystemD will reboot the system if the Ctrl-Alt-Del key sequence is pressed.\n\nTo configure the system to ignore the Ctrl-Alt-Del key sequence from the command line instead of rebooting the system, create a MachineConfig similar to the following:\n\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-disable-ctrlaltdel-reboot\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: ctrl-alt-del.target\n       mask: true\nEOF\n\nThis will mask the ctrl-alt-del.target systemd target for all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_disable_ctrlaltdel_reboot",
      "instructions": "To ensure the system is configured to mask the Ctrl-Alt-Del sequence, Check\nthat the ctrl-alt-del.target is masked and not active with the following\ncommand:\nsudo systemctl status ctrl-alt-del.target\nThe output should indicate that the target is masked and not active. It\nmight resemble following output:\nctrl-alt-del.target\nLoaded: masked (/dev/null; bad)\nActive: inactive (dead)",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "disable-ctrlaltdel-reboot",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-disable-ctrlaltdel-reboot",
        "namespace": "openshift-compliance",
        "resourceVersion": "76844",
        "uid": "2fe6d4b0-97d9-48ed-ba2a-086a5f6d6d20"
      },
      "rationale": "A locally logged-in user who presses Ctrl-Alt-Del, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of mixed OS environment, this can create the risk of short-term loss of availability of systems due to unintentional reboot.",
      "severity": "high",
      "title": "Disable Ctrl-Alt-Del Reboot Activation"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018%2F04%2F09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D%2Fusr%2Flocal%2Fbin%3A%2Fusr%2Fbin%3A%2Fusr%2Flocal%2Fsbin%3A%2Fusr%2Fsbin%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20%2Fetc%2Fssh%2Fssh_host_rsa_key%0AHostKey%20%2Fetc%2Fssh%2Fssh_host_ecdsa_key%0AHostKey%20%2Fetc%2Fssh%2Fssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20512M%201h%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20%2Fetc%2Fsysconfig%2Fsshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0A%23LogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%202m%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh%2Fauthorized_keys%20and%20.ssh%2Fauthorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh%2Fauthorized_keys%0AAuthorizedKeysFile%09.ssh%2Fauthorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20%2Fetc%2Fssh%2Fssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~%2F.ssh%2Fknown_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~%2F.rhosts%20and%20~%2F.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s%2Fkey%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20%2Fetc%2Fpam.d%2Fsshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20no%0AClientAliveInterval%20600%0AClientAliveCountMax%200%0A%23UseDNS%20no%0A%23PidFile%20%2Fvar%2Frun%2Fsshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20%2Fetc%2Fissue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09%2Fusr%2Flibexec%2Fopenssh%2Fsftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20sandbox"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "SSH's cryptographic host-based authentication is more secure than.rhosts authentication. However, it is not recommended that hosts unilaterally trust one another, even within an organization.\n\nThe default SSH configuration disables host-based authentication. The appropriate configuration is used if no value is set for HostbasedAuthentication.\n\nTo explicitly disable host-based authentication, add or correct the following line in /etc/ssh/sshd_config :\n\nHostbasedAuthentication no",
      "id": "xccdf_org.ssgproject.content_rule_disable_host_auth",
      "instructions": "To determine how the SSH daemon's HostbasedAuthentication option is set, run the following command:\n\n$ sudo grep -i HostbasedAuthentication /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "disable-host-auth",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;AC-17(a);CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-3,AC-17(a),CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-disable-host-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "78521",
        "uid": "88efef9a-a85b-482e-b850-b48f7ebd9e66"
      },
      "rationale": "SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts.",
      "severity": "medium",
      "title": "Disable Host-Based Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The prelinking feature changes binaries in an attempt to decrease their startup time. In order to disable it, change or add the following line inside the file /etc/sysconfig/prelink :\n\nPRELINKING=no\n\nNext, run the following command to return binaries to a normal, non-prelinked state:\n\n$ sudo /usr/sbin/prelink -ua",
      "id": "xccdf_org.ssgproject.content_rule_disable_prelink",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "disable-prelink",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-13;CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-11.5",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-13,CM-6(a),Req-11.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-disable-prelink",
        "namespace": "openshift-compliance",
        "resourceVersion": "76538",
        "uid": "5784d986-0b77-4ed5-a821-d7220090af37"
      },
      "rationale": "Because the prelinking feature changes binaries, it can interfere with the operation of certain software and/or modes such as AIDE, FIPS, etc.",
      "severity": "medium",
      "title": "Disable Prelinking"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%2A%20%20%20%20%20hard%20%20%20core%20%20%20%200"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/security/limits.d/75-disable_users_coredumps.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To disable core dumps for all users, add the following line to /etc/security/limits.conf , or to a file within the /etc/security/limits.d/ directory:\n\n*     hard   core    0",
      "id": "xccdf_org.ssgproject.content_rule_disable_users_coredumps",
      "instructions": "Verify that core dumps are disabled for all users, run the following command:\n$ grep core /etc/security/limits.conf\n*     hard   core    0",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "disable-users-coredumps",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;SC-7(10)",
          "policies.open-cluster-management.io/controls": "CM-6,SC-7(10)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-disable-users-coredumps",
        "namespace": "openshift-compliance",
        "resourceVersion": "78387",
        "uid": "692f9114-37b1-4025-85d9-acc71de46d09"
      },
      "rationale": "A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems.",
      "severity": "medium",
      "title": "Disable Core Dumps for All Users"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Verify the operating system is not configured to bypass password requirements for privilege escalation. Check the configuration of the \"/etc/pam.d/sudo\" file with the following command:\n\n$ sudo grep pam_succeed_if /etc/pam.d/sudo\n\nIf any occurrences of \"pam_succeed_if\" is returned from the command, this is a finding.",
      "id": "xccdf_org.ssgproject.content_rule_disallow_bypass_password_sudo",
      "instructions": "Verify the operating system is not configured to bypass password requirements for privilege\nescalation. Check the configuration of the \"/etc/pam.d/sudo\" file with the following command:\n$ sudo grep pam_succeed_if /etc/pam.d/sudo",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "disallow-bypass-password-sudo",
          "control.compliance.openshift.io/NIST-800-53": "IA-11",
          "policies.open-cluster-management.io/controls": "IA-11",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-disallow-bypass-password-sudo",
        "namespace": "openshift-compliance",
        "resourceVersion": "76799",
        "uid": "011aade5-bb57-43e2-ba95-25a241708684"
      },
      "rationale": "Without re-authentication, users may access resources or perform tasks for which they do not have authorization. When operating systems provide the capability to escalate a functional capability, it is critical the user re-authenticate.",
      "severity": "medium",
      "title": "Disallow Configuration to Bypass Password Requirements for Privilege Escalation"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To configure the system to notify users of last logon/access using pam_lastlog , add or correct the pam_lastlog settings in /etc/pam.d/postlogin to include showfailed option, such as:\n\nsession     [default=1]    pam_lastlog.so showfailed\n\nAnd make sure that the silent option is not set for this specific line.",
      "id": "xccdf_org.ssgproject.content_rule_display_login_attempts",
      "instructions": "Verify users are provided with feedback on when account accesses last occurred with the following command:\n\n$ sudo grep pam_lastlog /etc/pam.d/postlogin\n\nsession [default=1] pam_lastlog.so showfailed",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "display-login-attempts",
          "control.compliance.openshift.io/NIST-800-53": "AC-9;AC-9(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.4",
          "policies.open-cluster-management.io/controls": "AC-9,AC-9(1),Req-10.2.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-display-login-attempts",
        "namespace": "openshift-compliance",
        "resourceVersion": "76800",
        "uid": "7c367dc5-d73e-4aee-9ebc-87d2852f6d84"
      },
      "rationale": "Users need to be aware of activity that occurs regarding their account. Providing users with information regarding the number of unsuccessful attempts that were made to login to their account allows the user to determine if any unauthorized activity has occurred and gives them an opportunity to notify administrators.",
      "severity": "low",
      "title": "Ensure PAM Displays Last Logon/Access Notification",
      "warning": "Users need to be aware of activity that occurs regarding their account. Providing users with information regarding the number of unsuccessful attempts that were made to login to their account allows the user to determine if any unauthorized activity has occurred and gives them an opportunity to notify administrators."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable FIPS mode, run the following command:\n\nfips-mode-setup --enable\n\nTo enable FIPS, the system requires that the fips module is added in dracut configuration. Check if /etc/dracut.conf.d/40-fips.conf contain add_dracutmodules+=\" fips \"",
      "id": "xccdf_org.ssgproject.content_rule_enable_dracut_fips_module",
      "instructions": "To verify that the Dracut FIPS module is enabled, run the following command:\ngrep \"add_dracutmodules\" /etc/dracut.conf.d/40-fips.conf\nThe output should look like this:\nadd_dracutmodules+=\" fips \"",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "enable-dracut-fips-module",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-12(2);SC-12(3);IA-7;SC-13;CM-6(a);SC-12",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-12(2),SC-12(3),IA-7,SC-13,CM-6(a),SC-12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-enable-dracut-fips-module",
        "namespace": "openshift-compliance",
        "resourceVersion": "76550",
        "uid": "defcca45-d210-4afd-b7b6-5576108e5dee"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "high",
      "title": "Enable Dracut FIPS Module",
      "warning": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "OpenShift has an installation-time flag that can enable FIPS mode for the cluster. The flag\n\nfips: true\n\nmust be enabled at install time in the\n\ninstall-config.yaml\n\nfile. If this rule fails on an installed cluster, then this is a permanent finding and cannot be fixed.",
      "id": "xccdf_org.ssgproject.content_rule_enable_fips_mode",
      "instructions": "To verify that FIPS mode is enabled properly, run the following command:\nfips-mode-setup --check\nThe output should contain the following:\nFIPS mode is enabled.\nTo verify that the cryptographic policy has been configured correctly, run the\nfollowing command:\n$ update-crypto-policies --show\nThe output should return .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "enable-fips-mode",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-3(6);SC-12(2);SC-12(3);IA-7;SC-13;CM-6(a);SC-12",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CM-3(6),SC-12(2),SC-12(3),IA-7,SC-13,CM-6(a),SC-12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-enable-fips-mode",
        "namespace": "openshift-compliance",
        "resourceVersion": "76561",
        "uid": "4e3f5184-f81d-45bd-95ef-c1a0878b6aee"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "high",
      "title": "Enable FIPS Mode",
      "warning": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Red Hat Enterprise Linux CoreOS 4 natively supports partition encryption through the Linux Unified Key Setup-on-disk-format (LUKS) technology. The easiest way to encrypt a partition is during installation time.\n\nFor manual installations, select the Encrypt checkbox during partition creation to encrypt the partition. When this option is selected the system will prompt for a passphrase to use in decrypting the partition. The passphrase will subsequently need to be entered manually every time the system boots.\n\nFor automated/unattended installations, it is possible to use Kickstart by adding the --encrypted and --passphrase= options to the definition of each partition to be encrypted. For example, the following line would encrypt the root partition:\n\npart / --fstype=ext4 --size=100 --onpart=hda1 --encrypted --passphrase= PASSPHRASE\n\nAny PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must then be protected accordingly. Omitting the --passphrase= option from the partition definition will cause the installer to pause and interactively ask for the passphrase during installation.\n\nBy default, the Anaconda installer uses aes-xts-plain64 cipher with a minimum 512 bit key size which should be compatible with FIPS enabled.\n\nDetailed information on encrypting partitions using LUKS or LUKS ciphers can be found on the Red Hat Enterprise Linux CoreOS 4 Documentation web site:\n\nhttps://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/encrypting-block-devices-using-luks_security-hardening.",
      "id": "xccdf_org.ssgproject.content_rule_encrypt_partitions",
      "instructions": "Check the system partitions to determine if they are encrypted with the following command:\nblkid\n\nOutput will be similar to:\n/dev/sda1: UUID=\" ab12c3de-4f56-789a-8f33-3850cc8ce3a2\n\" TYPE=\"crypto_LUKS\"\n/dev/sda2: UUID=\" bc98d7ef-6g54-321h-1d24-9870de2ge1a2\n\" TYPE=\"crypto_LUKS\"\n\nThe boot partition and pseudo-file systems, such as /proc, /sys, and tmpfs,\nare not required to use disk encryption and are not a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "encrypt-partitions",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);SC-28;SC-28(1);SC-13;AU-9(3)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CM-6(a),SC-28,SC-28(1),SC-13,AU-9(3)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-encrypt-partitions",
        "namespace": "openshift-compliance",
        "resourceVersion": "76631",
        "uid": "d919c9bd-1b02-4fb7-a355-9aab5849d42e"
      },
      "rationale": "The risk of a system's physical compromise, particularly mobile systems such as laptops, places its data at risk of compromise. Encrypting this data mitigates the risk of its loss if the system is lost.",
      "severity": "high",
      "title": "Encrypt Partitions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %23%20see%20%22man%20logrotate%22%20for%20details%0A%23%20rotate%20log%20files%20daily%0Adaily%0A%0A%23%20keep%204%20weeks%20worth%20of%20backlogs%0Arotate%2030%0A%0A%23%20create%20new%20%28empty%29%20log%20files%20after%20rotating%20old%20ones%0Acreate%0A%0A%23%20use%20date%20as%20a%20suffix%20of%20the%20rotated%20file%0Adateext%0A%0A%23%20uncomment%20this%20if%20you%20want%20your%20log%20files%20compressed%0A%23compress%0A%0A%23%20RPM%20packages%20drop%20log%20rotation%20information%20into%20this%20directory%0Ainclude%20/etc/logrotate.d%0A%0A%23%20system-specific%20logs%20may%20be%20also%20be%20configured%20here. }}"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/logrotate.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The logrotate utility allows for the automatic rotation of log files. The frequency of rotation is specified in /etc/logrotate.conf , which triggers a cron task or a timer. To configure logrotate to run daily, add or correct the following line in /etc/logrotate.conf :\n\n# rotate log files frequency daily",
      "id": "xccdf_org.ssgproject.content_rule_ensure_logrotate_activated",
      "instructions": "To determine the status and frequency of logrotate, run the following command:\n$ sudo grep logrotate /var/log/cron*\nIf logrotate is configured properly, output should include references to\n/etc/cron.daily.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "ensure-logrotate-activated",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-ensure-logrotate-activated",
        "namespace": "openshift-compliance",
        "resourceVersion": "78008",
        "uid": "ec936d3e-c3ee-44ad-bb9b-9a21057e6968"
      },
      "rationale": "Log files that are not properly rotated run the risk of growing so large that they fill up the /var/log partition. Valuable logging information could be lost if the /var/log partition becomes full.",
      "severity": "medium",
      "title": "Ensure Logrotate Runs Periodically"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To ensure the system can cryptographically verify base software packages come from Red Hat (and to connect to the Red Hat Network to receive them), the Red Hat GPG key must properly be installed. To install the Red Hat GPG key, run:\n\n$ sudo subscription-manager register\n\nIf the system is not connected to the Internet or an RHN Satellite, then install the Red Hat GPG key from trusted media such as the Red Hat installation CD-ROM or DVD. Assuming the disc is mounted in /media/cdrom , use the following command as the root user to import it into the keyring:\n\n$ sudo rpm --import /media/cdrom/RPM-GPG-KEY\n\nAlternatively, the key may be pre-loaded during the RHEL installation. In such cases, the key can be installed by running the following command:\n\nsudo rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release",
      "id": "xccdf_org.ssgproject.content_rule_ensure_redhat_gpgkey_installed",
      "instructions": "To ensure that the GPG key is installed, run:\n$ rpm -q --queryformat \"%{SUMMARY}\\n\" gpg-pubkey\nThe command should return the string below:\ngpg(Red Hat, Inc. (release key 2)  <security@redhat.com>",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-minimal,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "ensure-redhat-gpgkey-installed",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(3);SI-7;SC-12;SC-12(3);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-6.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,CM-5(3),SI-7,SC-12,SC-12(3),CM-6(a),Req-6.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-ensure-redhat-gpgkey-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76751",
        "uid": "217b1a33-edc3-44db-b736-c6e1120bb196"
      },
      "rationale": "Changes to software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor. The Red Hat GPG key is necessary to cryptographically verify packages are from Red Hat.",
      "severity": "high",
      "title": "Ensure Red Hat GPG Key Installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "On a system where FIPS mode is enabled, /etc/system-fips must exist. To enable FIPS mode, run the following command:\n\nfips-mode-setup --enable",
      "id": "xccdf_org.ssgproject.content_rule_etc_system_fips_exists",
      "instructions": "To verify /etc/system-fips exists, run the following command:\nls -l /etc/system-fips\nThe output should be similar to the following:\n-rw-r--r--. 1 root root 36 Nov 26 11:31 /etc/system-fips",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "etc-system-fips-exists",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-12(2);SC-12(3);IA-7;SC-13;CM-6(a);SC-12",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-12(2),SC-12(3),IA-7,SC-13,CM-6(a),SC-12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-etc-system-fips-exists",
        "namespace": "openshift-compliance",
        "resourceVersion": "76560",
        "uid": "24697bfe-b7d6-4651-a80e-6c53f52b8ab2"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "high",
      "title": "Ensure '/etc/system-fips' exists",
      "warning": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "fapolicyd needs be configured so that users cannot give access to their home folders to other users.",
      "id": "xccdf_org.ssgproject.content_rule_fapolicyd_prevent_home_folder_access",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "fapolicyd-prevent-home-folder-access",
          "control.compliance.openshift.io/NIST-800-53": "CM-6 b",
          "policies.open-cluster-management.io/controls": "CM-6 b",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-fapolicyd-prevent-home-folder-access",
        "namespace": "openshift-compliance",
        "resourceVersion": "78443",
        "uid": "87a0b8f4-daac-40d7-8fce-165e135bf5b6"
      },
      "rationale": "Users' home directories/folders may contain information of a sensitive nature. Non-privileged users should coordinate any sharing of information with a System Administrator (SA) through shared resources. fapolicyd can confine users to their home directory, not allowing them to make any changes outside of their own home directories. Confining users to their home directory will minimize the risk of sharing information.",
      "severity": "medium",
      "title": "fapolicyd Must be Configured to Limit Access to Users Home Folders",
      "warning": "Users' home directories/folders may contain information of a sensitive nature. Non-privileged users should coordinate any sharing of information with a System Administrator (SA) through shared resources. fapolicyd can confine users to their home directory, not allowing them to make any changes outside of their own home directories. Confining users to their home directory will minimize the risk of sharing information."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/group- , run the command:\n\n$ sudo chgrp root /etc/group-",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_group",
      "instructions": "To check the group ownership of /etc/group-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/group-\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-groupowner-backup-etc-group",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-backup-etc-group",
        "namespace": "openshift-compliance",
        "resourceVersion": "78212",
        "uid": "0fd80e2c-dcca-4fdd-a43b-9b6b0fc48133"
      },
      "rationale": "The /etc/group- file is a backup file of /etc/group , and as such, it contains information regarding groups that are configured on the system. Protection of this file is important for system security.",
      "severity": "medium",
      "title": "Verify Group Who Owns Backup group File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/gshadow- , run the command:\n\n$ sudo chgrp root /etc/gshadow-",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_gshadow",
      "instructions": "To check the group ownership of /etc/gshadow-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/gshadow-\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-groupowner-backup-etc-gshadow",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-backup-etc-gshadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78213",
        "uid": "271ba332-7a1e-4f6f-bad2-4b6c55420448"
      },
      "rationale": "The /etc/gshadow- file is a backup of /etc/gshadow , and as such, it contains group password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Group Who Owns Backup gshadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/passwd- , run the command:\n\n$ sudo chgrp root /etc/passwd-",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_passwd",
      "instructions": "To check the group ownership of /etc/passwd-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/passwd-\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-groupowner-backup-etc-passwd",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-backup-etc-passwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "78215",
        "uid": "e8b6d0e3-3fb9-441e-b799-c2a632a33b6b"
      },
      "rationale": "The /etc/passwd- file is a backup file of /etc/passwd , and as such, it contains information about the users that are configured on the system. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Group Who Owns Backup passwd File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/shadow- , run the command:\n\n$ sudo chgrp root /etc/shadow-",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_shadow",
      "instructions": "To check the group ownership of /etc/shadow-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/shadow-\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-groupowner-backup-etc-shadow",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7",
          "policies.open-cluster-management.io/controls": "Req-8.7",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-backup-etc-shadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78216",
        "uid": "2d122ef9-aed7-4e8c-b6f6-e28c2bb60f07"
      },
      "rationale": "The /etc/shadow- file is a backup file of /etc/shadow , and as such, it contains the list of local system accounts and password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify User Who Owns Backup shadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The file /boot/grub2/grub.cfg should be group-owned by the root group to prevent destruction or modification of the file. To properly set the group owner of /boot/grub2/grub.cfg , run the command:\n\n$ sudo chgrp root /boot/grub2/grub.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_efi_grub2_cfg",
      "instructions": "To check the group ownership of /boot/grub2/grub.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /boot/grub2/grub.cfg\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-groupowner-efi-grub2-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1),Req-7.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-efi-grub2-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77806",
        "uid": "93852253-c4f9-4f5e-b0ad-076a9ac8683a"
      },
      "rationale": "The root group is a highly-privileged group. Furthermore, the group-owner of this file should not have any access privileges anyway.",
      "severity": "medium",
      "title": "Verify the UEFI Boot Loader grub.cfg Group Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The file /boot/grub2/user.cfg should be group-owned by the root group to prevent reading or modification of the file. To properly set the group owner of /boot/grub2/user.cfg , run the command:\n\n$ sudo chgrp root /boot/grub2/user.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_efi_user_cfg",
      "instructions": "To check the group ownership of /boot/grub2/user.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /boot/grub2/user.cfg\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-groupowner-efi-user-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1),Req-7.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-efi-user-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77810",
        "uid": "7a836d86-d5a5-48e6-8549-1f66082021ae"
      },
      "rationale": "The root group is a highly-privileged group. Furthermore, the group-owner of this file should not have any access privileges anyway. Non-root users who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them.",
      "severity": "medium",
      "title": "Verify /boot/grub2/user.cfg Group Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/chrony.keys , run the command:\n\n$ sudo chgrp root /etc/chrony.keys",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_chrony_keys",
      "instructions": "To check the group ownership of /etc/chrony.keys,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/chrony.keys\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-groupowner-etc-chrony-keys"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-chrony-keys",
        "namespace": "openshift-compliance",
        "resourceVersion": "78477",
        "uid": "0653a64f-7f94-4807-8381-afaf09790c57"
      },
      "rationale": "The ownership of the /etc/chrony.keys file by the root group is important because this file hosts chrony cryptographic keys. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the chrony cryptography keys.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/chrony.keys File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/crypttab , run the command:\n\n$ sudo chgrp root /etc/crypttab",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_crypttab",
      "instructions": "To check the group ownership of /etc/crypttab,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/crypttab\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-groupowner-etc-crypttab"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-crypttab",
        "namespace": "openshift-compliance",
        "resourceVersion": "78201",
        "uid": "bb406e22-4194-4179-a076-7dfa8001c16c"
      },
      "rationale": "The ownership of the /etc/crypttab file by the root group is important because this file hosts encrypted block devices configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the encrypted block devices configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/crypttab File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/group , run the command:\n\n$ sudo chgrp root /etc/group",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_group",
      "instructions": "To check the group ownership of /etc/group,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/group\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-groupowner-etc-group",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-group",
        "namespace": "openshift-compliance",
        "resourceVersion": "78219",
        "uid": "0545f8a1-280e-4bfd-9cc9-3231c5876cbe"
      },
      "rationale": "The /etc/group file contains information regarding groups that are configured on the system. Protection of this file is important for system security.",
      "severity": "medium",
      "title": "Verify Group Who Owns group File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/gshadow , run the command:\n\n$ sudo chgrp root /etc/gshadow",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_gshadow",
      "instructions": "To check the group ownership of /etc/gshadow,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/gshadow\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-groupowner-etc-gshadow",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-gshadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78221",
        "uid": "937c6aa8-861f-4d5e-aca4-95477cf05701"
      },
      "rationale": "The /etc/gshadow file contains group password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Group Who Owns gshadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/ipsec.conf , run the command:\n\n$ sudo chgrp root /etc/ipsec.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_ipsec_conf",
      "instructions": "To check the group ownership of /etc/ipsec.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ipsec.conf\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-groupowner-etc-ipsec-conf"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-ipsec-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "78048",
        "uid": "232be919-00f1-40ba-947c-069c645c2532"
      },
      "rationale": "The ownership of the /etc/ipsec.conf file by the root group is important because this file hosts Libreswan configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the Libreswan configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/ipsec.conf File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/ipsec.secrets , run the command:\n\n$ sudo chgrp root /etc/ipsec.secrets",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_ipsec_secrets",
      "instructions": "To check the group ownership of /etc/ipsec.secrets,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ipsec.secrets\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-groupowner-etc-ipsec-secrets"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-ipsec-secrets",
        "namespace": "openshift-compliance",
        "resourceVersion": "78050",
        "uid": "5aa57d8a-cdc0-45fe-a820-66a6cc60ff15"
      },
      "rationale": "The ownership of the /etc/ipsec.secrets file by the root group is important because this file hosts Libreswan configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the Libreswan configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/ipsec.secrets File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/issue , run the command:\n\n$ sudo chgrp root /etc/issue",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue",
      "instructions": "To check the group ownership of /etc/issue,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/issue\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-groupowner-etc-issue"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-issue",
        "namespace": "openshift-compliance",
        "resourceVersion": "76774",
        "uid": "7037d4ee-cf18-4f47-af80-36767fae148c"
      },
      "rationale": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nProper group ownership will ensure that only root user can modify the banner.",
      "severity": "medium",
      "title": "Verify Group Ownership of System Login Banner"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/issue.net , run the command:\n\n$ sudo chgrp root /etc/issue.net",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue_net",
      "instructions": "To check the group ownership of /etc/issue.net,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/issue.net\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-groupowner-etc-issue-net"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-issue-net",
        "namespace": "openshift-compliance",
        "resourceVersion": "76778",
        "uid": "b6184ee2-5a0b-4345-b185-81101c3e0b67"
      },
      "rationale": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nProper group ownership will ensure that only root user can modify the banner.",
      "severity": "medium",
      "title": "Verify Group Ownership of System Login Banner for Remote Connections"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/passwd , run the command:\n\n$ sudo chgrp root /etc/passwd",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_passwd",
      "instructions": "To check the group ownership of /etc/passwd,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/passwd\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-groupowner-etc-passwd",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-passwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "78222",
        "uid": "dc433798-dcd2-43c6-ac93-764f08d7c926"
      },
      "rationale": "The /etc/passwd file contains information about the users that are configured on the system. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Group Who Owns passwd File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/sestatus.conf , run the command:\n\n$ sudo chgrp root /etc/sestatus.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_sestatus_conf",
      "instructions": "To check the group ownership of /etc/sestatus.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/sestatus.conf\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-groupowner-etc-sestatus-conf"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-sestatus-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "78410",
        "uid": "baef3ff1-3e21-425d-b083-ef63eecd5d50"
      },
      "rationale": "The ownership of the /etc/sestatus.conf file by the root group is important because this file hosts SELinux configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the SELinux configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/sestatus.conf File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/shadow , run the command:\n\n$ sudo chgrp root /etc/shadow",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_shadow",
      "instructions": "To check the group ownership of /etc/shadow,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/shadow\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-groupowner-etc-shadow",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-shadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78223",
        "uid": "033adc46-9968-4356-a1c2-272ea4fd3ff2"
      },
      "rationale": "The /etc/shadow file stores password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Group Who Owns shadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/shells , run the command:\n\n$ sudo chgrp root /etc/shells",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_shells",
      "instructions": "To check the group ownership of /etc/shells,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/shells\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-groupowner-etc-shells",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;MP-2",
          "policies.open-cluster-management.io/controls": "AC-3,MP-2",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-shells",
        "namespace": "openshift-compliance",
        "resourceVersion": "78224",
        "uid": "b1b19f9f-d08d-4f07-8c7e-62ade49f2c8c"
      },
      "rationale": "The /etc/shells file contains the list of full pathnames to shells on the system. Since this file is used by many system programs this file should be protected.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/shells File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/sudoers , run the command:\n\n$ sudo chgrp root /etc/sudoers",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_sudoers",
      "instructions": "To check the group ownership of /etc/sudoers,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/sudoers\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-groupowner-etc-sudoers"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-etc-sudoers",
        "namespace": "openshift-compliance",
        "resourceVersion": "76681",
        "uid": "626f0480-d262-41b2-bcab-753db184eb68"
      },
      "rationale": "The ownership of the /etc/sudoers file by the root group is important because this file hosts sudo configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the sudo configuration.",
      "severity": "medium",
      "title": "Verify Group Who Owns /etc/sudoers File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The file /boot/grub2/grub.cfg should be group-owned by the root group to prevent destruction or modification of the file. To properly set the group owner of /boot/grub2/grub.cfg , run the command:\n\n$ sudo chgrp root /boot/grub2/grub.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_grub2_cfg",
      "instructions": "To check the group ownership of /boot/grub2/grub.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /boot/grub2/grub.cfg\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-groupowner-grub2-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1),Req-7.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-grub2-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77791",
        "uid": "e194bf0e-296d-4018-b8f3-5a1fcb4de4f1"
      },
      "rationale": "The root group is a highly-privileged group. Furthermore, the group-owner of this file should not have any access privileges anyway.",
      "severity": "medium",
      "title": "Verify /boot/grub2/grub.cfg Group Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /etc/ssh/sshd_config , run the command:\n\n$ sudo chgrp root /etc/ssh/sshd_config",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_sshd_config",
      "instructions": "To check the group ownership of /etc/ssh/sshd_config,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ssh/sshd_config\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "file-groupowner-sshd-config",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-17(a),CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-sshd-config",
        "namespace": "openshift-compliance",
        "resourceVersion": "78497",
        "uid": "afaa3e71-3740-4706-adeb-3a5c0866b4ab"
      },
      "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the correct group to prevent unauthorized changes.",
      "severity": "medium",
      "title": "Verify Group Who Owns SSH Server config file"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/log/journal/.*/system.journal , run the command:\n\n$ sudo chgrp systemd-journal /var/log/journal/.*/system.journal",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_system_journal",
      "instructions": "To check the group ownership of /var/log/journal/.*/system.journal,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/log/journal/.*/system.journal\nIf properly configured, the output should indicate the following group-owner:\nsystemd-journal",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "file-groupowner-system-journal"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-system-journal",
        "namespace": "openshift-compliance",
        "resourceVersion": "77997",
        "uid": "3205897f-6973-467a-9c27-153f083861bd"
      },
      "rationale": "RHCOS must protect system journal file from any type of unauthorized access by setting file group ownership.",
      "severity": "medium",
      "title": "Verify Group Who Owns the system journal"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The file /boot/grub2/user.cfg should be group-owned by the root group to prevent reading or modification of the file. To properly set the group owner of /boot/grub2/user.cfg , run the command:\n\n$ sudo chgrp root /boot/grub2/user.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_user_cfg",
      "instructions": "To check the group ownership of /boot/grub2/user.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /boot/grub2/user.cfg\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-groupowner-user-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1),Req-7.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-user-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77794",
        "uid": "f1589f7a-2303-4ca3-b9bf-5ab3a0fe21c6"
      },
      "rationale": "The root group is a highly-privileged group. Furthermore, the group-owner of this file should not have any access privileges anyway. Non-root users who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them.",
      "severity": "medium",
      "title": "Verify /boot/grub2/user.cfg Group Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/log , run the command:\n\n$ sudo chgrp root /var/log",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_var_log",
      "instructions": "To check the group ownership of /var/log,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/log\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "file-groupowner-var-log"
        },
        "creationTimestamp": "2024-03-05T15:03:07Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-var-log",
        "namespace": "openshift-compliance",
        "resourceVersion": "78263",
        "uid": "48f34f3d-758d-4939-ac93-8cbd868cd293"
      },
      "rationale": "The /var/log directory contains files with logs of error messages in the system and should only be accessed by authorized personnel.",
      "severity": "medium",
      "title": "Verify Group Who Owns /var/log Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/log/messages , run the command:\n\n$ sudo chgrp root /var/log/messages",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_var_log_messages",
      "instructions": "To check the group ownership of /var/log/messages,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/log/messages\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-groupowner-var-log-messages"
        },
        "creationTimestamp": "2024-03-05T15:03:07Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-var-log-messages",
        "namespace": "openshift-compliance",
        "resourceVersion": "78265",
        "uid": "abce0993-8078-4591-a5f4-4f6adbe03ebc"
      },
      "rationale": "The /var/log/messages file contains logs of error messages in the system and should only be accessed by authorized personnel.",
      "severity": "medium",
      "title": "Verify Group Who Owns /var/log/messages File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the group owner of /var/log/syslog , run the command:\n\n$ sudo chgrp adm /var/log/syslog",
      "id": "xccdf_org.ssgproject.content_rule_file_groupowner_var_log_syslog",
      "instructions": "To check the group ownership of /var/log/syslog,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/log/syslog\nIf properly configured, the output should indicate the following group-owner:\nadm",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-groupowner-var-log-syslog"
        },
        "creationTimestamp": "2024-03-05T15:03:07Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupowner-var-log-syslog",
        "namespace": "openshift-compliance",
        "resourceVersion": "78262",
        "uid": "ad54d44f-a67f-424e-9691-49cd40234d80"
      },
      "rationale": "The /var/log/syslog file contains logs of error messages in the system and should only be accessed by authorized personnel.",
      "severity": "medium",
      "title": "Verify Group Who Owns /var/log/syslog File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All audit configuration files must be owned by group root.\n\nchown :root /etc/audit/audit*.{rules,conf} /etc/audit/rules.d/*",
      "id": "xccdf_org.ssgproject.content_rule_file_groupownership_audit_configuration",
      "instructions": "To properly set the group owner of /etc/audit/, run the command:\n$ sudo chgrp root /etc/audit/\n\nTo properly set the group owner of /etc/audit/rules.d/, run the command:\n$ sudo chgrp root /etc/audit/rules.d/",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-groupownership-audit-configuration"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupownership-audit-configuration",
        "namespace": "openshift-compliance",
        "resourceVersion": "77181",
        "uid": "a90adbf8-3bec-4e39-889d-250f591b3804"
      },
      "rationale": "Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.",
      "severity": "medium",
      "title": "Audit Configuration Files Must Be Owned By Group root"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SSH server private keys, files that match the /etc/ssh/*_key glob, must be group-owned by ssh_keys group.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupownership_sshd_private_key",
      "instructions": "To check the group ownership of /etc/ssh/*_key,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ssh/*_key\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-groupownership-sshd-private-key"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupownership-sshd-private-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "78500",
        "uid": "05ecbda5-c457-4edf-986e-fde8e1cf95ce"
      },
      "rationale": "If an unauthorized user obtains the private SSH host key file, the host could be impersonated.",
      "severity": "medium",
      "title": "Verify Group Ownership on SSH Server Private *_key Key Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SSH server public keys, files that match the /etc/ssh/*.pub glob, must be group-owned by root group.",
      "id": "xccdf_org.ssgproject.content_rule_file_groupownership_sshd_pub_key",
      "instructions": "To check the group ownership of /etc/ssh/*.pub,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ssh/*.pub\nIf properly configured, the output should indicate the following group-owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-groupownership-sshd-pub-key"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupownership-sshd-pub-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "78501",
        "uid": "0d3a2e48-c433-4ca7-9035-c7aaf171b2ad"
      },
      "rationale": "If a public host key file is modified by an unauthorized user, the SSH service may be compromised.",
      "severity": "medium",
      "title": "Verify Group Ownership on SSH Server Public *.pub Key Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System commands files are stored in the following directories by default:\n\n/bin\n/sbin\n/usr/bin\n/usr/sbin\n/usr/local/bin\n/usr/local/sbin\n\nAll files in these directories should be owned by the root group, or a system account. If the directory, or any file in these directories, is found to be owned by a group other than root or a a system account correct its ownership with the following command:\n\n$ sudo chgrp root FILE",
      "id": "xccdf_org.ssgproject.content_rule_file_groupownership_system_commands_dirs",
      "instructions": "Verify the system commands contained in the following directories are group-owned by \"root\", or a required system account, with the following command:\n\n$ sudo find -L /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -group root -exec ls -l {} \\;",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-groupownership-system-commands-dirs",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(6);CM-5(6).1",
          "policies.open-cluster-management.io/controls": "CM-5(6),CM-5(6).1",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-groupownership-system-commands-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "78287",
        "uid": "d9cf6947-37fe-4ad5-ad75-0a244cafd555"
      },
      "rationale": "If the operating system allows any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process. This requirement applies to operating systems with software libraries that are accessible and configurable, as in the case of interpreted languages. Software libraries also include privileged programs which execute with escalated privileges. Only qualified and authorized individuals must be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.",
      "severity": "medium",
      "title": "Verify that system commands files are group owned by root or a system account"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/group- , run the command:\n\n$ sudo chown root /etc/group-",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_group",
      "instructions": "To check the ownership of /etc/group-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/group-\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-owner-backup-etc-group",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-backup-etc-group",
        "namespace": "openshift-compliance",
        "resourceVersion": "78227",
        "uid": "b743c009-dd8c-49e4-8eea-9d0dd336801c"
      },
      "rationale": "The /etc/group- file is a backup file of /etc/group , and as such, it contains information regarding groups that are configured on the system. Protection of this file is important for system security.",
      "severity": "medium",
      "title": "Verify User Who Owns Backup group File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/gshadow- , run the command:\n\n$ sudo chown root /etc/gshadow-",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_gshadow",
      "instructions": "To check the ownership of /etc/gshadow-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/gshadow-\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-owner-backup-etc-gshadow",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:05Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-backup-etc-gshadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78232",
        "uid": "9572170c-637b-4652-b50f-bec73c75eecc"
      },
      "rationale": "The /etc/gshadow- file is a backup of /etc/gshadow , and as such, it contains group password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify User Who Owns Backup gshadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/passwd- , run the command:\n\n$ sudo chown root /etc/passwd-",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_passwd",
      "instructions": "To check the ownership of /etc/passwd-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/passwd-\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-owner-backup-etc-passwd",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-backup-etc-passwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "78235",
        "uid": "02270219-d159-4c02-854b-83657f306371"
      },
      "rationale": "The /etc/passwd- file is a backup file of /etc/passwd , and as such, it contains information about the users that are configured on the system. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify User Who Owns Backup passwd File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/shadow- , run the command:\n\n$ sudo chown root /etc/shadow-",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_shadow",
      "instructions": "To check the ownership of /etc/shadow-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/shadow-\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-owner-backup-etc-shadow",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-backup-etc-shadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78239",
        "uid": "dd8c076a-8a93-4762-82d3-a2e06dd3edc6"
      },
      "rationale": "The /etc/shadow- file is a backup file of /etc/shadow , and as such, it contains the list of local system accounts and password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Group Who Owns Backup shadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The file /boot/grub2/grub.cfg should be owned by the root user to prevent destruction or modification of the file. To properly set the owner of /boot/grub2/grub.cfg , run the command:\n\n$ sudo chown root /boot/grub2/grub.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_efi_grub2_cfg",
      "instructions": "To check the ownership of /boot/grub2/grub.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /boot/grub2/grub.cfg\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-owner-efi-grub2-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1),Req-7.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-efi-grub2-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77812",
        "uid": "46d641b6-e381-48fb-9a00-1ecda93430a3"
      },
      "rationale": "Only root should be able to modify important boot parameters.",
      "severity": "medium",
      "title": "Verify the UEFI Boot Loader grub.cfg User Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The file /boot/grub2/user.cfg should be owned by the root user to prevent reading or modification of the file. To properly set the owner of /boot/grub2/user.cfg , run the command:\n\n$ sudo chown root /boot/grub2/user.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_efi_user_cfg",
      "instructions": "To check the ownership of /boot/grub2/user.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /boot/grub2/user.cfg\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-owner-efi-user-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1),Req-7.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-efi-user-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77815",
        "uid": "6accddb1-cb57-4254-98e5-927292090fe6"
      },
      "rationale": "Only root should be able to modify important boot parameters. Also, non-root users who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them.",
      "severity": "medium",
      "title": "Verify /boot/grub2/user.cfg User Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/chrony.keys , run the command:\n\n$ sudo chown root /etc/chrony.keys",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_chrony_keys",
      "instructions": "To check the ownership of /etc/chrony.keys,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/chrony.keys\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-owner-etc-chrony-keys"
        },
        "creationTimestamp": "2024-03-05T15:03:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-chrony-keys",
        "namespace": "openshift-compliance",
        "resourceVersion": "78478",
        "uid": "0ad732c5-7cf4-4919-96d3-e0ad1c171ed9"
      },
      "rationale": "The ownership of the /etc/chrony.keys file by the root user is important because this file hosts chrony cryptographic keys. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the chrony cryptographic keys.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/chrony.keys File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/crypttab , run the command:\n\n$ sudo chown root /etc/crypttab",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_crypttab",
      "instructions": "To check the ownership of /etc/crypttab,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/crypttab\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-owner-etc-crypttab"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-crypttab",
        "namespace": "openshift-compliance",
        "resourceVersion": "78202",
        "uid": "be943995-ff80-40b4-8135-5586cd59f904"
      },
      "rationale": "The ownership of the /etc/crypttab file by the root user is important because this file hosts encrypted block devices configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the encrypted block devices configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/crypttab File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/group , run the command:\n\n$ sudo chown root /etc/group",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_group",
      "instructions": "To check the ownership of /etc/group,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/group\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-owner-etc-group",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-group",
        "namespace": "openshift-compliance",
        "resourceVersion": "78240",
        "uid": "d1c19b63-0b6d-48c2-b5b2-10aa4ce35156"
      },
      "rationale": "The /etc/group file contains information regarding groups that are configured on the system. Protection of this file is important for system security.",
      "severity": "medium",
      "title": "Verify User Who Owns group File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/gshadow , run the command:\n\n$ sudo chown root /etc/gshadow",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_gshadow",
      "instructions": "To check the ownership of /etc/gshadow,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/gshadow\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-owner-etc-gshadow",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-gshadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78245",
        "uid": "36b6f276-9b25-4fab-b845-74cdc602e74c"
      },
      "rationale": "The /etc/gshadow file contains group password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify User Who Owns gshadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/ipsec.conf , run the command:\n\n$ sudo chown root /etc/ipsec.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_ipsec_conf",
      "instructions": "To check the ownership of /etc/ipsec.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ipsec.conf\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-owner-etc-ipsec-conf"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-ipsec-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "78052",
        "uid": "5f7df82c-f922-4293-a125-757d9c875d77"
      },
      "rationale": "The ownership of the /etc/ipsec.conf file by the root user is important because this file hosts Libreswan configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the Libreswan configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/ipsec.conf File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/ipsec.secrets , run the command:\n\n$ sudo chown root /etc/ipsec.secrets",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_ipsec_secrets",
      "instructions": "To check the ownership of /etc/ipsec.secrets,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ipsec.secrets\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-owner-etc-ipsec-secrets"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-ipsec-secrets",
        "namespace": "openshift-compliance",
        "resourceVersion": "78054",
        "uid": "36bb0a48-25f3-4112-8212-10d71c143cea"
      },
      "rationale": "The ownership of the /etc/ipsec.secrets file by the root user is important because this file hosts Libreswan configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the Libreswan configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/ipsec.secrets File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/issue , run the command:\n\n$ sudo chown root /etc/issue",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_issue",
      "instructions": "To check the ownership of /etc/issue,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/issue\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-owner-etc-issue"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-issue",
        "namespace": "openshift-compliance",
        "resourceVersion": "76781",
        "uid": "a76b9c16-c52a-4e36-8478-234445b08aea"
      },
      "rationale": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nProper ownership will ensure that only root user can modify the banner.",
      "severity": "medium",
      "title": "Verify ownership of System Login Banner"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/issue.net , run the command:\n\n$ sudo chown root /etc/issue.net",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_issue_net",
      "instructions": "To check the ownership of /etc/issue.net,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/issue.net\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-owner-etc-issue-net"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-issue-net",
        "namespace": "openshift-compliance",
        "resourceVersion": "76786",
        "uid": "9363d9b8-064c-4ab9-9df1-46a5c1d286d7"
      },
      "rationale": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nProper ownership will ensure that only root user can modify the banner.",
      "severity": "medium",
      "title": "Verify ownership of System Login Banner for Remote Connections"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/passwd , run the command:\n\n$ sudo chown root /etc/passwd",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_passwd",
      "instructions": "To check the ownership of /etc/passwd,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/passwd\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-owner-etc-passwd",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-passwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "78241",
        "uid": "eccca276-562b-4a67-920c-6e9f695762e5"
      },
      "rationale": "The /etc/passwd file contains information about the users that are configured on the system. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify User Who Owns passwd File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/sestatus.conf , run the command:\n\n$ sudo chown root /etc/sestatus.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_sestatus_conf",
      "instructions": "To check the ownership of /etc/sestatus.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/sestatus.conf\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-owner-etc-sestatus-conf"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-sestatus-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "78411",
        "uid": "3b671d1d-7b5f-40ed-b690-dfb61caaf500"
      },
      "rationale": "The ownership of the /etc/sestatus.conf file by the root user is important because this file hosts SELinux configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the SELinux configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/sestatus.conf File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/shadow , run the command:\n\n$ sudo chown root /etc/shadow",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_shadow",
      "instructions": "To check the ownership of /etc/shadow,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/shadow\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-owner-etc-shadow",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-shadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78249",
        "uid": "072c6c2c-616f-4dea-bc63-aa3500229d3f"
      },
      "rationale": "The /etc/shadow file contains the list of local system accounts and stores password hashes. Protection of this file is critical for system security. Failure to give ownership of this file to root provides the designated owner with access to sensitive information which could weaken the system security posture.",
      "severity": "medium",
      "title": "Verify User Who Owns shadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/shells , run the command:\n\n$ sudo chown root /etc/shells",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_shells",
      "instructions": "To check the ownership of /etc/shells,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/shells\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-owner-etc-shells",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;MP-2",
          "policies.open-cluster-management.io/controls": "AC-3,MP-2",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-shells",
        "namespace": "openshift-compliance",
        "resourceVersion": "78247",
        "uid": "f41dd61e-34be-4dc1-ac61-5289c6dbc5ec"
      },
      "rationale": "The /etc/shells file contains the list of full pathnames to shells on the system. Since this file is used by many system programs this file should be protected.",
      "severity": "medium",
      "title": "Verify Who Owns /etc/shells File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/sudoers , run the command:\n\n$ sudo chown root /etc/sudoers",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_etc_sudoers",
      "instructions": "To check the ownership of /etc/sudoers,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/sudoers\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-owner-etc-sudoers"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-etc-sudoers",
        "namespace": "openshift-compliance",
        "resourceVersion": "76670",
        "uid": "059fd589-ad2d-4da2-b042-ee9101576330"
      },
      "rationale": "The ownership of the /etc/sudoers file by the root user is important because this file hosts sudo configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the sudo configuration.",
      "severity": "medium",
      "title": "Verify User Who Owns /etc/sudoers File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The file /boot/grub2/grub.cfg should be owned by the root user to prevent destruction or modification of the file. To properly set the owner of /boot/grub2/grub.cfg , run the command:\n\n$ sudo chown root /boot/grub2/grub.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_grub2_cfg",
      "instructions": "To check the ownership of /boot/grub2/grub.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /boot/grub2/grub.cfg\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-owner-grub2-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1),Req-7.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-grub2-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77796",
        "uid": "5e7ab0f9-bf20-4c6e-9c89-79974f448a3f"
      },
      "rationale": "Only root should be able to modify important boot parameters.",
      "severity": "medium",
      "title": "Verify /boot/grub2/grub.cfg User Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /etc/ssh/sshd_config , run the command:\n\n$ sudo chown root /etc/ssh/sshd_config",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_sshd_config",
      "instructions": "To check the ownership of /etc/ssh/sshd_config,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ssh/sshd_config\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-owner-sshd-config",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-17(a),CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-sshd-config",
        "namespace": "openshift-compliance",
        "resourceVersion": "78502",
        "uid": "d913b308-0898-4ddb-b370-1bd237923d78"
      },
      "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the correct group to prevent unauthorized changes.",
      "severity": "medium",
      "title": "Verify Owner on SSH Server config file"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/log/journal/.*/system.journal , run the command:\n\n$ sudo chown root /var/log/journal/.*/system.journal",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_system_journal",
      "instructions": "To check the ownership of /var/log/journal/.*/system.journal,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/log/journal/.*/system.journal\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "file-owner-system-journal"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-system-journal",
        "namespace": "openshift-compliance",
        "resourceVersion": "78000",
        "uid": "1bea0e0b-cd1c-486a-9438-d9308dfbd9c9"
      },
      "rationale": "RHCOS must protect system journal file from any type of unauthorized access by setting file ownership",
      "severity": "medium",
      "title": "Verify Owner on the system journal"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The file /boot/grub2/user.cfg should be owned by the root user to prevent reading or modification of the file. To properly set the owner of /boot/grub2/user.cfg , run the command:\n\n$ sudo chown root /boot/grub2/user.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_user_cfg",
      "instructions": "To check the ownership of /boot/grub2/user.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /boot/grub2/user.cfg\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-owner-user-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-7.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1),Req-7.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-user-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77798",
        "uid": "b6869112-4974-4f54-a76b-e8f03a6fb424"
      },
      "rationale": "Only root should be able to modify important boot parameters. Also, non-root users who read the boot parameters may be able to identify weaknesses in security upon boot and be able to exploit them.",
      "severity": "medium",
      "title": "Verify /boot/grub2/user.cfg User Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/log , run the command:\n\n$ sudo chown root /var/log",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_var_log",
      "instructions": "To check the ownership of /var/log,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/log\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "file-owner-var-log"
        },
        "creationTimestamp": "2024-03-05T15:03:07Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-var-log",
        "namespace": "openshift-compliance",
        "resourceVersion": "78270",
        "uid": "52340c34-345c-443e-a55b-c0b93423d318"
      },
      "rationale": "The /var/log directory contains files with logs of error messages in the system and should only be accessed by authorized personnel.",
      "severity": "medium",
      "title": "Verify User Who Owns /var/log Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/log/messages , run the command:\n\n$ sudo chown root /var/log/messages",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_var_log_messages",
      "instructions": "To check the ownership of /var/log/messages,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/log/messages\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-owner-var-log-messages"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-var-log-messages",
        "namespace": "openshift-compliance",
        "resourceVersion": "78271",
        "uid": "6b96bbd9-ecf6-44bf-a6fb-b55f7e66886a"
      },
      "rationale": "The /var/log/messages file contains logs of error messages in the system and should only be accessed by authorized personnel.",
      "severity": "medium",
      "title": "Verify User Who Owns /var/log/messages File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the owner of /var/log/syslog , run the command:\n\n$ sudo chown syslog /var/log/syslog",
      "id": "xccdf_org.ssgproject.content_rule_file_owner_var_log_syslog",
      "instructions": "To check the ownership of /var/log/syslog,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /var/log/syslog\nIf properly configured, the output should indicate the following owner:\nsyslog",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-owner-var-log-syslog"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-owner-var-log-syslog",
        "namespace": "openshift-compliance",
        "resourceVersion": "78272",
        "uid": "f2720cb3-ec62-4ce2-a259-0e841bd7e307"
      },
      "rationale": "The /var/log/syslog file contains logs of error messages in the system and should only be accessed by authorized personnel.",
      "severity": "medium",
      "title": "Verify User Who Owns /var/log/syslog File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All audit configuration files must be owned by root user. To properly set the owner of /etc/audit/ , run the command:\n\n$ sudo chown root /etc/audit/\n\nTo properly set the owner of /etc/audit/rules.d/ , run the command:\n\n$ sudo chown root /etc/audit/rules.d/",
      "id": "xccdf_org.ssgproject.content_rule_file_ownership_audit_configuration",
      "instructions": "To properly set the owner of /etc/audit/, run the command:\n$ sudo chown root /etc/audit/ \n\nTo properly set the owner of /etc/audit/rules.d/, run the command:\n$ sudo chown root /etc/audit/rules.d/",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-ownership-audit-configuration"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-ownership-audit-configuration",
        "namespace": "openshift-compliance",
        "resourceVersion": "77183",
        "uid": "44c37182-0efb-4147-add1-9ad1da0d2b97"
      },
      "rationale": "Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.",
      "severity": "medium",
      "title": "Audit Configuration Files Must Be Owned By Root"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System executables are stored in the following directories by default:\n\n/bin\n/sbin\n/usr/bin\n/usr/libexec\n/usr/local/bin\n/usr/local/sbin\n/usr/sbin\n\nAll files in these directories should be owned by the root user. If any file FILE in these directories is found to be owned by a user other than root, correct its ownership with the following command:\n\n$ sudo chown root FILE",
      "id": "xccdf_org.ssgproject.content_rule_file_ownership_binary_dirs",
      "instructions": "Verify the system commands contained in the following directories are owned by \"root\" with the following command:\n\n$ sudo find -L /bin /sbin /usr/bin /usr/sbin /usr/libexec /usr/local/bin /usr/local/sbin ! -user root -exec ls -l {} \\;",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-ownership-binary-dirs",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(6);CM-5(6).1;CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-5(6),CM-5(6).1,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-ownership-binary-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "78288",
        "uid": "410900fa-2c62-4743-9638-e849167cc3b0"
      },
      "rationale": "System binaries are executed by privileged users as well as system services, and restrictive permissions are necessary to ensure that their execution of these programs cannot be co-opted.",
      "severity": "medium",
      "title": "Verify that System Executables Have Root Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System-wide shared library files, which are linked to executables during process load time or run time, are stored in the following directories by default:\n\n/lib\n/lib64\n/usr/lib\n/usr/lib64\n\nKernel modules, which can be added to the kernel during runtime, are also stored in /lib/modules. All files in these directories should be owned by the root user. If the directory, or any file in these directories, is found to be owned by a user other than root correct its ownership with the following command:\n\n$ sudo chown root FILE",
      "id": "xccdf_org.ssgproject.content_rule_file_ownership_library_dirs",
      "instructions": "Verify the system-wide shared library files are owned by \"root\" with the following command:\n\n$ sudo find -L /lib /lib64 /usr/lib /usr/lib64 ! -user root -exec ls -l {} \\;",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-ownership-library-dirs",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(6);CM-5(6).1;CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-5(6),CM-5(6).1,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-ownership-library-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "78290",
        "uid": "880fac1a-4361-4620-9800-2d49ebe29f31"
      },
      "rationale": "Files from shared library directories are loaded into the address space of processes (including privileged ones) or of the kernel itself at runtime. Proper ownership is necessary to protect the integrity of the system.",
      "severity": "medium",
      "title": "Verify that Shared Library Files Have Root Ownership"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SSH server private keys, files that match the /etc/ssh/*_key glob, must be owned by root user.",
      "id": "xccdf_org.ssgproject.content_rule_file_ownership_sshd_private_key",
      "instructions": "To check the ownership of /etc/ssh/*_key,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ssh/*_key\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-ownership-sshd-private-key"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-ownership-sshd-private-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "78505",
        "uid": "ce2706d6-f95d-455e-bad9-dfb457d1018c"
      },
      "rationale": "If an unauthorized user obtains the private SSH host key file, the host could be impersonated.",
      "severity": "medium",
      "title": "Verify Ownership on SSH Server Private *_key Key Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SSH server public keys, files that match the /etc/ssh/*.pub glob, must be owned by root user.",
      "id": "xccdf_org.ssgproject.content_rule_file_ownership_sshd_pub_key",
      "instructions": "To check the ownership of /etc/ssh/*.pub,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -lL /etc/ssh/*.pub\nIf properly configured, the output should indicate the following owner:\nroot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-ownership-sshd-pub-key"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-ownership-sshd-pub-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "78503",
        "uid": "e4cc85a7-23f8-4724-b2b3-d67f6f367f81"
      },
      "rationale": "If a public host key file is modified by an unauthorized user, the SSH service may be compromised.",
      "severity": "medium",
      "title": "Verify Ownership on SSH Server Public *.pub Key Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All audit logs must be owned by root user and group. By default, the path for audit log is\n\n/var/log/audit/\n\n. To properly set the owner of /var/log/audit , run the command:\n\n$ sudo chown root /var/log/audit\n\nTo properly set the owner of /var/log/audit/* , run the command:\n\n$ sudo chown root /var/log/audit/*",
      "id": "xccdf_org.ssgproject.content_rule_file_ownership_var_log_audit",
      "instructions": "To properly set the owner of /var/log/audit, run the command:\n$ sudo chown root /var/log/audit \n\nTo properly set the owner of /var/log/audit/*, run the command:\n$ sudo chown root /var/log/audit/*",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "file-ownership-var-log-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9(4)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.1",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),AU-9(4),Req-10.5.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:30Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-ownership-var-log-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "77187",
        "uid": "46f8bbc5-697f-49ea-9384-c2ffe52caaa7"
      },
      "rationale": "Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.",
      "severity": "medium",
      "title": "System Audit Logs Must Be Owned By Root"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Set the mode of the user initialization files to 0740 with the following command:\n\n$ sudo chmod 0740 /home/ USER /. INIT_FILE",
      "id": "xccdf_org.ssgproject.content_rule_file_permission_user_init_files",
      "instructions": "To verify that all user initialization files have a mode of 0740 or\nless permissive, run the following command:\n$ sudo find /home -type f -name '\\.*' \\( -perm -0002 -o -perm -0020 \\)\nThere should be no output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-permission-user-init-files"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permission-user-init-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "77049",
        "uid": "0a79de07-a691-493b-bed6-f23f4b766010"
      },
      "rationale": "Local initialization files are used to configure the user's shell environment upon logon. Malicious modification of these files could compromise accounts upon logon.",
      "severity": "medium",
      "title": "Ensure All User Initialization Files Have Mode 0740 Or Less Permissive"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All audit configuration files permissions must be 640 or more restrictive.\n\nchmod 0640 /etc/audit/audit*.{rules,conf} /etc/audit/rules.d/*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_audit_configuration",
      "instructions": "To properly set the permissions of /etc/audit/, run the command:\n$ sudo chmod 0640 /etc/audit/\n\nTo properly set the permissions of /etc/audit/rules.d/, run the command:\n$ sudo chmod 0640 /etc/audit/rules.d/",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-audit-configuration"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-audit-configuration",
        "namespace": "openshift-compliance",
        "resourceVersion": "77191",
        "uid": "7d36e915-b602-4a2b-82d8-992d92fce597"
      },
      "rationale": "Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.",
      "severity": "medium",
      "title": "Audit Configuration Files Permissions are 640 or More Restrictive"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/group- , run the command:\n\n$ sudo chmod 0644 /etc/group-",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_group",
      "instructions": "To check the permissions of /etc/group-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/group-\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-backup-etc-group",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-backup-etc-group",
        "namespace": "openshift-compliance",
        "resourceVersion": "78253",
        "uid": "a2e6ec47-b4dd-43c2-a494-d1d0c0bcde78"
      },
      "rationale": "The /etc/group- file is a backup file of /etc/group , and as such, it contains information regarding groups that are configured on the system. Protection of this file is important for system security.",
      "severity": "medium",
      "title": "Verify Permissions on Backup group File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/gshadow- , run the command:\n\n$ sudo chmod 0000 /etc/gshadow-",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_gshadow",
      "instructions": "To check the permissions of /etc/gshadow-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/gshadow-\nIf properly configured, the output should indicate the following permissions:\n----------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-backup-etc-gshadow",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "policies.open-cluster-management.io/controls": "AC-6 (1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-backup-etc-gshadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78250",
        "uid": "8dd9d6cf-6897-466c-919e-25ddaaa98906"
      },
      "rationale": "The /etc/gshadow- file is a backup of /etc/gshadow , and as such, it contains group password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Permissions on Backup gshadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/passwd- , run the command:\n\n$ sudo chmod 0644 /etc/passwd-",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_passwd",
      "instructions": "To check the permissions of /etc/passwd-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/passwd-\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-backup-etc-passwd",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-backup-etc-passwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "78255",
        "uid": "c157e135-1991-4eee-a5ac-8eb87873128a"
      },
      "rationale": "The /etc/passwd- file is a backup file of /etc/passwd , and as such, it contains information about the users that are configured on the system. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Permissions on Backup passwd File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/shadow- , run the command:\n\n$ sudo chmod 0000 /etc/shadow-",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_shadow",
      "instructions": "To check the permissions of /etc/shadow-,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/shadow-\nIf properly configured, the output should indicate the following permissions:\n----------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-backup-etc-shadow",
          "control.compliance.openshift.io/NIST-800-53": "AC-6 (1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "AC-6 (1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:06Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-backup-etc-shadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78254",
        "uid": "b67b96af-77d7-48d4-b626-5310cb78b6d5"
      },
      "rationale": "The /etc/shadow- file is a backup file of /etc/shadow , and as such, it contains the list of local system accounts and password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Permissions on Backup shadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System executables are stored in the following directories by default:\n\n/bin\n/sbin\n/usr/bin\n/usr/libexec\n/usr/local/bin\n/usr/local/sbin\n/usr/sbin\n\nAll files in these directories should not be group-writable or world-writable. If any file FILE in these directories is found to be group-writable or world-writable, correct its permission with the following command:\n\n$ sudo chmod go-w FILE",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_binary_dirs",
      "instructions": "Verify the system commands contained in the following directories have mode \"755\" or less permissive with the following command:\n\n$ sudo find -L /bin /sbin /usr/bin /usr/sbin /usr/libexec /usr/local/bin /usr/local/sbin -perm /022 -exec ls -l {} \\;",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-permissions-binary-dirs",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-5(6);CM-5(6).1;CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-5(6),CM-5(6).1,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-binary-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "78291",
        "uid": "afa4f0c3-40b8-4313-985c-b9e59e16fe63"
      },
      "rationale": "System binaries are executed by privileged users, as well as system services, and restrictive permissions are necessary to ensure execution of these programs cannot be co-opted.",
      "severity": "medium",
      "title": "Verify that System Executables Have Restrictive Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "File permissions for /boot/grub2/grub.cfg should be set to 700. To properly set the permissions of /boot/grub2/grub.cfg , run the command:\n\n$ sudo chmod 700 /boot/grub2/grub.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_efi_grub2_cfg",
      "instructions": "To check the permissions of /boot/grub2/grub.cfg, run the command:\n$ sudo ls -lL /boot/grub2/grub.cfg\nIf properly configured, the output should indicate the following\npermissions: -rwx------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-efi-grub2-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-efi-grub2-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77820",
        "uid": "2c7977cb-d3db-4d26-9736-6b64079486a9"
      },
      "rationale": "Proper permissions ensure that only the root user can modify important boot parameters.",
      "severity": "medium",
      "title": "Verify the UEFI Boot Loader grub.cfg Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "File permissions for /boot/grub2/user.cfg should be set to 600. To properly set the permissions of /boot/grub2/user.cfg , run the command:\n\n$ sudo chmod 600 /boot/grub2/user.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_efi_user_cfg",
      "instructions": "To check the permissions of /boot/grub2/user.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /boot/grub2/user.cfg\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-permissions-efi-user-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-efi-user-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77823",
        "uid": "bc0c43d0-9cbe-4332-a73c-eafb47bf2154"
      },
      "rationale": "Proper permissions ensure that only the root user can read or modify important boot parameters.",
      "severity": "medium",
      "title": "Verify /boot/grub2/user.cfg Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/chrony.keys , run the command:\n\n$ sudo chmod 0600 /etc/chrony.keys",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_chrony_keys",
      "instructions": "To check the permissions of /etc/chrony.keys,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/chrony.keys\nIf properly configured, the output should indicate the following permissions:\n0600",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-etc-chrony-keys"
        },
        "creationTimestamp": "2024-03-05T15:03:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-chrony-keys",
        "namespace": "openshift-compliance",
        "resourceVersion": "78479",
        "uid": "bbbcac51-2693-4a38-9a75-54d650314537"
      },
      "rationale": "Setting correct permissions on the /etc/chrony.keys file is important because this file hosts chrony cryptographic keys. Protection of this file is critical for system security. Assigning the correct mode ensures exclusive control of the chrony cryptographic keys.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/chrony.keys File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/crypttab , run the command:\n\n$ sudo chmod 0600 /etc/crypttab",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_crypttab",
      "instructions": "To check the permissions of /etc/crypttab,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/crypttab\nIf properly configured, the output should indicate the following permissions:\n0600",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-etc-crypttab"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-crypttab",
        "namespace": "openshift-compliance",
        "resourceVersion": "78204",
        "uid": "63074f88-4b96-4b0a-8093-b8ec377b89ac"
      },
      "rationale": "Setting correct permissions on the /etc/crypttab file is important because this file hosts encrypted block devices configuration. Protection of this file is critical for system security. Assigning the ownership to root ensures exclusive control of the encrypted block devices configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/crypttab File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/group , run the command:\n\n$ sudo chmod 0644 /etc/group",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_group",
      "instructions": "To check the permissions of /etc/group,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/group\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-permissions-etc-group",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:07Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-group",
        "namespace": "openshift-compliance",
        "resourceVersion": "78257",
        "uid": "31e4c1e8-c3f5-4138-b9ce-46692890be76"
      },
      "rationale": "The /etc/group file contains information regarding groups that are configured on the system. Protection of this file is important for system security.",
      "severity": "medium",
      "title": "Verify Permissions on group File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/gshadow , run the command:\n\n$ sudo chmod 0000 /etc/gshadow",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_gshadow",
      "instructions": "To check the permissions of /etc/gshadow,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/gshadow\nIf properly configured, the output should indicate the following permissions:\n----------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-permissions-etc-gshadow",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:07Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-gshadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78259",
        "uid": "248672e4-13ff-48bf-be41-b6ce32cb66de"
      },
      "rationale": "The /etc/gshadow file contains group password hashes. Protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Permissions on gshadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/ipsec.conf , run the command:\n\n$ sudo chmod 0644 /etc/ipsec.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_ipsec_conf",
      "instructions": "To check the permissions of /etc/ipsec.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/ipsec.conf\nIf properly configured, the output should indicate the following permissions:\n0644",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-etc-ipsec-conf"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-ipsec-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "78056",
        "uid": "56490e48-65f7-4b87-b79d-a65b3e2d6346"
      },
      "rationale": "Setting correct permissions on the /etc/ipsec.conf file is important because this file hosts Libreswan configuration. Protection of this file is critical for system security. Restricting the permissions ensures exclusive control of the Libreswan configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/ipsec.conf File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/ipsec.secrets , run the command:\n\n$ sudo chmod 0644 /etc/ipsec.secrets",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_ipsec_secrets",
      "instructions": "To check the permissions of /etc/ipsec.secrets,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/ipsec.secrets\nIf properly configured, the output should indicate the following permissions:\n0644",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-etc-ipsec-secrets"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-ipsec-secrets",
        "namespace": "openshift-compliance",
        "resourceVersion": "78062",
        "uid": "bc81481e-2872-496d-bc8a-3e21afedbfde"
      },
      "rationale": "Setting correct permissions on the /etc/ipsec.secrets file is important because this file hosts Libreswan configuration. Protection of this file is critical for system security. Restricting the permissions ensures exclusive control of the Libreswan configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/ipsec.secrets File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/issue , run the command:\n\n$ sudo chmod 0644 /etc/issue",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_issue",
      "instructions": "To check the permissions of /etc/issue,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/issue\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-etc-issue"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-issue",
        "namespace": "openshift-compliance",
        "resourceVersion": "76789",
        "uid": "61b10f9e-f1d1-44f3-a710-40ba1b3cc87a"
      },
      "rationale": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nProper permissions will ensure that only root user can modify the banner.",
      "severity": "medium",
      "title": "Verify permissions on System Login Banner"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/issue.net , run the command:\n\n$ sudo chmod 0644 /etc/issue.net",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_issue_net",
      "instructions": "To check the permissions of /etc/issue.net,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/issue.net\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-etc-issue-net"
        },
        "creationTimestamp": "2024-03-05T15:02:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-issue-net",
        "namespace": "openshift-compliance",
        "resourceVersion": "76792",
        "uid": "0f06bc7b-fd0f-4d70-8b74-f503b0f95193"
      },
      "rationale": "Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nProper permissions will ensure that only root user can modify the banner.",
      "severity": "medium",
      "title": "Verify permissions on System Login Banner for Remote Connections"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/passwd , run the command:\n\n$ sudo chmod 0644 /etc/passwd",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_passwd",
      "instructions": "To check the permissions of /etc/passwd,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/passwd\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-etc-passwd",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:07Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-passwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "78260",
        "uid": "f45ae19e-6ff5-423d-b5f8-3dc1a6d17af3"
      },
      "rationale": "If the /etc/passwd file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the list of accounts on the system and associated information, and protection of this file is critical for system security.",
      "severity": "medium",
      "title": "Verify Permissions on passwd File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/sestatus.conf , run the command:\n\n$ sudo chmod 0644 /etc/sestatus.conf",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_sestatus_conf",
      "instructions": "To check the permissions of /etc/sestatus.conf,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/sestatus.conf\nIf properly configured, the output should indicate the following permissions:\n0644",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "file-permissions-etc-sestatus-conf"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-sestatus-conf",
        "namespace": "openshift-compliance",
        "resourceVersion": "78413",
        "uid": "3bfc0405-d995-40c1-aee0-872a6d614191"
      },
      "rationale": "Setting correct permissions on the /etc/sestatus.conf file is important because this file hosts SELinux configuration. Protection of this file is critical for system security. Restricting the permissions ensures exclusive control of the SELinux configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/sestatus.conf File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/shadow , run the command:\n\n$ sudo chmod 0000 /etc/shadow",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_shadow",
      "instructions": "To check the permissions of /etc/shadow,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/shadow\nIf properly configured, the output should indicate the following permissions:\n----------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-etc-shadow",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.7.c",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-8.7.c",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:07Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-shadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "78261",
        "uid": "b86d7ccf-5cf7-4821-81e5-579f5b95bd25"
      },
      "rationale": "The /etc/shadow file contains the list of local system accounts and stores password hashes. Protection of this file is critical for system security. Failure to give ownership of this file to root provides the designated owner with access to sensitive information which could weaken the system security posture.",
      "severity": "medium",
      "title": "Verify Permissions on shadow File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/shells , run the command:\n\n$ sudo chmod 0644 /etc/shells",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_shells",
      "instructions": "To check the permissions of /etc/shells,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/shells\nIf properly configured, the output should indicate the following permissions:\n0644",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-permissions-etc-shells",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;MP-2",
          "policies.open-cluster-management.io/controls": "AC-3,MP-2",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:07Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-shells",
        "namespace": "openshift-compliance",
        "resourceVersion": "78258",
        "uid": "7f379dd5-3835-4f1e-aef5-273af80a7495"
      },
      "rationale": "The /etc/shells file contains the list of full pathnames to shells on the system. Since this file is used by many system programs this file should be protected.",
      "severity": "medium",
      "title": "Verify Permissions on /etc/shells File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/sudoers , run the command:\n\n$ sudo chmod 0440 /etc/sudoers",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_sudoers",
      "instructions": "To check the permissions of /etc/sudoers,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/sudoers\nIf properly configured, the output should indicate the following permissions:\n0440",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-etc-sudoers"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-etc-sudoers",
        "namespace": "openshift-compliance",
        "resourceVersion": "76697",
        "uid": "03d4fb95-3782-42e6-9b29-660ede751425"
      },
      "rationale": "Setting correct permissions on the /etc/sudoers file is important because this file hosts sudo configuration. Protection of this file is critical for system security. Restricting the permissions ensures exclusive control of the sudo configuration.",
      "severity": "medium",
      "title": "Verify Permissions On /etc/sudoers File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "File permissions for /boot/grub2/grub.cfg should be set to 600. To properly set the permissions of /boot/grub2/grub.cfg , run the command:\n\n$ sudo chmod 600 /boot/grub2/grub.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_grub2_cfg",
      "instructions": "To check the permissions of /boot/grub2/grub.cfg, run the command:\n$ sudo ls -lL /boot/grub2/grub.cfg\nIf properly configured, the output should indicate the following\npermissions: -rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-grub2-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-grub2-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77801",
        "uid": "dda0c53e-0d18-47b9-9b22-985743f95350"
      },
      "rationale": "Proper permissions ensure that only the root user can modify important boot parameters.",
      "severity": "medium",
      "title": "Verify /boot/grub2/grub.cfg Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "For each human user of the system, view the permissions of the user's home directory:\n\n# ls -ld /home/ USER\n\nEnsure that the directory is not group-writable and that it is not world-readable. If necessary, repair the permissions:\n\n# chmod g-w /home/ USER # chmod o-rwx /home/ USER",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_home_dirs",
      "instructions": "To ensure the user home directory is not group-writable or world-readable, run the following:\n# ls -ld /home/USER",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-home-dirs",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-home-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "77035",
        "uid": "304b0c1b-9cf1-490f-acc4-15e635a9037b"
      },
      "rationale": "User home directories contain many configuration files which affect the behavior of a user's account. No user should ever have write permission to another user's home directory. Group shared directories can be configured in sub-directories or elsewhere in the filesystem if they are needed. Typically, user home directories should not be world-readable, as it would disclose file names to other users. If a subset of users need read access to one another's home directories, this can be provided using groups or ACLs.",
      "severity": "medium",
      "title": "Ensure that User Home Directories are not Group-Writable or World-Readable",
      "warning": "User home directories contain many configuration files which affect the behavior of a user's account. No user should ever have write permission to another user's home directory. Group shared directories can be configured in sub-directories or elsewhere in the filesystem if they are needed. Typically, user home directories should not be world-readable, as it would disclose file names to other users. If a subset of users need read access to one another's home directories, this can be provided using groups or ACLs."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System-wide shared library files, which are linked to executables during process load time or run time, are stored in the following directories by default:\n\n/lib\n/lib64\n/usr/lib\n/usr/lib64\n\nKernel modules, which can be added to the kernel during runtime, are stored in /lib/modules. All files in these directories should not be group-writable or world-writable. If any file in these directories is found to be group-writable or world-writable, correct its permission with the following command:\n\n$ sudo chmod go-w FILE",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_library_dirs",
      "instructions": "Verify the system-wide shared library files contained in the following directories have mode \"755\" or less permissive with the following command:\n\n$ sudo find -L /lib /lib64 /usr/lib /usr/lib64 -perm /022 -type f -exec ls -l {} \\;",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-library-dirs",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);CM-5(6);CM-5(6).1;AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),CM-5(6),CM-5(6).1,AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-library-dirs",
        "namespace": "openshift-compliance",
        "resourceVersion": "78292",
        "uid": "35cff14d-8923-42c4-b77b-49c48e598c0f"
      },
      "rationale": "Files from shared library directories are loaded into the address space of processes (including privileged ones) or of the kernel itself at runtime. Restrictive permissions are necessary to protect the integrity of the system.",
      "severity": "medium",
      "title": "Verify that Shared Library Files Have Restrictive Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/ssh/sshd_config , run the command:\n\n$ sudo chmod 0600 /etc/ssh/sshd_config",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_sshd_config",
      "instructions": "To check the permissions of /etc/ssh/sshd_config,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/ssh/sshd_config\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "file-permissions-sshd-config",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-17(a),CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-sshd-config",
        "namespace": "openshift-compliance",
        "resourceVersion": "78506",
        "uid": "2b52147e-7aa8-4b28-a087-ccfec6e4c535"
      },
      "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly can lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the correct group to prevent unauthorized changes.",
      "severity": "medium",
      "title": "Verify Permissions on SSH Server config file"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SSH server private keys - files that match the /etc/ssh/*_key glob, have to have restricted permissions. If those files are owned by the root user and the root group, they have to have the 0640 permission or stricter. If they are owned by the root user, but by a dedicated group ssh_keys , they can have the 0640 permission or stricter.",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_sshd_private_key",
      "instructions": "To check the permissions of /etc/ssh/*_key,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/ssh/*_key\nIf properly configured, the output should indicate the following permissions:\n-rw-r-----",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "file-permissions-sshd-private-key",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.4",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-17(a),CM-6(a),AC-6(1),Req-2.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-sshd-private-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "78512",
        "uid": "e4969185-a074-4087-bef8-c8fc0b0a4480"
      },
      "rationale": "If an unauthorized user obtains the private SSH host key file, the host could be impersonated.",
      "severity": "medium",
      "title": "Verify Permissions on SSH Server Private *_key Key Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /etc/ssh/*.pub , run the command:\n\n$ sudo chmod 0644 /etc/ssh/*.pub",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_sshd_pub_key",
      "instructions": "To check the permissions of /etc/ssh/*.pub,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /etc/ssh/*.pub\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r--",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "file-permissions-sshd-pub-key",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.4",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-17(a),CM-6(a),AC-6(1),Req-2.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-sshd-pub-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "78514",
        "uid": "8480bab9-d85e-4272-91d0-8026eeffa395"
      },
      "rationale": "If a public host key file is modified by an unauthorized user, the SSH service may be compromised.",
      "severity": "medium",
      "title": "Verify Permissions on SSH Server Public *.pub Key Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /usr/bin/sudo , run the command:\n\n$ sudo chmod 4111 /usr/bin/sudo",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_sudo",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-sudo"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-sudo",
        "namespace": "openshift-compliance",
        "resourceVersion": "76693",
        "uid": "699917b7-48b3-4e12-a398-ec18fe6a2955"
      },
      "rationale": "The sudoers program should only be usable by people who have the correct permissions.",
      "severity": "medium",
      "title": "Ensure That the sudo Binary Has the Correct Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log/journal/.*/system.journal , run the command:\n\n$ sudo chmod 0640 /var/log/journal/.*/system.journal",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_system_journal",
      "instructions": "To check the permissions of /var/log/journal/.*/system.journal,\n  you'll need to log into a node in the cluster.\n  As a user with administrator privileges, log into a node in the relevant pool:\n  \n  $ oc debug node/$NODE_NAME\n  \n  At the sh-4.4# prompt, run:\n  \n  # chroot /host\n  \n\n  Then,run the command:\n  $ ls -l /var/log/journal/.*/system.journal\n  If properly configured, the output should indicate the following permissions:\n  -rw-r-----",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "file-permissions-system-journal"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-system-journal",
        "namespace": "openshift-compliance",
        "resourceVersion": "78002",
        "uid": "6d559d29-0cde-4444-8a0f-16a6691581ac"
      },
      "rationale": "RHCOS must protect system journal file from any type of unauthorized access by setting file permissions.",
      "severity": "medium",
      "title": "Verify Permissions on the system journal"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Files containing sensitive informations should be protected by restrictive permissions. Most of the time, there is no need that these files need to be read by any non-root user To properly set the permissions of /boot/System.map-* , run the command:\n\n$ sudo chmod 0600 /boot/System.map-*",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_systemmap",
      "instructions": "To check the permissions of /boot/Sysem.map-*,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /boot/Sysem.map-*\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-systemmap"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-systemmap",
        "namespace": "openshift-compliance",
        "resourceVersion": "78206",
        "uid": "4287fcf4-3b9d-4e41-b389-591cb948a544"
      },
      "rationale": "The System.map file contains information about kernel symbols and can give some hints to generate local exploitation.",
      "severity": "unknown",
      "title": "Verify that local System.map file (if exists) is readable only by root"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "It is generally a good idea to remove global (other) write access to a file when it is discovered. However, check with documentation for specific applications before making changes. Also, monitor for recurring world-writable files, as these may be symptoms of a misconfigured application or user account. Finally, this applies to real files and not virtual files that are a part of pseudo file systems such as sysfs or procfs.",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_unauthorized_world_writable",
      "instructions": "To find world-writable files, run the following command:\n$ sudo find / -xdev -type f -perm -002",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-minimal,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-unauthorized-world-writable",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-unauthorized-world-writable",
        "namespace": "openshift-compliance",
        "resourceVersion": "78207",
        "uid": "d73f238c-ef06-492b-b57d-565e39679cf8"
      },
      "rationale": "Data in world-writable files can be modified by any user on the system. In almost all circumstances, files can be configured using a combination of user and group permissions to support whatever legitimate access is needed without the risk caused by world-writable files.",
      "severity": "medium",
      "title": "Ensure No World-Writable Files Exist",
      "warning": "Data in world-writable files can be modified by any user on the system. In almost all circumstances, files can be configured using a combination of user and group permissions to support whatever legitimate access is needed without the risk caused by world-writable files."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "File permissions for /boot/grub2/user.cfg should be set to 600. To properly set the permissions of /boot/grub2/user.cfg , run the command:\n\n$ sudo chmod 600 /boot/grub2/user.cfg",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_user_cfg",
      "instructions": "To check the permissions of /boot/grub2/user.cfg,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /boot/grub2/user.cfg\nIf properly configured, the output should indicate the following permissions:\n-rw-------",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "file-permissions-user-cfg",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:48Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-user-cfg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77804",
        "uid": "9d19f07a-3a0f-49c2-a6d6-93507f46234b"
      },
      "rationale": "Proper permissions ensure that only the root user can read or modify important boot parameters.",
      "severity": "medium",
      "title": "Verify /boot/grub2/user.cfg Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log , run the command:\n\n$ sudo chmod 0755 /var/log",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_var_log",
      "instructions": "To check the permissions of /var/log,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log\nIf properly configured, the output should indicate the following permissions:\ndrwxr-xr-x",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "file-permissions-var-log"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-var-log",
        "namespace": "openshift-compliance",
        "resourceVersion": "78273",
        "uid": "f017d4f6-2810-4109-a7ad-2da98d1b6de6"
      },
      "rationale": "The /var/log directory contains files with logs of error messages in the system and should only be accessed by authorized personnel.",
      "severity": "medium",
      "title": "Verify Permissions on /var/log Directory"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Determine where the audit logs are stored with the following command:\n\n$ sudo grep -iw log_file /etc/audit/auditd.conf\nlog_file = /var/log/audit/audit.log\n\nConfigure the audit log to be protected from unauthorized read access by setting the correct permissive mode with the following command:\n\n$ sudo chmod 0600 audit_log_file\n\nBy default, audit_log_file is \"/var/log/audit/audit.log\".",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_var_log_audit",
      "instructions": "Run the following command to check the mode of the system audit logs:\n$ sudo grep -iw log_file /etc/audit/auditd.conf\nlog_file=/var/log/audit/audit.log\n$ sudo stat -c \"%n %a\" /var/log/audit/*\n$ sudo ls -l /var/log/audit\nAudit logs must be mode 0640 or less permissive.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "file-permissions-var-log-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1);AU-9(4)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),AU-9(4),Req-10.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:31Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-var-log-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "77195",
        "uid": "9657c5ed-7af7-4aca-88ba-e43d4a1b7d7e"
      },
      "rationale": "If users can write to audit logs, audit trails can be modified or destroyed.",
      "severity": "medium",
      "title": "System Audit Logs Must Have Mode 0640 or Less Permissive"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log/messages , run the command:\n\n$ sudo chmod 0640 /var/log/messages",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_var_log_messages",
      "instructions": "To check the permissions of /var/log/messages,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log/messages\nIf properly configured, the output should indicate the following permissions:\n-rw-r-----",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-var-log-messages"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-var-log-messages",
        "namespace": "openshift-compliance",
        "resourceVersion": "78274",
        "uid": "5384a8d0-d61d-4d67-9c30-f6661a43f65c"
      },
      "rationale": "The /var/log/messages file contains logs of error messages in the system and should only be accessed by authorized personnel.",
      "severity": "medium",
      "title": "Verify Permissions on /var/log/messages File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To properly set the permissions of /var/log/syslog , run the command:\n\n$ sudo chmod 0640 /var/log/syslog",
      "id": "xccdf_org.ssgproject.content_rule_file_permissions_var_log_syslog",
      "instructions": "To check the permissions of /var/log/syslog,\nyou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nThen,run the command:\n$ ls -l /var/log/syslog\nIf properly configured, the output should indicate the following permissions:\n-rw-r-----",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "file-permissions-var-log-syslog"
        },
        "creationTimestamp": "2024-03-05T15:03:08Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-file-permissions-var-log-syslog",
        "namespace": "openshift-compliance",
        "resourceVersion": "78276",
        "uid": "f371b5b2-e39f-45cb-949a-96f3530cbd68"
      },
      "rationale": "The /var/log/syslog file contains logs of error messages in the system and should only be accessed by authorized personnel.",
      "severity": "medium",
      "title": "Verify Permissions on /var/log/syslog File"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "By default, iptables blocks access to the ports used by the web server. To configure iptables to allow port 21 traffic, one must edit /etc/sysconfig/iptables and /etc/sysconfig/ip6tables (if IPv6 is in use). Add the following line, ensuring that it appears before the final LOG and DROP lines for the INPUT chain:\n\n-A INPUT -m state --state NEW -p tcp --dport 21 -j ACCEPT\n\nEdit the file /etc/sysconfig/iptables-config. Ensure that the space-separated list of modules contains the FTP connection tracking module:\n\nIPTABLES_MODULES=\"ip_conntrack_ftp\"",
      "id": "xccdf_org.ssgproject.content_rule_ftp_configure_firewall",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "ftp-configure-firewall"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-ftp-configure-firewall",
        "namespace": "openshift-compliance",
        "resourceVersion": "78444",
        "uid": "0bd6ed86-09b6-4a55-bb8e-69a85b25effb"
      },
      "rationale": "These settings configure the firewall to allow connections to an FTP server. The first line allows initial connections to the FTP server port. FTP is an older protocol which is not very compatible with firewalls. During the initial FTP dialogue, the client and server negotiate an arbitrary port to be used for data transfer. The ip_conntrack_ftp module is used by iptables to listen to that dialogue and allow connections to the data ports which FTP negotiates. This allows an FTP server to operate on a system which is running a firewall.",
      "severity": "unknown",
      "title": "Configure Firewalls to Protect the FTP Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "If there is a mission-critical reason for users to access their accounts via the insecure FTP protocol, limit the set of users who are allowed this access. Edit the vsftpd configuration file. Add or correct the following configuration options:\n\nuserlist_enable=YES\nuserlist_file=/etc/vsftp.ftpusers\nuserlist_deny=NO\n\nEdit the file /etc/vsftp.ftpusers. For each user USERNAME who should be allowed to access the system via FTP, add a line containing that user's name:\n\nUSERNAME\n\nIf anonymous access is also required, add the anonymous usernames to /etc/vsftp.ftpusers as well.\n\nanonymous\nftp",
      "id": "xccdf_org.ssgproject.content_rule_ftp_limit_users",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "ftp-limit-users"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-ftp-limit-users",
        "namespace": "openshift-compliance",
        "resourceVersion": "78445",
        "uid": "21f08a69-91bf-4bd8-984f-3530ad644644"
      },
      "rationale": "Historically, the file /etc/ftpusers contained a list of users who were not allowed to access the system via FTP. It was used to prevent system users such as the root user from logging in via the insecure FTP protocol. However, when the configuration option userlist deny=NO is set, vsftpd interprets ftpusers as the set of users who are allowed to login via FTP. Since it should be possible for most users to access their accounts via secure protocols, it is recommended that this setting be used, so that non-anonymous FTP access can be limited to legacy users who have been explicitly identified.",
      "severity": "unknown",
      "title": "Limit Users Allowed FTP Access if Necessary"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Add a group to the system for each GID referenced without a corresponding group.",
      "id": "xccdf_org.ssgproject.content_rule_gid_passwd_group_same",
      "instructions": "To ensure all GIDs referenced in /etc/passwd are defined in /etc/group,\nrun the following command:\n$ sudo pwck -qr\nThere should be no output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "gid-passwd-group-same",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "IA-2;CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.5.a",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,IA-2,CM-6(a),Req-8.5.a",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-gid-passwd-group-same",
        "namespace": "openshift-compliance",
        "resourceVersion": "76934",
        "uid": "2e92f57b-b24e-407d-ac48-01456a664d0d"
      },
      "rationale": "If a user is assigned the Group Identifier (GID) of a group not existing on the system, and a group with the Group Identifier (GID) is subsequently created, the user may have unintended rights to any files associated with the group.",
      "severity": "low",
      "title": "All GIDs referenced in /etc/passwd must be defined in /etc/group"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "XDMCP is an unencrypted protocol, and therefore, presents a security risk, see e.g. XDMCP Gnome docs ( https://help.gnome.org/admin/gdm/stable/security.html.en_GB#xdmcpsecurity ). To disable XDMCP support in Gnome, set Enable to false under the [xdmcp] configuration section in /etc/gdm/custom.conf. For example:\n\n[xdmcp]\nEnable=false",
      "id": "xccdf_org.ssgproject.content_rule_gnome_gdm_disable_xdmcp",
      "instructions": "To ensure that XDMCP is disabled in /etc/gdm/custom.conf, run the following command:\ngrep -Pzo \"\\[xdmcp\\]\\nEnable=false\" /etc/gdm/custom.conf\nThe output should return the following:\n\n[xdmcp]\nEnable=false",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "gnome-gdm-disable-xdmcp"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-gnome-gdm-disable-xdmcp",
        "namespace": "openshift-compliance",
        "resourceVersion": "76660",
        "uid": "642999df-c2d3-4c18-a8b6-829c63c6339c"
      },
      "rationale": "XDMCP provides unencrypted remote access through the Gnome Display Manager (GDM) which does not provide for the confidentiality and integrity of user passwords or the remote session. If a privileged user were to login using XDMCP, the privileged user password could be compromised due to typed XEvents and keystrokes will traversing over the network in clear text.",
      "severity": "high",
      "title": "Disable XDMCP in GDM"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Red Hat Enterprise Linux CoreOS 4 systems support an \"interactive boot\" option that can be used to prevent services from being started. On a Red Hat Enterprise Linux CoreOS 4 system, interactive boot can be enabled by providing a 1 , yes , true , or on value to the systemd.confirm_spawn kernel argument in /etc/default/grub. Remove any instance of\n\nsystemd.confirm_spawn=(1|yes|true|on)\n\nfrom the kernel arguments in that file to disable interactive boot. Recovery booting must also be disabled. Confirm that GRUB_DISABLE_RECOVERY=true is set in /etc/default/grub. It is also required to change the runtime configuration, run:\n\n/sbin/grubby --update-kernel=ALL --remove-args=\"systemd.confirm_spawn\"\n\ngrub2-mkconfig -o /boot/grub2/grub.cfg",
      "id": "xccdf_org.ssgproject.content_rule_grub2_disable_interactive_boot",
      "instructions": "Inspect /etc/default/grub for any instances of\nsystemd.confirm_spawn=(1|yes|true|on) in the kernel boot arguments.\nPresence of a systemd.confirm_spawn=(1|yes|true|on) indicates\nthat interactive boot is enabled at boot time and verify that\nGRUB_DISABLE_RECOVERY=true to disable recovery boot.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "grub2-disable-interactive-boot",
          "control.compliance.openshift.io/NIST-800-53": "SC-2(1);CM-6(a)",
          "policies.open-cluster-management.io/controls": "SC-2(1),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-disable-interactive-boot",
        "namespace": "openshift-compliance",
        "resourceVersion": "76849",
        "uid": "6efcbfba-c5d4-44bb-af8a-f9f3f145c4ea"
      },
      "rationale": "Using interactive or recovery boot, the console user could disable auditing, firewalls, or other services, weakening system security.",
      "severity": "medium",
      "title": "Verify that Interactive Boot is Disabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Red Hat Enterprise Linux CoreOS 4 systems support an \"recovery boot\" option that can be used to prevent services from being started. The GRUB_DISABLE_RECOVERY configuration option in /etc/default/grub should be set to true to disable the generation of recovery mode menu entries. It is also required to change the runtime configuration, run:\n\n$ sudo grubby --update-kernel=ALL",
      "id": "xccdf_org.ssgproject.content_rule_grub2_disable_recovery",
      "instructions": "Verify that GRUB_DISABLE_RECOVERY is set to true in /etc/default/grub to disable recovery boot.\nRun the following command:\n\n$ sudo grep GRUB_DISABLE_RECOVERY /etc/default/grub",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "grub2-disable-recovery"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-disable-recovery",
        "namespace": "openshift-compliance",
        "resourceVersion": "77757",
        "uid": "86080e94-e7ca-44e2-abd7-22784bff80d7"
      },
      "rationale": "Using recovery boot, the console user could disable auditing, firewalls, or other services, weakening system security.",
      "severity": "medium",
      "title": "Disable Recovery Booting"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To ensure FIPS mode is enabled, install package dracut-fips , and rebuild initramfs by running the following commands:\n\n$ sudo dnf install dracut-fips\ndracut -f\n\nAfter the dracut command has been run, add the argument fips=1 to the default GRUB 2 command line for the Linux operating system in /etc/default/grub , in the manner below:\n\nGRUB_CMDLINE_LINUX=\"crashkernel=auto rd.lvm.lv=VolGroup/LogVol06 rd.lvm.lv=VolGroup/lv_swap rhgb quiet rd.shell=0 fips=1\"\n\nFinally, rebuild the grub.cfg file by using the\n\ngrub2-mkconfig -o\n\ncommand as follows:\n\n* On BIOS-based machines, issue the following command as root :\n\n~]# grub2-mkconfig -o /boot/grub2/grub.cfg\n\n* On UEFI-based machines, issue the following command as root :\n\n~]# grub2-mkconfig -o /boot/grub2/grub.cfg",
      "id": "xccdf_org.ssgproject.content_rule_grub2_enable_fips_mode",
      "instructions": "To verify that FIPS is enabled properly in grub, run the following command:\n$ grep fips /etc/default/grub\nThe output should contain fips=1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "grub2-enable-fips-mode",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-12(2);SC-12(3);IA-7;SC-13;CM-6(a);SC-12",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-12(2),SC-12(3),IA-7,SC-13,CM-6(a),SC-12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-enable-fips-mode",
        "namespace": "openshift-compliance",
        "resourceVersion": "76571",
        "uid": "b89f6cb9-fe0c-4dee-831f-7a952a9e4a32"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "high",
      "title": "Enable FIPS Mode in GRUB2",
      "warning": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "On x86 architecture supporting VT-d, the IOMMU manages the access control policy between the hardware devices and some of the system critical units such as the memory. Configure the default Grub2 kernel command line to contain iommu=force as follows:\n\n# grub2-editenv - set \"$(grub2-editenv - list | grep kernelopts) iommu=force\"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_enable_iommu_force",
      "instructions": "Inspect the form of default GRUB 2 command line for the Linux operating system\nin /boot/grub2/grubenv.\nIf they include iommu=force, then the parameter\nis configured at boot time.\n$ sudo grep 'kernelopts.*iommu=force.*' GRUBENV_FILE_LOCATION\nFill in GRUBENV_FILE_LOCATION based on information above.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "grub2-enable-iommu-force"
        },
        "creationTimestamp": "2024-03-05T15:02:46Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-enable-iommu-force",
        "namespace": "openshift-compliance",
        "resourceVersion": "77760",
        "uid": "ba272dc4-39f1-4295-9cd6-05d58c4ee2a5"
      },
      "rationale": "On x86 architectures, activating the I/OMMU prevents the system from arbitrary accesses potentially made by hardware devices.",
      "severity": "unknown",
      "title": "IOMMU configuration directive",
      "warning": "On x86 architectures, activating the I/OMMU prevents the system from arbitrary accesses potentially made by hardware devices."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SELinux can be disabled at boot time by an argument in /etc/default/grub. Remove any instances of selinux=0 from the kernel arguments in that file to prevent SELinux from being disabled at boot.",
      "id": "xccdf_org.ssgproject.content_rule_grub2_enable_selinux",
      "instructions": "Inspect /etc/default/grub for any instances of selinux=0\nin the kernel boot arguments.  Presence of selinux=0 indicates\nthat SELinux is disabled at boot time.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "grub2-enable-selinux",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;AC-3(3)(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-3,AC-3(3)(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-enable-selinux",
        "namespace": "openshift-compliance",
        "resourceVersion": "78415",
        "uid": "9e83f903-69a3-47eb-9a5d-a32323f05fbe"
      },
      "rationale": "Disabling a major host protection feature, such as SELinux, at boot time prevents it from confining system services at boot time. Further, it increases the chances that it will remain off during system operation.",
      "severity": "medium",
      "title": "Ensure SELinux Not Disabled in /etc/default/grub"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To disable IPv6 protocol support in the Linux kernel, add the argument ipv6.disable=1 to the default GRUB2 command line for the Linux operating system. Configure the default Grub2 kernel command line to contain ipv6.disable=1 as follows:\n\n# grub2-editenv - set \"$(grub2-editenv - list | grep kernelopts) ipv6.disable=1\"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_ipv6_disable_argument",
      "instructions": "Inspect the form of default GRUB 2 command line for the Linux operating system\nin /boot/grub2/grubenv.\nIf they include ipv6.disable=1, then the parameter\nis configured at boot time.\n$ sudo grep 'kernelopts.*ipv6.disable=1.*' GRUBENV_FILE_LOCATION\nFill in GRUBENV_FILE_LOCATION based on information above.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "grub2-ipv6-disable-argument",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.3.1;Req-1.3.2",
          "policies.open-cluster-management.io/controls": "Req-1.3.1,Req-1.3.2",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-ipv6-disable-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "78090",
        "uid": "d31117c6-f236-4362-85fd-28806148e75a"
      },
      "rationale": "Any unnecessary network stacks, including IPv6, should be disabled to reduce the vulnerability to exploitation.",
      "severity": "low",
      "title": "Ensure IPv6 is disabled through kernel boot parameter"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "L1 Terminal Fault (L1TF) is a hardware vulnerability which allows unprivileged speculative access to data which is available in the Level 1 Data Cache when the page table entry isn't present. Select the appropriate mitigation by adding the argument l1tf= flush to the default GRUB 2 command line for the Linux operating system. Configure the default Grub2 kernel command line to contain l1tf= flush as follows:\n\n# grub2-editenv - set \"$(grub2-editenv - list | grep kernelopts) l1tf= flush \"\n\nSince Linux Kernel 4.19 you can check the L1TF vulnerability state with the following command: cat /sys/devices/system/cpu/vulnerabilities/l1tf",
      "id": "xccdf_org.ssgproject.content_rule_grub2_l1tf_argument",
      "instructions": "Inspect the form of default GRUB 2 command line for the Linux operating system\nin /boot/grub2/grubenv.\nIf they include l1tf=, then the parameter\nis configured at boot time.\n$ sudo grep 'kernelopts.*l1tf=.*' GRUBENV_FILE_LOCATION\nFill in GRUBENV_FILE_LOCATION based on information above.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "grub2-l1tf-argument",
          "compliance.openshift.io/rule-variable": "var-l1tf-options,var-l1tf-options,var-l1tf-options"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-l1tf-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77762",
        "uid": "326834ec-bf93-4a3a-824f-944674a8c253"
      },
      "rationale": "The L1TF vulnerability allows an attacker to bypass memory access security controls imposed by the system or hypervisor. The L1TF vulnerability allows read access to any physical memory location that is cached in the L1 Data Cache.",
      "severity": "high",
      "title": "Configure L1 Terminal Fault mitigations",
      "warning": "The L1TF vulnerability allows an attacker to bypass memory access security controls imposed by the system or hypervisor. The L1TF vulnerability allows read access to any physical memory location that is cached in the L1 Data Cache."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "A Machine Check Exception is an error generated by the CPU itdetects an error in itself, memory or I/O devices. These errors may be corrected and generate a check log entry, if an error cannot be corrected the kernel may panic or SIGBUS. To force the kernel to panic on any uncorrected error reported by Machine Check set the MCE tolerance to zero by adding mce=0 to the default GRUB 2 command line for the Linux operating system. Configure the default Grub2 kernel command line to contain mce=0 as follows:\n\n# grub2-editenv - set \"$(grub2-editenv - list | grep kernelopts) mce=0\"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_mce_argument",
      "instructions": "Inspect the form of default GRUB 2 command line for the Linux operating system\nin /boot/grub2/grubenv.\nIf they include mce=0, then the parameter\nis configured at boot time.\n$ sudo grep 'kernelopts.*mce=0.*' GRUBENV_FILE_LOCATION\nFill in GRUBENV_FILE_LOCATION based on information above.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "grub2-mce-argument"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-mce-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77764",
        "uid": "4795d929-b8d5-48b6-a7e3-19beffbcb93f"
      },
      "rationale": "Allowing uncorrected errors to result on a SIGBUS may allow an attacker to continue trying to exploit a vulnerability such as Rowhammer.",
      "severity": "medium",
      "title": "Force kernel panic on uncorrected MCEs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The SMAP is used to prevent the supervisor mode from unintentionally reading/writing into memory pages in the user space, it is enabled by default since Linux kernel 3.7. But it could be disabled through kernel boot parameters. Ensure that Supervisor Mode Access Prevention (SMAP) is not disabled by the nosmap boot paramenter option. Check that the line\n\nGRUB_CMDLINE_LINUX=\"...\"\n\nwithin /etc/default/grub doesn't contain the argument nosmap. Run the following command to update command line for already installed kernels:\n\n# grubby --update-kernel=ALL --remove-args=\"nosmap\"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_nosmap_argument_absent",
      "instructions": "Make sure that the kernel is not disabling SMAP with the following\ncommands.\ngrep -q nosmap /boot/config-`uname -r`\nIf the command returns a line, it means that SMAP is being disabled.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "grub2-nosmap-argument-absent"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-nosmap-argument-absent",
        "namespace": "openshift-compliance",
        "resourceVersion": "77766",
        "uid": "b41ba59f-60a0-4efe-ab77-bc162f897ccf"
      },
      "rationale": "Disabling SMAP can facilitate exploitation of vulnerabilities caused by unintended access and manipulation of data in the user space.",
      "severity": "medium",
      "title": "Ensure SMAP is not disabled during boot"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The SMEP is used to prevent the supervisor mode from executing user space code, it is enabled by default since Linux kernel 3.0. But it could be disabled through kernel boot parameters. Ensure that Supervisor Mode Execution Prevention (SMEP) is not disabled by the nosmep boot paramenter option. Check that the line\n\nGRUB_CMDLINE_LINUX=\"...\"\n\nwithin /etc/default/grub doesn't contain the argument nosmep. Run the following command to update command line for already installed kernels:\n\n# grubby --update-kernel=ALL --remove-args=\"nosmep\"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_nosmep_argument_absent",
      "instructions": "Make sure that the kernel is not disabling SMEP with the following\ncommands.\ngrep -q nosmep /boot/config-`uname -r`\nIf the command returns a line, it means that SMEP is being disabled.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "grub2-nosmep-argument-absent"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-nosmep-argument-absent",
        "namespace": "openshift-compliance",
        "resourceVersion": "77769",
        "uid": "5eaad5cd-859c-43e3-b18e-7fdf0468e019"
      },
      "rationale": "Disabling SMEP can facilitate exploitation of certain vulnerabilities because it allows the kernel to unintentionally execute code in less privileged memory space.",
      "severity": "medium",
      "title": "Ensure SMEP is not disabled during boot"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All USB support can be disabled by adding the nousb argument to the kernel's boot loader configuration. To do so, append \"nousb\" to the kernel line in /etc/default/grub as shown:\n\nkernel /vmlinuz- VERSION ro vga=ext root=/dev/VolGroup00/LogVol00 rhgb quiet nousb",
      "id": "xccdf_org.ssgproject.content_rule_grub2_nousb_argument",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "grub2-nousb-argument",
          "control.compliance.openshift.io/NIST-800-53": "MP-7;CM-6(a)",
          "policies.open-cluster-management.io/controls": "MP-7,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-nousb-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "78298",
        "uid": "1ec8442b-5b2d-43f9-8241-d47a5ab92dab"
      },
      "rationale": "Disabling the USB subsystem within the Linux kernel at system boot will protect against potentially malicious USB devices, although it is only practical in specialized systems.",
      "severity": "unknown",
      "title": "Disable Kernel Support for USB via Bootloader Configuration",
      "warning": "Disabling the USB subsystem within the Linux kernel at system boot will protect against potentially malicious USB devices, although it is only practical in specialized systems."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The TPM security chip that is available in most modern systems has a hardware RNG. It is also used to feed the entropy pool, but generally not credited entropy. Use rng_core.default_quality in the kernel command line to set the trust level on the hardware generators. The trust level defines the amount of entropy to credit. A value of 0 tells the system not to trust the hardware random number generators available, and doesn't credit any entropy to the pool. A value of 1000 assigns full confidence in the generators, and credits all the entropy it provides to the pool. Note that the value of rng_core.default_quality is global, affecting the trust on all hardware random number generators. Select the appropriate confidence by adding the argument rng_core.default_quality= 500 to the default GRUB 2 command line for the Linux operating system. Configure the default Grub2 kernel command line to contain rng_core.default_quality= 500 as follows:\n\n# grub2-editenv - set \"$(grub2-editenv - list | grep kernelopts) rng_core.default_quality= 500 \"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_rng_core_default_quality_argument",
      "instructions": "Inspect the form of default GRUB 2 command line for the Linux operating system\nin /boot/grub2/grubenv.\nIf they include rng_core.default_quality=, then the parameter\nis configured at boot time.\n$ sudo grep 'kernelopts.*rng_core.default_quality=.*' GRUBENV_FILE_LOCATION\nFill in GRUBENV_FILE_LOCATION based on information above.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "grub2-rng-core-default-quality-argument",
          "compliance.openshift.io/rule-variable": "var-rng-core-default-quality,var-rng-core-default-quality,var-rng-core-default-quality"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-rng-core-default-quality-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77772",
        "uid": "624e9554-6749-4632-8fcc-1dd26fc251a3"
      },
      "rationale": "A system may struggle to initialize its entropy pool and end up starving. Crediting entropy from the hardware number generators available in the system helps fill up the entropy pool.",
      "severity": "low",
      "title": "Configure the confidence in TPM for entropy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The kernel may merge similar slabs together to reduce overhead and increase cache hotness of objects. Disabling merging of slabs keeps the slabs separate and reduces the risk of kernel heap overflows overwriting objects in merged caches. To disable merging of slabs in the Kernel add the argument slab_nomerge=yes to the default GRUB 2 command line for the Linux operating system. Configure the default Grub2 kernel command line to contain slab_nomerge=yes as follows:\n\n# grub2-editenv - set \"$(grub2-editenv - list | grep kernelopts) slab_nomerge=yes\"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_slab_nomerge_argument",
      "instructions": "Inspect the form of default GRUB 2 command line for the Linux operating system\nin /boot/grub2/grubenv.\nIf they include slab_nomerge=yes, then the parameter\nis configured at boot time.\n$ sudo grep 'kernelopts.*slab_nomerge=yes.*' GRUBENV_FILE_LOCATION\nFill in GRUBENV_FILE_LOCATION based on information above.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "grub2-slab-nomerge-argument"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-slab-nomerge-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77775",
        "uid": "a5bc7ce3-f276-47a5-a77d-e81ac238e954"
      },
      "rationale": "Disabling the merge of slabs of similar sizes prevents the kernel from merging a seemingly useless but vulnerable slab with a useful and valuable slab. This increase the risk that a heap overflow could overwrite objects from merged caches, with unmerged caches the heap overflow would only affect the objects in the same cache. Overall, this reduces the kernel attack surface area by isolating slabs from each other.",
      "severity": "medium",
      "title": "Disable merging of slabs with similar size",
      "warning": "Disabling the merge of slabs of similar sizes prevents the kernel from merging a seemingly useless but vulnerable slab with a useful and valuable slab. This increase the risk that a heap overflow could overwrite objects from merged caches, with unmerged caches the heap overflow would only affect the objects in the same cache. Overall, this reduces the kernel attack surface area by isolating slabs from each other."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Certain CPUs are vulnerable to an exploit against a common wide industry wide performance optimization known as Speculative Store Bypass (SSB). In such cases, recent stores to the same memory location cannot always be observed by later loads during speculative execution. However, such stores are unlikely and thus they can be detected prior to instruction retirement at the end of a particular speculation execution window. Since Linux Kernel 4.17 you can check the SSB mitigation state with the following command: cat /sys/devices/system/cpu/vulnerabilities/spec_store_bypass Select the appropriate SSB state by adding the argument spec_store_bypass_disable= prctl to the default GRUB 2 command line for the Linux operating system. Configure the default Grub2 kernel command line to contain spec_store_bypass_disable= prctl as follows:\n\n# grub2-editenv - set \"$(grub2-editenv - list | grep kernelopts) spec_store_bypass_disable= prctl \"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_spec_store_bypass_disable_argument",
      "instructions": "Inspect the form of default GRUB 2 command line for the Linux operating system\nin /boot/grub2/grubenv.\nIf they include spec_store_bypass_disable=, then the parameter\nis configured at boot time.\n$ sudo grep 'kernelopts.*spec_store_bypass_disable=.*' GRUBENV_FILE_LOCATION\nFill in GRUBENV_FILE_LOCATION based on information above.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "grub2-spec-store-bypass-disable-argument",
          "compliance.openshift.io/rule-variable": "var-spec-store-bypass-disable-options,var-spec-store-bypass-disable-options,var-spec-store-bypass-disable-options"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-spec-store-bypass-disable-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77779",
        "uid": "0329f2b0-83b0-4a1b-a1cd-75f9c625497c"
      },
      "rationale": "In vulnerable processsors, the speculatively forwarded store can be used in a cache side channel attack. An example of this is reading memory to which the attacker does not directly have access, for example inside the sandboxed code.",
      "severity": "medium",
      "title": "Configure Speculative Store Bypass Mitigation",
      "warning": "In vulnerable processsors, the speculatively forwarded store can be used in a cache side channel attack. An example of this is reading memory to which the attacker does not directly have access, for example inside the sandboxed code."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Spectre V2 is an indirect branch poisoning attack that can lead to data leakage. An exploit for Spectre V2 tricks the indirect branch predictor into executing code from a future indirect branch chosen by the attacker, even if the privilege level is different. Since Linux Kernel 4.15 you can check the Spectre V2 mitigation state with the following command: cat /sys/devices/system/cpu/vulnerabilities/spectre_v2 Enforce the Spectre V2 mitigation by adding the argument spectre_v2=on to the default GRUB 2 command line for the Linux operating system. Configure the default Grub2 kernel command line to contain spectre_v2=on) as follows:\n\n# grub2-editenv - set \"$(grub2-editenv - list | grep kernelopts) spectre_v2=on)\"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_spectre_v2_argument",
      "instructions": "Inspect the form of default GRUB 2 command line for the Linux operating system\nin /boot/grub2/grubenv.\nIf they include spectre_v2=on, then the parameter\nis configured at boot time.\n$ sudo grep 'kernelopts.*spectre_v2=on.*' GRUBENV_FILE_LOCATION\nFill in GRUBENV_FILE_LOCATION based on information above.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "grub2-spectre-v2-argument"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-spectre-v2-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77784",
        "uid": "8bccc483-90bc-493b-922c-666782eee508"
      },
      "rationale": "The Spectre V2 vulnerability allows an attacker to read memory that he should not have access to.",
      "severity": "high",
      "title": "Enforce Spectre v2 mitigation"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "systemd's debug-shell service is intended to diagnose systemd related boot issues with various systemctl commands. Once enabled and following a system reboot, the root shell will be available on tty9 which is access by pressing CTRL-ALT-F9. The debug-shell service should only be used for systemd related issues and should otherwise be disabled.\n\nBy default, the debug-shell systemd service is already disabled. Ensure the debug-shell is not enabled by the systemd.debug-shel=1 boot paramenter option. Check that the line\n\nGRUB_CMDLINE_LINUX=\"...\"\n\nwithin /etc/default/grub doesn't contain the argument systemd.debug-shell=1. Run the following command to update command line for already installed kernels:\n\n# grubby --update-kernel=ALL --remove-args=\"systemd.debug-shell\"",
      "id": "xccdf_org.ssgproject.content_rule_grub2_systemd_debug-shell_argument_absent",
      "instructions": "Ensure that debug-shell service is not enabled with the following command:\ngrep systemd\\.debug-shell=1 /boot/grub2/grubenv /etc/default/grub\nIf the command returns a line, it means that debug-shell service is being enabled.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "grub2-systemd-debug-shell-argument-absent"
        },
        "creationTimestamp": "2024-03-05T15:02:47Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-systemd-debug-shell-argument-absent",
        "namespace": "openshift-compliance",
        "resourceVersion": "77790",
        "uid": "aa9385dc-7153-436b-8cf0-25f6dabcc246"
      },
      "rationale": "This prevents attackers with physical access from trivially bypassing security on the machine through valid troubleshooting configurations and gaining root access when the system is rebooted.",
      "severity": "medium",
      "title": "Ensure debug-shell service is not enabled during boot"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The grub2 boot loader should have a superuser account and password protection enabled to protect boot-time settings.\n\nTo maximize the protection, select a password-protected superuser account with unique name, and modify the /etc/grub.d/01_users configuration file to reflect the account name change.\n\nIt is highly suggested not to use common administrator account names like root, admin, or administrator for the grub2 superuser account.\n\nChange the superuser to a different username (The default is 'root').\n\n$ sed -i 's/\\(set superusers=\\).*/\\1\" \"/g' /etc/grub.d/01_users\n\nOnce the superuser account has been added, update the grub.cfg file by running:\n\ngrubby --update-kernel=ALL",
      "id": "xccdf_org.ssgproject.content_rule_grub2_uefi_admin_username",
      "instructions": "To verify the boot loader superuser account has been set, run the following\ncommand:\nsudo grep -A1 \"superusers\" /boot/grub2/grub.cfg\nThe output should show the following:\nset superusers=\"superusers-account\"\nexport superusers\nwhere superusers-account is the actual account name different from common names like root,\nadmin, or administrator and different from any other existing user name.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "grub2-uefi-admin-username",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-uefi-admin-username",
        "namespace": "openshift-compliance",
        "resourceVersion": "77826",
        "uid": "f22a5fac-8010-451e-a7a0-6732b03201c2"
      },
      "rationale": "Having a non-default grub superuser username makes password-guessing attacks less effective.",
      "severity": "medium",
      "title": "Set the UEFI Boot Loader Admin Username to a Non-Default Value",
      "warning": "Having a non-default grub superuser username makes password-guessing attacks less effective."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The grub2 boot loader should have a superuser account and password protection enabled to protect boot-time settings.\n\nSince plaintext passwords are a security risk, generate a hash for the password by running the following command:\n\n# grub2-setpassword\n\nWhen prompted, enter the password that was selected.",
      "id": "xccdf_org.ssgproject.content_rule_grub2_uefi_password",
      "instructions": "To verify the boot loader superuser password has been set, run the following command:\n$ sudo grep \"^[\\s]*GRUB2_PASSWORD=grub\\.pbkdf2\\.sha512.*$\" /boot/grub2/user.cfg\nThe output should be similar to:\nGRUB2_PASSWORD=grub.pbkdf2.sha512.10000.C4E08AC72FBFF7E837FD267BFAD7AEB3D42DDC\n2C99F2A94DD5E2E75C2DC331B719FE55D9411745F82D1B6CFD9E927D61925F9BBDD1CFAA0080E0\n916F7AB46E0D.1302284FCCC52CD73BA3671C6C12C26FF50BA873293B24EE2A96EE3B57963E6D7\n0C83964B473EC8F93B07FE749AA6710269E904A9B08A6BBACB00A2D242AD828",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "grub2-uefi-password",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-grub2-uefi-password",
        "namespace": "openshift-compliance",
        "resourceVersion": "77828",
        "uid": "fc0afe38-e9d3-4ccb-8289-0e2c20315f07"
      },
      "rationale": "Password protection on the boot loader configuration ensures users with physical access cannot trivially alter important bootloader settings. These include which kernel to use, and whether to enter single-user mode.",
      "severity": "high",
      "title": "Set the UEFI Boot Loader Password",
      "warning": "Password protection on the boot loader configuration ensures users with physical access cannot trivially alter important bootloader settings. These include which kernel to use, and whether to enter single-user mode."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Crypto Policies are means of enforcing certain cryptographic settings for selected applications including OpenSSL. OpenSSL is by default configured to modify its configuration based on currently configured Crypto Policy. However, in certain cases it might be needed to override the Crypto Policy specific to OpenSSL and leave rest of the Crypto Policy intact. This can be done by dropping a file named opensslcnf-xxx.config , replacing xxx with arbitrary identifier, into /etc/crypto-policies/local.d. This has to be followed by running update-crypto-policies so that changes are applied. Changes are propagated into /etc/crypto-policies/back-ends/opensslcnf.config. This rule checks if this file contains predefined Ciphersuites variable configured with predefined value.",
      "id": "xccdf_org.ssgproject.content_rule_harden_openssl_crypto_policy",
      "instructions": "To verify if the OpenSSL uses defined Crypto Policy, run:\n$ grep 'Ciphersuites' /etc/crypto-policies/back-ends/opensslcnf.config | tail -n 1\nand verify that the line matches\nCiphersuites = TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "harden-openssl-crypto-policy",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-8(1);SC-13",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-8(1),SC-13",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-harden-openssl-crypto-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "76612",
        "uid": "da150109-9cab-448f-9bd4-f1ebce08b5ec"
      },
      "rationale": "The Common Criteria requirements specify that certain parameters for OpenSSL are configured e.g. cipher suites. Currently particular requirements specified by CC are stricter compared to any existing Crypto Policy.",
      "severity": "medium",
      "title": "Harden OpenSSL Crypto Policy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Crypto Policies are means of enforcing certain cryptographic settings for selected applications including OpenSSH client. To override the system wide crypto policy for Openssh client, place a file in the /etc/ssh/ssh_config.d/ so that it is loaded before the 05-redhat.conf. In this case it is file named 02-ospp.conf containing parameters which need to be changed with respect to the crypto policy. This rule checks if the file exists and if it contains required parameters and values which modify the Crypto Policy. During the parsing process, as soon as Openssh client parses some configuration option and its value, it remembers it and ignores any subsequent overrides. The customization mechanism provided by crypto policies appends eventual customizations at the end of the system wide crypto policy. Therefore, if the crypto policy customization overrides some parameter which is already configured in the system wide crypto policy, the SSH client will not honor that customized parameter.",
      "id": "xccdf_org.ssgproject.content_rule_harden_ssh_client_crypto_policy",
      "instructions": "To verify if the OpenSSH Client uses defined Crypto Policy, run:\n$ cat /etc/ssh/ssh_config.d/02-ospp.conf\nand verify that the line matches\nMatch final all\nRekeyLimit 512M 1h\nGSSAPIAuthentication no\nCiphers aes256-ctr,aes256-cbc,aes128-ctr,aes128-cbc\nPubkeyAcceptedKeyTypes ssh-rsa,ecdsa-sha2-nistp384,ecdsa-sha2-nistp256\nMACs hmac-sha2-512,hmac-sha2-256\nKexAlgorithms ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group14-sha1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "harden-ssh-client-crypto-policy",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1;CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);AC-17(2);CM-6(a);MA-4(6);SC-13",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CIP-007-3 R7.1,AC-17(a),AC-17(2),CM-6(a),MA-4(6),SC-13",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-harden-ssh-client-crypto-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "76621",
        "uid": "a3abbf0c-a6fd-45d2-a9af-f69c6e99479b"
      },
      "rationale": "The Common Criteria requirements specify how certain parameters for OpenSSH Client are configured. Particular parameters are RekeyLimit, GSSAPIAuthentication, Ciphers, PubkeyAcceptedKeyTypes, MACs and KexAlgorithms. Currently particular requirements specified by CC are stricter compared to any existing Crypto Policy.",
      "severity": "medium",
      "title": "Harden SSH client Crypto Policy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Crypto Policies are means of enforcing certain cryptographic settings for selected applications including OpenSSH server. The SSHD service is by default configured to modify its configuration based on currently configured Crypto-Policy. However, in certain cases it might be needed to override the Crypto Policy specific to OpenSSH Server and leave rest of the Crypto Policy intact. This can be done by dropping a file named opensshserver-xxx.config , replacing xxx with arbitrary identifier, into /etc/crypto-policies/local.d. This has to be followed by running update-crypto-policies so that changes are applied. Changes are propagated into /etc/crypto-policies/back-ends/opensshserver.config. This rule checks if this file contains predefined CRYPTO_POLICY environment variable configured with predefined value.",
      "id": "xccdf_org.ssgproject.content_rule_harden_sshd_crypto_policy",
      "instructions": "To verify if the OpenSSH server uses defined Crypto Policy, run:\n$ grep 'CRYPTO_POLICY' /etc/crypto-policies/back-ends/opensshserver.config | tail -n 1\nand verify that the line matches\nCRYPTO_POLICY='-oCiphers=aes256-ctr,aes128-ctr,aes256-cbc,aes128-cbc -oMACs=hmac-sha2-512,hmac-sha2-256 -oGSSAPIKeyExchange=no -oKexAlgorithms=ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group14-sha1 -oHostKeyAlgorithms=ssh-rsa,ecdsa-sha2-nistp384,ecdsa-sha2-nistp256 -oPubkeyAcceptedKeyTypes=rsa-sha2-512,rsa-sha2-256,ssh-rsa,ecdsa-sha2-nistp384,ecdsa-sha2-nistp256'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "harden-sshd-crypto-policy",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1;CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);AC-17(2);CM-6(a);MA-4(6);SC-13;SC-12(2);SC-12(3)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CIP-007-3 R7.1,AC-17(a),AC-17(2),CM-6(a),MA-4(6),SC-13,SC-12(2),SC-12(3)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-harden-sshd-crypto-policy",
        "namespace": "openshift-compliance",
        "resourceVersion": "76611",
        "uid": "61286d38-09e5-4f9a-82dd-e721e8803a27"
      },
      "rationale": "The Common Criteria requirements specify that certain parameters for OpenSSH Server are configured e.g. supported ciphers, accepted host key algorithms, public key types, key exchange algorithms, HMACs and GSSAPI key exchange is disabled. Currently particular requirements specified by CC are stricter compared to any existing Crypto Policy.",
      "severity": "medium",
      "title": "Harden SSHD Crypto Policy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable processing of sensitive information the operating system must provide certified cryptographic modules compliant with FIPS 140-2 standard.",
      "id": "xccdf_org.ssgproject.content_rule_installed_OS_is_FIPS_certified",
      "instructions": "To verify that the installed operating system is supported or certified, run\nthe following command:\n\nThe output should contain something similar to:\nRed Hat Enterprise Linux CoreOS 4",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "installed-os-is-fips-certified",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-12(2);SC-12(3);IA-7;SC-13;CM-6(a);SC-12",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-12(2),SC-12(3),IA-7,SC-13,CM-6(a),SC-12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-installed-os-is-fips-certified",
        "namespace": "openshift-compliance",
        "resourceVersion": "76614",
        "uid": "1dbc6c4c-ed6e-4b28-9791-e242fbf29192"
      },
      "rationale": "The Federal Information Processing Standard (FIPS) Publication 140-2, (FIPS PUB 140-2) is a computer security standard. The standard specifies security requirements for cryptographic modules used to protect sensitive unclassified information. Refer to the full FIPS 140-2 standard at http://csrc.nist.gov/publications/fips/fips140-2/fips1402.pdf for further details on the requirements. FIPS 140-2 validation is required by U.S. law when information systems use cryptography to protect sensitive government information. In order to achieve FIPS 140-2 certification, cryptographic modules are subject to extensive testing by independent laboratories, accredited by National Institute of Standards and Technology (NIST).",
      "severity": "high",
      "title": "The Installed Operating System Is FIPS 140-2 Certified",
      "warning": "The Federal Information Processing Standard (FIPS) Publication 140-2, (FIPS PUB 140-2) is a computer security standard. The standard specifies security requirements for cryptographic modules used to protect sensitive unclassified information. Refer to the full FIPS 140-2 standard at http://csrc.nist.gov/publications/fips/fips140-2/fips1402.pdf for further details on the requirements. FIPS 140-2 validation is required by U.S. law when information systems use cryptography to protect sensitive government information. In order to achieve FIPS 140-2 certification, cryptographic modules are subject to extensive testing by independent laboratories, accredited by National Institute of Standards and Technology (NIST)."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "By default, inbound connections to SSH's port are allowed. If the SSH server is not being used, this exception should be removed from the firewall configuration.\n\nEdit the files /etc/sysconfig/iptables and /etc/sysconfig/ip6tables (if IPv6 is in use). In each file, locate and delete the line:\n\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT\n\nThis is unusual, as SSH is a common method for encrypted and authenticated remote access.",
      "id": "xccdf_org.ssgproject.content_rule_iptables_sshd_disabled",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "iptables-sshd-disabled"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-iptables-sshd-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78515",
        "uid": "73e7aed3-6353-4591-b85e-2e07ccde0b87"
      },
      "rationale": "If inbound SSH connections are not expected, disallowing access to the SSH port will avoid possible exploitation of the port by an attacker.",
      "severity": "unknown",
      "title": "Remove SSH Server iptables Firewall exception (Unusual)"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Kerberos is not an approved key distribution method for Common Criteria. To prevent using Kerberos by system daemons, remove the Kerberos keytab files, especially /etc/krb5.keytab.",
      "id": "xccdf_org.ssgproject.content_rule_kerberos_disable_no_keytab",
      "instructions": "Run the following command to see if there are some keytabs\nthat would potentially allow the use of Kerberos by system daemons.\n$ ls -la /etc/*.keytab\nThe expected result is\nls: cannot access '/etc/*.keytab': No such file or directory",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "kerberos-disable-no-keytab"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kerberos-disable-no-keytab",
        "namespace": "openshift-compliance",
        "resourceVersion": "78446",
        "uid": "23e28e06-b9b3-4f55-a4cc-de6d1baaeeaa"
      },
      "rationale": "The key derivation function (KDF) in Kerberos is not FIPS compatible.",
      "severity": "medium",
      "title": "Disable Kerberos by removing host keytab"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "This debug facility allows ACPI AML methods to be inserted and/or replaced without rebooting the system. This configuration is available from kernel 3.0. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_ACPI_CUSTOM_METHOD , run the following command: grep CONFIG_ACPI_CUSTOM_METHOD /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_acpi_custom_method",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_ACPI_CUSTOM_METHOD /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-acpi-custom-method"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-acpi-custom-method",
        "namespace": "openshift-compliance",
        "resourceVersion": "77861",
        "uid": "5b2fcbdb-0c8e-496a-875a-82bc7ba5edce"
      },
      "rationale": "Enabling this feature allows arbitrary kernel memory to be written to by root (uid=0) users, allowing them to bypass certain security measures",
      "severity": "low",
      "title": "Do not allow ACPI methods to be inserted/replaced at run time",
      "warning": "Enabling this feature allows arbitrary kernel memory to be written to by root (uid=0) users, allowing them to bypass certain security measures"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Enabling CONFIG_BINFMT_MISC makes it possible to plug wrapper-driven binary formats into the kernel. This is specially useful for programs that need an interpreter to run like Java, Python and DOS emulators. Once you have registered such a binary class with the kernel, you can start one of those programs simply by typing in its name at a shell prompt. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_BINFMT_MISC , run the following command: grep CONFIG_BINFMT_MISC /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_binfmt_misc",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_BINFMT_MISC /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-binfmt-misc"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-binfmt-misc",
        "namespace": "openshift-compliance",
        "resourceVersion": "77862",
        "uid": "0140ef60-4cc4-4d98-93e8-412fb2ebf6f8"
      },
      "rationale": "This disables arbitrary binary format support and helps reduce attack surface.",
      "severity": "medium",
      "title": "Disable kernel support for MISC binaries",
      "warning": "This disables arbitrary binary format support and helps reduce attack surface."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Disabling this option eliminates support for BUG and WARN, reducing the size of your kernel image and potentially quietly ignoring numerous fatal conditions. You should only consider disabling this option for embedded systems with no facilities for reporting errors. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_BUG , run the following command: grep CONFIG_BUG /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_bug",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_BUG /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-bug"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-bug",
        "namespace": "openshift-compliance",
        "resourceVersion": "77864",
        "uid": "7552061b-1a32-4903-adca-6f516867ae86"
      },
      "rationale": "Not setting this variable may hide a number of critical errors.",
      "severity": "medium",
      "title": "Enable support for BUG()",
      "warning": "Not setting this variable may hide a number of critical errors."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Enabling compatiliby with brk() allows legacy binaries to run (i.e. those linked against libc5). But this compatibility comes at the cost of not being able to randomize the heap placement (ASLR). Unless legacy binaries need to run on the system, set CONFIG_COMPAT_BRK to \"n\". The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_COMPAT_BRK , run the following command: grep CONFIG_COMPAT_BRK /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_compat_brk",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_COMPAT_BRK /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-compat-brk"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-compat-brk",
        "namespace": "openshift-compliance",
        "resourceVersion": "77869",
        "uid": "d18c8312-27db-4cfb-a25b-aea918c018e4"
      },
      "rationale": "Enabling compatibility with brk() disables support for ASLR.",
      "severity": "medium",
      "title": "Disable compatibility with brk()",
      "warning": "Enabling compatibility with brk() disables support for ASLR."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Certain buggy versions of glibc (2.3.3) will crash if they are presented with a 32-bit vDSO that is not mapped at the address indicated in its segment table. Setting CONFIG_COMPAT_VDSO to y turns off the 32-bit VDSO and works aroud the glibc bug. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_COMPAT_VDSO , run the following command: grep CONFIG_COMPAT_VDSO /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_compat_vdso",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_COMPAT_VDSO /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-compat-vdso"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-compat-vdso",
        "namespace": "openshift-compliance",
        "resourceVersion": "77872",
        "uid": "27123818-bc51-4264-8290-a19e25b9c3d1"
      },
      "rationale": "Enabling VDSO compatibility hurts performance and disables ASLR.",
      "severity": "low",
      "title": "Disable the 32-bit vDSO",
      "warning": "Enabling VDSO compatibility hurts performance and disables ASLR."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Enable this to turn on some debug checking for credential management. The additional code keeps track of the number of pointers from task_structs to any given cred struct, and checks to see that this number never exceeds the usage count of the cred struct. Furthermore, if SELinux is enabled, this also checks that the security pointer in the cred struct is never seen to be invalid. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_DEBUG_CREDENTIALS , run the following command: grep CONFIG_DEBUG_CREDENTIALS /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_debug_credentials",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_DEBUG_CREDENTIALS /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-debug-credentials"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-debug-credentials",
        "namespace": "openshift-compliance",
        "resourceVersion": "77875",
        "uid": "ef79d9b3-1254-4d8e-b17d-b5e43c4f00db"
      },
      "rationale": "This adds sanity checks and validations to credential data structures.",
      "severity": "low",
      "title": "Enable checks on credential management",
      "warning": "This adds sanity checks and validations to credential data structures."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "debugfs is a virtual file system that kernel developers use to put debugging files into. Enable this option to be able to read and write to these files. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_DEBUG_FS , run the following command: grep CONFIG_DEBUG_FS /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_debug_fs",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_DEBUG_FS /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-debug-fs"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-debug-fs",
        "namespace": "openshift-compliance",
        "resourceVersion": "77876",
        "uid": "44a4ebf0-8286-4f99-84ce-ae784d92a466"
      },
      "rationale": "To reduce the attack surface, this file system should be disabled if not in use.",
      "severity": "low",
      "title": "Disable kernel debugfs",
      "warning": "To reduce the attack surface, this file system should be disabled if not in use."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Enable this to turn on extended checks in the linked-list walking routines. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_DEBUG_LIST , run the following command: grep CONFIG_DEBUG_LIST /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_debug_list",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_DEBUG_LIST /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-debug-list"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-debug-list",
        "namespace": "openshift-compliance",
        "resourceVersion": "77881",
        "uid": "249445e9-dcd0-457e-a6f3-29b778c6b182"
      },
      "rationale": "This add sanity checks to manipulation of linked lists structures in the kernel and may prevent exploits such as CVE-2017-1661, where a race condition and simultaneos operations caused a list to corrupt.",
      "severity": "low",
      "title": "Enable checks on linked list manipulation",
      "warning": "This add sanity checks to manipulation of linked lists structures in the kernel and may prevent exploits such as CVE-2017-1661, where a race condition and simultaneos operations caused a list to corrupt."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Enable this to turn on sanity checking for notifier call chains. This is most useful for kernel developers to make sure that modules properly unregister themselves from notifier chains. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_DEBUG_NOTIFIERS , run the following command: grep CONFIG_DEBUG_NOTIFIERS /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_debug_notifiers",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_DEBUG_NOTIFIERS /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-debug-notifiers"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-debug-notifiers",
        "namespace": "openshift-compliance",
        "resourceVersion": "77884",
        "uid": "380a3c10-df97-4b80-8586-30fcd9910b0c"
      },
      "rationale": "This provides validation of notifier chains, it checks whether the notifiers are from the kernel or a module that is still loaded prior to being invoked.",
      "severity": "low",
      "title": "Enable checks on notifier call chains",
      "warning": "This provides validation of notifier chains, it checks whether the notifiers are from the kernel or a module that is still loaded prior to being invoked."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Scatter-gather tables are mechanism used for high performance I/O on DMA devices. Enable this to turn on checks on scatter-gather tables. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_DEBUG_SG , run the following command: grep CONFIG_DEBUG_SG /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_debug_sg",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_DEBUG_SG /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-debug-sg"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-debug-sg",
        "namespace": "openshift-compliance",
        "resourceVersion": "77886",
        "uid": "a309cf28-3e6d-497b-bf62-7b85c46b5990"
      },
      "rationale": "This can help find problems with drivers that do not properly initialize their SG tables.",
      "severity": "low",
      "title": "Enable checks on scatter-gather (SG) table operations",
      "warning": "This can help find problems with drivers that do not properly initialize their SG tables."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "This is the portion of low virtual memory which should be protected from userspace allocation. This configuration is available from kernel 3.14, but may be available if backported by distros. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_DEFAULT_MMAP_MIN_ADDR , run the following command: grep CONFIG_DEFAULT_MMAP_MIN_ADDR /boot/config-* For each kernel installed, a line with value should be returned. If the system architecture is x86_64, the value should be 65536. If the system architecture is aarch64, the value should be 32768.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_default_mmap_min_addr",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n$ grep CONFIG_DEFAULT_MMAP_MIN_ADDR /boot/config.*\nFor each kernel installed, a line with value should be returned.\nIf the system architecture is x86_64, the value should be 65536.\nIf the system architecture is aarch64, the value should be 32768.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-default-mmap-min-addr"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-default-mmap-min-addr",
        "namespace": "openshift-compliance",
        "resourceVersion": "77890",
        "uid": "ee2b4ff7-be54-448c-89a6-922f75554f16"
      },
      "rationale": "Keeping a user from writing to low pages can help reduce the impact of kernel NULL pointer bugs.",
      "severity": "medium",
      "title": "Configure Low Address Space To Protect From User Allocation",
      "warning": "Keeping a user from writing to low pages can help reduce the impact of kernel NULL pointer bugs."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Disable support for the /dev/kmem device. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_DEVKMEM , run the following command: grep CONFIG_DEVKMEM /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_devkmem",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_DEVKMEM /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-devkmem"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-devkmem",
        "namespace": "openshift-compliance",
        "resourceVersion": "77891",
        "uid": "693d4fb4-0add-4776-a646-343dcdb00867"
      },
      "rationale": "The /dev/kmem device is rarely used, but can be used for certain kind of kernel debugging operations.",
      "severity": "low",
      "title": "Disable /dev/kmem virtual device support",
      "warning": "The /dev/kmem device is rarely used, but can be used for certain kind of kernel debugging operations."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Enable the suspend to disk (STD) functionality, which is usually called \"hibernation\" in user interfaces. STD checkpoints the system and powers it off; and restores that checkpoint on reboot. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_HIBERNATION , run the following command: grep CONFIG_HIBERNATION /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_hibernation",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_HIBERNATION /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-hibernation"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-hibernation",
        "namespace": "openshift-compliance",
        "resourceVersion": "77894",
        "uid": "d88723d2-fbeb-415e-aa1c-92726259bf20"
      },
      "rationale": "Suspending to disk allows one to replace the running kernel.",
      "severity": "medium",
      "title": "Disable hibernation",
      "warning": "Suspending to disk allows one to replace the running kernel."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Disables support for legacy 32-bit programs under a 64-bit kernel. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_IA32_EMULATION , run the following command: grep CONFIG_IA32_EMULATION /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_ia32_emulation",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_IA32_EMULATION /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-ia32-emulation"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-ia32-emulation",
        "namespace": "openshift-compliance",
        "resourceVersion": "77896",
        "uid": "952056c7-c029-4ecc-801c-0281f9263e97"
      },
      "rationale": "Disabling 32-bit backwards compatibility helps reduce the attack surface.",
      "severity": "medium",
      "title": "Disable IA32 emulation",
      "warning": "Disabling 32-bit backwards compatibility helps reduce the attack surface."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Disable support for IP version 6 (IPv6). The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_IPV6 , run the following command: grep CONFIG_IPV6 /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_ipv6",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_IPV6 /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "kernel-config-ipv6"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-ipv6",
        "namespace": "openshift-compliance",
        "resourceVersion": "77899",
        "uid": "b3137678-e8a2-4bff-820a-ce2d3f7aca5a"
      },
      "rationale": "Any unnecessary network stacks, including IPv6, should be disabled to reduce the vulnerability to exploitation.",
      "severity": "medium",
      "title": "Disable the IPv6 protocol",
      "warning": "Any unnecessary network stacks, including IPv6, should be disabled to reduce the vulnerability to exploitation."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "kexec is a system call that implements the ability to shutdown your current kernel, and to start another kernel. It is like a reboot but it is independent of the system firmware. And like a reboot you can start any kernel with it, not just Linux. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_KEXEC , run the following command: grep CONFIG_KEXEC /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_kexec",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_KEXEC /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-kexec"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-kexec",
        "namespace": "openshift-compliance",
        "resourceVersion": "77902",
        "uid": "f483d8a3-a1fb-401a-b001-25f21f47baf2"
      },
      "rationale": "Prohibits the execution of a new kernel image after reboot.",
      "severity": "low",
      "title": "Disable kexec system call",
      "warning": "Prohibits the execution of a new kernel image after reboot."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Disable the Linux traditional BSD-like terminal names /dev/ptyxx for masters and /dev/ttyxx for slaves of pseudo terminals, and use only the modern ptys (devpts) interface. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_LEGACY_PTYS , run the following command: grep CONFIG_LEGACY_PTYS /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_legacy_ptys",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_LEGACY_PTYS /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-legacy-ptys"
        },
        "creationTimestamp": "2024-03-05T15:02:51Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-legacy-ptys",
        "namespace": "openshift-compliance",
        "resourceVersion": "77905",
        "uid": "41ec75ac-d04f-4b35-92f4-07182415160c"
      },
      "rationale": "The legacy scheme has a number of security problems.",
      "severity": "medium",
      "title": "Disable legacy (BSD) PTY support",
      "warning": "The legacy scheme has a number of security problems."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Check modules for valid signatures upon load. Note that this option adds the OpenSSL development packages as a kernel build dependency so that the signing tool can use its crypto library. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_MODULE_SIG , run the following command: grep CONFIG_MODULE_SIG /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_module_sig",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_MODULE_SIG /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-module-sig"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-module-sig",
        "namespace": "openshift-compliance",
        "resourceVersion": "77907",
        "uid": "21857cd6-ffda-497a-b640-f4c1e10f01fe"
      },
      "rationale": "Loaded modules must be signed.",
      "severity": "medium",
      "title": "Enable module signature verification",
      "warning": "Loaded modules must be signed."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Sign all modules during make modules_install. Without this option, modules must be signed manually, using the scripts/sign-file tool. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_MODULE_SIG_ALL , run the following command: grep CONFIG_MODULE_SIG_ALL /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_module_sig_all",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_MODULE_SIG_ALL /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-module-sig-all"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-module-sig-all",
        "namespace": "openshift-compliance",
        "resourceVersion": "77910",
        "uid": "0cebc844-f9e7-4d3a-9637-4098bd0a6edf"
      },
      "rationale": "This ensures the modules are signed during install process.",
      "severity": "medium",
      "title": "Enable automatic signing of all modules",
      "warning": "This ensures the modules are signed during install process."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Reject unsigned modules or signed modules with an unknown key. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_MODULE_SIG_FORCE , run the following command: grep CONFIG_MODULE_SIG_FORCE /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_module_sig_force",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_MODULE_SIG_FORCE /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-module-sig-force"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-module-sig-force",
        "namespace": "openshift-compliance",
        "resourceVersion": "77913",
        "uid": "b669b754-4d60-4f72-a521-e402922638fc"
      },
      "rationale": "Prevent loading modules that are unsigned or signed with an unknown key.",
      "severity": "medium",
      "title": "Require modules to be validly signed",
      "warning": "Prevent loading modules that are unsigned or signed with an unknown key."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "This configures the kernel to build and sign modules using sha512 as the hash function. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_MODULE_SIG_HASH , run the following command: grep CONFIG_MODULE_SIG_HASH /boot/config-* For each kernel installed, a line with value \" sha512 \" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_module_sig_hash",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_MODULE_SIG_HASH /boot/config.*\n    \n    For each kernel installed, a line with value \"\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-module-sig-hash",
          "compliance.openshift.io/rule-variable": "var-kernel-config-module-sig-hash,var-kernel-config-module-sig-hash"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-module-sig-hash",
        "namespace": "openshift-compliance",
        "resourceVersion": "77916",
        "uid": "5712e4f0-0718-4e41-9f6e-c704ac33d8fe"
      },
      "rationale": "Use of strong hash function is important to secure the module against counterfeit signatures.",
      "severity": "medium",
      "title": "Specify the hash to use when signing modules",
      "warning": "Use of strong hash function is important to secure the module against counterfeit signatures."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Setting this option to something other than its default of certs/signing_key.pem will disable the autogeneration of signing keys and allow the kernel modules to be signed with a key of your choosing. The string provided should identify a file containing both a private key and its corresponding X.509 certificate in PEM form, or — on systems where the OpenSSL ENGINE_pkcs11 is functional — a PKCS#11 URI as defined by RFC7512. In the latter case, the PKCS#11 URI should reference both a certificate and a private key. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_MODULE_SIG_KEY , run the following command: grep CONFIG_MODULE_SIG_KEY /boot/config-* For each kernel installed, a line with value \" certs/signing_key.pem \" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_module_sig_key",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_MODULE_SIG_KEY /boot/config.*\n    \n    For each kernel installed, a line with value \"\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-module-sig-key",
          "compliance.openshift.io/rule-variable": "var-kernel-config-module-sig-key"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-module-sig-key",
        "namespace": "openshift-compliance",
        "resourceVersion": "77917",
        "uid": "de87b8b3-c7a7-4b53-bb9b-1f049df1e4cc"
      },
      "rationale": "A key and certificate is required to sign the built modules.",
      "severity": "medium",
      "title": "Specify module signing key to use",
      "warning": "A key and certificate is required to sign the built modules."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "This configures the kernel to build and sign modules using SHA512 as the hash function. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_MODULE_SIG_SHA512 , run the following command: grep CONFIG_MODULE_SIG_SHA512 /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_module_sig_sha512",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_MODULE_SIG_SHA512 /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-module-sig-sha512"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-module-sig-sha512",
        "namespace": "openshift-compliance",
        "resourceVersion": "77919",
        "uid": "665c0cda-3038-4d3c-afa0-6af06f2208dc"
      },
      "rationale": "Use of strong hash function is important to secure the module against counterfeit signatures.",
      "severity": "medium",
      "title": "Sign kernel modules with SHA-512",
      "warning": "Use of strong hash function is important to secure the module against counterfeit signatures."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Skip the sanity checking on alloc, only fill the pages with poison on free. This reduces some of the overhead of the poisoning feature. This configuration is available from kernel 4.6. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_PAGE_POISONING_NO_SANITY , run the following command: grep CONFIG_PAGE_POISONING_NO_SANITY /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_page_poisoning_no_sanity",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_PAGE_POISONING_NO_SANITY /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-page-poisoning-no-sanity"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-page-poisoning-no-sanity",
        "namespace": "openshift-compliance",
        "resourceVersion": "77921",
        "uid": "9f48ed7a-f412-4a24-acfa-b6aebf61d8bc"
      },
      "rationale": "This configuration helps alleviates the performance impact of poisonining.",
      "severity": "medium",
      "title": "Enable poison without sanity check",
      "warning": "This configuration helps alleviates the performance impact of poisonining."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Instead of using the existing poison value, fill the pages with zeros. This makes it harder to detect when errors are occurring due to sanitization but the zeroing at free means that it is no longer necessary to write zeros when GFP_ZERO is used on allocation. This configuration is available from kernel 4.19. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_PAGE_POISONING_ZERO , run the following command: grep CONFIG_PAGE_POISONING_ZERO /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_page_poisoning_zero",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_PAGE_POISONING_ZERO /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-page-poisoning-zero"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-page-poisoning-zero",
        "namespace": "openshift-compliance",
        "resourceVersion": "77928",
        "uid": "31282dbd-da4b-4d48-b09b-444f473d45c5"
      },
      "rationale": "This configuration helps alleviates the performance impact of poisonining.",
      "severity": "medium",
      "title": "Use zero for poisoning instead of debugging value",
      "warning": "This configuration helps alleviates the performance impact of poisonining."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "This feature reduces the number of hardware side channels by ensuring that the majority of kernel addresses are not mapped into userspace. This configuration is available from kernel 4.15, but may be available if backported by distros. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_PAGE_TABLE_ISOLATION , run the following command: grep CONFIG_PAGE_TABLE_ISOLATION /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_page_table_isolation",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_PAGE_TABLE_ISOLATION /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-page-table-isolation"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-page-table-isolation",
        "namespace": "openshift-compliance",
        "resourceVersion": "77929",
        "uid": "df362eea-1b30-458b-983b-76e351587204"
      },
      "rationale": "This is a countermeasure to the Meltdown attack.",
      "severity": "high",
      "title": "Remove the kernel mapping in user mode",
      "warning": "This is a countermeasure to the Meltdown attack."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Enable the kernel to panic when it oopses. This has the same effect as setting oops=panic on the kernel command line. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_PANIC_ON_OOPS , run the following command: grep CONFIG_PANIC_ON_OOPS /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_panic_on_oops",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_PANIC_ON_OOPS /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-panic-on-oops"
        },
        "creationTimestamp": "2024-03-05T15:02:52Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-panic-on-oops",
        "namespace": "openshift-compliance",
        "resourceVersion": "77930",
        "uid": "c977cf6c-554e-404c-a5ab-96a0a79464cf"
      },
      "rationale": "This feature ensures that the kernel does not do anything erroneous after an oops which could result in data corruption or other issues.",
      "severity": "medium",
      "title": "Kernel panic oops",
      "warning": "This feature ensures that the kernel does not do anything erroneous after an oops which could result in data corruption or other issues."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Set the timeout value (in seconds) until a reboot occurs when the kernel panics. A timeout of 0 configures the system to wait forever. With a timeout value greater than 0, the system will wait the specified amount of seconds before rebooting. While a timeout value less than 0 makes the system reboot immediately. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_PANIC_TIMEOUT , run the following command: grep CONFIG_PANIC_TIMEOUT /boot/config-* For each kernel installed, a line with value \" 0 \" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_panic_timeout",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_PANIC_TIMEOUT /boot/config.*\n    \n    For each kernel installed, a line with value \"\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-panic-timeout",
          "compliance.openshift.io/rule-variable": "var-kernel-config-panic-timeout"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-panic-timeout",
        "namespace": "openshift-compliance",
        "resourceVersion": "77931",
        "uid": "40914e28-6476-4987-9338-2219a6f71096"
      },
      "rationale": "This is required to enable protection against Spectre v2.",
      "severity": "medium",
      "title": "Kernel panic timeout",
      "warning": "This is required to enable protection against Spectre v2."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Provides a virtual ELF core file of the live kernel. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_PROC_KCORE , run the following command: grep CONFIG_PROC_KCORE /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_proc_kcore",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_PROC_KCORE /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-proc-kcore"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-proc-kcore",
        "namespace": "openshift-compliance",
        "resourceVersion": "77943",
        "uid": "99cdc6bc-4620-4526-9a72-616d9018c9fa"
      },
      "rationale": "This feature exposes the memory to the userspace and can assist an attacker in discovering attack vectors.",
      "severity": "low",
      "title": "Disable support for /proc/kkcore",
      "warning": "This feature exposes the memory to the userspace and can assist an attacker in discovering attack vectors."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "In support of Kernel Address Space Layout Randomization (KASLR), this randomizes the physical address at which the kernel image is decompressed and the virtual address where the kernel image is mapped. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_RANDOMIZE_BASE , run the following command: grep CONFIG_RANDOMIZE_BASE /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_randomize_base",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_RANDOMIZE_BASE /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-randomize-base"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-randomize-base",
        "namespace": "openshift-compliance",
        "resourceVersion": "77947",
        "uid": "61b4b7f7-e3ad-418b-9ce6-5671fadb9b11"
      },
      "rationale": "An unpredictable kernel address makes it more difficult to succeed with exploits that rely on knowledge of the location of kernel code internals.",
      "severity": "medium",
      "title": "Randomize the address of the kernel image (KASLR)",
      "warning": "An unpredictable kernel address makes it more difficult to succeed with exploits that rely on knowledge of the location of kernel code internals."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Randomizes the base virtual address of kernel memory sections (physical memory mapping, vmalloc & vmemmap). This configuration is available from kernel 4.8, but may be available if backported by distros. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_RANDOMIZE_MEMORY , run the following command: grep CONFIG_RANDOMIZE_MEMORY /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_randomize_memory",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_RANDOMIZE_MEMORY /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-randomize-memory"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-randomize-memory",
        "namespace": "openshift-compliance",
        "resourceVersion": "77942",
        "uid": "b7c884b4-056d-4371-95e9-ed34a8ac372b"
      },
      "rationale": "This security feature makes exploits relying on predictable memory locations less reliable.",
      "severity": "medium",
      "title": "Randomize the kernel memory sections",
      "warning": "This security feature makes exploits relying on predictable memory locations less reliable."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Compile kernel with the retpoline compiler options to guard against kernel-to-user data leaks by avoiding speculative indirect branches. Requires a compiler with -mindirect-branch=thunk-extern support for full protection. The kernel may run slower. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_RETPOLINE , run the following command: grep CONFIG_RETPOLINE /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_retpoline",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_RETPOLINE /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-retpoline"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-retpoline",
        "namespace": "openshift-compliance",
        "resourceVersion": "77940",
        "uid": "57815131-d7c2-46b9-8482-3e42d42d771d"
      },
      "rationale": "This is required to enable protection against Spectre v2.",
      "severity": "medium",
      "title": "Avoid speculative indirect branches in kernel",
      "warning": "This is required to enable protection against Spectre v2."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "This kernel feature is useful for number crunching applications that may need to compute untrusted bytecode during their execution. By using pipes or other transports made available to the process as file descriptors supporting the read/write syscalls, it's possible to isolate those applications in their own address space using seccomp. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_SECCOMP , run the following command: grep CONFIG_SECCOMP /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_seccomp",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_SECCOMP /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-seccomp"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-seccomp",
        "namespace": "openshift-compliance",
        "resourceVersion": "77945",
        "uid": "39f62d22-a78f-411b-b477-7f153d61a20c"
      },
      "rationale": "seccomp enables the ability to filter system calls made by an application, effectively isolating the system's resources from it.",
      "severity": "medium",
      "title": "Enable seccomp to safely compute untrusted bytecode",
      "warning": "seccomp enables the ability to filter system calls made by an application, effectively isolating the system's resources from it."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Enable tasks to build secure computing environments defined in terms of Berkeley Packet Filter programs which implement task-defined system call filtering polices. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_SECCOMP_FILTER , run the following command: grep CONFIG_SECCOMP_FILTER /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_seccomp_filter",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_SECCOMP_FILTER /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-seccomp-filter"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-seccomp-filter",
        "namespace": "openshift-compliance",
        "resourceVersion": "77952",
        "uid": "429cf028-e735-43d4-8b8e-c9d91931d602"
      },
      "rationale": "Use of BPF filters allows for expressive filtering of system calls using a filter program language with a long history of being exposed to userland.",
      "severity": "medium",
      "title": "Enable use of Berkeley Packet Filter with seccomp",
      "warning": "Use of BPF filters allows for expressive filtering of system calls using a filter program language with a long history of being exposed to userland."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "This allows you to choose different security modules to be configured into your kernel. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_SECURITY , run the following command: grep CONFIG_SECURITY /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_security",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_SECURITY /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-security"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-security",
        "namespace": "openshift-compliance",
        "resourceVersion": "77950",
        "uid": "c7830e00-038d-4d09-a3ab-01576ab9c403"
      },
      "rationale": "This is enables kernel security primitives required by the LSM framework.",
      "severity": "medium",
      "title": "Enable different security models",
      "warning": "This is enables kernel security primitives required by the LSM framework."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Enforce restrictions on unprivileged users reading the kernel syslog via dmesg(8). The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_SECURITY_DMESG_RESTRICT , run the following command: grep CONFIG_SECURITY_DMESG_RESTRICT /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_security_dmesg_restrict",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_SECURITY_DMESG_RESTRICT /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-security-dmesg-restrict"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-security-dmesg-restrict",
        "namespace": "openshift-compliance",
        "resourceVersion": "77960",
        "uid": "36709b60-15d2-40c5-85ce-74a296d88fab"
      },
      "rationale": "Prevents unprivileged users from retrieving kernel addresses with dmesg.",
      "severity": "medium",
      "title": "Restrict unprivileged access to the kernel syslog",
      "warning": "Prevents unprivileged users from retrieving kernel addresses with dmesg."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure kernel structures associated with LSMs are always mapped as read-only after system boot. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_SECURITY_WRITABLE_HOOKS , run the following command: grep CONFIG_SECURITY_WRITABLE_HOOKS /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_security_writable_hooks",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_SECURITY_WRITABLE_HOOKS /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-security-writable-hooks"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-security-writable-hooks",
        "namespace": "openshift-compliance",
        "resourceVersion": "77962",
        "uid": "e39d8d54-3080-4d18-a6f4-dfa5313c4efd"
      },
      "rationale": "If CONFIG_SECURITY_WRITABLE_HOOKS is enabled, then hooks can be loaded at runtime and being able to manipulate hooks is a way to bypass all LSMs.",
      "severity": "medium",
      "title": "Disable mutable hooks",
      "warning": "If CONFIG_SECURITY_WRITABLE_HOOKS is enabled, then hooks can be loaded at runtime and being able to manipulate hooks is a way to bypass all LSMs."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "This enables support for LSM module Yama, which extends DAC support with additional system-wide security settings beyond regular Linux discretionary access controls. The module will limit the use of the system call ptrace(). The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_SECURITY_YAMA , run the following command: grep CONFIG_SECURITY_YAMA /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_security_yama",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_SECURITY_YAMA /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-security-yama"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-security-yama",
        "namespace": "openshift-compliance",
        "resourceVersion": "77957",
        "uid": "3bfc657a-e67d-48c9-84cc-b5e9f9f399f9"
      },
      "rationale": "Unrestricted usage of ptrace allows compromised binaries to run ptrace on another processes of the user.",
      "severity": "medium",
      "title": "Enable Yama support",
      "warning": "Unrestricted usage of ptrace allows compromised binaries to run ptrace on another processes of the user."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SLUB has extensive debug support features and this allows the allocator validation checking to be enabled. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_SLUB_DEBUG , run the following command: grep CONFIG_SLUB_DEBUG /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_slub_debug",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_SLUB_DEBUG /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-slub-debug"
        },
        "creationTimestamp": "2024-03-05T15:02:53Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-slub-debug",
        "namespace": "openshift-compliance",
        "resourceVersion": "77956",
        "uid": "747c910d-4c29-41ea-89e4-ea88ab4eeb86"
      },
      "rationale": "This activates the checking of the memory allocator structures and resets to zero the zones allocated when they are released.",
      "severity": "medium",
      "title": "Enable SLUB debugging support",
      "warning": "This activates the checking of the memory allocator structures and resets to zero the zones allocated when they are released."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Normal TCP/IP networking is open to an attack known as SYN flooding. It is denial-of-service attack that prevents legitimate remote users from being able to connect to your computer during an ongoing attack. When enabled the TCP/IP stack will use a cryptographic challenge protocol known as SYN cookies to enable legitimate users to continue to connect, even when your machine is under attack. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_SYN_COOKIES , run the following command: grep CONFIG_SYN_COOKIES /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_syn_cookies",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_SYN_COOKIES /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-syn-cookies"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-syn-cookies",
        "namespace": "openshift-compliance",
        "resourceVersion": "77963",
        "uid": "4bb8807b-f802-4b2a-81cb-17dc1c6b202d"
      },
      "rationale": "SYN cookies provide protection against SYN flooding attacks.",
      "severity": "medium",
      "title": "Enable TCP/IP syncookie support",
      "warning": "SYN cookies provide protection against SYN flooding attacks."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Speculation attacks against some high-performance processors can be used to bypass MMU permission checks and leak kernel data to userspace. This can be defended against by unmapping the kernel when running in userspace, mapping it back in on exception entry via a trampoline page in the vector table. This configuration is available from kernel 4.16, but may be available if backported by distros. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_UNMAP_KERNEL_AT_EL0 , run the following command: grep CONFIG_UNMAP_KERNEL_AT_EL0 /boot/config-* For each kernel installed, a line with value \"y\" should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_unmap_kernel_at_el0",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_UNMAP_KERNEL_AT_EL0 /boot/config.*\n    \n    For each kernel installed, a line with value \"y\" should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-unmap-kernel-at-el0"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-unmap-kernel-at-el0",
        "namespace": "openshift-compliance",
        "resourceVersion": "77970",
        "uid": "eeb19bce-7de8-4178-8ada-e477c0cfd684"
      },
      "rationale": "This is a countermeasure to the Meltdown attack.",
      "severity": "medium",
      "title": "Unmap kernel when running in userspace (aka KAISER)",
      "warning": "This is a countermeasure to the Meltdown attack."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Disabling it is roughly equivalent to booting with vsyscall=none, except that it will also disable the helpful warning if a program tries to use a vsyscall. With this option set to N, offending programs will just segfault, citing addresses of the form 0xffffffffff600?00. This configuration is available from kernel 3.19. The configuration that was used to build kernel is available at /boot/config-*. To check the configuration value for CONFIG_X86_VSYSCALL_EMULATION , run the following command: grep CONFIG_X86_VSYSCALL_EMULATION /boot/config-* Configs with value 'n' are not explicitly set in the file, so either commented lines or no lines should be returned.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_config_x86_vsyscall_emulation",
      "instructions": "To determine the config value the kernel was built with, run the following command:\n    $ grep CONFIG_X86_VSYSCALL_EMULATION /boot/config.*\n    \n    Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "kernel-config-x86-vsyscall-emulation"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-config-x86-vsyscall-emulation",
        "namespace": "openshift-compliance",
        "resourceVersion": "77966",
        "uid": "f24681fe-918b-44c2-b25c-0987505dfb1c"
      },
      "rationale": "The vsyscall table is no longer required and is a potential source of ROP gadgets.",
      "severity": "low",
      "title": "Disable x86 vsyscall emulation",
      "warning": "The vsyscall table is no longer required and is a potential source of ROP gadgets."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "For each solid-state drive on the system, run:\n\n# echo 0 > /sys/block/DRIVE/queue/add_random",
      "id": "xccdf_org.ssgproject.content_rule_kernel_disable_entropy_contribution_for_solid_state_drives",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "kernel-disable-entropy-contribution-for-solid-state-drives"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-disable-entropy-contribution-for-solid-state-drives",
        "namespace": "openshift-compliance",
        "resourceVersion": "77858",
        "uid": "b42f8e4f-5d78-4710-b334-2a02363a4ee4"
      },
      "rationale": "In contrast to traditional electromechanical magnetic disks, containing spinning disks and / or movable read / write heads, the solid-state storage devices (SSDs) do not contain moving / mechanical components. Therefore the I/O operation completion times are much more predictable for them.",
      "severity": "medium",
      "title": "Ensure Solid State Drives Do Not Contribute To Random-Number Entropy Pool"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20atm%20/bin/false%0Ablacklist%20atm%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/atm.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The Asynchronous Transfer Mode (ATM) is a protocol operating on network, data link, and physical layers, based on virtual circuits and virtual paths. To configure the system to prevent the atm kernel module from being loaded, add the following line to the file /etc/modprobe.d/atm.conf :\n\ninstall atm /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_atm_disabled",
      "instructions": "If the system is configured to prevent the loading of the atm kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r atm /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "kernel-module-atm-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-18",
          "policies.open-cluster-management.io/controls": "AC-18",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-atm-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78173",
        "uid": "26bc79ed-955d-43e0-a682-bfcd1834096c"
      },
      "rationale": "Disabling ATM protects the system against exploitation of any flaws in its implementation.",
      "severity": "medium",
      "title": "Disable ATM Support"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20bluetooth%20/bin/false%0Ablacklist%20bluetooth%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/bluetooth.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The kernel's module loading system can be configured to prevent loading of the Bluetooth module. Add the following to the appropriate /etc/modprobe.d configuration file to prevent the loading of the Bluetooth module:\n\ninstall bluetooth /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_bluetooth_disabled",
      "instructions": "If the system is configured to prevent the loading of the bluetooth kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r bluetooth /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "kernel-module-bluetooth-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-18(a);AC-18(3);CM-7(a);CM-7(b);CM-6(a);MP-7",
          "policies.open-cluster-management.io/controls": "AC-18(a),AC-18(3),CM-7(a),CM-7(b),CM-6(a),MP-7",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-bluetooth-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78183",
        "uid": "435d2efa-ef8d-4a3e-801e-8457a59abf9c"
      },
      "rationale": "If Bluetooth functionality must be disabled, preventing the kernel from loading the kernel module provides an additional safeguard against its activation.",
      "severity": "medium",
      "title": "Disable Bluetooth Kernel Module"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20can%20/bin/false%0Ablacklist%20can%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/can.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The Controller Area Network (CAN) is a serial communications protocol which was initially developed for automotive and is now also used in marine, industrial, and medical applications. To configure the system to prevent the can kernel module from being loaded, add the following line to the file /etc/modprobe.d/can.conf :\n\ninstall can /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_can_disabled",
      "instructions": "If the system is configured to prevent the loading of the can kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r can /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high",
          "compliance.openshift.io/rule": "kernel-module-can-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-18",
          "policies.open-cluster-management.io/controls": "AC-18",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-can-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78174",
        "uid": "74249d52-d8d4-4bd7-8b9b-f72bcc0f01f6"
      },
      "rationale": "Disabling CAN protects the system against exploitation of any flaws in its implementation.",
      "severity": "medium",
      "title": "Disable CAN Support"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20cfg80211%20/bin/false%0Ablacklist%20cfg80211%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/cfg80211.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the cfg80211 kernel module from being loaded, add the following line to the file /etc/modprobe.d/cfg80211.conf :\n\ninstall cfg80211 /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_cfg80211_disabled",
      "instructions": "If the system is configured to prevent the loading of the cfg80211 kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r cfg80211 /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "kernel-module-cfg80211-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-18(a);AC-18(3);CM-7(a);CM-7(b);CM-6(a);MP-7;AC-18(4)",
          "policies.open-cluster-management.io/controls": "AC-18(a),AC-18(3),CM-7(a),CM-7(b),CM-6(a),MP-7,AC-18(4)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-cfg80211-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78186",
        "uid": "d56e3828-38f4-410c-aabd-19672a73b6b8"
      },
      "rationale": "If Wireless functionality must be disabled, preventing the kernel from loading the kernel module provides an additional safeguard against its activation.",
      "severity": "medium",
      "title": "Disable Kernel cfg80211 Module"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20cramfs%20/bin/false%0Ablacklist%20cramfs%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/cramfs.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the cramfs kernel module from being loaded, add the following line to the file /etc/modprobe.d/cramfs.conf :\n\ninstall cramfs /bin/true\n\nThis effectively prevents usage of this uncommon filesystem. The cramfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A cramfs image can be used without having to first decompress the image.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_cramfs_disabled",
      "instructions": "If the system is configured to prevent the loading of the cramfs kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r cramfs /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "kernel-module-cramfs-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-cramfs-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78299",
        "uid": "e54207b2-e072-415d-abc2-6b908ad17de2"
      },
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the server.",
      "severity": "low",
      "title": "Disable Mounting of cramfs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20firewire-core%20/bin/false%0Ablacklist%20firewire-core%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/firewire-core.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The IEEE 1394 (FireWire) is a serial bus standard for high-speed real-time communication. To configure the system to prevent the firewire-core kernel module from being loaded, add the following line to the file /etc/modprobe.d/firewire-core.conf :\n\ninstall firewire-core /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_firewire-core_disabled",
      "instructions": "If the system is configured to prevent the loading of the firewire-core kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r firewire-core /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "kernel-module-firewire-core-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-18",
          "policies.open-cluster-management.io/controls": "AC-18",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-firewire-core-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78175",
        "uid": "49b4e17a-5af7-4cbe-84a9-68089d8cdb6b"
      },
      "rationale": "Disabling FireWire protects the system against exploitation of any flaws in its implementation.",
      "severity": "low",
      "title": "Disable IEEE 1394 (FireWire) Support"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20freevxfs%20/bin/false%0Ablacklist%20freevxfs%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/freevxfs.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the freevxfs kernel module from being loaded, add the following line to the file /etc/modprobe.d/freevxfs.conf :\n\ninstall freevxfs /bin/true\n\nThis effectively prevents usage of this uncommon filesystem.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_freevxfs_disabled",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "kernel-module-freevxfs-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-freevxfs-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78300",
        "uid": "c6531580-2b47-44b5-b4e3-f835602bd662"
      },
      "rationale": "Linux kernel modules which implement filesystems that are not needed by the local system should be disabled.",
      "severity": "low",
      "title": "Disable Mounting of freevxfs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20hfs%20/bin/false%0Ablacklist%20hfs%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/hfs.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the hfs kernel module from being loaded, add the following line to the file /etc/modprobe.d/hfs.conf :\n\ninstall hfs /bin/true\n\nThis effectively prevents usage of this uncommon filesystem.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_hfs_disabled",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "kernel-module-hfs-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-hfs-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78301",
        "uid": "643dd9af-3524-460f-9b10-cf822b8a3a0a"
      },
      "rationale": "Linux kernel modules which implement filesystems that are not needed by the local system should be disabled.",
      "severity": "low",
      "title": "Disable Mounting of hfs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20hfsplus%20/bin/false%0Ablacklist%20hfsplus%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/hfsplus.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the hfsplus kernel module from being loaded, add the following line to the file /etc/modprobe.d/hfsplus.conf :\n\ninstall hfsplus /bin/true\n\nThis effectively prevents usage of this uncommon filesystem.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_hfsplus_disabled",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "kernel-module-hfsplus-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-hfsplus-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78303",
        "uid": "123eaccc-7314-4b5e-9724-34042746bd8a"
      },
      "rationale": "Linux kernel modules which implement filesystems that are not needed by the local system should be disabled.",
      "severity": "low",
      "title": "Disable Mounting of hfsplus"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To prevent the IPv6 kernel module ( ipv6 ) from binding to the IPv6 networking stack, add the following line to /etc/modprobe.d/disabled.conf (or another file in /etc/modprobe.d ):\n\noptions ipv6 disable=1\n\nThis permits the IPv6 module to be loaded (and thus satisfy other modules that depend on it), while disabling support for the IPv6 protocol.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_ipv6_option_disabled",
      "instructions": "If the system uses IPv6, this is not applicable.\n\nIf the system is configured to disable the\nipv6 kernel module, it will contain a line\nof the form:\noptions ipv6 disable=1\nSuch lines may be inside any file in /etc/modprobe.d or the\ndeprecated/etc/modprobe.conf.  This permits insertion of the IPv6\nkernel module (which other parts of the system expect to be present), but\notherwise keeps it inactive.  Run the following command to search for such\nlines in all files in /etc/modprobe.d and the deprecated\n/etc/modprobe.conf:\n$ grep -r ipv6 /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "kernel-module-ipv6-option-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-ipv6-option-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78092",
        "uid": "e46964f3-2a37-48eb-8274-8b29b51d1f71"
      },
      "rationale": "Any unnecessary network stacks - including IPv6 - should be disabled, to reduce the vulnerability to exploitation.",
      "severity": "medium",
      "title": "Disable IPv6 Networking Support Automatic Loading"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20iwlmvm%20/bin/false%0Ablacklist%20iwlmvm%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/iwlmvm.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the iwlmvm kernel module from being loaded, add the following line to the file /etc/modprobe.d/iwlmvm.conf :\n\ninstall iwlmvm /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_iwlmvm_disabled",
      "instructions": "If the system is configured to prevent the loading of the iwlmvm kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r iwlmvm /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "kernel-module-iwlmvm-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-18(a);AC-18(3);CM-7(a);CM-7(b);CM-6(a);MP-7;AC-18(4)",
          "policies.open-cluster-management.io/controls": "AC-18(a),AC-18(3),CM-7(a),CM-7(b),CM-6(a),MP-7,AC-18(4)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-iwlmvm-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78187",
        "uid": "28a37a13-e830-4b3b-bdf6-2a9cf7e40235"
      },
      "rationale": "If Wireless functionality must be disabled, preventing the kernel from loading the kernel module provides an additional safeguard against its activation.",
      "severity": "medium",
      "title": "Disable Kernel iwlmvm Module"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20iwlwifi%20/bin/false%0Ablacklist%20iwlwifi%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/iwlwifi.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the iwlwifi kernel module from being loaded, add the following line to the file /etc/modprobe.d/iwlwifi.conf :\n\ninstall iwlwifi /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_iwlwifi_disabled",
      "instructions": "If the system is configured to prevent the loading of the iwlwifi kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r iwlwifi /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "kernel-module-iwlwifi-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-18(a);AC-18(3);CM-7(a);CM-7(b);CM-6(a);MP-7;AC-18(4)",
          "policies.open-cluster-management.io/controls": "AC-18(a),AC-18(3),CM-7(a),CM-7(b),CM-6(a),MP-7,AC-18(4)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-iwlwifi-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78189",
        "uid": "9dbc7c3c-8703-4d3a-bf72-299be16f31cc"
      },
      "rationale": "If Wireless functionality must be disabled, preventing the kernel from loading the kernel module provides an additional safeguard against its activation.",
      "severity": "medium",
      "title": "Disable Kernel iwlwifi Module"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20jffs2%20/bin/false%0Ablacklist%20jffs2%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/jffs2.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the jffs2 kernel module from being loaded, add the following line to the file /etc/modprobe.d/jffs2.conf :\n\ninstall jffs2 /bin/true\n\nThis effectively prevents usage of this uncommon filesystem.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_jffs2_disabled",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "kernel-module-jffs2-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-jffs2-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78304",
        "uid": "4d8af140-6564-4fa6-b418-336ff3eab1ea"
      },
      "rationale": "Linux kernel modules which implement filesystems that are not needed by the local system should be disabled.",
      "severity": "low",
      "title": "Disable Mounting of jffs2"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20mac80211%20/bin/false%0Ablacklist%20mac80211%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/mac80211.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the mac80211 kernel module from being loaded, add the following line to the file /etc/modprobe.d/mac80211.conf :\n\ninstall mac80211 /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_mac80211_disabled",
      "instructions": "If the system is configured to prevent the loading of the mac80211 kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r mac80211 /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "kernel-module-mac80211-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-18(a);AC-18(3);CM-7(a);CM-7(b);CM-6(a);MP-7;AC-18(4)",
          "policies.open-cluster-management.io/controls": "AC-18(a),AC-18(3),CM-7(a),CM-7(b),CM-6(a),MP-7,AC-18(4)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-mac80211-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78191",
        "uid": "5468e18a-b93f-4f43-9f32-51debbc35e4a"
      },
      "rationale": "If Wireless functionality must be disabled, preventing the kernel from loading the kernel module provides an additional safeguard against its activation.",
      "severity": "medium",
      "title": "Disable Kernel mac80211 Module"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20rds%20/bin/false%0Ablacklist%20rds%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/rds.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The Reliable Datagram Sockets (RDS) protocol is a transport layer protocol designed to provide reliable high-bandwidth, low-latency communications between nodes in a cluster. To configure the system to prevent the rds kernel module from being loaded, add the following line to the file /etc/modprobe.d/rds.conf :\n\ninstall rds /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_rds_disabled",
      "instructions": "If the system is configured to prevent the loading of the rds kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r rds /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "kernel-module-rds-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-rds-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78178",
        "uid": "96bdd7fa-adb4-42ac-b682-7f3112fa10a6"
      },
      "rationale": "Disabling RDS protects the system against exploitation of any flaws in its implementation.",
      "severity": "low",
      "title": "Disable RDS Support"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20sctp%20/bin/false%0Ablacklist%20sctp%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/sctp.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The Stream Control Transmission Protocol (SCTP) is a transport layer protocol, designed to support the idea of message-oriented communication, with several streams of messages within one connection. To configure the system to prevent the sctp kernel module from being loaded, add the following line to the file /etc/modprobe.d/sctp.conf :\n\ninstall sctp /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_sctp_disabled",
      "instructions": "If the system is configured to prevent the loading of the sctp kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r sctp /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "kernel-module-sctp-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.4.2",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),Req-1.4.2",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-sctp-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78179",
        "uid": "fee506d2-9309-4bbb-a530-9ef34fe538e6"
      },
      "rationale": "Disabling SCTP protects the system against exploitation of any flaws in its implementation.",
      "severity": "medium",
      "title": "Disable SCTP Support"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20squashfs%20/bin/false%0Ablacklist%20squashfs%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/squashfs.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the squashfs kernel module from being loaded, add the following line to the file /etc/modprobe.d/squashfs.conf :\n\ninstall squashfs /bin/true\n\nThis effectively prevents usage of this uncommon filesystem. The squashfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems (similar to cramfs ). A squashfs image can be used without having to first decompress the image.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_squashfs_disabled",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "kernel-module-squashfs-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-squashfs-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78306",
        "uid": "bcd28479-6b5e-4800-9db6-c42ed8bf33a1"
      },
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "severity": "low",
      "title": "Disable Mounting of squashfs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20tipc%20/bin/false%0Ablacklist%20tipc%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/tipc.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The Transparent Inter-Process Communication (TIPC) protocol is designed to provide communications between nodes in a cluster. To configure the system to prevent the tipc kernel module from being loaded, add the following line to the file /etc/modprobe.d/tipc.conf :\n\ninstall tipc /bin/true",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_tipc_disabled",
      "instructions": "If the system is configured to prevent the loading of the tipc kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r tipc /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "kernel-module-tipc-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-tipc-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78180",
        "uid": "1cbef3e9-20c5-459b-ba49-4787d13043b7"
      },
      "rationale": "Disabling TIPC protects the system against exploitation of any flaws in its implementation.",
      "severity": "low",
      "title": "Disable TIPC Support",
      "warning": "Disabling TIPC protects the system against exploitation of any flaws in its implementation."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20udf%20/bin/false%0Ablacklist%20udf%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/udf.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the udf kernel module from being loaded, add the following line to the file /etc/modprobe.d/udf.conf :\n\ninstall udf /bin/true\n\nThis effectively prevents usage of this uncommon filesystem. The udf filesystem type is the universal disk format used to implement the ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor filesystem type for data storage on a broad range of media. This filesystem type is neccessary to support writing DVDs and newer optical disc formats.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_udf_disabled",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "kernel-module-udf-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-udf-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78307",
        "uid": "ae007dfe-c7ac-40cb-99a0-c7426fd80d4e"
      },
      "rationale": "Removing support for unneeded filesystem types reduces the local attack surface of the system.",
      "severity": "low",
      "title": "Disable Mounting of udf"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20usb-storage%20/bin/false%0Ablacklist%20usb-storage%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/usb-storage.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To prevent USB storage devices from being used, configure the kernel module loading system to prevent automatic loading of the USB storage driver. To configure the system to prevent the usb-storage kernel module from being loaded, add the following line to the file /etc/modprobe.d/usb-storage.conf :\n\ninstall usb-storage /bin/true\n\nThis will prevent the modprobe program from loading the usb-storage module, but will not prevent an administrator (or another program) from using the insmod program to load the module manually.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_usb-storage_disabled",
      "instructions": "If the system is configured to prevent the loading of the usb-storage kernel module,\nit will contain lines inside any file in /etc/modprobe.d or the deprecated /etc/modprobe.conf.\nThese lines instruct the module loading system to run another program (such as /bin/true) upon a module install event.\n\nRun the following command to search for such lines in all files in /etc/modprobe.d and the deprecated /etc/modprobe.conf:\n$ grep -r usb-storage /etc/modprobe.conf /etc/modprobe.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "kernel-module-usb-storage-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);MP-7",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),MP-7",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-usb-storage-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78308",
        "uid": "e49b7964-a8f4-4be1-9b83-e7a234bd9a8b"
      },
      "rationale": "USB storage devices such as thumb drives can be used to introduce malicious software.",
      "severity": "medium",
      "title": "Disable Modprobe Loading of USB Storage Driver"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20uvcvideo%20/bin/false%0Ablacklist%20uvcvideo%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/uvcvideo.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If the device contains a camera it should be covered or disabled when not in use.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_uvcvideo_disabled",
      "instructions": "If the device or Red Hat Enterprise Linux CoreOS 4 does not have a camera installed, this requirement is not applicable.\n\nThis requirement is not applicable to mobile devices (smartphones and tablets), where the use of the camera is a local AO decision.\n\nThis requirement is not applicable to dedicated VTC suites located in approved VTC locations that are centrally managed.\n\nFor an external camera, if there is not a method for the operator to manually disconnect the camera at the end of collaborative computing sessions, this is a finding.\n\nFor a built-in camera, the camera must be protected by a camera cover (e.g., laptop camera cover slide) when not in use. If the built-in camera is not protected with a camera cover, or is not physically disabled, this is a finding.\n\nIf the camera is not disconnected, covered, or physically disabled, determine if it is being disabled via software with the following commands:\n\nVerify the operating system disables the ability to load the uvcvideo kernel module.\n\n$ sudo grep -r uvcvideo /etc/modprobe.d/* | grep \"/bin/true\"\n\ninstall uvcvideo /bin/true",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "kernel-module-uvcvideo-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7 (a);CM-7 (5) (b)",
          "policies.open-cluster-management.io/controls": "CM-7 (a),CM-7 (5) (b)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-uvcvideo-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78361",
        "uid": "d554a133-a419-4e72-80c7-0faab45e72da"
      },
      "rationale": "Failing to disconnect from collaborative computing devices (i.e., cameras) can result in subsequent compromises of organizational information. Providing easy methods to physically disconnect from such devices after a collaborative computing session helps to ensure participants actually carry out the disconnect activity without having to go through complex and tedious procedures.",
      "severity": "medium",
      "title": "Disable the uvcvideo module"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,install%20vfat%20/bin/false%0Ablacklist%20vfat%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/modprobe.d/vfat.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To configure the system to prevent the vfat kernel module from being loaded, add the following line to the file /etc/modprobe.d/vfat.conf :\n\ninstall vfat /bin/true\n\nThis effectively prevents usage of this uncommon filesystem. The vFAT filesystem format is primarily used on older windows systems and portable USB drives or flash modules. It comes in three types FAT12 , FAT16 , and FAT32 all of which are supported by the vfat kernel module.",
      "id": "xccdf_org.ssgproject.content_rule_kernel_module_vfat_disabled",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "kernel-module-vfat-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:10Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-kernel-module-vfat-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78309",
        "uid": "c85bec44-0b34-4e53-8187-e35d9059bcbb"
      },
      "rationale": "Removing support for unneeded filesystems reduces the local attack surface of the system.",
      "severity": "low",
      "title": "Disable Mounting of vFAT filesystems"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To configure logind service to terminate inactive user sessions after 300 seconds, edit the file /etc/systemd/logind.conf. Ensure that there is a section\n\n[Login]\n\nwhich contains the configuration\n\nStopIdleSessionSec= 300 \n\n.",
      "id": "xccdf_org.ssgproject.content_rule_logind_session_timeout",
      "instructions": "Display the contents of the file /etc/systemd/logind.conf:\ncat /etc/systemd/logind.conf\nEnsure that there is a section [login] which contains the\nconfiguration StopIdleSessionSec=.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "logind-session-timeout",
          "compliance.openshift.io/rule-variable": "var-logind-session-timeout,var-logind-session-timeout",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-007-3 R5.1;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-17(a);AC-2(5);AC-12;SC-10",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.1.8",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-007-3 R5.1,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CM-6(a),AC-17(a),AC-2(5),AC-12,SC-10,Req-8.1.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-logind-session-timeout",
        "namespace": "openshift-compliance",
        "resourceVersion": "76865",
        "uid": "1fc465e4-952b-4ad1-ab86-9e1eb71b939b"
      },
      "rationale": "Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been let unattended.",
      "severity": "medium",
      "title": "Configure Logind to terminate idle sessions after certain time of inactivity"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option can be used to prevent device files from being created in /boot. Legitimate character and block devices should exist only in the /dev directory on the root partition or within chroot jails built for system services. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of /boot.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_boot_nodev",
      "instructions": "Verify the nodev option is configured for the /boot mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/boot\\s'\n    . . . /boot . . . nodev . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-boot-nodev",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-boot-nodev",
        "namespace": "openshift-compliance",
        "resourceVersion": "78311",
        "uid": "e89b70c7-c107-4e70-ba83-e1f03bb532e8"
      },
      "rationale": "The only legitimate location for device files is the /dev directory located on the root partition. The only exception to this is chroot jails.",
      "severity": "medium",
      "title": "Add nodev Option to /boot"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nosuid mount option can be used to prevent execution of setuid programs in /boot. The SUID and SGID permissions should not be required on the boot partition. Add the nosuid option to the list of Options in the systemd.mount unit that controls mounting of /boot.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_boot_nosuid",
      "instructions": "Verify the nosuid option is configured for the /boot mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/boot\\s'\n    . . . /boot . . . nosuid . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "mount-option-boot-nosuid",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-boot-nosuid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78312",
        "uid": "19c843b3-e1d6-4a0c-aa09-775d23e972db"
      },
      "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users should not be able to execute SUID or SGID binaries from boot partitions.",
      "severity": "medium",
      "title": "Add nosuid Option to /boot"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option can be used to prevent creation of device files in /dev/shm. Legitimate character and block devices should not exist within temporary directories like /dev/shm. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of /dev/shm.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nodev",
      "instructions": "Verify the nodev option is configured for the /dev/shm mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/dev/shm\\s'\n    . . . /dev/shm . . . nodev . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-dev-shm-nodev",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-dev-shm-nodev",
        "namespace": "openshift-compliance",
        "resourceVersion": "78313",
        "uid": "ac595e6f-c754-4dde-b1be-d15cb0dec40e"
      },
      "rationale": "The only legitimate location for device files is the /dev directory located on the root partition. The only exception to this is chroot jails.",
      "severity": "medium",
      "title": "Add nodev Option to /dev/shm"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The noexec mount option can be used to prevent binaries from being executed out of /dev/shm. It can be dangerous to allow the execution of binaries from world-writable temporary storage directories such as /dev/shm. Add the noexec option to the list of Options in the systemd.mount unit that controls mounting of /dev/shm.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_dev_shm_noexec",
      "instructions": "Verify the noexec option is configured for the /dev/shm mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/dev/shm\\s'\n    . . . /dev/shm . . . noexec . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-dev-shm-noexec",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-dev-shm-noexec",
        "namespace": "openshift-compliance",
        "resourceVersion": "78314",
        "uid": "74ad1728-f8f0-4519-92ec-c96111cc15f8"
      },
      "rationale": "Allowing users to execute binaries from world-writable directories such as /dev/shm can expose the system to potential compromise.",
      "severity": "medium",
      "title": "Add noexec Option to /dev/shm"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nosuid mount option can be used to prevent execution of setuid programs in /dev/shm. The SUID and SGID permissions should not be required in these world-writable directories. Add the nosuid option to the list of Options in the systemd.mount unit that controls mounting of /dev/shm.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nosuid",
      "instructions": "Verify the nosuid option is configured for the /dev/shm mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/dev/shm\\s'\n    . . . /dev/shm . . . nosuid . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-dev-shm-nosuid",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-dev-shm-nosuid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78315",
        "uid": "52244144-a779-42ba-8ae4-670c54817942"
      },
      "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users should not be able to execute SUID or SGID binaries from temporary storage partitions.",
      "severity": "medium",
      "title": "Add nosuid Option to /dev/shm"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option can be used to prevent device files from being created in /home. Legitimate character and block devices should exist only in the /dev directory on the root partition or within chroot jails built for system services. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of /home.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_home_nodev",
      "instructions": "Verify the nodev option is configured for the /home mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/home\\s'\n    . . . /home . . . nodev . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-home-nodev"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-home-nodev",
        "namespace": "openshift-compliance",
        "resourceVersion": "78319",
        "uid": "b32a79e0-0ffd-4218-a4bc-77ddb4a7107a"
      },
      "rationale": "The only legitimate location for device files is the /dev directory located on the root partition. The only exception to this is chroot jails.",
      "severity": "unknown",
      "title": "Add nodev Option to /home"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nosuid mount option can be used to prevent execution of setuid programs in /home. The SUID and SGID permissions should not be required in these user data directories. Add the nosuid option to the list of Options in the systemd.mount unit that controls mounting of /home.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_home_nosuid",
      "instructions": "Verify the nosuid option is configured for the /home mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/home\\s'\n    . . . /home . . . nosuid . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "mount-option-home-nosuid",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-home-nosuid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78321",
        "uid": "cff22041-051d-4a27-bf26-e22b4c3e73e5"
      },
      "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users should not be able to execute SUID or SGID binaries from user home directory partitions.",
      "severity": "medium",
      "title": "Add nosuid Option to /home"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option prevents files from being interpreted as character or block devices. Legitimate character and block devices should exist only in the /dev directory on the root partition or within chroot jails built for system services. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of any non-root local partitions.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_nodev_nonroot_local_partitions",
      "instructions": "To verify the nodev option is configured for non-root local partitions, run the following command:\n$ sudo mount | grep '^/dev\\S* on /\\S' | grep --invert-match 'nodev'\nThe output shows local non-root partitions mounted without the nodev option, and there should be no output at all.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "mount-option-nodev-nonroot-local-partitions",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-nodev-nonroot-local-partitions",
        "namespace": "openshift-compliance",
        "resourceVersion": "78322",
        "uid": "b8662835-6ee0-4e3c-bca2-a90d022f65f9"
      },
      "rationale": "The nodev mount option prevents files from being interpreted as character or block devices. The only legitimate location for device files is the /dev directory located on the root partition. The only exception to this is chroot jails, for which it is not advised to set nodev on these filesystems.",
      "severity": "medium",
      "title": "Add nodev Option to Non-Root Local Partitions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option prevents files from being interpreted as character or block devices. Legitimate character and block devices should exist only in the /dev directory on the root partition or within chroot jails built for system services. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of any removable media partitions.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_nodev_removable_partitions",
      "instructions": "Verify file systems that are used for removable media are mounted with the \"nodev\" option with the following command:\n\n$ sudo more /etc/fstab\n\nUUID=2bc871e4-e2a3-4f29-9ece-3be60c835222 /mnt/usbflash vfat noauto,owner,ro,nosuid,nodev,noexec 0 0",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-nodev-removable-partitions",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-nodev-removable-partitions",
        "namespace": "openshift-compliance",
        "resourceVersion": "78323",
        "uid": "a3bcb411-c25c-40ce-a20f-3f51b09564ee"
      },
      "rationale": "The only legitimate location for device files is the /dev directory located on the root partition. An exception to this is chroot jails, and it is not advised to set nodev on partitions which contain their root filesystems.",
      "severity": "medium",
      "title": "Add nodev Option to Removable Media Partitions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The noexec mount option prevents the direct execution of binaries on the mounted filesystem. Preventing the direct execution of binaries from removable media (such as a USB key) provides a defense against malicious software that may be present on such untrusted media. Add the noexec option to the list of Options in the systemd.mount unit that controls mounting of any removable media partitions.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_noexec_removable_partitions",
      "instructions": "To verify that binaries cannot be directly executed from removable media, run the following command:\n$ grep -v noexec /etc/fstab\nThe resulting output will show partitions which do not have the noexec flag. Verify all partitions\nin the output are not removable media.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-noexec-removable-partitions",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:11Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-noexec-removable-partitions",
        "namespace": "openshift-compliance",
        "resourceVersion": "78326",
        "uid": "eea39f6a-a8b9-4525-8c26-6efab1f19e08"
      },
      "rationale": "Allowing users to execute binaries from removable media such as USB keys exposes the system to potential compromise.",
      "severity": "medium",
      "title": "Add noexec Option to Removable Media Partitions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nosuid mount option prevents set-user-identifier (SUID) and set-group-identifier (SGID) permissions from taking effect. These permissions allow users to execute binaries with the same permissions as the owner and group of the file respectively. Users should not be allowed to introduce SUID and SGID files into the system via partitions mounted from removeable media. Add the nosuid option to the list of Options in the systemd.mount unit that controls mounting of any removable media partitions.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_nosuid_removable_partitions",
      "instructions": "Verify file systems that are used for removable media are mounted with the \"nosuid\" option with the following command:\n\n$ sudo more /etc/fstab\n\nUUID=2bc871e4-e2a3-4f29-9ece-3be60c835222 /mnt/usbflash vfat noauto,owner,ro,nosuid,nodev,noexec 0 0",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-nosuid-removable-partitions",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-nosuid-removable-partitions",
        "namespace": "openshift-compliance",
        "resourceVersion": "78328",
        "uid": "c191f964-ac90-4f5c-9b76-90981ce5fd22"
      },
      "rationale": "The presence of SUID and SGID executables should be tightly controlled. Allowing users to introduce SUID or SGID binaries from partitions mounted off of removable media would allow them to introduce their own highly-privileged programs.",
      "severity": "medium",
      "title": "Add nosuid Option to Removable Media Partitions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option can be used to prevent device files from being created in /tmp. Legitimate character and block devices should not exist within temporary directories like /tmp. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of /tmp.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_tmp_nodev",
      "instructions": "Verify the nodev option is configured for the /tmp mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/tmp\\s'\n    . . . /tmp . . . nodev . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-tmp-nodev",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-tmp-nodev",
        "namespace": "openshift-compliance",
        "resourceVersion": "78330",
        "uid": "1899aea5-79fc-4ce7-b49a-6d747fd5e780"
      },
      "rationale": "The only legitimate location for device files is the /dev directory located on the root partition. The only exception to this is chroot jails.",
      "severity": "medium",
      "title": "Add nodev Option to /tmp"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The noexec mount option can be used to prevent binaries from being executed out of /tmp. Add the noexec option to the list of Options in the systemd.mount unit that controls mounting of /tmp.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_tmp_noexec",
      "instructions": "Verify the noexec option is configured for the /tmp mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/tmp\\s'\n    . . . /tmp . . . noexec . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "mount-option-tmp-noexec",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-tmp-noexec",
        "namespace": "openshift-compliance",
        "resourceVersion": "78331",
        "uid": "994cb3d3-4af8-4b85-980a-20dfad25a9f1"
      },
      "rationale": "Allowing users to execute binaries from world-writable directories such as /tmp should never be necessary in normal operation and can expose the system to potential compromise.",
      "severity": "medium",
      "title": "Add noexec Option to /tmp"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nosuid mount option can be used to prevent execution of setuid programs in /tmp. The SUID and SGID permissions should not be required in these world-writable directories. Add the nosuid option to the list of Options in the systemd.mount unit that controls mounting of /tmp.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_tmp_nosuid",
      "instructions": "Verify the nosuid option is configured for the /tmp mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/tmp\\s'\n    . . . /tmp . . . nosuid . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "mount-option-tmp-nosuid",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-tmp-nosuid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78333",
        "uid": "66bd8a0f-a69d-464f-a106-56add45df92d"
      },
      "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users should not be able to execute SUID or SGID binaries from temporary storage partitions.",
      "severity": "medium",
      "title": "Add nosuid Option to /tmp"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option can be used to prevent device files from being created in /var/log/audit. Legitimate character and block devices should exist only in the /dev directory on the root partition or within chroot jails built for system services. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of /var/log/audit.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nodev",
      "instructions": "Verify the nodev option is configured for the /var/log/audit mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var/log/audit\\s'\n    . . . /var/log/audit . . . nodev . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-var-log-audit-nodev",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-log-audit-nodev",
        "namespace": "openshift-compliance",
        "resourceVersion": "78336",
        "uid": "05e0fe89-7ab9-4d45-9b0c-54f731c2f18d"
      },
      "rationale": "The only legitimate location for device files is the /dev directory located on the root partition. The only exception to this is chroot jails.",
      "severity": "medium",
      "title": "Add nodev Option to /var/log/audit"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The noexec mount option can be used to prevent binaries from being executed out of /var/log/audit. Add the noexec option to the list of Options in the systemd.mount unit that controls mounting of /var/log/audit.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_noexec",
      "instructions": "Verify the noexec option is configured for the /var/log/audit mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var/log/audit\\s'\n    . . . /var/log/audit . . . noexec . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-var-log-audit-noexec",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-log-audit-noexec",
        "namespace": "openshift-compliance",
        "resourceVersion": "78340",
        "uid": "001f168b-80c3-4773-b847-9decad27f611"
      },
      "rationale": "Allowing users to execute binaries from directories containing audit log files such as /var/log/audit should never be necessary in normal operation and can expose the system to potential compromise.",
      "severity": "medium",
      "title": "Add noexec Option to /var/log/audit"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nosuid mount option can be used to prevent execution of setuid programs in /var/log/audit. The SUID and SGID permissions should not be required in directories containing audit log files. Add the nosuid option to the list of Options in the systemd.mount unit that controls mounting of /var/log/audit.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nosuid",
      "instructions": "Verify the nosuid option is configured for the /var/log/audit mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var/log/audit\\s'\n    . . . /var/log/audit . . . nosuid . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-var-log-audit-nosuid",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-log-audit-nosuid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78341",
        "uid": "b31ee4b6-837f-49b1-98d6-756828918468"
      },
      "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users should not be able to execute SUID or SGID binaries from partitions designated for audit log files.",
      "severity": "medium",
      "title": "Add nosuid Option to /var/log/audit"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option can be used to prevent device files from being created in /var/log. Legitimate character and block devices should exist only in the /dev directory on the root partition or within chroot jails built for system services. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of /var/log.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_nodev",
      "instructions": "Verify the nodev option is configured for the /var/log mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var/log\\s'\n    . . . /var/log . . . nodev . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-var-log-nodev",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-log-nodev",
        "namespace": "openshift-compliance",
        "resourceVersion": "78342",
        "uid": "68808708-bbcc-4736-b747-566cd0af82ed"
      },
      "rationale": "The only legitimate location for device files is the /dev directory located on the root partition. The only exception to this is chroot jails.",
      "severity": "medium",
      "title": "Add nodev Option to /var/log"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The noexec mount option can be used to prevent binaries from being executed out of /var/log. Add the noexec option to the list of Options in the systemd.mount unit that controls mounting of /var/log.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_noexec",
      "instructions": "Verify the noexec option is configured for the /var/log mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var/log\\s'\n    . . . /var/log . . . noexec . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "mount-option-var-log-noexec",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-log-noexec",
        "namespace": "openshift-compliance",
        "resourceVersion": "78344",
        "uid": "64af4759-51e3-48b9-8a73-f267660fa154"
      },
      "rationale": "Allowing users to execute binaries from directories containing log files such as /var/log should never be necessary in normal operation and can expose the system to potential compromise.",
      "severity": "medium",
      "title": "Add noexec Option to /var/log"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nosuid mount option can be used to prevent execution of setuid programs in /var/log. The SUID and SGID permissions should not be required in directories containing log files. Add the nosuid option to the list of Options in the systemd.mount unit that controls mounting of /var/log.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_nosuid",
      "instructions": "Verify the nosuid option is configured for the /var/log mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var/log\\s'\n    . . . /var/log . . . nosuid . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "mount-option-var-log-nosuid",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:12Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-log-nosuid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78349",
        "uid": "244441da-6e43-49ed-a649-f4ca26e0e8d2"
      },
      "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users should not be able to execute SUID or SGID binaries from partitions designated for log files.",
      "severity": "medium",
      "title": "Add nosuid Option to /var/log"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option can be used to prevent device files from being created in /var. Legitimate character and block devices should exist only in the /dev directory on the root partition or within chroot jails built for system services. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of /var.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_nodev",
      "instructions": "Verify the nodev option is configured for the /var mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var\\s'\n    . . . /var . . . nodev . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-var-nodev",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-6;AC-6(1);MP-7",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-6,AC-6(1),MP-7",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-nodev",
        "namespace": "openshift-compliance",
        "resourceVersion": "78351",
        "uid": "da8f7b99-4593-4286-890b-0940204fe92c"
      },
      "rationale": "The only legitimate location for device files is the /dev directory located on the root partition. The only exception to this is chroot jails.",
      "severity": "medium",
      "title": "Add nodev Option to /var"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nosuid mount option can be used to prevent execution of setuid programs in /var. The SUID and SGID permissions should not be required for this directory. Add the nosuid option to the list of Options in the systemd.mount unit that controls mounting of /var.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_nosuid",
      "instructions": "Verify the nosuid option is configured for the /var mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var\\s'\n    . . . /var . . . nosuid . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "mount-option-var-nosuid"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-nosuid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78352",
        "uid": "8bb4cb21-dab4-4448-bedf-db651a28a043"
      },
      "rationale": "The presence of SUID and SGID executables should be tightly controlled.",
      "severity": "medium",
      "title": "Add nosuid Option to /var"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nodev mount option can be used to prevent device files from being created in /var/tmp. Legitimate character and block devices should not exist within temporary directories like /var/tmp. Add the nodev option to the list of Options in the systemd.mount unit that controls mounting of /var/tmp.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nodev",
      "instructions": "Verify the nodev option is configured for the /var/tmp mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var/tmp\\s'\n    . . . /var/tmp . . . nodev . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "mount-option-var-tmp-nodev"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-tmp-nodev",
        "namespace": "openshift-compliance",
        "resourceVersion": "78355",
        "uid": "d88ff867-b109-403b-a5fa-19703516759a"
      },
      "rationale": "The only legitimate location for device files is the /dev directory located on the root partition. The only exception to this is chroot jails.",
      "severity": "medium",
      "title": "Add nodev Option to /var/tmp"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The noexec mount option can be used to prevent binaries from being executed out of /var/tmp. Add the noexec option to the list of Options in the systemd.mount unit that controls mounting of /var/tmp.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_tmp_noexec",
      "instructions": "Verify the noexec option is configured for the /var/tmp mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var/tmp\\s'\n    . . . /var/tmp . . . noexec . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "mount-option-var-tmp-noexec"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-tmp-noexec",
        "namespace": "openshift-compliance",
        "resourceVersion": "78357",
        "uid": "5fef0f90-8c44-476a-94a0-d1ec65365314"
      },
      "rationale": "Allowing users to execute binaries from world-writable directories such as /var/tmp should never be necessary in normal operation and can expose the system to potential compromise.",
      "severity": "medium",
      "title": "Add noexec Option to /var/tmp"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nosuid mount option can be used to prevent execution of setuid programs in /var/tmp. The SUID and SGID permissions should not be required in these world-writable directories. Add the nosuid option to the list of Options in the systemd.mount unit that controls mounting of /var/tmp.",
      "id": "xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nosuid",
      "instructions": "Verify the nosuid option is configured for the /var/tmp mount point,\n    You'll need to log into a node in the cluster.\n    As a user with administrator privileges, log into a node in the relevant pool:\n    \n    $ oc debug node/$NODE_NAME\n    \n    At the sh-4.4# prompt, run:\n    \n    # chroot /host\n    \n\n    Subsequently,run the following command:\n    $ sudo mount | grep '\\s/var/tmp\\s'\n    . . . /var/tmp . . . nosuid . . .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "mount-option-var-tmp-nosuid"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-mount-option-var-tmp-nosuid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78358",
        "uid": "8633010c-ad39-4bfc-8845-21412c3d306f"
      },
      "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users should not be able to execute SUID or SGID binaries from temporary storage partitions.",
      "severity": "medium",
      "title": "Add nosuid Option to /var/tmp"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "By default, non-privileged users are given permissions to modify networking interfaces and configurations using the nmcli command. Non-privileged users should not be making configuration changes to network configurations. To ensure that non-privileged users do not have permissions to make changes to the network configuration using nmcli , create the following configuration in /etc/polkit-1/localauthority/20-org.d/10-nm-harden-access.pkla :\n\n[Disable General User Access to NetworkManager]\nIdentity=default\nAction=org.freedesktop.NetworkManager.*\nResultAny=no\nResultInactive=no\nResultActive=auth_admin",
      "id": "xccdf_org.ssgproject.content_rule_network_nmcli_permissions",
      "instructions": "Using a non-privileged account, verify that users cannot modify or change\nnetwork settings with the nmcli command with the following command:\n$ nmcli general permissions\nThe output should contain the following:\nPERMISSION                                                        VALUE\norg.freedesktop.NetworkManager.enable-disable-network             auth\norg.freedesktop.NetworkManager.enable-disable-wifi                auth\norg.freedesktop.NetworkManager.enable-disable-wwan                auth\norg.freedesktop.NetworkManager.enable-disable-wimax               auth\norg.freedesktop.NetworkManager.sleep-wake                         auth\norg.freedesktop.NetworkManager.network-control                    auth\norg.freedesktop.NetworkManager.wifi.share.protected               auth\norg.freedesktop.NetworkManager.wifi.share.open                    auth\norg.freedesktop.NetworkManager.settings.modify.system             auth\norg.freedesktop.NetworkManager.settings.modify.own                auth\norg.freedesktop.NetworkManager.settings.modify.hostname           auth\norg.freedesktop.NetworkManager.settings.modify.global-dns         auth\norg.freedesktop.NetworkManager.reload                             auth\norg.freedesktop.NetworkManager.checkpoint-rollback                auth\norg.freedesktop.NetworkManager.enable-disable-statistics          auth\norg.freedesktop.NetworkManager.enable-disable-connectivity-check  auth\norg.freedesktop.NetworkManager.wifi.scan                          auth",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "network-nmcli-permissions",
          "control.compliance.openshift.io/NIST-800-53": "AC-18(4);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-18(4),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-network-nmcli-permissions",
        "namespace": "openshift-compliance",
        "resourceVersion": "78028",
        "uid": "9a65d4bb-5733-4ed3-a918-dcc83be3db52"
      },
      "rationale": "Allowing non-privileged users to make changes to network settings can allow untrusted access, prevent system availability, and/or can lead to a compromise or attack.",
      "severity": "medium",
      "title": "Prevent non-Privileged Users from Modifying Network Interfaces using nmcli"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The all_squash maps all uids and gids to an anonymous user. This should be disabled by removing any instances of the all_squash option from the file /etc/exports.",
      "id": "xccdf_org.ssgproject.content_rule_no_all_squash_exports",
      "instructions": "To verify all squashing has been disabled, run the following command:\n$ grep all_squash /etc/exports",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "no-all-squash-exports"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-all-squash-exports",
        "namespace": "openshift-compliance",
        "resourceVersion": "78459",
        "uid": "ed801669-c80a-4b89-9505-7393407eff47"
      },
      "rationale": "The all_squash option maps all client requests to a single anonymous uid/gid on the NFS server, negating the ability to track file access by user ID.",
      "severity": "low",
      "title": "Ensure All-Squashing Disabled On All Exports"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/securetty"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To further limit access to the root account, administrators can disable root logins at the console by editing the /etc/securetty file. This file lists all devices the root user is allowed to login to. If the file does not exist at all, the root user can login through any communication device on the system, whether via the console or via a raw network interface. This is dangerous as user can login to the system as root via Telnet, which sends the password in plain text over the network. By default, Red Hat Enterprise Linux CoreOS 4's /etc/securetty file only allows the root user to login at the console physically attached to the system. To prevent root from logging in, remove the contents of this file. To prevent direct root logins, remove the contents of this file by typing the following command:\n\n$ sudo echo > /etc/securetty",
      "id": "xccdf_org.ssgproject.content_rule_no_direct_root_logins",
      "instructions": "To ensure root may not directly login to the system over physical consoles,\nrun the following command:\ncat /etc/securetty\nIf any output is returned, this is a finding.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "no-direct-root-logins",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "IA-2;CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,IA-2,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-direct-root-logins",
        "namespace": "openshift-compliance",
        "resourceVersion": "76973",
        "uid": "c917827d-2243-4cbc-9636-620217a04d04"
      },
      "rationale": "Disabling direct root logins ensures proper accountability and multifactor authentication to privileged accounts. Users will first login, then escalate to privileged (root) access via su / sudo. This is required for FISMA Low and FISMA Moderate systems.",
      "severity": "medium",
      "title": "Direct root Logins Not Allowed",
      "warning": "Disabling direct root logins ensures proper accountability and multifactor authentication to privileged accounts. Users will first login, then escalate to privileged (root) access via su / sudo. This is required for FISMA Low and FISMA Moderate systems."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,%23%20Generated%20by%20authselect%20on%20Sat%20Oct%2027%2014%3A59%3A36%202018%0A%23%20Do%20not%20modify%20this%20file%20manually.%0A%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_env.so%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_faildelay.so%20delay%3D2000000%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_fprintd.so%0Aauth%20%20%20%20%20%20%20%20%5Bdefault%3D1%20ignore%3Dignore%20success%3Dok%5D%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3E%3D%201000%20quiet%0Aauth%20%20%20%20%20%20%20%20%5Bdefault%3D1%20ignore%3Dignore%20success%3Dok%5D%20%20%20%20%20%20%20%20%20pam_localuser.so%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%20try_first_pass%0Aauth%20%20%20%20%20%20%20%20requisite%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3E%3D%201000%20quiet_success%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%20forward_pass%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_deny.so%0A%0Aaccount%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%0Aaccount%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_localuser.so%0Aaccount%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3C%201000%20quiet%0Aaccount%20%20%20%20%20%5Bdefault%3Dbad%20success%3Dok%20user_unknown%3Dignore%5D%20pam_sss.so%0Aaccount%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_permit.so%0A%0Apassword%20%20%20%20requisite%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_pwquality.so%20try_first_pass%20local_users_only%0Apassword%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%20sha512%20shadow%20try_first_pass%20use_authtok%0Apassword%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%20use_authtok%0Apassword%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_deny.so%0A%0Asession%20%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_keyinit.so%20revoke%0Asession%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_limits.so%0A-session%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_systemd.so%0Asession%20%20%20%20%20%5Bsuccess%3D1%20default%3Dignore%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20service%20in%20crond%20quiet%20use_uid%0Asession%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%0Asession%20%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/pam.d/password-auth"
                    },
                    {
                      "contents": {
                        "source": "data:,%23%20Generated%20by%20authselect%20on%20Sat%20Oct%2027%2014%3A59%3A36%202018%0A%23%20Do%20not%20modify%20this%20file%20manually.%0A%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_env.so%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_faildelay.so%20delay%3D2000000%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_fprintd.so%0Aauth%20%20%20%20%20%20%20%20%5Bdefault%3D1%20ignore%3Dignore%20success%3Dok%5D%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3E%3D%201000%20quiet%0Aauth%20%20%20%20%20%20%20%20%5Bdefault%3D1%20ignore%3Dignore%20success%3Dok%5D%20%20%20%20%20%20%20%20%20pam_localuser.so%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%20try_first_pass%0Aauth%20%20%20%20%20%20%20%20requisite%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3E%3D%201000%20quiet_success%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%20forward_pass%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_deny.so%0A%0Aaccount%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%0Aaccount%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_localuser.so%0Aaccount%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3C%201000%20quiet%0Aaccount%20%20%20%20%20%5Bdefault%3Dbad%20success%3Dok%20user_unknown%3Dignore%5D%20pam_sss.so%0Aaccount%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_permit.so%0A%0Apassword%20%20%20%20requisite%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_pwquality.so%20try_first_pass%20local_users_only%0Apassword%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%20sha512%20shadow%20try_first_pass%20use_authtok%0Apassword%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%20use_authtok%0Apassword%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_deny.so%0A%0Asession%20%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_keyinit.so%20revoke%0Asession%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_limits.so%0A-session%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_systemd.so%0Asession%20%20%20%20%20%5Bsuccess%3D1%20default%3Dignore%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20service%20in%20crond%20quiet%20use_uid%0Asession%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%0Asession%20%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/pam.d/system-auth"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "If an account is configured for password authentication but does not have an assigned password, it may be possible to log into the account without authentication. Remove any instances of the nullok in /etc/pam.d/system-auth and /etc/pam.d/password-auth to prevent logins with empty passwords.",
      "id": "xccdf_org.ssgproject.content_rule_no_empty_passwords",
      "instructions": "To verify that null passwords cannot be used, run the following command:\n\n$ grep nullok /etc/pam.d/system-auth /etc/pam.d/password-auth\n\nIf this produces any output, it may be possible to log into accounts\nwith empty passwords. Remove any instances of the nullok option to\nprevent logins with empty passwords.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "no-empty-passwords",
          "control.compliance.openshift.io/NIST-800-53": "IA-5(1)(a);IA-5(c);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.2.3",
          "policies.open-cluster-management.io/controls": "IA-5(1)(a),IA-5(c),CM-6(a),Req-8.2.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-empty-passwords",
        "namespace": "openshift-compliance",
        "resourceVersion": "76936",
        "uid": "6cdf8c8e-9b6a-4596-a24a-c9703de0434e"
      },
      "rationale": "If an account has an empty password, anyone could log in and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments.",
      "severity": "high",
      "title": "Prevent Login to Accounts With Empty Password",
      "warning": "If an account has an empty password, anyone could log in and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Check the \"/etc/shadow\" file for blank passwords with the following command:\n\n$ sudo awk -F: '!$2 {print $1}' /etc/shadow\n\nIf the command returns any results, this is a finding. Configure all accounts on the system to have a password or lock the account with the following commands: Perform a password reset:\n\n$ sudo passwd [username]\n\nLock an account:\n\n$ sudo passwd -l [username]",
      "id": "xccdf_org.ssgproject.content_rule_no_empty_passwords_etc_shadow",
      "instructions": "To verify that null passwords cannot be used, run the following command:\n$ sudo awk -F: '!$2 {print $1}' /etc/shadow\nIf this produces any output, it may be possible to log into accounts\nwith empty passwords.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "no-empty-passwords-etc-shadow",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(b);CM-6.1(iv)",
          "policies.open-cluster-management.io/controls": "CM-6(b),CM-6.1(iv)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-empty-passwords-etc-shadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "76939",
        "uid": "33768843-b41e-454c-b526-a9e1c09abb0b"
      },
      "rationale": "If an account has an empty password, anyone could log in and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments.",
      "severity": "high",
      "title": "Ensure There Are No Accounts With Blank or Null Passwords",
      "warning": "If an account has an empty password, anyone could log in and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The + character in /etc/group file marks a place where entries from a network information service (NIS) should be directly inserted.",
      "id": "xccdf_org.ssgproject.content_rule_no_legacy_plus_entries_etc_group",
      "instructions": "To check for legacy lines in /etc/group, run the following command:\n grep '^\\+' /etc/group\nThe command should not return any output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "no-legacy-plus-entries-etc-group"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-legacy-plus-entries-etc-group",
        "namespace": "openshift-compliance",
        "resourceVersion": "76946",
        "uid": "3f2ee478-ca65-401f-9477-aaf3d85eea40"
      },
      "rationale": "Using this method to include entries into /etc/group is considered legacy and should be avoided. These entries may provide a way for an attacker to gain access to the system.",
      "severity": "medium",
      "title": "Ensure there are no legacy + NIS entries in /etc/group"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The + character in /etc/passwd file marks a place where entries from a network information service (NIS) should be directly inserted.",
      "id": "xccdf_org.ssgproject.content_rule_no_legacy_plus_entries_etc_passwd",
      "instructions": "To check for legacy lines in /etc/passwd, run the following command:\n grep '^\\+' /etc/passwd\nThe command should not return any output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "no-legacy-plus-entries-etc-passwd"
        },
        "creationTimestamp": "2024-03-05T15:02:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-legacy-plus-entries-etc-passwd",
        "namespace": "openshift-compliance",
        "resourceVersion": "76949",
        "uid": "c2bb44dc-d5a5-48b0-a055-b81c46921287"
      },
      "rationale": "Using this method to include entries into /etc/passwd is considered legacy and should be avoided. These entries may provide a way for an attacker to gain access to the system.",
      "severity": "medium",
      "title": "Ensure there are no legacy + NIS entries in /etc/passwd"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The + character in /etc/shadow file marks a place where entries from a network information service (NIS) should be directly inserted.",
      "id": "xccdf_org.ssgproject.content_rule_no_legacy_plus_entries_etc_shadow",
      "instructions": "To check for legacy lines in /etc/shadow, run the following command:\n grep '^\\+' /etc/shadow\nThe command should not return any output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "no-legacy-plus-entries-etc-shadow"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-legacy-plus-entries-etc-shadow",
        "namespace": "openshift-compliance",
        "resourceVersion": "76953",
        "uid": "ff72fdf3-f75c-4097-954e-46fcd56b2535"
      },
      "rationale": "Using this method to include entries into /etc/shadow is considered legacy and should be avoided. These entries may provide a way for an attacker to gain access to the system.",
      "severity": "medium",
      "title": "Ensure there are no legacy + NIS entries in /etc/shadow"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The.netrc files contain login information used to auto-login into FTP servers and reside in the user's home directory. These files may contain unencrypted passwords to remote FTP servers making them susceptible to access by unauthorized users and should not be used. Any.netrc files should be removed.",
      "id": "xccdf_org.ssgproject.content_rule_no_netrc_files",
      "instructions": "To check the system for the existence of any .netrc files,\nrun the following command:\n$ sudo find /home -xdev -name .netrc",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "no-netrc-files",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R1.3;CIP-003-8 R3;CIP-003-8 R3.1;CIP-003-8 R3.2;CIP-003-8 R3.3;CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "IA-5(h);IA-5(1)(c);CM-6(a);IA-5(7)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R1.3,CIP-003-8 R3,CIP-003-8 R3.1,CIP-003-8 R3.2,CIP-003-8 R3.3,CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,IA-5(h),IA-5(1)(c),CM-6(a),IA-5(7)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-netrc-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "76960",
        "uid": "f71967a8-6819-468f-83b7-f801fe3bbcce"
      },
      "rationale": "Unencrypted passwords for remote FTP servers may be stored in.netrc files.",
      "severity": "medium",
      "title": "Verify No netrc Files Exist"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The files /etc/hosts.equiv and ~/.rhosts (in each user's home directory) list remote hosts and users that are trusted by the local system when using the rshd daemon. To remove these files, run the following command to delete them from any location:\n\n$ sudo rm /etc/hosts.equiv\n\n$ rm ~/.rhosts",
      "id": "xccdf_org.ssgproject.content_rule_no_rsh_trust_files",
      "instructions": "The existence of the file /etc/hosts.equiv or a file named\n.rhosts inside a user home directory indicates the presence\nof an Rsh trust relationship.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "no-rsh-trust-files",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-rsh-trust-files",
        "namespace": "openshift-compliance",
        "resourceVersion": "78485",
        "uid": "e8890a4a-9b91-48cc-9486-8c7578a24a49"
      },
      "rationale": "This action is only meaningful if.rhosts support is permitted through PAM. Trust files are convenient, but when used in conjunction with the R-services, they can allow unauthenticated access to a system.",
      "severity": "high",
      "title": "Remove Rsh Trust Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Some accounts are not associated with a human user of the system, and exist to perform some administrative functions. Should an attacker be able to log into these accounts, they should not be granted access to a shell.\n\nThe login shell for each local account is stored in the last field of each line in /etc/passwd. System accounts are those user accounts with a user ID less than 1000. The user ID is stored in the third field. If any system account other than root has a login shell, disable it with the command:\n\n$ sudo usermod -s /sbin/nologin account",
      "id": "xccdf_org.ssgproject.content_rule_no_shelllogin_for_systemaccounts",
      "instructions": "To obtain a listing of all users, their UIDs, and their shells, run the command:\n$ awk -F: '{print $1 \":\" $3 \":\" $7}' /etc/passwd\nIdentify the system accounts from this listing. These will primarily be the accounts with UID\nnumbers less than 1000, other than root.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "no-shelllogin-for-systemaccounts",
          "control.compliance.openshift.io/NIST-800-53": "AC-6;CM-6(a);CM-6(b);CM-6.1(iv)",
          "policies.open-cluster-management.io/controls": "AC-6,CM-6(a),CM-6(b),CM-6.1(iv)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-shelllogin-for-systemaccounts",
        "namespace": "openshift-compliance",
        "resourceVersion": "76980",
        "uid": "10643ef6-2498-4862-baf6-3fccc9bb9454"
      },
      "rationale": "Ensuring shells are not given to system accounts upon login makes it more difficult for attackers to make use of system accounts.",
      "severity": "medium",
      "title": "Ensure that System Accounts Do Not Run a Shell Upon Login",
      "warning": "Ensuring shells are not given to system accounts upon login makes it more difficult for attackers to make use of system accounts."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,/bin/sh%0A/bin/bash%0A/usr/bin/sh%0A/usr/bin/bash%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/shells"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The tmux terminal multiplexer is used to implement automatic session locking. It should not be listed in /etc/shells.",
      "id": "xccdf_org.ssgproject.content_rule_no_tmux_in_shells",
      "instructions": "To verify that tmux is not listed as allowed shell on the system\nrun the following command:\n$ grep 'tmux$' /etc/shells\nThe output should be empty.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "no-tmux-in-shells",
          "control.compliance.openshift.io/NIST-800-53": "CM-6",
          "policies.open-cluster-management.io/controls": "CM-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-no-tmux-in-shells",
        "namespace": "openshift-compliance",
        "resourceVersion": "76888",
        "uid": "a0b41a0e-54b7-4ee5-9cc5-d41924a1f439"
      },
      "rationale": "Not listing tmux among permitted shells prevents malicious program running as user from lowering security by disabling the screen lock.",
      "severity": "low",
      "title": "Prevent user from disabling the screen lock"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Additional NTP servers can be specified for time synchronization in the file /etc/ntp.conf. To do so, add additional lines of the following form, substituting the IP address or hostname of a remote NTP server for ntpserver :\n\nserver ntpserver",
      "id": "xccdf_org.ssgproject.content_rule_ntpd_specify_multiple_servers",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "ntpd-specify-multiple-servers",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-8(1)(a);AU-8(2)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.3",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-8(1)(a),AU-8(2),Req-10.4.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-ntpd-specify-multiple-servers",
        "namespace": "openshift-compliance",
        "resourceVersion": "78482",
        "uid": "9da1498a-55c3-4f49-b1a2-ca79c140e14d"
      },
      "rationale": "Specifying additional NTP servers increases the availability of accurate time data, in the event that one of the specified servers becomes unavailable. This is typical for a system acting as an NTP server for other systems.",
      "severity": "unknown",
      "title": "Specify Additional Remote NTP Servers"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To specify a remote NTP server for time synchronization, edit the file /etc/ntp.conf. Add or correct the following lines, substituting the IP or hostname of a remote NTP server for ntpserver :\n\nserver ntpserver\n\nThis instructs the NTP software to contact that remote server to obtain time data.",
      "id": "xccdf_org.ssgproject.content_rule_ntpd_specify_remote_server",
      "instructions": "To verify that a remote NTP service is configured for time synchronization,\nopen the following file:\n/etc/ntp.conf\nIn the file, there should be a section similar to the following:\nserver ntpserver",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "ntpd-specify-remote-server",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-8(1)(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.1;Req-10.4.3",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-8(1)(a),Req-10.4.1,Req-10.4.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-ntpd-specify-remote-server",
        "namespace": "openshift-compliance",
        "resourceVersion": "78484",
        "uid": "31a9d58a-50eb-4522-ad48-d0a6fd7f1a96"
      },
      "rationale": "Synchronizing with an NTP server makes it possible to collate system logs from multiple sources or correlate computer events with real time events.",
      "severity": "medium",
      "title": "Specify a Remote NTP Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The 389-ds-base RPM is not installed by default on a Red Hat Enterprise Linux CoreOS 4 system. It is needed only by the 389-ds server, not by the clients which use LDAP for authentication. If the system is not intended for use as an LDAP Server it should be removed.",
      "id": "xccdf_org.ssgproject.content_rule_package_389-ds-base_removed",
      "instructions": "To verify the 389-ds-base package is not installed, run the\nfollowing command:\n$ rpm -q 389-ds-base\nThe output should show the following:\npackage 389-ds-base is not installed",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-389-ds-base-removed",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-389-ds-base-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78447",
        "uid": "1807489d-f899-4963-b173-0a6db39104bd"
      },
      "rationale": "Unnecessary packages should not be installed to decrease the attack surface of the system. While this software is clearly essential on an LDAP server, it is not necessary on typical desktop or workstation systems.",
      "severity": "low",
      "title": "Uninstall 389-ds-base Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The aide package can be installed with the following command:\n\n$ sudo dnf install aide",
      "id": "xccdf_org.ssgproject.content_rule_package_aide_installed",
      "instructions": "Run the following command to determine if the aide package is installed: $ rpm -q aide",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "package-aide-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-11.5",
          "policies.open-cluster-management.io/controls": "CM-6(a),Req-11.5",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-aide-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76534",
        "uid": "18597c24-3cd3-478d-adf0-beae1fd0d194"
      },
      "rationale": "The AIDE package must be installed if it is to be available for integrity checking.",
      "severity": "medium",
      "title": "Install AIDE"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The audispd-plugins package can be installed with the following command:\n\n$ sudo dnf install audispd-plugins",
      "id": "xccdf_org.ssgproject.content_rule_package_audispd-plugins_installed",
      "instructions": "Run the following command to determine if the audispd-plugins package is installed: $ rpm -q audispd-plugins",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-audispd-plugins-installed"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-audispd-plugins-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "77063",
        "uid": "858e6975-ea92-4e28-a4b3-651861cd6010"
      },
      "rationale": "audispd-plugins provides plugins for the real-time interface to the audit subsystem, audispd. These plugins can do things like relay events to remote machines or analyze events for suspicious behavior.",
      "severity": "medium",
      "title": "Install audispd-plugins Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The audit package should be installed.",
      "id": "xccdf_org.ssgproject.content_rule_package_audit_installed",
      "instructions": "Run the following command to determine if the audit package is installed: $ rpm -q audit",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "package-audit-installed",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AC-7(a);AU-7(1);AU-7(2);AU-14;AU-12(2);AU-2(a);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.1",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R3.3,CIP-007-3 R6.5,AC-7(a),AU-7(1),AU-7(2),AU-14,AU-12(2),AU-2(a),CM-6(a),Req-10.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-audit-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "77066",
        "uid": "558095d2-1d7a-4118-a3c8-e0ac2da951cf"
      },
      "rationale": "The auditd service is an access monitoring and accounting daemon, watching system calls to audit any access, in comparison with potential local access control policy such as SELinux policy.",
      "severity": "medium",
      "title": "Ensure the audit Subsystem is Installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The named service is provided by the bind package. The bind package can be removed with the following command:\n\n$ sudo dnf erase bind",
      "id": "xccdf_org.ssgproject.content_rule_package_bind_removed",
      "instructions": "Run the following command to determine if the bind package is installed:\n$ rpm -q bind",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-bind-removed",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-bind-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78439",
        "uid": "7b5c99c6-0939-41d3-ba45-c997c873db6a"
      },
      "rationale": "If there is no need to make DNS server software available, removing it provides a safeguard against its activation.",
      "severity": "low",
      "title": "Uninstall bind Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System time should be synchronized between all systems in an environment. This is typically done by establishing an authoritative time server or set of servers and having all systems synchronize their clocks to them. The chrony package can be installed with the following command:\n\n$ sudo dnf install chrony",
      "id": "xccdf_org.ssgproject.content_rule_package_chrony_installed",
      "instructions": "Run the following command to determine if the chrony package is installed: $ rpm -q chrony",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "package-chrony-installed",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4",
          "policies.open-cluster-management.io/controls": "Req-10.4",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-chrony-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78460",
        "uid": "40506a26-71d2-4680-abbd-7a37abf7ffa4"
      },
      "rationale": "Time synchronization is important to support time sensitive security mechanisms like Kerberos and also ensures log files have consistent time records across the enterprise, which aids in forensic investigations.",
      "severity": "medium",
      "title": "The Chrony package is installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The Cron service should be installed.",
      "id": "xccdf_org.ssgproject.content_rule_package_cron_installed",
      "instructions": "Run the following command to determine if the cron package is installed:\n$ rpm -q cron",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-cron-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-cron-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78424",
        "uid": "6861d729-3414-4087-a97d-a389ec5d33d9"
      },
      "rationale": "The cron service allow periodic job execution, needed for almost all administrative tasks and services (software update, log rotating, etc.). Access to cron service should be restricted to administrative accounts only.",
      "severity": "medium",
      "title": "Install the cron service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable FIPS on system that support the Advanced Encryption Standard (AES) or New Instructions (AES-NI) engine, the system requires that the dracut-fips-aesni package be installed. The dracut-fips-aesni package can be installed with the following command:\n\n$ sudo dnf install dracut-fips-aesni",
      "id": "xccdf_org.ssgproject.content_rule_package_dracut-fips-aesni_installed",
      "instructions": "Run the following command to determine if the dracut-fips-aesni package is installed: $ rpm -q dracut-fips-aesni",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "package-dracut-fips-aesni-installed",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-12(2);SC-12(3);IA-7;SC-13;CM-6(a);SC-12",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-12(2),SC-12(3),IA-7,SC-13,CM-6(a),SC-12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-dracut-fips-aesni-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76568",
        "uid": "2f906f16-d1e5-48ae-baa2-8cedee4ddfd1"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "medium",
      "title": "Install the dracut-fips-aesni Package",
      "warning": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable FIPS, the system requires that the dracut-fips package be installed. The dracut-fips package can be installed with the following command:\n\n$ sudo dnf install dracut-fips",
      "id": "xccdf_org.ssgproject.content_rule_package_dracut-fips_installed",
      "instructions": "Run the following command to determine if the dracut-fips package is installed: $ rpm -q dracut-fips",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-dracut-fips-installed",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-12(2);SC-12(3);IA-7;SC-13;CM-6(a);SC-12",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-12(2),SC-12(3),IA-7,SC-13,CM-6(a),SC-12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-dracut-fips-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76556",
        "uid": "80bbdef6-7fe0-409a-aa7e-d1ed34fc31ba"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "medium",
      "title": "Install the dracut-fips Package",
      "warning": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The fapolicyd package can be installed with the following command:\n\n$ sudo dnf install fapolicyd",
      "id": "xccdf_org.ssgproject.content_rule_package_fapolicyd_installed",
      "instructions": "Run the following command to determine if the fapolicyd package is installed: $ rpm -q fapolicyd",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-fapolicyd-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);SI-4(22)",
          "policies.open-cluster-management.io/controls": "CM-6(a),SI-4(22)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-fapolicyd-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78441",
        "uid": "4fe3513c-0e44-432c-92ed-d2761e85e536"
      },
      "rationale": "fapolicyd (File Access Policy Daemon) implements application whitelisting to decide file access rights.",
      "severity": "medium",
      "title": "Install fapolicyd Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The firewalld package can be installed with the following command:\n\n$ sudo dnf install firewalld",
      "id": "xccdf_org.ssgproject.content_rule_package_firewalld_installed",
      "instructions": "Run the following command to determine if the firewalld package is installed: $ rpm -q firewalld",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-firewalld-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-firewalld-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78030",
        "uid": "ff141934-0936-413d-a50c-c5823545c73a"
      },
      "rationale": "\"Firewalld\" provides an easy and effective way to block/limit remote access to the system via ports, services, and protocols. Remote access services, such as those providing remote access to network devices and information systems, which lack automated control capabilities, increase risk and make remote user access management difficult at best. Remote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. Red Hat Enterprise Linux CoreOS 4 functionality (e.g., SSH) must be capable of taking enforcement action if the audit reveals unauthorized activity. Automated control of remote access sessions allows organizations to ensure ongoing compliance with remote access policies by enforcing connection rules of remote access applications on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).\"",
      "severity": "medium",
      "title": "Install firewalld Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The gnutls-utils package can be installed with the following command:\n\n$ sudo dnf install gnutls-utils",
      "id": "xccdf_org.ssgproject.content_rule_package_gnutls-utils_installed",
      "instructions": "Run the following command to determine if the gnutls-utils package is installed: $ rpm -q gnutls-utils",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-gnutls-utils-installed"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-gnutls-utils-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76747",
        "uid": "88975946-90d9-4975-8365-03e9e3976579"
      },
      "rationale": "GnuTLS is a secure communications library implementing the SSL, TLS and DTLS protocols and technologies around them. It provides a simple C language application programming interface (API) to access the secure communications protocols as well as APIs to parse and write X.509, PKCS #12, OpenPGP and other required structures. This package contains command line TLS client and server and certificate manipulation tools.",
      "severity": "medium",
      "title": "Ensure gnutls-utils is installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The inet-based telnet daemon should be uninstalled.",
      "id": "xccdf_org.ssgproject.content_rule_package_inetutils-telnetd_removed",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-inetutils-telnetd-removed",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-inetutils-telnetd-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78429",
        "uid": "efeb4c92-af88-4900-8b6a-da4a7ebd4e45"
      },
      "rationale": "telnet allows clear text communications, and does not protect any data transmission between client and server. Any confidential data can be listened and no integrity checking is made.",
      "severity": "high",
      "title": "Uninstall the inet-based telnet server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The iptables package can be installed with the following command:\n\n$ sudo dnf install iptables",
      "id": "xccdf_org.ssgproject.content_rule_package_iptables_installed",
      "instructions": "Run the following command to determine if the iptables package is installed: $ rpm -q iptables",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "package-iptables-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.4.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),Req-1.4.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-iptables-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78067",
        "uid": "64e93e54-45bc-41f5-8c0b-48869d855b41"
      },
      "rationale": "iptables controls the Linux kernel network packet filtering code. iptables allows system operators to set up firewalls and IP masquerading, etc.",
      "severity": "medium",
      "title": "Install iptables Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The iptables-nft package can be installed with the following command:\n\n$ sudo dnf install iptables-nft",
      "id": "xccdf_org.ssgproject.content_rule_package_iptables-nft_installed",
      "instructions": "Run the following command to determine if the iptables-nft package is installed: $ rpm -q iptables-nft",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "package-iptables-nft-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:57Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-iptables-nft-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78065",
        "uid": "2015b6e9-a168-4997-b588-f0fd62e8e510"
      },
      "rationale": "iptables-nft controls the Linux kernel network packet filtering code. iptables-nft allows system operators to set up firewalls and IP masquerading, etc.",
      "severity": "medium",
      "title": "Install iptables-nft Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The libreswan package provides an implementation of IPsec and IKE, which permits the creation of secure tunnels over untrusted networks. The libreswan package can be installed with the following command:\n\n$ sudo dnf install libreswan",
      "id": "xccdf_org.ssgproject.content_rule_package_libreswan_installed",
      "instructions": "Run the following command to determine if the libreswan package is installed: $ rpm -q libreswan",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-libreswan-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-4.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),Req-4.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-libreswan-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78039",
        "uid": "6cc0cf37-618c-439f-bcec-cb5ea7ca6f9e"
      },
      "rationale": "Providing the ability for remote users or systems to initiate a secure VPN connection protects information when it is transmitted over a wide area network.",
      "severity": "medium",
      "title": "Install libreswan Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The libselinux package can be installed with the following command:\n\n$ sudo dnf install libselinux",
      "id": "xccdf_org.ssgproject.content_rule_package_libselinux_installed",
      "instructions": "Run the following command to determine if the libselinux package is installed: $ rpm -q libselinux",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-libselinux-installed"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-libselinux-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78398",
        "uid": "7d8dc4d4-9c3e-45f6-b85c-341be76de512"
      },
      "rationale": "Security-enhanced Linux is a feature of the Linux kernel and a number of utilities with enhanced security functionality designed to add mandatory access controls to Linux. The libselinux package contains the core library of the Security-enhanced Linux system.",
      "severity": "high",
      "title": "Install libselinux Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "logrotate is installed by default. The logrotate package can be installed with the following command:\n\n$ sudo dnf install logrotate",
      "id": "xccdf_org.ssgproject.content_rule_package_logrotate_installed",
      "instructions": "Run the following command to determine if the logrotate package is installed: $ rpm -q logrotate",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "package-logrotate-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-logrotate-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78005",
        "uid": "db6cffd6-68eb-46ae-ac3b-d330f418423c"
      },
      "rationale": "The logrotate package provides the logrotate services.",
      "severity": "medium",
      "title": "Ensure logrotate is Installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Install the McAfee Host Intrusion Prevention System (HIPS) Module if it is absolutely necessary. If SELinux is enabled, do not install or enable this module.",
      "id": "xccdf_org.ssgproject.content_rule_package_MFEhiplsm_installed",
      "instructions": "To verify that McAfee HIPS is installed, run the following command(s):\n$ rpm -q MFEhiplsm",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-mfehiplsm-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-11.4",
          "policies.open-cluster-management.io/controls": "CM-6(a),Req-11.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-mfehiplsm-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76630",
        "uid": "136278b1-e8d8-4183-9247-2943636f7ac6"
      },
      "rationale": "Without a host-based intrusion detection tool, there is no system-level defense when an intruder gains access to a system or network. Additionally, a host-based intrusion prevention tool can provide methods to immediately lock out detected intrusion attempts.",
      "severity": "medium",
      "title": "Install the Host Intrusion Prevention System (HIPS) Module",
      "warning": "Without a host-based intrusion detection tool, there is no system-level defense when an intruder gains access to a system or network. Additionally, a host-based intrusion prevention tool can provide methods to immediately lock out detected intrusion attempts."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The net-snmp package provides the snmpd service. The net-snmp package can be removed with the following command:\n\n$ sudo dnf erase net-snmp",
      "id": "xccdf_org.ssgproject.content_rule_package_net-snmp_removed",
      "instructions": "Run the following command to determine if the net-snmp package is installed:\n$ rpm -q net-snmp",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-net-snmp-removed"
        },
        "creationTimestamp": "2024-03-05T15:03:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-net-snmp-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78489",
        "uid": "1940f8a8-eb7e-4206-a1c7-c4d29035af61"
      },
      "rationale": "If there is no need to run SNMP server software, removing the package provides a safeguard against its activation.",
      "severity": "unknown",
      "title": "Uninstall net-snmp Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The support for Yellowpages should not be installed unless it is required.",
      "id": "xccdf_org.ssgproject.content_rule_package_nis_removed",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-nis-removed"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-nis-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78430",
        "uid": "1b2eb847-0e90-44d4-b47f-4a62a03b7ab5"
      },
      "rationale": "NIS is the historical SUN service for central account management, more and more replaced by LDAP. NIS does not support efficiently security constraints, ACL, etc. and should not be used.",
      "severity": "low",
      "title": "Uninstall the nis package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The nss-tools package can be installed with the following command:\n\n$ sudo dnf install nss-tools",
      "id": "xccdf_org.ssgproject.content_rule_package_nss-tools_installed",
      "instructions": "Run the following command to determine if the nss-tools package is installed: $ rpm -q nss-tools",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-nss-tools-installed"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-nss-tools-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76752",
        "uid": "401b733a-1faf-4bb3-82e7-8b6eda94595b"
      },
      "rationale": "Network Security Services (NSS) is a set of libraries designed to support cross-platform development of security-enabled client and server applications. Install the nss-tools package to install command-line tools to manipulate the NSS certificate and key database.",
      "severity": "medium",
      "title": "Ensure nss-tools is installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The ntpd service should be installed.",
      "id": "xccdf_org.ssgproject.content_rule_package_ntp_installed",
      "instructions": "Run the following command to determine if the ntp package is installed: $ rpm -q ntp",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-ntp-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4",
          "policies.open-cluster-management.io/controls": "CM-6(a),Req-10.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-ntp-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78461",
        "uid": "74bf314a-21ee-4777-9a23-315ef66ceb38"
      },
      "rationale": "Time synchronization (using NTP) is required by almost all network and administrative tasks (syslog, cryptographic based services (authentication, etc.), etc.). Ntpd is regulary maintained and updated, supporting security features such as RFC 5906.",
      "severity": "high",
      "title": "Install the ntp service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "ntpdate is a historical ntp synchronization client for unixes. It sould be uninstalled.",
      "id": "xccdf_org.ssgproject.content_rule_package_ntpdate_removed",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-ntpdate-removed"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-ntpdate-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78431",
        "uid": "ffd06934-1992-4109-b9f6-e2dc6f25360f"
      },
      "rationale": "ntpdate is an old not security-compliant ntp client. It should be replaced by modern ntp clients such as ntpd, able to use cryptographic mechanisms integrated in NTP.",
      "severity": "low",
      "title": "Uninstall the ntpdate package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The Lightweight Directory Access Protocol (LDAP) is a service that provides a method for looking up information from a central database. The openldap-clients package can be removed with the following command:\n\n$ sudo dnf erase openldap-clients",
      "id": "xccdf_org.ssgproject.content_rule_package_openldap-clients_removed",
      "instructions": "Run the following command to determine if the openldap-clients package is installed:\n$ rpm -q openldap-clients",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-openldap-clients-removed"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-openldap-clients-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78448",
        "uid": "b516c2f6-bab9-4c28-a02f-297c2dc8c31f"
      },
      "rationale": "If the system does not need to act as an LDAP client, it is recommended that the software is removed to reduce the potential attack surface.",
      "severity": "low",
      "title": "Ensure LDAP client is not installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The openssh-server package should be installed. The openssh-server package can be installed with the following command:\n\n$ sudo dnf install openssh-server",
      "id": "xccdf_org.ssgproject.content_rule_package_openssh-server_installed",
      "instructions": "Run the following command to determine if the openssh-server package is installed: $ rpm -q openssh-server",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-openssh-server-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-openssh-server-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78490",
        "uid": "0dfd9f87-c9f7-41cb-829b-2e6f702bfbe6"
      },
      "rationale": "Without protection of the transmitted information, confidentiality, and integrity may be compromised because unprotected communications can be intercepted and either read or altered.",
      "severity": "medium",
      "title": "Install the OpenSSH Server Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The openssh-server package should be removed. The openssh-server package can be removed with the following command:\n\n$ sudo dnf erase openssh-server",
      "id": "xccdf_org.ssgproject.content_rule_package_openssh-server_removed",
      "instructions": "Run the following command to determine if the openssh-server package is installed: $ rpm -q openssh-server",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-openssh-server-removed"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-openssh-server-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78493",
        "uid": "4cce3b4f-451d-4e3a-9b81-08a05133e2f7"
      },
      "rationale": "Without protection of the transmitted information, confidentiality, and integrity may be compromised because unprotected communications can be intercepted and either read or altered.",
      "severity": "medium",
      "title": "Remove the OpenSSH Server Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "A mail server is required for sending emails. The postfix package can be installed with the following command:\n\n$ sudo dnf install postfix",
      "id": "xccdf_org.ssgproject.content_rule_package_postfix_installed",
      "instructions": "Run the following command to determine if the postfix package is installed: $ rpm -q postfix",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-postfix-installed"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-postfix-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78449",
        "uid": "4d4e9175-7e3f-4a86-a671-9fc4fa81b7bd"
      },
      "rationale": "Emails can be used to notify designated personnel about important system events such as failures or warnings.",
      "severity": "medium",
      "title": "The Postfix package is installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Rsyslog is installed by default. The rsyslog package can be installed with the following command:\n\n$ sudo dnf install rsyslog",
      "id": "xccdf_org.ssgproject.content_rule_package_rsyslog_installed",
      "instructions": "Run the following command to determine if the rsyslog package is installed: $ rpm -q rsyslog",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-rsyslog-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-rsyslog-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "77972",
        "uid": "b676b2cb-2c49-4459-bbcf-9f08dd481a60"
      },
      "rationale": "The rsyslog package provides the rsyslog daemon, which provides system logging services.",
      "severity": "medium",
      "title": "Ensure rsyslog is Installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The samba-common package should be installed. The samba-common package can be installed with the following command:\n\n$ sudo dnf install samba-common",
      "id": "xccdf_org.ssgproject.content_rule_package_samba-common_installed",
      "instructions": "Run the following command to determine if the samba-common package is installed: $ rpm -q samba-common",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-samba-common-installed"
        },
        "creationTimestamp": "2024-03-05T15:03:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-samba-common-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78487",
        "uid": "9dd14b60-00f6-49c8-ae4b-1b25247d152c"
      },
      "rationale": "If the samba-common package is not installed, samba cannot be configured.",
      "severity": "medium",
      "title": "Install the Samba Common Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Sendmail is not the default mail transfer agent and is not installed by default. The sendmail package can be removed with the following command:\n\n$ sudo dnf erase sendmail",
      "id": "xccdf_org.ssgproject.content_rule_package_sendmail_removed",
      "instructions": "Run the following command to determine if the sendmail package is installed:\n$ rpm -q sendmail",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-minimal,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "package-sendmail-removed",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-sendmail-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78450",
        "uid": "c26746a0-a887-4d1d-ad44-9e7b0e3e11ac"
      },
      "rationale": "The sendmail software was not developed with security in mind and its design prevents it from being effectively contained by SELinux. Postfix should be used instead.",
      "severity": "medium",
      "title": "Uninstall Sendmail Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The SETroubleshoot plugins are used to analyze SELinux AVC data. The service provides information around configuration errors, unauthorized intrusions, and other potential errors. The setroubleshoot-plugins package can be removed with the following command:\n\n$ sudo dnf erase setroubleshoot-plugins",
      "id": "xccdf_org.ssgproject.content_rule_package_setroubleshoot-plugins_removed",
      "instructions": "Run the following command to determine if the setroubleshoot-plugins package is installed:\n$ rpm -q setroubleshoot-plugins",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "package-setroubleshoot-plugins-removed"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-setroubleshoot-plugins-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78399",
        "uid": "2b6c939d-10d3-4cb3-81c9-318226cd367d"
      },
      "rationale": "The SETroubleshoot service is an unnecessary daemon to have running on a server.",
      "severity": "low",
      "title": "Uninstall setroubleshoot-plugins Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The SETroubleshoot service notifies desktop users of SELinux denials. The service provides information around configuration errors, unauthorized intrusions, and other potential errors. The setroubleshoot-server package can be removed with the following command:\n\n$ sudo dnf erase setroubleshoot-server",
      "id": "xccdf_org.ssgproject.content_rule_package_setroubleshoot-server_removed",
      "instructions": "Run the following command to determine if the setroubleshoot-server package is installed:\n$ rpm -q setroubleshoot-server",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "package-setroubleshoot-server-removed"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-setroubleshoot-server-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78400",
        "uid": "d1f2ac49-a250-44e8-ac0f-bbe4655ae589"
      },
      "rationale": "The SETroubleshoot service is an unnecessary daemon to have running on a server.",
      "severity": "low",
      "title": "Uninstall setroubleshoot-server Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The sudo package can be installed with the following command:\n\n$ sudo dnf install sudo",
      "id": "xccdf_org.ssgproject.content_rule_package_sudo_installed",
      "instructions": "Run the following command to determine if the sudo package is installed: $ rpm -q sudo",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "package-sudo-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-sudo-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76663",
        "uid": "2de959bb-69ae-43f4-85b1-9b49fe94cbc4"
      },
      "rationale": "sudo is a program designed to allow a system administrator to give limited root privileges to users and log root activity. The basic philosophy is to give as few privileges as possible but still allow system users to get their work done.",
      "severity": "medium",
      "title": "Install sudo Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "syslog-ng can be installed in replacement of rsyslog. The syslog-ng-core package can be installed with the following command:\n\n$ sudo dnf install syslog-ng-core",
      "id": "xccdf_org.ssgproject.content_rule_package_syslogng_installed",
      "instructions": "Run the following command to determine if the syslog-ng-core package is installed: $ rpm -q syslog-ng-core",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-syslogng-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-syslogng-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78015",
        "uid": "e4c93d30-7c65-49bc-a780-7cade5c60bb1"
      },
      "rationale": "The syslog-ng-core package provides the syslog-ng daemon, which provides system logging services.",
      "severity": "medium",
      "title": "Ensure syslog-ng is Installed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The telnet daemon should be uninstalled.",
      "id": "xccdf_org.ssgproject.content_rule_package_telnetd_removed",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-telnetd-removed",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-telnetd-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78434",
        "uid": "e08fecdc-68d8-4874-92cf-43ff5223839f"
      },
      "rationale": "telnet allows clear text communications, and does not protect any data transmission between client and server. Any confidential data can be listened and no integrity checking is made.'",
      "severity": "high",
      "title": "Uninstall the telnet server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The telnet daemon, even with ssl support, should be uninstalled.",
      "id": "xccdf_org.ssgproject.content_rule_package_telnetd-ssl_removed",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-telnetd-ssl-removed",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-telnetd-ssl-removed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78433",
        "uid": "0c57223a-ac78-4d8b-8a37-1e81b9f195e8"
      },
      "rationale": "telnet , even with ssl support, should not be installed. When remote shell is required, up-to-date ssh daemon can be used.",
      "severity": "high",
      "title": "Uninstall the ssl compliant telnet server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable console screen locking, install the tmux package. A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence. The session lock is implemented at the point where session activity can be determined. Rather than be forced to wait for a period of time to expire before the user session can be locked, Red Hat Enterprise Linux CoreOS 4 needs to provide users with the ability to manually invoke a session lock so users can secure their session if it is necessary to temporarily vacate the immediate physical vicinity. Instruct users to begin new terminal sessions with the following command:\n\n$ tmux\n\nThe console can now be locked with the following key combination:\n\nctrl+b :lock-session",
      "id": "xccdf_org.ssgproject.content_rule_package_tmux_installed",
      "instructions": "Run the following command to determine if the tmux package is installed: $ rpm -q tmux",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "package-tmux-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-tmux-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "76868",
        "uid": "dab5a674-f4a7-42e6-8cd5-7c53326ed69b"
      },
      "rationale": "A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not logout because of the temporary nature of the absence. Rather than relying on the user to manually lock their operation system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.\n\nThe tmux package allows for a session lock to be implemented and configured.",
      "severity": "medium",
      "title": "Install the tmux Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                }
              },
              "extensions": [
                "usbguard"
              ]
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The usbguard package can be installed with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-usbguard-install\nspec:\n config:\n   ignition:\n     version: 3.1.0\n extensions:\n   - usbguard\n\nThis will install the usbguard package in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_package_usbguard_installed",
      "instructions": "Run the following command to determine if the usbguard package is installed: $ rpm -q usbguard",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-stig-v1r1",
          "compliance.openshift.io/rule": "package-usbguard-installed",
          "control.compliance.openshift.io/NIST-800-53": "CM-8(3);IA-3",
          "policies.open-cluster-management.io/controls": "CM-8(3),IA-3",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-package-usbguard-installed",
        "namespace": "openshift-compliance",
        "resourceVersion": "78577",
        "uid": "f0b8869e-e3e5-4a72-8dca-06e57b06280e"
      },
      "rationale": "usbguard is a software framework that helps to protect against rogue USB devices by implementing basic whitelisting/blacklisting capabilities based on USB device attributes.",
      "severity": "medium",
      "title": "Install usbguard Package"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The /dev/shm is a traditional shared memory concept. One program will create a memory portion, which other processes (if permitted) can access. If /dev/shm is not configured, tmpfs will be mounted to /dev/shm by systemd.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_dev_shm",
      "instructions": "You'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,Verify that a separate file system/partition has been created for /dev/shm with the following command:\n\n$ mountpoint /dev/shm",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "partition-for-dev-shm"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-partition-for-dev-shm",
        "namespace": "openshift-compliance",
        "resourceVersion": "76626",
        "uid": "f68b247f-f2f4-4f92-8bf6-9fdee7d0c17b"
      },
      "rationale": "Any user can upload and execute files inside the /dev/shm similar to the /tmp partition. Configuring /dev/shm allows an administrator to set the noexec option on the mount, making /dev/shm useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the hardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw.",
      "severity": "low",
      "title": "Ensure /dev/shm is configured",
      "warning": "Any user can upload and execute files inside the /dev/shm similar to the /tmp partition. Configuring /dev/shm allows an administrator to set the noexec option on the mount, making /dev/shm useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the hardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "If user home directories will be stored locally, create a separate partition for /home at installation time (or migrate it later using LVM). If /home will be mounted from another system such as an NFS server, then creating a separate partition is not necessary at installation time, and the mountpoint can instead be configured later.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_home",
      "instructions": "You'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,Verify that a separate file system/partition has been created for /home with the following command:\n\n$ mountpoint /home",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "partition-for-home",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);SC-5(2)",
          "policies.open-cluster-management.io/controls": "CM-6(a),SC-5(2)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-partition-for-home",
        "namespace": "openshift-compliance",
        "resourceVersion": "76627",
        "uid": "4c7ba93e-6815-4d10-8b73-dfd382360b65"
      },
      "rationale": "Ensuring that /home is mounted on its own partition enables the setting of more restrictive mount options, and also helps ensure that users cannot trivially fill partitions used for log or audit data storage.",
      "severity": "low",
      "title": "Ensure /home Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "If a file server (FTP, TFTP...) is hosted locally, create a separate partition for /srv at installation time (or migrate it later using LVM). If /srv will be mounted from another system such as an NFS server, then creating a separate partition is not necessary at installation time, and the mountpoint can instead be configured later.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_srv",
      "instructions": "You'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,Verify that a separate file system/partition has been created for /srv with the following command:\n\n$ mountpoint /srv",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "partition-for-srv"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-partition-for-srv",
        "namespace": "openshift-compliance",
        "resourceVersion": "76632",
        "uid": "0c9e74ec-eb71-4b10-b225-7d6bcb7852e9"
      },
      "rationale": "Srv deserves files for local network file server such as FTP. Ensuring that /srv is mounted on its own partition enables the setting of more restrictive mount options, and also helps ensure that users cannot trivially fill partitions used for log or audit data storage.",
      "severity": "unknown",
      "title": "Ensure /srv Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The /tmp directory is a world-writable directory used for temporary file storage. Ensure it has its own partition or logical volume at installation time, or migrate it using LVM.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_tmp",
      "instructions": "You'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,Verify that a separate file system/partition has been created for /tmp with the following command:\n\n$ mountpoint /tmp",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "partition-for-tmp",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);SC-5(2)",
          "policies.open-cluster-management.io/controls": "CM-6(a),SC-5(2)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-partition-for-tmp",
        "namespace": "openshift-compliance",
        "resourceVersion": "76642",
        "uid": "c19f6181-1f84-47b8-81bc-29563984381a"
      },
      "rationale": "The /tmp partition is used as temporary storage by many programs. Placing /tmp in its own partition enables the setting of more restrictive mount options, which can help protect programs which use it.",
      "severity": "low",
      "title": "Ensure /tmp Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The /var directory is used by daemons and other system services to store frequently-changing data. Ensure that /var has its own partition or logical volume at installation time, or migrate it using LVM.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_var",
      "instructions": "You'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,Verify that a separate file system/partition has been created for /var with the following command:\n\n$ mountpoint /var",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "partition-for-var",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);SC-5(2)",
          "policies.open-cluster-management.io/controls": "CM-6(a),SC-5(2)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-partition-for-var",
        "namespace": "openshift-compliance",
        "resourceVersion": "76639",
        "uid": "bfb288ec-dd6a-44db-8b1c-b283ac1afe1c"
      },
      "rationale": "Ensuring that /var is mounted on its own partition enables the setting of more restrictive mount options. This helps protect system services such as daemons or other programs which use it. It is not uncommon for the /var directory to contain world-writable directories installed by other software packages.",
      "severity": "low",
      "title": "Ensure /var Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "System logs are stored in the /var/log directory.\n\nPartitioning Red Hat CoreOS is a Day 1 operation and cannot be changed afterwards. For documentation on how to add a MachineConfig manifest that specifies a separate /var/log partition, follow: https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic\n\nNote that the Red Hat OpenShift documentation often references a block device, such as /dev/vda. The name of the available block devices depends on the underlying infrastructure (bare metal vs cloud), and often the specific instance type. For example in AWS, some instance types have NVMe drives ( /dev/nvme* ), others use /dev/xvda*. You will need to look for relevant documentation for your infrastructure around this. In many cases, the simplest thing is to boot a single machine with an Ignition configuration that just gives you SSH access, and inspect the block devices via e.g. the lsblk command. For physical hardware, a good best practice is to reference devices via the /dev/disk/by-id/ or /dev/disk/by-path links.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_var_log",
      "instructions": "You'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,Verify that a separate file system/partition has been created for /var/log with the following command:\n\n$ mountpoint /var/log",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-moderate",
          "compliance.openshift.io/rule": "partition-for-var-log",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-4;SC-5(2)",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R6.5,CM-6(a),AU-4,SC-5(2)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-partition-for-var-log",
        "namespace": "openshift-compliance",
        "resourceVersion": "76652",
        "uid": "16379b0e-7274-46c0-a64b-0221035c1d5c"
      },
      "rationale": "Placing /var/log in its own partition enables better separation between log files and other files in /var/.",
      "severity": "low",
      "title": "Ensure /var/log Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Audit logs are stored in the /var/log/audit directory.\n\nPartitioning Red Hat CoreOS is a Day 1 operation and cannot be changed afterwards. For documentation on how to add a MachineConfig manifest that specifies a separate /var/log/audit partition, follow: https://docs.openshift.com/container-platform/latest/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-user-infra-machines-advanced_disk_installing-platform-agnostic\n\nNote that the Red Hat OpenShift documentation often references a block device, such as /dev/vda. The name of the available block devices depends on the underlying infrastructure (bare metal vs cloud), and often the specific instance type. For example in AWS, some instance types have NVMe drives ( /dev/nvme* ), others use /dev/xvda*. You will need to look for relevant documentation for your infrastructure around this. In many cases, the simplest thing is to boot a single machine with an Ignition configuration that just gives you SSH access, and inspect the block devices via e.g. the lsblk command. For physical hardware, a good best practice is to reference devices via the /dev/disk/by-id/ or /dev/disk/by-path links.\n\nMake absolutely certain that it is large enough to store all audit logs that will be created by the auditing daemon.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_var_log_audit",
      "instructions": "You'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,Verify that a separate file system/partition has been created for /var/log/audit with the following command:\n\n$ mountpoint /var/log/audit",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-nerc-cip,rhcos4-moderate-rev-4,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "partition-for-var-log-audit",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-4;SC-5(2)",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R6.5,CM-6(a),AU-4,SC-5(2)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-partition-for-var-log-audit",
        "namespace": "openshift-compliance",
        "resourceVersion": "76662",
        "uid": "3c529bbf-2e5a-4d9b-8536-e77b34409684"
      },
      "rationale": "Placing /var/log/audit in its own partition enables better separation between audit files and other files, and helps ensure that auditing cannot be halted due to the partition running out of space.",
      "severity": "low",
      "title": "Ensure /var/log/audit Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The /var/tmp directory is a world-writable directory used for temporary file storage. Ensure it has its own partition or logical volume at installation time, or migrate it using LVM.",
      "id": "xccdf_org.ssgproject.content_rule_partition_for_var_tmp",
      "instructions": "You'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,Verify that a separate file system/partition has been created for /var/tmp with the following command:\n\n$ mountpoint /var/tmp",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "partition-for-var-tmp"
        },
        "creationTimestamp": "2024-03-05T15:02:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-partition-for-var-tmp",
        "namespace": "openshift-compliance",
        "resourceVersion": "76659",
        "uid": "ae517b3d-9d33-4b25-9c1b-e8e4e903a4b9"
      },
      "rationale": "The /var/tmp partition is used as temporary storage by many programs. Placing /var/tmp in its own partition enables the setting of more restrictive mount options, which can help protect programs which use it.",
      "severity": "medium",
      "title": "Ensure /var/tmp Located On Separate Partition"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Make sure that mails delivered to root user are forwarded to a monitored email address. Make sure that the address change_me@localhost is a valid email address reachable from the system in question. Use the following command to configure the alias:\n\n$ sudo echo \"root: change_me@localhost \" >> /etc/aliases\n$ sudo newaliases",
      "id": "xccdf_org.ssgproject.content_rule_postfix_client_configure_mail_alias",
      "instructions": "Find the list of alias maps used by the Postfix mail server:\n$ sudo postconf alias_maps\nQuery the Postfix alias maps for an alias for the root user:\n$ sudo postmap -q root hash:/etc/aliases\nThe output should return an alias.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "postfix-client-configure-mail-alias",
          "compliance.openshift.io/rule-variable": "var-postfix-root-mail-alias,var-postfix-root-mail-alias",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-postfix-client-configure-mail-alias",
        "namespace": "openshift-compliance",
        "resourceVersion": "78453",
        "uid": "5cd115ec-b0e2-47be-a5ff-f55601b0898e"
      },
      "rationale": "A number of system services utilize email messages sent to the root user to notify system administrators of active or impending issues. These messages must be forwarded to at least one monitored email address.",
      "severity": "medium",
      "title": "Configure System to Forward All Mail For The Root Account"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Verify the administrators are notified in the event of an audit processing failure. Check that the \"/etc/aliases\" file has a defined value for \"root\".\n\n$ sudo grep \"postmaster:\\s*root$\" /etc/aliases\n\npostmaster: root",
      "id": "xccdf_org.ssgproject.content_rule_postfix_client_configure_mail_alias_postmaster",
      "instructions": "Find the list of alias maps used by the Postfix mail server:\n$ sudo postconf alias_maps\nQuery the Postfix alias maps for an alias for the postmaster user:\n$ sudo postmap -q postmaster hash:/etc/aliases\nThe output should return root.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "postfix-client-configure-mail-alias-postmaster",
          "control.compliance.openshift.io/NIST-800-53": "AU-5(a);AU-5.1(ii)",
          "policies.open-cluster-management.io/controls": "AU-5(a),AU-5.1(ii)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-postfix-client-configure-mail-alias-postmaster",
        "namespace": "openshift-compliance",
        "resourceVersion": "78454",
        "uid": "8c4794e4-bc2b-458e-981b-0324bc957724"
      },
      "rationale": "It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.",
      "severity": "medium",
      "title": "Configure System to Forward All Mail From Postmaster to The Root Account"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Set up a relay host that will act as a gateway for all outbound email. Edit the file /etc/postfix/main.cf to ensure that only the following relayhost line appears:\n\nrelayhost = smtp.$mydomain",
      "id": "xccdf_org.ssgproject.content_rule_postfix_client_configure_relayhost",
      "instructions": "Run the following command to ensure postfix routes mail to this system:\n$ grep relayhost /etc/postfix/main.cf\nIf properly configured, the output should show only .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "postfix-client-configure-relayhost",
          "compliance.openshift.io/rule-variable": "var-postfix-relayhost"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-postfix-client-configure-relayhost",
        "namespace": "openshift-compliance",
        "resourceVersion": "78456",
        "uid": "9503bf88-917b-4bc3-b3f1-2a57d614a1b5"
      },
      "rationale": "A central outbound email location ensures messages sent from any network host can be audited for potential unexpected content. Tooling on the central server may help prevent spam or viruses from being delivered.",
      "severity": "medium",
      "title": "Configure System to Forward All Mail through a specific host"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Prefer installation of 64-bit operating systems when the CPU supports it.",
      "id": "xccdf_org.ssgproject.content_rule_prefer_64bit_os",
      "instructions": "To check if the installed Operating System is 64-bit, run the following command:\n$ uname -m\nThe output should be one of the following: x86_64, aarch64, ppc64le or s390x.\nIf the output is i686 or i386 the operating system is 32-bit.\nCheck if the installed CPU supports 64-bit operating systems by running the following command:\n$ lscpu | grep \"CPU op-mode\"\nIf the output contains 64bit, the CPU supports 64-bit operating systems.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "prefer-64bit-os"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-prefer-64bit-os",
        "namespace": "openshift-compliance",
        "resourceVersion": "76535",
        "uid": "5bf984d1-6876-4eef-94da-b36285543f6c"
      },
      "rationale": "Use of a 64-bit operating system offers a few advantages, like a larger address space range for Address Space Layout Randomization (ASLR) and systematic presence of No eXecute and Execute Disable (NX/XD) protection bits.",
      "severity": "medium",
      "title": "Prefer to use a 64-bit Operating System when supported",
      "warning": "Use of a 64-bit operating system offers a few advantages, like a larger address space range for Address Space Layout Randomization (ASLR) and systematic presence of No eXecute and Execute Disable (NX/XD) protection bits."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Single-user mode is intended as a system recovery method, providing a single user root access to the system by providing a boot option at startup.\n\nBy default, single-user mode is protected by requiring a password and is set in /usr/lib/systemd/system/rescue.service.",
      "id": "xccdf_org.ssgproject.content_rule_require_singleuser_auth",
      "instructions": "To check if authentication is required for single-user mode, run the following command:\n$ grep sulogin /usr/lib/systemd/system/rescue.service\nThe output should be similar to the following, and the line must begin with\nExecStart and /usr/lib/systemd/systemd-sulogin-shell.\n    ExecStart=-/usr/lib/systemd/systemd-sulogin-shell rescue\n\n\nThen, verify that the rescue service is in the runlevel1.target.\nRun the following command:\n$ sudo grep \"^Requires=.*rescue\\.service\" /usr/lib/systemd/system/runlevel1.target\nThe output should be the following:\nRequires=sysinit.target rescue.service\n\nThen, check if there is no custom runlevel1 target configured in systemd configuration.\nRun the following command:\n$ sudo grep -r \"^runlevel1.target$\" /etc/systemd/system\nThere should be no output.\n\nThen, check if there is no custom rescue service configured in systemd configuration.\nRun the following command:\n$ sudo grep -r \"^rescue.service$\" /etc/systemd/system\nThere should be no output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "require-singleuser-auth",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "IA-2;AC-3;CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,IA-2,AC-3,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-require-singleuser-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "76862",
        "uid": "f33a6463-d75b-4f30-b182-776d23109559"
      },
      "rationale": "This prevents attackers with physical access from trivially bypassing security on the machine and gaining root access. Such accesses are further prevented by configuring the bootloader password.",
      "severity": "medium",
      "title": "Require Authentication for Single User Mode"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To restrict root logins on serial ports, ensure lines of this form do not appear in /etc/securetty :\n\nttyS0\nttyS1",
      "id": "xccdf_org.ssgproject.content_rule_restrict_serial_port_logins",
      "instructions": "To check for serial port entries which permit root login,\nrun the following command:\n$ sudo grep ^ttyS/[0-9] /etc/securetty\nIf any output is returned, then root login over serial ports is permitted.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "restrict-serial-port-logins",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-6;CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-6,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-restrict-serial-port-logins",
        "namespace": "openshift-compliance",
        "resourceVersion": "76985",
        "uid": "ef14bedd-dd52-40a1-ad8a-46e84c14ebee"
      },
      "rationale": "Preventing direct root login to serial port interfaces helps ensure accountability for actions taken on the systems using the root account.",
      "severity": "medium",
      "title": "Restrict Serial Port Root Logins"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that none of the directories in root's path is equal to a single. character, or that it contains any instances that lead to relative path traversal, such as.. or beginning a path without the slash ( / ) character. Also ensure that there are no \"empty\" elements in the path, such as in these examples:\n\nPATH=:/bin\nPATH=/bin:\nPATH=/bin::/sbin\n\nThese empty elements have the same effect as a single. character.",
      "id": "xccdf_org.ssgproject.content_rule_root_path_no_dot",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "root-path-no-dot",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-root-path-no-dot",
        "namespace": "openshift-compliance",
        "resourceVersion": "77044",
        "uid": "e919188b-730d-4581-ac20-12ad244f4837"
      },
      "rationale": "Including these entries increases the risk that root could execute code from an untrusted location.",
      "severity": "unknown",
      "title": "Ensure that Root's Path Does Not Include Relative Paths or Null Directories"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The RPM package management system can check file ownership permissions of installed software packages, including many that are important to system security. After locating a file with incorrect permissions, which can be found with:\n\nrpm -Va | awk '{ if (substr($0,6,1)==\"U\" || substr($0,7,1)==\"G\") print $NF }'\n\nrun the following command to determine which package owns it:\n\n$ rpm -qf FILENAME\n\nNext, run the following command to reset its permissions to the correct values:\n\n$ sudo rpm --setugids PACKAGENAME",
      "id": "xccdf_org.ssgproject.content_rule_rpm_verify_ownership",
      "instructions": "The following command will list which files on the system have ownership different from what\nis expected by the RPM database:\n$ rpm -Va | rpm -Va --nofiledigest | awk '{ if (substr($0,6,1)==\"U\" || substr($0,7,1)==\"G\") print $NF }'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "rpm-verify-ownership",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(d);CM-6(c);SI-7;SI-7(1);SI-7(6);AU-9(3)",
          "control.compliance.openshift.io/PCI-DSS": "Req-11.5",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CM-6(d),CM-6(c),SI-7,SI-7(1),SI-7(6),AU-9(3),Req-11.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rpm-verify-ownership",
        "namespace": "openshift-compliance",
        "resourceVersion": "76537",
        "uid": "0d139847-0e0f-40d3-8f55-1562c0f824bf"
      },
      "rationale": "Ownership of binaries and configuration files that is incorrect could allow an unauthorized user to gain privileges that they should not have. The ownership set by the vendor should be maintained. Any deviations from this baseline should be investigated.",
      "severity": "high",
      "title": "Verify and Correct Ownership with RPM",
      "warning": "Ownership of binaries and configuration files that is incorrect could allow an unauthorized user to gain privileges that they should not have. The ownership set by the vendor should be maintained. Any deviations from this baseline should be investigated."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The RPM package management system can check file access permissions of installed software packages, including many that are important to system security. Verify that the file permissions of system files and commands match vendor values. Check the file permissions with the following command:\n\n$ sudo rpm -Va | awk '{ if (substr($0,2,1)==\"M\") print $NF }'\n\nOutput indicates files that do not match vendor defaults. After locating a file with incorrect permissions, run the following command to determine which package owns it:\n\n$ rpm -qf FILENAME\n\nNext, run the following command to reset its permissions to the correct values:\n\n$ sudo rpm --setperms PACKAGENAME",
      "id": "xccdf_org.ssgproject.content_rule_rpm_verify_permissions",
      "instructions": "The following command will list which files on the system have permissions different from what\nis expected by the RPM database:\n$ rpm -Va | awk '{ if (substr($0,2,1)==\"M\") print $NF }'",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "rpm-verify-permissions",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-003-8 R6;CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(d);CM-6(c);SI-7;SI-7(1);SI-7(6);AU-9(3);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-11.5",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-003-8 R6,CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CM-6(d),CM-6(c),SI-7,SI-7(1),SI-7(6),AU-9(3),CM-6(a),Req-11.5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rpm-verify-permissions",
        "namespace": "openshift-compliance",
        "resourceVersion": "76540",
        "uid": "15856f66-22ce-4152-9a84-ed0380dbf883"
      },
      "rationale": "Permissions on system binaries and configuration files that are too generous could allow an unauthorized user to gain privileges that they should not have. The permissions set by the vendor should be maintained. Any deviations from this baseline should be investigated.",
      "severity": "high",
      "title": "Verify and Correct File Permissions with RPM",
      "warning": "Permissions on system binaries and configuration files that are too generous could allow an unauthorized user to gain privileges that they should not have. The permissions set by the vendor should be maintained. Any deviations from this baseline should be investigated."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The rsyslog daemon should not accept remote messages unless the system acts as a log server. If the system needs to act as a central log server, add the following lines to /etc/rsyslog.conf to enable reception of messages over TCP:\n\n$ModLoad imtcp\n$InputTCPServerRun 514",
      "id": "xccdf_org.ssgproject.content_rule_rsyslog_accept_remote_messages_tcp",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "rsyslog-accept-remote-messages-tcp",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R3.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-6(3);AU-6(4)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R3.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R6.5,CM-6(a),AU-6(3),AU-6(4)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rsyslog-accept-remote-messages-tcp",
        "namespace": "openshift-compliance",
        "resourceVersion": "78022",
        "uid": "ece6274b-d818-4964-bccc-f30cf6522955"
      },
      "rationale": "If the system needs to act as a log server, this ensures that it can receive messages over a reliable TCP connection.",
      "severity": "unknown",
      "title": "Enable rsyslog to Accept Messages via TCP, if Acting As Log Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "The rsyslog daemon should not accept remote messages unless the system acts as a log server. If the system needs to act as a central log server, add the following lines to /etc/rsyslog.conf to enable reception of messages over UDP:\n\n$ModLoad imudp\n$UDPServerRun 514",
      "id": "xccdf_org.ssgproject.content_rule_rsyslog_accept_remote_messages_udp",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "rsyslog-accept-remote-messages-udp",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.2;CIP-004-6 R3.3;CIP-007-3 R.1.3;CIP-007-3 R5;CIP-007-3 R5.1.1;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-6(3);AU-6(4)",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.2,CIP-004-6 R3.3,CIP-007-3 R.1.3,CIP-007-3 R5,CIP-007-3 R5.1.1,CIP-007-3 R6.5,CM-6(a),AU-6(3),AU-6(4)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rsyslog-accept-remote-messages-udp",
        "namespace": "openshift-compliance",
        "resourceVersion": "78024",
        "uid": "95d7206a-efbd-43e4-9e2a-bbdc2dace820"
      },
      "rationale": "Many devices, such as switches, routers, and other Unix-like systems, may only support the traditional syslog transmission over UDP. If the system must act as a log server, this enables it to receive their messages as well.",
      "severity": "unknown",
      "title": "Enable rsyslog to Accept Messages via UDP, if Acting As Log Server"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Rsyslogd is a system utility providing support for message logging. Support for both internet and UNIX domain sockets enables this utility to support both local and remote logging. Couple this utility with gnutls (which is a secure communications library implementing the SSL, TLS and DTLS protocols), and you have a method to securely encrypt and off-load auditing. When using rsyslogd to off-load logs the remote system must be authenticated.",
      "id": "xccdf_org.ssgproject.content_rule_rsyslog_encrypt_offload_actionsendstreamdriverauthmode",
      "instructions": "Verify the operating system authenticates the remote logging server for off-loading audit logs with the following command:\n\n$ sudo grep -i '$ActionSendStreamDriverAuthMode' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\nThe output should be\n$/etc/rsyslog.conf:$ActionSendStreamDriverAuthMode x509/name",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "rsyslog-encrypt-offload-actionsendstreamdriverauthmode",
          "control.compliance.openshift.io/NIST-800-53": "AU-4(1)",
          "policies.open-cluster-management.io/controls": "AU-4(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rsyslog-encrypt-offload-actionsendstreamdriverauthmode",
        "namespace": "openshift-compliance",
        "resourceVersion": "77982",
        "uid": "7e0c1eca-0199-470e-9996-3dac1e22f7ad"
      },
      "rationale": "The audit records generated by Rsyslog contain valuable information regarding system configuration, user authentication, and other such information. Audit records should be protected from unauthorized access.",
      "severity": "medium",
      "title": "Ensure Rsyslog Authenticates Off-Loaded Audit Records"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Rsyslogd is a system utility providing support for message logging. Support for both internet and UNIX domain sockets enables this utility to support both local and remote logging. Couple this utility with gnutls (which is a secure communications library implementing the SSL, TLS and DTLS protocols), and you have a method to securely encrypt and off-load auditing. When using rsyslogd to off-load logs off a encrpytion system must be used.",
      "id": "xccdf_org.ssgproject.content_rule_rsyslog_encrypt_offload_actionsendstreamdrivermode",
      "instructions": "Verify the operating system encrypts audit records off-loaded onto a different system\nor media from the system being audited with the following commands:\n\n$ sudo grep -i '$ActionSendStreamDriverMode' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n\nThe output should be:\n\n/etc/rsyslog.conf:$ActionSendStreamDriverMode 1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "rsyslog-encrypt-offload-actionsendstreamdrivermode",
          "control.compliance.openshift.io/NIST-800-53": "AU-4(1)",
          "policies.open-cluster-management.io/controls": "AU-4(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rsyslog-encrypt-offload-actionsendstreamdrivermode",
        "namespace": "openshift-compliance",
        "resourceVersion": "77978",
        "uid": "1406f2ff-9d65-40b8-b177-b50abd05036a"
      },
      "rationale": "The audit records generated by Rsyslog contain valuable information regarding system configuration, user authentication, and other such information. Audit records should be protected from unauthorized access.",
      "severity": "medium",
      "title": "Ensure Rsyslog Encrypts Off-Loaded Audit Records"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Rsyslogd is a system utility providing support for message logging. Support for both internet and UNIX domain sockets enables this utility to support both local and remote logging. Couple this utility with gnutls (which is a secure communications library implementing the SSL, TLS and DTLS protocols), and you have a method to securely encrypt and off-load auditing. When using rsyslogd to off-load logs off an encryption system must be used.",
      "id": "xccdf_org.ssgproject.content_rule_rsyslog_encrypt_offload_defaultnetstreamdriver",
      "instructions": "Verify the operating system encrypts audit records off-loaded onto a different system\nor media from the system being audited with the following commands:\n\n$ sudo grep -i '$DefaultNetstreamDriver' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n\nThe output should be:\n\n/etc/rsyslog.conf:$DefaultNetstreamDriver gtls",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "rsyslog-encrypt-offload-defaultnetstreamdriver",
          "control.compliance.openshift.io/NIST-800-53": "AU-4(1)",
          "policies.open-cluster-management.io/controls": "AU-4(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rsyslog-encrypt-offload-defaultnetstreamdriver",
        "namespace": "openshift-compliance",
        "resourceVersion": "77985",
        "uid": "56d4361a-c1b9-41e6-82b7-4f5c7e2fe392"
      },
      "rationale": "The audit records generated by Rsyslog contain valuable information regarding system configuration, user authentication, and other such information. Audit records should be protected from unauthorized access.",
      "severity": "medium",
      "title": "Ensure Rsyslog Encrypts Off-Loaded Audit Records"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The group-owner of all log files written by rsyslog should be root. These log files are determined by the second part of each Rule line in /etc/rsyslog.conf and typically all appear in /var/log. For each log file LOGFILE referenced in /etc/rsyslog.conf , run the following command to inspect the file's group owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not root , run the following command to correct this:\n\n$ sudo chgrp root LOGFILE",
      "id": "xccdf_org.ssgproject.content_rule_rsyslog_files_groupownership",
      "instructions": "The group-owner of all log files written by rsyslog should be\nroot.\nThese log files are determined by the second part of each Rule line in\n/etc/rsyslog.conf and typically all appear in /var/log.\nTo see the group-owner of a given log file, run the following command:\n$ ls -l LOGFILE",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "rsyslog-files-groupownership",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.1;Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-10.5.1,Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rsyslog-files-groupownership",
        "namespace": "openshift-compliance",
        "resourceVersion": "77987",
        "uid": "7aeb0337-fd5a-46c1-901d-fdfee14cbc44"
      },
      "rationale": "The log files generated by rsyslog contain valuable information regarding system configuration, user authentication, and other such information. Log files should be protected from unauthorized access.",
      "severity": "medium",
      "title": "Ensure Log Files Are Owned By Appropriate Group"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The owner of all log files written by rsyslog should be root. These log files are determined by the second part of each Rule line in /etc/rsyslog.conf and typically all appear in /var/log. For each log file LOGFILE referenced in /etc/rsyslog.conf , run the following command to inspect the file's owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not root , run the following command to correct this:\n\n$ sudo chown root LOGFILE",
      "id": "xccdf_org.ssgproject.content_rule_rsyslog_files_ownership",
      "instructions": "The owner of all log files written by rsyslog should be\n\nroot.\n\nThese log files are determined by the second part of each Rule line in\n/etc/rsyslog.conf and typically all appear in /var/log.\nTo see the owner of a given log file, run the following command:\n$ ls -l LOGFILE",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "rsyslog-files-ownership",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.1;Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-10.5.1,Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rsyslog-files-ownership",
        "namespace": "openshift-compliance",
        "resourceVersion": "77989",
        "uid": "b39bb3e3-e4c9-4c87-b111-520860b4e949"
      },
      "rationale": "The log files generated by rsyslog contain valuable information regarding system configuration, user authentication, and other such information. Log files should be protected from unauthorized access.",
      "severity": "medium",
      "title": "Ensure Log Files Are Owned By Appropriate User"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The file permissions for all log files written by rsyslog should be set to 640, or more restrictive. These log files are determined by the second part of each Rule line in /etc/rsyslog.conf and typically all appear in /var/log. For each log file LOGFILE referenced in /etc/rsyslog.conf , run the following command to inspect the file's permissions:\n\n$ ls -l LOGFILE\n\nIf the permissions are not 640 or more restrictive, run the following command to correct this:\n\n$ sudo chmod 640 LOGFILE\n\n\"",
      "id": "xccdf_org.ssgproject.content_rule_rsyslog_files_permissions",
      "instructions": "The file permissions for all log files written by rsyslog should\nbe set to 640, or more restrictive. These log files are determined by the\nsecond part of each Rule line in /etc/rsyslog.conf and typically\nall appear in /var/log. To see the permissions of a given log\nfile, run the following command:\n$ ls -l LOGFILE\nThe permissions should be 640, or more restrictive.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "rsyslog-files-permissions",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.5.1;Req-10.5.2",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1),Req-10.5.1,Req-10.5.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rsyslog-files-permissions",
        "namespace": "openshift-compliance",
        "resourceVersion": "77993",
        "uid": "739d80db-c161-4070-b963-089705dea734"
      },
      "rationale": "Log files can contain valuable information regarding system configuration. If the system log files are not protected unauthorized users could change the logged data, eliminating their forensic value.",
      "severity": "medium",
      "title": "Ensure System Log Files Have Correct Permissions"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To configure rsyslog to send logs to a remote log server, open /etc/rsyslog.conf and read and understand the last section of the file, which describes the multiple directives necessary to activate remote logging. Along with these other directives, the system can be configured to forward its logs to a particular log server by adding or correcting one of the following lines, substituting logcollector appropriately. The choice of protocol depends on the environment of the system; although TCP and RELP provide more reliable message delivery, they may not be supported in all environments.\n\nTo use UDP for log message delivery:\n\n*.* @ logcollector \n\nTo use TCP for log message delivery:\n\n*.* @@ logcollector \n\nTo use RELP for log message delivery:\n\n*.* :omrelp: logcollector \n\nThere must be a resolvable DNS CNAME or Alias record set to \" logcollector \" for logs to be sent correctly to the centralized logging utility.",
      "id": "xccdf_org.ssgproject.content_rule_rsyslog_remote_loghost",
      "instructions": "To ensure logs are sent to a remote host, examine the file\n/etc/rsyslog.conf.\nIf using UDP, a line similar to the following should be present:\n *.* @\nIf using TCP, a line similar to the following should be present:\n *.* @@\nIf using RELP, a line similar to the following should be present:\n *.* :omrelp:",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "rsyslog-remote-loghost",
          "compliance.openshift.io/rule-variable": "rsyslog-remote-loghost-address,rsyslog-remote-loghost-address,rsyslog-remote-loghost-address,rsyslog-remote-loghost-address,rsyslog-remote-loghost-address",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.2;CIP-004-6 R3.3",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-4(1);AU-9(2)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.2,CIP-004-6 R3.3,CM-6(a),AU-4(1),AU-9(2)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-rsyslog-remote-loghost",
        "namespace": "openshift-compliance",
        "resourceVersion": "78026",
        "uid": "04db3121-9ce5-4b9b-8dd3-dcf03d661b0d"
      },
      "rationale": "A log server (loghost) receives syslog messages from one or more systems. This data can be used as an additional log source in the event a system is compromised and its local logs are suspect. Forwarding log messages to a remote loghost also provides system administrators with a centralized place to view the status of multiple hosts within the enterprise.",
      "severity": "medium",
      "title": "Ensure Logs Sent To Remote Host",
      "warning": "A log server (loghost) receives syslog messages from one or more systems. This data can be used as an additional log source in the event a system is compromised and its local logs are suspect. Forwarding log messages to a remote loghost also provides system administrators with a centralized place to view the status of multiple hosts within the enterprise."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To restrict root logins through the (deprecated) virtual console devices, ensure lines of this form do not appear in /etc/securetty :\n\nvc/1\nvc/2\nvc/3\nvc/4",
      "id": "xccdf_org.ssgproject.content_rule_securetty_root_login_console_only",
      "instructions": "To check for virtual console entries which permit root login, run the\nfollowing command:\n$ sudo grep ^vc/[0-9] /etc/securetty\nIf any output is returned, then root logins over virtual console devices is permitted.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "securetty-root-login-console-only",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-6;CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-6,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-securetty-root-login-console-only",
        "namespace": "openshift-compliance",
        "resourceVersion": "76988",
        "uid": "14ad1519-89b7-42a7-938e-4bef8c1f2d0d"
      },
      "rationale": "Preventing direct root login to virtual console devices helps ensure accountability for actions taken on the system using the root account.",
      "severity": "medium",
      "title": "Restrict Virtual Console Root Logins"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Daemons for which the SELinux policy does not contain rules will inherit the context of the parent process. Because daemons are launched during startup and descend from the init process, they inherit the unconfined_service_t context.\n\nTo check for unconfined daemons, run the following command:\n\n$ sudo ps -eZ | grep \"unconfined_service_t\"\n\nIt should produce no output in a well-configured system.",
      "id": "xccdf_org.ssgproject.content_rule_selinux_confinement_of_daemons",
      "instructions": "Ensure there are no unconfined daemons running on the system,\nthe following command should produce no output:\n$ sudo ps -eZ | grep \"unconfined_service_t\"",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "selinux-confinement-of-daemons",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-3(3)(a);AC-6",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-7(a),CM-7(b),CM-6(a),AC-3(3)(a),AC-6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-selinux-confinement-of-daemons",
        "namespace": "openshift-compliance",
        "resourceVersion": "78417",
        "uid": "1638ec4a-b314-4b69-9b52-1a0116b7b739"
      },
      "rationale": "Daemons which run with the unconfined_service_t context may cause AVC denials, or allow privileges that the daemon does not require.",
      "severity": "medium",
      "title": "Ensure No Daemons are Unconfined by SELinux",
      "warning": "Daemons which run with the unconfined_service_t context may cause AVC denials, or allow privileges that the daemon does not require."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The SELinux state should be set to enforcing or permissive at system boot time. In the file /etc/selinux/config , add or correct the following line to configure the system to boot into enforcing or permissive mode:\n\nSELINUX=enforcing\n\nOR\n\nSELINUX=permissive",
      "id": "xccdf_org.ssgproject.content_rule_selinux_not_disabled",
      "instructions": "Ensure that Red Hat Enterprise Linux CoreOS 4 does not disable SELinux.\n\nCheck if \"SELinux\" is active and in \"enforcing\" or \"permissive\" mode with the following command:\n\n$ sudo getenforce\nEnforcing\n-OR-\nPermissive",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "selinux-not-disabled"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-selinux-not-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78418",
        "uid": "b51d5e52-5cc7-4bd0-a67f-89cac63e59d9"
      },
      "rationale": "Running SELinux in disabled mode is strongly discouraged. It prevents enforcing the SELinux controls without a system reboot. It also avoids labeling any persistent objects such as files, making it difficult to enable SELinux in the future.",
      "severity": "high",
      "title": "Ensure SELinux is Not Disabled",
      "warning": "Running SELinux in disabled mode is strongly discouraged. It prevents enforcing the SELinux controls without a system reboot. It also avoids labeling any persistent objects such as files, making it difficult to enable SELinux in the future."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The SELinux targeted policy is appropriate for general-purpose desktops and servers, as well as systems in many other roles. To configure the system to use this policy, add or correct the following line in /etc/selinux/config :\n\nSELINUXTYPE= targeted \n\nOther policies, such as mls , provide additional security labeling and greater confinement but are not compatible with many general-purpose use cases.",
      "id": "xccdf_org.ssgproject.content_rule_selinux_policytype",
      "instructions": "Verify the SELINUX on Red Hat Enterprise Linux CoreOS 4 is using the  policy with the following command:\n\n$ sestatus | grep policy\n\nLoaded policy name:",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-bsi-2022,rhcos4-e8,rhcos4-nerc-cip,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-bsi,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "selinux-policytype",
          "compliance.openshift.io/rule-variable": "var-selinux-policy-name",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.2;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-004-6 R3.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;AC-3(3)(a);AU-9;SC-7(21)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.2,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-004-6 R3.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CIP-007-3 R6.5,AC-3,AC-3(3)(a),AU-9,SC-7(21)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:16Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-selinux-policytype",
        "namespace": "openshift-compliance",
        "resourceVersion": "78420",
        "uid": "9525664d-d6b0-461e-8d8a-f512ac196c25"
      },
      "rationale": "Setting the SELinux policy to targeted or a more specialized policy ensures the system will confine processes that are likely to be targeted for exploitation, such as network or system services.\n\nNote: During the development or debugging of SELinux modules, it is common to temporarily place non-production systems in permissive mode. In such temporary cases, SELinux policies should be developed, and once work is completed, the system should be reconfigured to targeted.",
      "severity": "medium",
      "title": "Configure SELinux Policy"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The SELinux state should be set to enforcing at system boot time. In the file /etc/selinux/config , add or correct the following line to configure the system to boot into enforcing mode:\n\nSELINUX= enforcing",
      "id": "xccdf_org.ssgproject.content_rule_selinux_state",
      "instructions": "Ensure that Red Hat Enterprise Linux CoreOS 4 verifies correct operation of security functions.\n\nCheck if \"SELinux\" is active and in \"\" mode with the following command:\n\n$ sudo getenforce",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-anssi-bp28-high,rhcos4-e8,rhcos4-nerc-cip,rhcos4-bsi-2022,rhcos4-high-rev-4,rhcos4-stig,rhcos4-bsi",
          "compliance.openshift.io/rule": "selinux-state",
          "compliance.openshift.io/rule-variable": "var-selinux-state,var-selinux-state",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.2;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-004-6 R3.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;AC-3(3)(a);AU-9;SC-7(21)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.2,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-004-6 R3.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CIP-007-3 R6.5,AC-3,AC-3(3)(a),AU-9,SC-7(21)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-selinux-state",
        "namespace": "openshift-compliance",
        "resourceVersion": "78422",
        "uid": "6c66bfd2-e88c-4ac1-ba40-0210f7f18479"
      },
      "rationale": "Setting the SELinux state to enforcing ensures SELinux is able to confine potentially compromised processes to the security policy, which is designed to prevent them from causing damage to the system or further elevating their privileges.",
      "severity": "high",
      "title": "Ensure SELinux State is Enforcing"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "systemd": {
                  "units": [
                    {
                      "enabled": true,
                      "name": "auditd.service"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The auditd service is an essential userspace component of the Linux Auditing System, as it is responsible for writing audit records to disk. The auditd service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-auditd-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: auditd.service\n       enabled: true\n\nThis will enable the auditd service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_auditd_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nauditd service:\n$ sudo systemctl is-active auditd\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-stig,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-high-rev-4,rhcos4-high,rhcos4-e8",
          "compliance.openshift.io/rule": "service-auditd-enabled",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R3.3;CIP-007-3 R6.5",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(g);AU-3;AU-10;AU-2(d);AU-12(c);AU-14(1);AC-6(9);CM-6(a);SI-4(23)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.1",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R3.3,CIP-007-3 R6.5,AC-2(g),AU-3,AU-10,AU-2(d),AU-12(c),AU-14(1),AC-6(9),CM-6(a),SI-4(23),Req-10.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-auditd-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "77077",
        "uid": "694c5dc2-5f99-42a7-9773-c8a86b0e2523"
      },
      "rationale": "Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack. Ensuring the auditd service is active ensures audit records generated by the kernel are appropriately recorded.\n\nAdditionally, a properly configured audit subsystem ensures that actions of individual system users can be uniquely traced to those users so they can be held accountable for their actions.",
      "severity": "medium",
      "title": "Enable auditd Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "systemd": {
                  "units": [
                    {
                      "enabled": false,
                      "name": "autofs.service"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The autofs daemon mounts and unmounts filesystems, such as user home directories shared via NFS, on demand. In addition, autofs can be used to handle removable media, and the default configuration provides the cdrom device as /misc/cd. However, this method of providing access to removable media is not common, so autofs can almost always be disabled if NFS is not in use. Even if NFS is required, it may be possible to configure filesystem mounts statically by editing /etc/fstab rather than relying on the automounter.\n\nThe autofs service can be disabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-autofs-disable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - enabled: false\n       name: autofs.service\n\nThis will disable the autofs service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_autofs_disabled",
      "instructions": "To check that the autofs service is disabled in system boot configuration,\nYou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,run the following command:\n$ sudo systemctl is-enabled autofs\nOutput should indicate the autofs service has either not been installed,\nor has been disabled at all runlevels, as shown in the example below:\n$ sudo systemctl is-enabled autofs disabled\n\nRun the following command to verify autofs is not active (i.e. not running) through current runtime configuration:\n$ sudo systemctl is-active autofs\n\nIf the service is not running the command will return the following output:\ninactive\n\nThe service will also be masked, to check that the autofs is masked, run the following command:\n$ sudo systemctl show autofs | grep \"LoadState\\|UnitFileState\"\n\nIf the service is masked the command will return the following outputs:\n\nLoadState=masked\n\nUnitFileState=masked",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "service-autofs-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);MP-7",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),MP-7",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:09Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-autofs-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78293",
        "uid": "ae4ddf30-cb53-4504-a149-001582af023d"
      },
      "rationale": "Disabling the automounter permits the administrator to statically control filesystem mounting through /etc/fstab.\n\nAdditionally, automatically mounting filesystems permits easy introduction of unknown devices, thereby facilitating malicious activity.",
      "severity": "medium",
      "title": "Disable the Automounter"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "systemd": {
                  "units": [
                    {
                      "enabled": false,
                      "mask": true,
                      "name": "bluetooth.service"
                    },
                    {
                      "enabled": false,
                      "mask": true,
                      "name": "bluetooth.socket"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The bluetooth service can be disabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-bluetooth-disable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - enabled: false\n       name: bluetooth.service\n\nThis will disable the bluetooth service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).\n\n$ sudo service bluetooth stop",
      "id": "xccdf_org.ssgproject.content_rule_service_bluetooth_disabled",
      "instructions": "To check that the bluetooth service is disabled in system boot configuration,\nYou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,run the following command:\n$ sudo systemctl is-enabled bluetooth\nOutput should indicate the bluetooth service has either not been installed,\nor has been disabled at all runlevels, as shown in the example below:\n$ sudo systemctl is-enabled bluetooth disabled\n\nRun the following command to verify bluetooth is not active (i.e. not running) through current runtime configuration:\n$ sudo systemctl is-active bluetooth\n\nIf the service is not running the command will return the following output:\ninactive\n\nThe service will also be masked, to check that the bluetooth is masked, run the following command:\n$ sudo systemctl show bluetooth | grep \"LoadState\\|UnitFileState\"\n\nIf the service is masked the command will return the following outputs:\n\nLoadState=masked\n\nUnitFileState=masked",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "service-bluetooth-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-18(a);AC-18(3);CM-7(a);CM-7(b);CM-6(a);MP-7",
          "policies.open-cluster-management.io/controls": "AC-18(a),AC-18(3),CM-7(a),CM-7(b),CM-6(a),MP-7",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-bluetooth-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78182",
        "uid": "e7431926-dffd-4555-a2fb-085d00f35ef1"
      },
      "rationale": "Disabling the bluetooth service prevents the system from attempting connections to Bluetooth devices, which entails some security risk. Nevertheless, variation in this risk decision may be expected due to the utility of Bluetooth connectivity and its limited range.",
      "severity": "medium",
      "title": "Disable Bluetooth Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "chrony is a daemon which implements the Network Time Protocol (NTP) is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on chrony can be found at http://chrony.tuxfamily.org/. Chrony can be configured to be a client and/or a server. To enable Chronyd service, you can run: # systemctl enable chronyd.service This recommendation only applies if chrony is in use on the system.",
      "id": "xccdf_org.ssgproject.content_rule_service_chronyd_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nchronyd service:\n$ sudo systemctl is-active chronyd\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-chronyd-enabled"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-chronyd-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78463",
        "uid": "bf77ef4f-0753-4422-a8a3-9ccc7f643723"
      },
      "rationale": "If chrony is in use on the system proper configuration is vital to ensuring time synchronization is working properly.",
      "severity": "medium",
      "title": "The Chronyd service is enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the\n\nsh-4.4#\n\nprompt, run:\n\n# chroot /host\n\nRun the following command to determine the current status of the chronyd service:\n\n$ sudo systemctl is-active chronyd\n\nIf the service is running, it should return the following:\n\nactive\n\nNote: The chronyd daemon is enabled by default.\n\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the\n\nsh-4.4#\n\nprompt, run:\n\n# chroot /host\n\nRun the following command to determine the current status of the ntpd service:\n\n$ sudo systemctl is-active ntpd\n\nIf the service is running, it should return the following:\n\nactive\n\nNote: The ntpd daemon is not enabled by default. Though as mentioned in the previous sections in certain environments the ntpd daemon might be preferred to be used rather than the chronyd one. Refer to: https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-configuring_ntp_using_the_chrony_suite for guidance which NTP daemon to choose depending on the environment used.",
      "id": "xccdf_org.ssgproject.content_rule_service_chronyd_or_ntpd_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nchronyd service:\n$ sudo systemctl is-active chronyd\nIf the service is running, it should return the following: active\n\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nntpd service:\n$ sudo systemctl is-active ntpd\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-stig-v1r1,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-high-rev-4,rhcos4-moderate,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "service-chronyd-or-ntpd-enabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-8(1)(a);AU-12(1)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4.1",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-8(1)(a),AU-12(1),Req-10.4.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-chronyd-or-ntpd-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78464",
        "uid": "d6308c3b-f1df-479b-b298-f5d826770cf0"
      },
      "rationale": "Enabling some of chronyd or ntpd services ensures that the NTP daemon will be running and that the system will synchronize its time to any servers specified. This is important whether the system is configured to be a client (and synchronize only its own clock) or it is also acting as an NTP server to other systems. Synchronizing time is essential for authentication services such as Kerberos, but it is also important for maintaining accurate logs and auditing possible security breaches.\n\nThe chronyd and ntpd NTP daemons offer all of the functionality of ntpdate , which is now deprecated.",
      "severity": "medium",
      "title": "Enable the NTP Daemon"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The crond service is used to execute commands at preconfigured times. It is required by almost all systems to perform necessary maintenance tasks, such as notifying root of system activity. The cron service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-cron-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: cron.service\n       enabled: true\n\nThis will enable the cron service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_cron_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\ncron service:\n$ sudo systemctl is-active cron\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-cron-enabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-cron-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78425",
        "uid": "dbd0df4a-c9dc-4728-97cf-0ed63285c027"
      },
      "rationale": "Due to its usage for maintenance and security-supporting tasks, enabling the cron daemon is essential.",
      "severity": "medium",
      "title": "Enable cron Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "systemd": {
                  "units": [
                    {
                      "enabled": false,
                      "mask": true,
                      "name": "debug-shell.service"
                    },
                    {
                      "enabled": false,
                      "mask": true,
                      "name": "debug-shell.socket"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "SystemD's debug-shell service is intended to diagnose SystemD related boot issues with various systemctl commands. Once enabled and following a system reboot, the root shell will be available on tty9 which is access by pressing CTRL-ALT-F9. The debug-shell service should only be used for SystemD related issues and should otherwise be disabled.\n\nBy default, the debug-shell SystemD service is already disabled. The debug-shell service can be disabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-debug-shell-disable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - enabled: false\n       name: debug-shell.service\n\nThis will disable the debug-shell service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_debug-shell_disabled",
      "instructions": "To check that the debug-shell service is disabled in system boot configuration,\nYou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,run the following command:\n$ sudo systemctl is-enabled debug-shell\nOutput should indicate the debug-shell service has either not been installed,\nor has been disabled at all runlevels, as shown in the example below:\n$ sudo systemctl is-enabled debug-shell disabled\n\nRun the following command to verify debug-shell is not active (i.e. not running) through current runtime configuration:\n$ sudo systemctl is-active debug-shell\n\nIf the service is not running the command will return the following output:\ninactive\n\nThe service will also be masked, to check that the debug-shell is masked, run the following command:\n$ sudo systemctl show debug-shell | grep \"LoadState\\|UnitFileState\"\n\nIf the service is masked the command will return the following outputs:\n\nLoadState=masked\n\nUnitFileState=masked",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "service-debug-shell-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-6",
          "policies.open-cluster-management.io/controls": "CM-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-debug-shell-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76833",
        "uid": "2dc68083-6fcd-42dd-819e-a948428f4e33"
      },
      "rationale": "This prevents attackers with physical access from trivially bypassing security on the machine through valid troubleshooting configurations and gaining root access when the system is rebooted.",
      "severity": "medium",
      "title": "Disable debug-shell SystemD Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The File Access Policy service should be enabled. The fapolicyd service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-fapolicyd-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: fapolicyd.service\n       enabled: true\n\nThis will enable the fapolicyd service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_fapolicyd_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nfapolicyd service:\n$ sudo systemctl is-active fapolicyd\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-fapolicyd-enabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);SI-4(22)",
          "policies.open-cluster-management.io/controls": "CM-6(a),SI-4(22)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:18Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-fapolicyd-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78442",
        "uid": "7a1c77b7-0b94-4e99-8dab-303373e0d34d"
      },
      "rationale": "The fapolicyd service (File Access Policy Daemon) implements application whitelisting to decide file access rights.",
      "severity": "medium",
      "title": "Enable the File Access Policy Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The firewalld service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-firewalld-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: firewalld.service\n       enabled: true\n\nThis will enable the firewalld service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_firewalld_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nfirewalld service:\n$ sudo systemctl is-active firewalld\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-firewalld-enabled",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4;CIP-003-8 R5;CIP-004-6 R3",
          "control.compliance.openshift.io/NIST-800-53": "AC-4;CM-7(b);CA-3(5);SC-7(21);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4,CIP-003-8 R5,CIP-004-6 R3,AC-4,CM-7(b),CA-3(5),SC-7(21),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-firewalld-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78035",
        "uid": "d43b361c-dbb4-4e6b-91c8-7081890b00c3"
      },
      "rationale": "Access control methods provide the ability to enhance system security posture by restricting services and known good IP addresses and address ranges. This prevents connections from unknown hosts and protocols.",
      "severity": "medium",
      "title": "Verify firewalld Enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The ip6tables service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-ip6tables-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: ip6tables.service\n       enabled: true\n\nThis will enable the ip6tables service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_ip6tables_enabled",
      "instructions": "If IPv6 is disabled, this is not applicable.\n\n\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nip6tables service:\n$ sudo systemctl is-active ip6tables\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-ip6tables-enabled",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4;CIP-003-8 R5;CIP-004-6 R3",
          "control.compliance.openshift.io/NIST-800-53": "AC-4;CM-7(b);CA-3(5);SC-7(21);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4,CIP-003-8 R5,CIP-004-6 R3,AC-4,CM-7(b),CA-3(5),SC-7(21),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-ip6tables-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78075",
        "uid": "0a66bf1a-1b9a-49c5-97d0-70b45aa90271"
      },
      "rationale": "The ip6tables service provides the system's host-based firewalling capability for IPv6 and ICMPv6.",
      "severity": "medium",
      "title": "Verify ip6tables Enabled if Using IPv6"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The iptables service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-iptables-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: iptables.service\n       enabled: true\n\nThis will enable the iptables service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_iptables_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\niptables service:\n$ sudo systemctl is-active iptables\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-iptables-enabled",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4;CIP-003-8 R5;CIP-004-6 R3",
          "control.compliance.openshift.io/NIST-800-53": "AC-4;CM-7(b);CA-3(5);SC-7(21);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4,CIP-003-8 R5,CIP-004-6 R3,AC-4,CM-7(b),CA-3(5),SC-7(21),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-iptables-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78077",
        "uid": "0006397a-940b-459d-bb46-cf71ca47feae"
      },
      "rationale": "The iptables service provides the system's host-based firewalling capability for IPv4 and ICMP.",
      "severity": "medium",
      "title": "Verify iptables Enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "systemd": {
                  "units": [
                    {
                      "enabled": false,
                      "mask": true,
                      "name": "netfs.service"
                    },
                    {
                      "enabled": false,
                      "mask": true,
                      "name": "netfs.socket"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The netfs script manages the boot-time mounting of several types of networked filesystems, of which NFS and Samba are the most common. If these filesystem types are not in use, the script can be disabled, protecting the system somewhat against accidental or malicious changes to /etc/fstab and against flaws in the netfs script itself. The netfs service can be disabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-netfs-disable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - enabled: false\n       name: netfs.service\n\nThis will disable the netfs service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_netfs_disabled",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-netfs-disabled"
        },
        "creationTimestamp": "2024-03-05T15:03:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-netfs-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78458",
        "uid": "77213973-32ac-4e88-9043-e4caa5aeb1d5"
      },
      "severity": "unknown",
      "title": "Disable Network File Systems (netfs)"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The ntpd service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-ntpd-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: ntpd.service\n       enabled: true\n\nThis will enable the ntpd service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_ntpd_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nntpd service:\n$ sudo systemctl is-active ntpd\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-ntpd-enabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-8(1)(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.4",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-8(1)(a),Req-10.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-ntpd-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78465",
        "uid": "2a25093d-b53a-4357-8b49-6f1e3c79813c"
      },
      "rationale": "Enabling the ntpd service ensures that the ntpd service will be running and that the system will synchronize its time to any servers specified. This is important whether the system is configured to be a client (and synchronize only its own clock) or it is also acting as an NTP server to other systems. Synchronizing time is essential for authentication services such as Kerberos, but it is also important for maintaining accurate logs and auditing possible security breaches.\n\nThe NTP daemon offers all of the functionality of ntpdate , which is now deprecated.",
      "severity": "medium",
      "title": "Enable the NTP Daemon"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The Hardware RNG Entropy Gatherer service should be enabled. The rngd service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-rngd-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: rngd.service\n       enabled: true\n\nThis will enable the rngd service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_rngd_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nrngd service:\n$ sudo systemctl is-active rngd\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-rngd-enabled"
        },
        "creationTimestamp": "2024-03-05T15:03:21Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-rngd-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78486",
        "uid": "9e0c5a91-9372-4050-b7da-0f4f03f4e646"
      },
      "rationale": "The rngd service feeds random data from hardware device to kernel random device.",
      "severity": "low",
      "title": "Enable the Hardware RNG Entropy Gatherer Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The rsyslog service provides syslog-style logging by default on Red Hat Enterprise Linux CoreOS 4. The rsyslog service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-rsyslog-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: rsyslog.service\n       enabled: true\n\nThis will enable the rsyslog service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_rsyslog_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nrsyslog service:\n$ sudo systemctl is-active rsyslog\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-rsyslog-enabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-4(1)",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-4(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:54Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-rsyslog-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "77975",
        "uid": "962ceeed-83df-434d-9e10-b1e1c692e850"
      },
      "rationale": "The rsyslog service must be running in order to provide logging services, which are essential to system administration.",
      "severity": "medium",
      "title": "Enable rsyslog Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "medium",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "systemd": {
                  "units": [
                    {
                      "enabled": false,
                      "mask": true,
                      "name": "sshd.service"
                    },
                    {
                      "enabled": false,
                      "mask": true,
                      "name": "sshd.socket"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Instead of using ssh to remotely log in to a cluster node, it is recommended to use oc debug The sshd service can be disabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-sshd-disable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - enabled: false\n       name: sshd.service\n\nThis will disable the sshd service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_sshd_disabled",
      "instructions": "To check that the sshd service is disabled in system boot configuration,\nYou'll need to log into a node in the cluster.\nAs a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nSubsequently,run the following command:\n$ sudo systemctl is-enabled sshd\nOutput should indicate the sshd service has either not been installed,\nor has been disabled at all runlevels, as shown in the example below:\n$ sudo systemctl is-enabled sshd disabled\n\nRun the following command to verify sshd is not active (i.e. not running) through current runtime configuration:\n$ sudo systemctl is-active sshd\n\nIf the service is not running the command will return the following output:\ninactive\n\nThe service will also be masked, to check that the sshd is masked, run the following command:\n$ sudo systemctl show sshd | grep \"LoadState\\|UnitFileState\"\n\nIf the service is masked the command will return the following outputs:\n\nLoadState=masked\n\nUnitFileState=masked",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "service-sshd-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-3(6);IA-2(4)",
          "policies.open-cluster-management.io/controls": "CM-3(6),IA-2(4)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:22Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-sshd-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78496",
        "uid": "7d3e4afb-00fd-429b-b5c5-b4846be78ddf"
      },
      "rationale": "Red Hat Enterprise Linux CoreOS (RHCOS) is a single-purpose container operating system. RHCOS is only supported as a component of the OpenShift Container Platform. Remote management of the RHCOS nodes is performed at the OpenShift Container Platform API level. As a result, any direct remote access to the RHCOS nodes is unnecessary. Disabling the SSHD service helps reduce the number of open ports on each host.",
      "severity": "high",
      "title": "Disable SSH Server If Possible"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The syslog-ng service (in replacement of rsyslog) provides syslog-style logging by default on Debian. The syslog-ng service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-syslog-ng-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: syslog-ng.service\n       enabled: true\n\nThis will enable the syslog-ng service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_syslogng_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nsyslog-ng service:\n$ sudo systemctl is-active syslog-ng\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-syslogng-enabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AU-4(1)",
          "policies.open-cluster-management.io/controls": "CM-6(a),AU-4(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:56Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-syslogng-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78018",
        "uid": "d9f8fb0d-cf22-47d3-af56-5291b0e85d83"
      },
      "rationale": "The syslog-ng service must be running in order to provide logging services, which are essential to system administration.",
      "severity": "medium",
      "title": "Enable syslog-ng Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The systemd-coredump.socket unit is a socket activation of the systemd-coredump@.service which processes core dumps. By masking the unit, core dump processing is disabled.",
      "id": "xccdf_org.ssgproject.content_rule_service_systemd-coredump_disabled",
      "instructions": "To verify that acquiring, saving, and processing core dumps is disabled, run the\nfollowing command:\n$ systemctl status systemd-coredump.socket\nThe output should be similar to:\n● systemd-coredump.socket\n   Loaded: masked (Reason: Unit systemd-coredump.socket is masked.)\n   Active: inactive (dead) ...",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "service-systemd-coredump-disabled",
          "control.compliance.openshift.io/NIST-800-53": "SC-7(10)",
          "policies.open-cluster-management.io/controls": "SC-7(10)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-systemd-coredump-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78381",
        "uid": "511d483f-3ec4-42bb-8ac6-c2e5250bd8f0"
      },
      "rationale": "A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems.",
      "severity": "medium",
      "title": "Disable acquiring, saving, and processing core dumps"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The systemd-journald service is an essential component of systemd. The systemd-journald service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-systemd-journald-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: systemd-journald.service\n       enabled: true\n\nThis will enable the systemd-journald service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_systemd-journald_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nsystemd-journald service:\n$ sudo systemctl is-active systemd-journald\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-systemd-journald-enabled",
          "control.compliance.openshift.io/NIST-800-53": "SC-24",
          "policies.open-cluster-management.io/controls": "SC-24",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-systemd-journald-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "77995",
        "uid": "85b3ba1b-0d8b-4eb9-868f-795506378f5f"
      },
      "rationale": "In the event of a system failure, Red Hat Enterprise Linux CoreOS 4 must preserve any information necessary to determine cause of failure and any information necessary to return to operations with least disruption to system processes.",
      "severity": "medium",
      "title": "Enable systemd-journald Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The ufw service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-ufw-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: ufw.service\n       enabled: true\n\nThis will enable the ufw service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_ufw_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nufw service:\n$ sudo systemctl is-active ufw\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "service-ufw-enabled"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-ufw-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78172",
        "uid": "4e4c44bc-e086-498e-be5f-9785d640e503"
      },
      "rationale": "The ufw service must be enabled and running in order for ufw to protect the system",
      "severity": "medium",
      "title": "Verify ufw Enabled"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "metadata": {
              "annotations": {
                "complianceascode.io/depends-on": "xccdf_org.ssgproject.content_rule_package_usbguard_installed"
              }
            },
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "systemd": {
                  "units": [
                    {
                      "enabled": true,
                      "name": "usbguard.service"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The USBGuard service should be enabled. The usbguard service can be enabled with the following manifest:\n\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n labels:\n   machineconfiguration.openshift.io/role: master\n name: 75-master-usbguard-enable\nspec:\n config:\n   ignition:\n     version: 3.1.0\n   systemd:\n     units:\n     - name: usbguard.service\n       enabled: true\n\nThis will enable the usbguard service in all the nodes labeled with the \"master\" role.\n\nNote that this needs to be done for each MachineConfigPool\n\nFor more information on how to configure nodes with the Machine Config Operator see the relevant documentation ( https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html ).",
      "id": "xccdf_org.ssgproject.content_rule_service_usbguard_enabled",
      "instructions": "As a user with administrator privileges, log into a node in the relevant pool:\n\n$ oc debug node/$NODE_NAME\n\nAt the sh-4.4# prompt, run:\n\n# chroot /host\n\n\nRun the following command to determine the current status of the\nusbguard service:\n$ sudo systemctl is-active usbguard\nIf the service is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-stig,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "service-usbguard-enabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-8(3)(a);IA-3",
          "policies.open-cluster-management.io/controls": "CM-8(3)(a),IA-3",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-service-usbguard-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78583",
        "uid": "e5c07c1b-344d-4c44-939f-d4fda3059022"
      },
      "rationale": "The usbguard service must be running in order to enforce the USB device authorization policy for all USB devices.",
      "severity": "medium",
      "title": "Enable the USBGuard Service"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To set the default policy to DROP (instead of ACCEPT) for the built-in INPUT chain which processes incoming packets, add or correct the following line in /etc/sysconfig/ip6tables :\n\n:INPUT DROP [0:0]\n\nIf changes were required, reload the ip6tables rules:\n\n$ sudo service ip6tables reload",
      "id": "xccdf_org.ssgproject.content_rule_set_ip6tables_default_rule",
      "instructions": "If IPv6 is disabled, this is not applicable.\n\nInspect the file /etc/sysconfig/ip6tables to determine\nthe default policy for the INPUT chain. It should be set to DROP:\n$ sudo grep \":INPUT\" /etc/sysconfig/ip6tables",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "set-ip6tables-default-rule",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4;CIP-003-8 R5;CIP-004-6 R3",
          "control.compliance.openshift.io/NIST-800-53": "AC-4;CM-7(b);CA-3(5);SC-7(21);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4,CIP-003-8 R5,CIP-004-6 R3,AC-4,CM-7(b),CA-3(5),SC-7(21),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-set-ip6tables-default-rule",
        "namespace": "openshift-compliance",
        "resourceVersion": "78081",
        "uid": "77471001-27b8-4d8a-b8a4-f29cf9642147"
      },
      "rationale": "In ip6tables , the default policy is applied only after all the applicable rules in the table are examined for a match. Setting the default policy to DROP implements proper design for a firewall, i.e. any packets which are not explicitly permitted should not be accepted.",
      "severity": "medium",
      "title": "Set Default ip6tables Policy for Incoming Packets"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To set the default policy to DROP (instead of ACCEPT) for the built-in INPUT chain which processes incoming packets, add or correct the following line in /etc/sysconfig/iptables :\n\n:INPUT DROP [0:0]",
      "id": "xccdf_org.ssgproject.content_rule_set_iptables_default_rule",
      "instructions": "Inspect the file /etc/sysconfig/iptables to determine\nthe default policy for the INPUT chain. It should be set to DROP:\n$ sudo grep \":INPUT\" /etc/sysconfig/iptables",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "set-iptables-default-rule",
          "control.compliance.openshift.io/NIST-800-53": "CA-3(5);CM-7(b);SC-7(23);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CA-3(5),CM-7(b),SC-7(23),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-set-iptables-default-rule",
        "namespace": "openshift-compliance",
        "resourceVersion": "78085",
        "uid": "f0257a7d-64f5-4f3b-9b15-e4206142fcee"
      },
      "rationale": "In iptables the default policy is applied only after all the applicable rules in the table are examined for a match. Setting the default policy to DROP implements proper design for a firewall, i.e. any packets which are not explicitly permitted should not be accepted.",
      "severity": "medium",
      "title": "Set Default iptables Policy for Incoming Packets"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To set the default policy to DROP (instead of ACCEPT) for the built-in FORWARD chain which processes packets that will be forwarded from one interface to another, add or correct the following line in /etc/sysconfig/iptables :\n\n:FORWARD DROP [0:0]",
      "id": "xccdf_org.ssgproject.content_rule_set_iptables_default_rule_forward",
      "instructions": "Run the following command to ensure the default FORWARD policy is DROP:\ngrep \":FORWARD\" /etc/sysconfig/iptables\nThe output should be similar to the following:\n$ sudo grep \":FORWARD\" /etc/sysconfig/iptables\n:FORWARD DROP [0:0",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "set-iptables-default-rule-forward",
          "control.compliance.openshift.io/NIST-800-53": "CA-3(5);CM-7(b);SC-7(23);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CA-3(5),CM-7(b),SC-7(23),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:58Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-set-iptables-default-rule-forward",
        "namespace": "openshift-compliance",
        "resourceVersion": "78088",
        "uid": "792dc1c9-f4d0-45f6-bc72-98355486f83c"
      },
      "rationale": "In iptables , the default policy is applied only after all the applicable rules in the table are examined for a match. Setting the default policy to DROP implements proper design for a firewall, i.e. any packets which are not explicitly permitted should not be accepted.",
      "severity": "medium",
      "title": "Set Default iptables Policy for Forwarded Packets"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The RekeyLimit parameter specifies how often the session key is renegotiated, both in terms of amount of data that may be transmitted and the time elapsed. To decrease the default limits, put line RekeyLimit 512M 1h to file /etc/ssh/ssh_config.d/02-rekey-limit.conf. Make sure that there is no other RekeyLimit configuration preceding the include directive in the main config file /etc/ssh/ssh_config. Check also other files in /etc/ssh/ssh_config.d directory. Files are processed according to lexicographical order of file names. Make sure that there is no file processed before 02-rekey-limit.conf containing definition of RekeyLimit.",
      "id": "xccdf_org.ssgproject.content_rule_ssh_client_rekey_limit",
      "instructions": "To check if RekeyLimit is set correctly, run the following command:\n$ sudo grep RekeyLimit /etc/ssh/ssh_config.d/*.conf\nIf configured properly, output should be\n/etc/ssh/ssh_config.d/02-rekey-limit.conf:\nRekeyLimit  \nCheck also the main configuration file with the following command:\n$ sudo grep RekeyLimit /etc/ssh/ssh_config\nThe command should not return any output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "ssh-client-rekey-limit",
          "compliance.openshift.io/rule-variable": "var-ssh-client-rekey-limit-size,var-ssh-client-rekey-limit-time"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-ssh-client-rekey-limit",
        "namespace": "openshift-compliance",
        "resourceVersion": "78516",
        "uid": "0efc4e38-da27-446e-ac6e-bcd63536507b"
      },
      "rationale": "By decreasing the limit based on the amount of data and enabling time-based limit, effects of potential attacks against encryption keys are limited.",
      "severity": "medium",
      "title": "Configure session renegotiation for SSH client"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Only SSH protocol version 2 connections should be permitted. The default setting in /etc/ssh/sshd_config is correct, and can be verified by ensuring that the following line appears:\n\nProtocol 2",
      "id": "xccdf_org.ssgproject.content_rule_sshd_allow_only_protocol2",
      "instructions": "To check which SSH protocol version is allowed, check version of openssh-server with following command:\n\n$ rpm -qi openssh-server | grep Version\n\nVersions equal to or higher than 7.4 only allow Protocol 2.\nIf version is lower than 7.4, run the following command to check configuration:\n$ sudo grep Protocol /etc/ssh/sshd_config\nIf configured properly, output should be Protocol 2",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-allow-only-protocol2",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1;CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-17(a);AC-17(2);IA-5(1)(c);SC-13;MA-4(6)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,CIP-007-3 R7.1,CM-6(a),AC-17(a),AC-17(2),IA-5(1)(c),SC-13,MA-4(6)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-allow-only-protocol2",
        "namespace": "openshift-compliance",
        "resourceVersion": "78523",
        "uid": "59fb0879-15c1-4856-8e9c-ab563cd14873"
      },
      "rationale": "SSH protocol version 1 is an insecure implementation of the SSH protocol and has many well-known vulnerability exploits. Exploits of the SSH daemon could provide immediate root access to the system.",
      "severity": "high",
      "title": "Allow Only SSH Protocol 2",
      "warning": "SSH protocol version 1 is an insecure implementation of the SSH protocol and has many well-known vulnerability exploits. Exploits of the SSH daemon could provide immediate root access to the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Compression is useful for slow network connections over long distances but can cause performance issues on local LANs. If use of compression is required, it should be enabled only after a user has authenticated; otherwise, it should be disabled. To disable compression or delay compression until after a user has successfully authenticated, add or correct the following line in the /etc/ssh/sshd_config file:\n\nCompression no",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_compression",
      "instructions": "To check if compression is enabled or set correctly, run the\nfollowing command:\n$ sudo grep Compression /etc/ssh/sshd_config\nIf configured properly, output should be no or delayed.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-disable-compression",
          "compliance.openshift.io/rule-variable": "var-sshd-disable-compression",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-17(a),CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-compression",
        "namespace": "openshift-compliance",
        "resourceVersion": "78525",
        "uid": "5860a060-464f-438c-affe-2c99e0988758"
      },
      "rationale": "If compression is allowed in an SSH connection prior to authentication, vulnerabilities in the compression software could result in compromise of the system from an unauthenticated connection, potentially with root privileges.",
      "severity": "medium",
      "title": "Disable Compression Or Set Compression to delayed"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Disallow SSH login with empty passwords. The default SSH configuration disables logins with empty passwords. The appropriate configuration is used if no value is set for PermitEmptyPasswords.\n\nTo explicitly disallow SSH login from accounts with empty passwords, add or correct the following line in /etc/ssh/sshd_config :\n\nPermitEmptyPasswords no\n\nAny accounts with empty passwords should be disabled immediately, and PAM configuration should prevent users from being able to assign themselves empty passwords.",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_empty_passwords",
      "instructions": "To determine how the SSH daemon's PermitEmptyPasswords option is set, run the following command:\n\n$ sudo grep -i PermitEmptyPasswords /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8",
          "compliance.openshift.io/rule": "sshd-disable-empty-passwords",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-7(a);CM-7(b);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.4",
          "policies.open-cluster-management.io/controls": "AC-17(a),CM-7(a),CM-7(b),CM-6(a),Req-2.2.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-empty-passwords",
        "namespace": "openshift-compliance",
        "resourceVersion": "78527",
        "uid": "48c6b6a2-c3df-45bd-bad8-707f4a3b79c6"
      },
      "rationale": "Configuring this setting for the SSH daemon provides additional assurance that remote login via SSH will require a password, even in the event of misconfiguration elsewhere.",
      "severity": "high",
      "title": "Disable SSH Access via Empty Passwords"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Unless needed, SSH should not permit extraneous or unnecessary authentication mechanisms like GSSAPI.\n\nThe default SSH configuration disallows authentications based on GSSAPI. The appropriate configuration is used if no value is set for GSSAPIAuthentication.\n\nTo explicitly disable GSSAPI authentication, add or correct the following line in /etc/ssh/sshd_config :\n\nGSSAPIAuthentication no",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_gssapi_auth",
      "instructions": "To determine how the SSH daemon's GSSAPIAuthentication option is set, run the following command:\n\n$ sudo grep -i GSSAPIAuthentication /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8",
          "compliance.openshift.io/rule": "sshd-disable-gssapi-auth",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);AC-17(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),AC-17(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-gssapi-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "78528",
        "uid": "cb67fc9a-14cc-4e85-8340-a0aecfb5c520"
      },
      "rationale": "GSSAPI authentication is used to provide additional authentication mechanisms to applications. Allowing GSSAPI authentication through SSH exposes the system's GSSAPI to remote hosts, increasing the attack surface of the system.",
      "severity": "medium",
      "title": "Disable GSSAPI Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Unless needed, SSH should not permit extraneous or unnecessary authentication mechanisms like Kerberos.\n\nThe default SSH configuration disallows authentication validation through Kerberos. The appropriate configuration is used if no value is set for KerberosAuthentication.\n\nTo explicitly disable Kerberos authentication, add or correct the following line in /etc/ssh/sshd_config :\n\nKerberosAuthentication no",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_kerb_auth",
      "instructions": "To determine how the SSH daemon's KerberosAuthentication option is set, run the following command:\n\n$ sudo grep -i KerberosAuthentication /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-disable-kerb-auth",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-17(a),CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-kerb-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "78529",
        "uid": "893da25a-f2b2-4d91-a452-c2708a9e4f45"
      },
      "rationale": "Kerberos authentication for SSH is often implemented using GSSAPI. If Kerberos is enabled through SSH, the SSH daemon provides a means of access to the system's Kerberos implementation. Configuring these settings for the SSH daemon provides additional assurance that remote logon via SSH will not use unused methods of authentication, even in the event of misconfiguration elsewhere.",
      "severity": "medium",
      "title": "Disable Kerberos Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Unless needed, SSH should not permit extraneous or unnecessary authentication mechanisms. To disable PubkeyAuthentication authentication, add or correct the following line in /etc/ssh/sshd_config :\n\nPubkeyAuthentication no",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_pubkey_auth",
      "instructions": "To determine how the SSH daemon's PubkeyAuthentication option is set, run the following command:\n\n$ sudo grep -i PubkeyAuthentication /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-disable-pubkey-auth"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-pubkey-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "78532",
        "uid": "001e3896-801c-4f44-9368-e62eaa6a322e"
      },
      "rationale": "PubkeyAuthentication authentication is used to provide additional authentication mechanisms to applications. Allowing PubkeyAuthentication authentication through SSH allows users to generate their own authentication tokens, increasing the attack surface of the system.",
      "severity": "medium",
      "title": "Disable PubkeyAuthentication Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "SSH can emulate the behavior of the obsolete rsh command in allowing users to enable insecure access to their accounts via.rhosts files.\n\nThe default SSH configuration disables support for.rhosts. The appropriate configuration is used if no value is set for IgnoreRhosts.\n\nTo explicitly disable support for .rhosts files, add or correct the following line in /etc/ssh/sshd_config :\n\nIgnoreRhosts yes",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_rhosts",
      "instructions": "To determine how the SSH daemon's IgnoreRhosts option is set, run the following command:\n\n$ sudo grep -i IgnoreRhosts /etc/ssh/sshd_config\n\nIf a line indicating yes is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "sshd-disable-rhosts",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-17(a),CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-rhosts",
        "namespace": "openshift-compliance",
        "resourceVersion": "78534",
        "uid": "48dcfe2b-447b-4531-b82c-20de4f7483f9"
      },
      "rationale": "SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts.",
      "severity": "medium",
      "title": "Disable SSH Support for .rhosts Files"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SSH can allow authentication through the obsolete rsh command through the use of the authenticating user's SSH keys. This should be disabled.\n\nTo ensure this behavior is disabled, add or correct the following line in /etc/ssh/sshd_config :\n\nRhostsRSAAuthentication no",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_rhosts_rsa",
      "instructions": "To check which SSH protocol version is allowed, check version of\nopenssh-server with following command:\n$ rpm -qi openssh-server | grep Version\nVersions equal to or higher than 7.4 have deprecated the RhostsRSAAuthentication option.\nIf version is lower than 7.4, run the following command to check configuration:\nTo determine how the SSH daemon's RhostsRSAAuthentication option is set, run the following command:\n\n$ sudo grep -i RhostsRSAAuthentication /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-disable-rhosts-rsa",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-17(a),CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-rhosts-rsa",
        "namespace": "openshift-compliance",
        "resourceVersion": "78535",
        "uid": "3965068e-a539-4cc2-8230-7fefec4990ec"
      },
      "rationale": "Configuring this setting for the SSH daemon provides additional assurance that remote login via SSH will require a password, even in the event of misconfiguration elsewhere.",
      "severity": "medium",
      "title": "Disable SSH Support for Rhosts RSA Authentication",
      "warning": "Configuring this setting for the SSH daemon provides additional assurance that remote login via SSH will require a password, even in the event of misconfiguration elsewhere."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The root user should never be allowed to login to a system directly over a network. To disable root login via SSH, add or correct the following line in /etc/ssh/sshd_config :\n\nPermitRootLogin no",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_root_login",
      "instructions": "To determine how the SSH daemon's PermitRootLogin option is set, run the following command:\n\n$ sudo grep -i PermitRootLogin /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-e8,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "sshd-disable-root-login",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-6(2);AC-17(a);IA-2;IA-2(5);CM-7(a);CM-7(b);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.4",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-6(2),AC-17(a),IA-2,IA-2(5),CM-7(a),CM-7(b),CM-6(a),Req-2.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-root-login",
        "namespace": "openshift-compliance",
        "resourceVersion": "78540",
        "uid": "48315718-9b82-44b8-a1a2-eb55966c3eab"
      },
      "rationale": "Even though the communications channel may be encrypted, an additional layer of security is gained by extending the policy of not logging directly on as root. In addition, logging in with a user-specific account provides individual accountability of actions performed on the system and also helps to minimize direct attack attempts on root's password.",
      "severity": "medium",
      "title": "Disable SSH Root Login"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To disable password-based root logins over SSH, add or correct the following line in /etc/ssh/sshd_config :\n\nPermitRootLogin prohibit-password",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_root_password_login",
      "instructions": "To determine how the SSH daemon's PermitRootLogin option is set, run the following command:\n\n$ sudo grep -i PermitRootLogin /etc/ssh/sshd_config\n\nIf a line indicating prohibit-password is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-disable-root-password-login"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-root-password-login",
        "namespace": "openshift-compliance",
        "resourceVersion": "78538",
        "uid": "29e86c9d-60b5-4b99-b321-77a1446d34f6"
      },
      "rationale": "Even though the communications channel may be encrypted, an additional layer of security is gained by preventing use of a password. This also helps to minimize direct attack attempts on root's password.",
      "severity": "medium",
      "title": "Disable SSH root Login with a Password (Insecure)",
      "warning": "Even though the communications channel may be encrypted, an additional layer of security is gained by preventing use of a password. This also helps to minimize direct attack attempts on root's password."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The AllowTcpForwarding parameter specifies whether TCP forwarding is permitted. To disable TCP forwarding, add or correct the following line in /etc/ssh/sshd_config :\n\nAllowTcpForwarding no",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_tcp_forwarding",
      "instructions": "To determine how the SSH daemon's AllowTcpForwarding option is set, run the following command:\n\n$ sudo grep -i AllowTcpForwarding /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-disable-tcp-forwarding"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-tcp-forwarding",
        "namespace": "openshift-compliance",
        "resourceVersion": "78542",
        "uid": "ec5a80d4-7be6-446f-8def-a33dcd189eee"
      },
      "rationale": "Leaving port forwarding enabled can expose the organization to security risks and back-doors.",
      "severity": "medium",
      "title": "Disable SSH TCP Forwarding"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "SSH can allow system users to connect to systems if a cache of the remote systems public keys is available. This should be disabled.\n\nTo ensure this behavior is disabled, add or correct the following line in /etc/ssh/sshd_config :\n\nIgnoreUserKnownHosts yes",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_user_known_hosts",
      "instructions": "To determine how the SSH daemon's IgnoreUserKnownHosts option is set, run the following command:\n\n$ sudo grep -i IgnoreUserKnownHosts /etc/ssh/sshd_config\n\nIf a line indicating yes is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8",
          "compliance.openshift.io/rule": "sshd-disable-user-known-hosts",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-17(a),CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-user-known-hosts",
        "namespace": "openshift-compliance",
        "resourceVersion": "78543",
        "uid": "85d89680-6f50-47ae-8355-06cd200a3810"
      },
      "rationale": "Configuring this setting for the SSH daemon provides additional assurance that remote login via SSH will require a password, even in the event of misconfiguration elsewhere.",
      "severity": "medium",
      "title": "Disable SSH Support for User Known Hosts"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The X11Forwarding parameter provides the ability to tunnel X11 traffic through the connection to enable remote graphic connections. SSH has the capability to encrypt remote X11 connections when SSH's X11Forwarding option is enabled.\n\nThe default SSH configuration disables X11Forwarding. The appropriate configuration is used if no value is set for X11Forwarding.\n\nTo explicitly disable X11 Forwarding, add or correct the following line in /etc/ssh/sshd_config :\n\nX11Forwarding no",
      "id": "xccdf_org.ssgproject.content_rule_sshd_disable_x11_forwarding",
      "instructions": "To determine how the SSH daemon's X11Forwarding option is set, run the following command:\n\n$ sudo grep -i X11Forwarding /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-disable-x11-forwarding",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(b)",
          "policies.open-cluster-management.io/controls": "CM-6(b)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-disable-x11-forwarding",
        "namespace": "openshift-compliance",
        "resourceVersion": "78545",
        "uid": "0ce12e3d-85a0-42d6-ac4c-917a4060c61c"
      },
      "rationale": "Disable X11 forwarding unless there is an operational requirement to use X11 applications directly. There is a small risk that the remote X11 servers of users who are logged in via SSH with X11 forwarding could be compromised by other users on the X11 server. Note that even if X11 forwarding is disabled, users can always install their own forwarders.",
      "severity": "medium",
      "title": "Disable X11 Forwarding"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Ensure that users are not able to override environment variables of the SSH daemon.\n\nThe default SSH configuration disables environment processing. The appropriate configuration is used if no value is set for PermitUserEnvironment.\n\nTo explicitly disable Environment options, add or correct the following /etc/ssh/sshd_config :\n\nPermitUserEnvironment no",
      "id": "xccdf_org.ssgproject.content_rule_sshd_do_not_permit_user_env",
      "instructions": "To determine how the SSH daemon's PermitUserEnvironment option is set, run the following command:\n\n$ sudo grep -i PermitUserEnvironment /etc/ssh/sshd_config\n\nIf a line indicating no is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8",
          "compliance.openshift.io/rule": "sshd-do-not-permit-user-env",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-7(a);CM-7(b);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.4",
          "policies.open-cluster-management.io/controls": "AC-17(a),CM-7(a),CM-7(b),CM-6(a),Req-2.2.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-do-not-permit-user-env",
        "namespace": "openshift-compliance",
        "resourceVersion": "78546",
        "uid": "6e4a78e1-e7fb-417b-b426-6790aa6f1e3d"
      },
      "rationale": "SSH environment options potentially allow users to bypass access restriction in some configurations.",
      "severity": "medium",
      "title": "Do Not Allow SSH Environment Options"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Sites setup to use Kerberos or other GSSAPI Authenticaion require setting sshd to accept this authentication. To enable GSSAPI authentication, add or correct the following line in /etc/ssh/sshd_config :\n\nGSSAPIAuthentication yes",
      "id": "xccdf_org.ssgproject.content_rule_sshd_enable_gssapi_auth",
      "instructions": "To determine how the SSH daemon's GSSAPIAuthentication option is set, run the following command:\n\n$ sudo grep -i GSSAPIAuthentication /etc/ssh/sshd_config\n\nIf a line indicating yes is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-enable-gssapi-auth"
        },
        "creationTimestamp": "2024-03-05T15:03:24Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-enable-gssapi-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "78548",
        "uid": "320c525b-2947-4cb8-85ba-136140789ad0"
      },
      "rationale": "Kerberos authentication for SSH is often implemented using GSSAPI. If Kerberos is enabled through SSH, the SSH daemon provides a means of access to the system's Kerberos implementation. Vulnerabilities in the system's Kerberos implementations may be subject to exploitation. For enterprises, Kerberos is often enabled and used with GSSAPI for centralized user account management which may necessitate enabling of GSSAPI functionality in SSH.",
      "severity": "medium",
      "title": "Enable GSSAPI Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "UsePAM Enables the Pluggable Authentication Module interface. If set to “yes” this will enable PAM authentication using ChallengeResponseAuthentication and PasswordAuthentication in addition to PAM account and session module processing for all authentication types. To enable PAM authentication, add or correct the following line in /etc/ssh/sshd_config :\n\nUsePAM yes",
      "id": "xccdf_org.ssgproject.content_rule_sshd_enable_pam",
      "instructions": "To determine how the SSH daemon's UsePAM option is set, run the following command:\n\n$ sudo grep -i UsePAM /etc/ssh/sshd_config\n\nIf a line indicating yes is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-enable-pam"
        },
        "creationTimestamp": "2024-03-05T15:03:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-enable-pam",
        "namespace": "openshift-compliance",
        "resourceVersion": "78552",
        "uid": "3468f89a-f41e-4504-ae2e-85d5901b244c"
      },
      "rationale": "When UsePAM is set to yes, PAM runs through account and session types properly. This is important if you want to restrict access to services based off of IP, time or other factors of the account. Additionally, you can make sure users inherit certain environment variables on login or disallow access to the server.",
      "severity": "medium",
      "title": "Enable PAM"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Enable SSH login with public keys.\n\nThe default SSH configuration enables authentication based on public keys. The appropriate configuration is used if no value is set for PubkeyAuthentication.\n\nTo explicitly enable Public Key Authentication, add or correct the following /etc/ssh/sshd_config :\n\nPubkeyAuthentication yes",
      "id": "xccdf_org.ssgproject.content_rule_sshd_enable_pubkey_auth",
      "instructions": "To determine how the SSH daemon's PubkeyAuthentication option is set, run the following command:\n\n$ sudo grep -i PubkeyAuthentication /etc/ssh/sshd_config\n\nIf a line indicating yes is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-enable-pubkey-auth"
        },
        "creationTimestamp": "2024-03-05T15:03:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-enable-pubkey-auth",
        "namespace": "openshift-compliance",
        "resourceVersion": "78554",
        "uid": "cf2a5186-7598-4d0e-ba11-dc07fa49b6bc"
      },
      "rationale": "Without the use of multifactor authentication, the ease of access to privileged functions is greatly increased. Multifactor authentication requires using two or more factors to achieve authentication. A privileged account is defined as an information system account with authorizations of a privileged user. The DoD CAC with DoD-approved PKI is an example of multifactor authentication.",
      "severity": "medium",
      "title": "Enable Public Key Authentication"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "SSHs StrictModes option checks file and ownership permissions in the user's home directory.ssh folder before accepting login. If world- writable permissions are found, logon is rejected.\n\nThe default SSH configuration has StrictModes enabled. The appropriate configuration is used if no value is set for StrictModes.\n\nTo explicitly enable StrictModes in SSH, add or correct the following line in /etc/ssh/sshd_config :\n\nStrictModes yes",
      "id": "xccdf_org.ssgproject.content_rule_sshd_enable_strictmodes",
      "instructions": "To determine how the SSH daemon's StrictModes option is set, run the following command:\n\n$ sudo grep -i StrictModes /etc/ssh/sshd_config\n\nIf a line indicating yes is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8",
          "compliance.openshift.io/rule": "sshd-enable-strictmodes",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "AC-6;AC-17(a);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,AC-6,AC-17(a),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-enable-strictmodes",
        "namespace": "openshift-compliance",
        "resourceVersion": "78555",
        "uid": "3e4c9384-1e53-4fcc-a24f-5ffc55a3efd7"
      },
      "rationale": "If other users have access to modify user-specific SSH configuration files, they may be able to log into the system as another user.",
      "severity": "medium",
      "title": "Enable Use of Strict Mode Checking"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To enable the warning banner and ensure it is consistent across the system, add or correct the following line in /etc/ssh/sshd_config :\n\nBanner /etc/issue\n\nAnother section contains information on how to create an appropriate system-wide warning banner.",
      "id": "xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner",
      "instructions": "To determine how the SSH daemon's Banner option is set, run the following command:\n\n$ sudo grep -i Banner /etc/ssh/sshd_config\n\nIf a line indicating /etc/issue is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-enable-warning-banner",
          "control.compliance.openshift.io/NIST-800-53": "AC-8(a);AC-8(c);AC-17(a);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.4",
          "policies.open-cluster-management.io/controls": "AC-8(a),AC-8(c),AC-17(a),CM-6(a),Req-2.2.4",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-enable-warning-banner",
        "namespace": "openshift-compliance",
        "resourceVersion": "78557",
        "uid": "e6794e18-97f9-420e-81a8-f2b6c1b473fe"
      },
      "rationale": "The warning message reinforces policy awareness during the logon process and facilitates possible legal action against attackers. Alternatively, systems whose ownership should not be obvious should ensure usage of a banner that does not provide easy attribution.",
      "severity": "medium",
      "title": "Enable SSH Warning Banner"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To enable the warning banner and ensure it is consistent across the system, add or correct the following line in /etc/ssh/sshd_config :\n\nBanner /etc/issue.net\n\nAnother section contains information on how to create an appropriate system-wide warning banner.",
      "id": "xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner_net",
      "instructions": "To determine how the SSH daemon's Banner option is set, run the following command:\n\n$ sudo grep -i Banner /etc/ssh/sshd_config\n\nIf a line indicating /etc/issue.net is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-enable-warning-banner-net",
          "control.compliance.openshift.io/NIST-800-53": "AC-8(a);AC-8(c);AC-17(a);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-8(a),AC-8(c),AC-17(a),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-enable-warning-banner-net",
        "namespace": "openshift-compliance",
        "resourceVersion": "78556",
        "uid": "f8287c25-1aef-4744-bcb9-ae87bf140ebd"
      },
      "rationale": "The warning message reinforces policy awareness during the logon process and facilitates possible legal action against attackers. Alternatively, systems whose ownership should not be obvious should ensure usage of a banner that does not provide easy attribution.",
      "severity": "medium",
      "title": "Enable SSH Warning Banner"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "By default, remote X11 connections are not encrypted when initiated by users. SSH has the capability to encrypt remote X11 connections when SSH's X11Forwarding option is enabled.\n\nTo enable X11 Forwarding, add or correct the following line in /etc/ssh/sshd_config :\n\nX11Forwarding yes",
      "id": "xccdf_org.ssgproject.content_rule_sshd_enable_x11_forwarding",
      "instructions": "To determine how the SSH daemon's X11Forwarding option is set, run the following command:\n\n$ sudo grep -i X11Forwarding /etc/ssh/sshd_config\n\nIf a line indicating yes is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-enable-x11-forwarding",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-17(a);AC-17(2)",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R7.1,CM-6(a),AC-17(a),AC-17(2)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-enable-x11-forwarding",
        "namespace": "openshift-compliance",
        "resourceVersion": "78569",
        "uid": "cd5b8d60-7441-4aab-a015-06b0e9fa7181"
      },
      "rationale": "Non-encrypted X displays allow an attacker to capture keystrokes and to execute commands remotely.",
      "severity": "high",
      "title": "Enable Encrypted X11 Forwarding"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "By default, the SSH configuration allows any user with an account to access the system. There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged: - AllowUsers variable gives the system administrator the option of allowing specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically allowing a user's access only from a particular host, the entry can be specified in the form of user@host. - AllowGroups variable gives the system administrator the option of allowing specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable. - DenyUsers variable gives the system administrator the option of denying specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically denying a user's access from a particular host, the entry can be specified in the form of user@host. - DenyGroups variable gives the system administrator the option of denying specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable.",
      "id": "xccdf_org.ssgproject.content_rule_sshd_limit_user_access",
      "instructions": "To ensure sshd limits the users who can log in, run the following:\npre>$ sudo grep -rPi '^\\h*(allow|deny)(users|groups)\\h+\\H+(\\h+.*)?$' /etc/ssh/sshd_config*\nIf properly configured, the output should be a list of usernames and/or\ngroups allowed to log in to this system.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "sshd-limit-user-access",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.2.3;CIP-004-6 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-3;CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.4",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.2.3,CIP-004-6 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-3,CM-6(a),Req-2.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-limit-user-access",
        "namespace": "openshift-compliance",
        "resourceVersion": "78561",
        "uid": "4c71af7b-8b25-4d5d-9e03-2dd014f57b1a"
      },
      "rationale": "Specifying which accounts are allowed SSH access into the system reduces the possibility of unauthorized access to the system.",
      "severity": "unknown",
      "title": "Limit Users' SSH Access",
      "warning": "Specifying which accounts are allowed SSH access into the system reduces the possibility of unauthorized access to the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "Ensure that SSH will display the date and time of the last successful account logon.\n\nThe default SSH configuration enables print of the date and time of the last login. The appropriate configuration is used if no value is set for PrintLastLog.\n\nTo explicitly enable LastLog in SSH, add or correct the following line in /etc/ssh/sshd_config :\n\nPrintLastLog yes",
      "id": "xccdf_org.ssgproject.content_rule_sshd_print_last_log",
      "instructions": "To determine how the SSH daemon's PrintLastLog option is set, run the following command:\n\n$ sudo grep -i PrintLastLog /etc/ssh/sshd_config\n\nIf a line indicating yes is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8",
          "compliance.openshift.io/rule": "sshd-print-last-log",
          "control.compliance.openshift.io/NIST-800-53": "AC-9;AC-9(1)",
          "policies.open-cluster-management.io/controls": "AC-9,AC-9(1)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-print-last-log",
        "namespace": "openshift-compliance",
        "resourceVersion": "78559",
        "uid": "aa7818ae-82ca-4433-85f1-b86612ffcf43"
      },
      "rationale": "Providing users feedback on when account accesses last occurred facilitates user recognition and reporting of unauthorized account use.",
      "severity": "medium",
      "title": "Enable SSH Print Last Log"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The RekeyLimit parameter specifies how often the session key of the is renegotiated, both in terms of amount of data that may be transmitted and the time elapsed.\n\nTo decrease the default limits, add or correct the following line in /etc/ssh/sshd_config :\n\nRekeyLimit 512M  1h",
      "id": "xccdf_org.ssgproject.content_rule_sshd_rekey_limit",
      "instructions": "To check if RekeyLimit is set correctly, run the\nfollowing command:\n\n$ sudo grep RekeyLimit /etc/ssh/sshd_config\n\nIf configured properly, output should be\nRekeyLimit",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-rekey-limit",
          "compliance.openshift.io/rule-variable": "var-rekey-limit-size,var-rekey-limit-time"
        },
        "creationTimestamp": "2024-03-05T15:03:25Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-rekey-limit",
        "namespace": "openshift-compliance",
        "resourceVersion": "78560",
        "uid": "526de560-77bb-4700-9f95-691d07845ca1"
      },
      "rationale": "By decreasing the limit based on the amount of data and enabling time-based limit, effects of potential attacks against encryption keys are limited.",
      "severity": "medium",
      "title": "Force frequent session key renegotiation"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "SSH allows administrators to set a network responsiveness timeout interval. After this interval has passed, the unresponsive client will be automatically logged out.\n\nTo set this timeout interval, edit the following line in /etc/ssh/sshd_config as follows:\n\nClientAliveInterval *300*\n\nThe timeout *interval* is given in seconds. For example, have a timeout of 10 minutes, set *interval* to 600.\n\nIf a shorter timeout has already been set for the login shell, that value will preempt any SSH setting made in /etc/ssh/sshd_config. Keep in mind that some processes may stop SSH from correctly detecting that the user is idle.",
      "id": "xccdf_org.ssgproject.content_rule_sshd_set_idle_timeout",
      "instructions": "Run the following command to see what the timeout interval is:\n$ sudo grep ClientAliveInterval /etc/ssh/sshd_config\nIf properly configured, the output should be:\nClientAliveInterval",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "sshd-set-idle-timeout",
          "compliance.openshift.io/rule-variable": "sshd-idle-timeout-value",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-007-3 R5.1;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-17(a);AC-2(5);AC-12;SC-10",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.1.8",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-007-3 R5.1,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,CM-6(a),AC-17(a),AC-2(5),AC-12,SC-10,Req-8.1.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-set-idle-timeout",
        "namespace": "openshift-compliance",
        "resourceVersion": "78520",
        "uid": "3d04fe60-7074-4efc-98f3-42dc166b3e13"
      },
      "rationale": "Terminating an idle ssh session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been let unattended.",
      "severity": "medium",
      "title": "Set SSH Client Alive Interval",
      "warning": "Terminating an idle ssh session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been let unattended."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The SSH server sends at most ClientAliveCountMax messages during a SSH session and waits for a response from the SSH client. The option ClientAliveInterval configures timeout after each ClientAliveCountMax message. If the SSH server does not receive a response from the client, then the connection is considered unresponsive and terminated. To ensure the SSH timeout occurs precisely when the ClientAliveInterval is set, set the ClientAliveCountMax to value of 0 in /etc/ssh/sshd_config :",
      "id": "xccdf_org.ssgproject.content_rule_sshd_set_keepalive_0",
      "instructions": "To ensure ClientAliveInterval is set correctly, run the following command:\n\n$ sudo grep ClientAliveCountMax /etc/ssh/sshd_config\n\nIf properly configured, the output should be:\nClientAliveCountMax 0\n\nIn this case, the SSH timeout occurs precisely when\nthe ClientAliveInterval is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "sshd-set-keepalive-0",
          "control.compliance.openshift.io/NERC-CIP": "CIP-004-6 R2.2.3;CIP-007-3 R5.1;CIP-007-3 R5.2;CIP-007-3 R5.3.1;CIP-007-3 R5.3.2;CIP-007-3 R5.3.3",
          "control.compliance.openshift.io/NIST-800-53": "AC-2(5);AC-12;AC-17(a);SC-10;CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.1.8",
          "policies.open-cluster-management.io/controls": "CIP-004-6 R2.2.3,CIP-007-3 R5.1,CIP-007-3 R5.2,CIP-007-3 R5.3.1,CIP-007-3 R5.3.2,CIP-007-3 R5.3.3,AC-2(5),AC-12,AC-17(a),SC-10,CM-6(a),Req-8.1.8",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:23Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-set-keepalive-0",
        "namespace": "openshift-compliance",
        "resourceVersion": "78517",
        "uid": "118bd3f4-fe64-4c97-91e2-20aec3eadff8"
      },
      "rationale": "This ensures a user login will be terminated as soon as the ClientAliveInterval is reached.",
      "severity": "medium",
      "title": "Set SSH Client Alive Count Max to zero"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The LoginGraceTime parameter to the SSH server specifies the time allowed for successful authentication to the SSH server. The longer the Grace period is the more open unauthenticated connections can exist. Like other session controls in this session the Grace Period should be limited to appropriate limits to ensure the service is available for needed access.",
      "id": "xccdf_org.ssgproject.content_rule_sshd_set_login_grace_time",
      "instructions": "To ensure LoginGraceTime is set correctly, run the following command:\n$ sudo grep LoginGraceTime /etc/ssh/sshd_config\nIf properly configured, the output should be:\nLoginGraceTime \nIf the option is set to a number greater than 0, then the unauthenticated session will be disconnected\nafter the configured number seconds.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-set-login-grace-time"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-set-login-grace-time",
        "namespace": "openshift-compliance",
        "resourceVersion": "78568",
        "uid": "3ad4c77e-37cf-4a1e-9417-3d4ac17cd3d5"
      },
      "rationale": "Setting the LoginGraceTime parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. It will also limit the number of concurrent unauthenticated connections.",
      "severity": "medium",
      "title": "Ensure SSH LoginGraceTime is configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The INFO parameter specifices that record login and logout activity will be logged.\n\nThe default SSH configuration sets the log level to INFO. The appropriate configuration is used if no value is set for LogLevel.\n\nTo explicitly specify the log level in SSH, add or correct the following line in /etc/ssh/sshd_config :\n\nLogLevel INFO",
      "id": "xccdf_org.ssgproject.content_rule_sshd_set_loglevel_info",
      "instructions": "To determine how the SSH daemon's LogLevel option is set, run the following command:\n\n$ sudo grep -i LogLevel /etc/ssh/sshd_config\n\nIf a line indicating INFO is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-e8",
          "compliance.openshift.io/rule": "sshd-set-loglevel-info",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);CM-6(a)",
          "policies.open-cluster-management.io/controls": "AC-17(a),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-set-loglevel-info",
        "namespace": "openshift-compliance",
        "resourceVersion": "78567",
        "uid": "84206c5f-04cb-428c-98da-0b4f17f50e14"
      },
      "rationale": "SSH provides several logging levels with varying amounts of verbosity. DEBUG is specifically not recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security information. INFO level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.",
      "severity": "low",
      "title": "Set LogLevel to INFO"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "disruption": "low",
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0A%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018/04/09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D/usr/local/bin%3A/usr/bin%3A/usr/local/sbin%3A/usr/sbin%0A%0AInclude%20/etc/ssh/sshd_config.d/%2A.conf%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20/etc/ssh/ssh_host_rsa_key%0AHostKey%20/etc/ssh/ssh_host_ecdsa_key%0AHostKey%20/etc/ssh/ssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20%7B%7B.var_rekey_limit_size%7D%7D%20%7B%7B.var_rekey_limit_time%7D%7D%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20/etc/sysconfig/sshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0ALogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%20%7B%7B.var_sshd_set_login_grace_time%7D%7D%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh/authorized_keys%20and%20.ssh/authorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh/authorized_keys%0AAuthorizedKeysFile%09.ssh/authorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20/etc/ssh/ssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~/.ssh/known_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~/.rhosts%20and%20~/.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s/key%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20/etc/pam.d/sshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20%7B%7B.var_sshd_disable_compression%7D%7D%0AClientAliveInterval%20%7B%7B.sshd_idle_timeout_value%7D%7D%0AClientAliveCountMax%20%7B%7B.var_sshd_set_keepalive%7D%7D%0A%23UseDNS%20no%0A%23PidFile%20/var/run/sshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20/etc/issue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09/usr/libexec/openssh/sftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20%7B%7B.var_sshd_priv_separation%7D%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/ssh/sshd_config"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "The VERBOSE parameter configures the SSH daemon to record login and logout activity. To specify the log level in SSH, add or correct the following line in /etc/ssh/sshd_config :\n\nLogLevel VERBOSE",
      "id": "xccdf_org.ssgproject.content_rule_sshd_set_loglevel_verbose",
      "instructions": "To determine how the SSH daemon's LogLevel option is set, run the following command:\n\n$ sudo grep -i LogLevel /etc/ssh/sshd_config\n\nIf a line indicating VERBOSE is returned, then the required value is set.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-set-loglevel-verbose",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R7.1",
          "control.compliance.openshift.io/NIST-800-53": "AC-17(a);AC-17(1);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.4",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R7.1,AC-17(a),AC-17(1),CM-6(a),Req-2.2.4",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-set-loglevel-verbose",
        "namespace": "openshift-compliance",
        "resourceVersion": "78570",
        "uid": "9d40478c-4afb-4a98-a271-07c658aaaca4"
      },
      "rationale": "SSH provides several logging levels with varying amounts of verbosity. DEBUG is specifically not recommended other than strictly for debugging SSH communications since it provides so much data that it is difficult to identify important security information. INFO or VERBOSE level is the basic level that only records login activity of SSH users. In many situations, such as Incident Response, it is important to determine when a particular user was active on a system. The logout record can eliminate those users who disconnected, which helps narrow the field.",
      "severity": "medium",
      "title": "Set SSH Daemon LogLevel to VERBOSE"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The MaxAuthTries parameter specifies the maximum number of authentication attempts permitted per connection. Once the number of failures reaches half this value, additional failures are logged. to set MaxAUthTries edit /etc/ssh/sshd_config as follows:\n\nMaxAuthTries 4",
      "id": "xccdf_org.ssgproject.content_rule_sshd_set_max_auth_tries",
      "instructions": "To ensure the MaxAuthTries parameter is set, run the following command:\n$ sudo grep MaxAuthTries /etc/ssh/sshd_config\nIf properly configured, output should be:\nMaxAuthTries",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-set-max-auth-tries",
          "compliance.openshift.io/rule-variable": "sshd-max-auth-tries-value"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-set-max-auth-tries",
        "namespace": "openshift-compliance",
        "resourceVersion": "78571",
        "uid": "424425ab-4608-491f-a2f2-4c35ccd1eeec"
      },
      "rationale": "Setting the MaxAuthTries parameter to a low number will minimize the risk of successful brute force attacks to the SSH server.",
      "severity": "medium",
      "title": "Set SSH authentication attempt limit"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The MaxSessions parameter specifies the maximum number of open sessions permitted from a given connection. To set MaxSessions edit /etc/ssh/sshd_config as follows:\n\nMaxSessions 10",
      "id": "xccdf_org.ssgproject.content_rule_sshd_set_max_sessions",
      "instructions": "Run the following command to see what the max sessions number is:\n$ sudo grep MaxSessions /etc/ssh/sshd_config\nIf properly configured, the output should be:\nMaxSessions",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-set-max-sessions",
          "compliance.openshift.io/rule-variable": "var-sshd-max-sessions"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-set-max-sessions",
        "namespace": "openshift-compliance",
        "resourceVersion": "78573",
        "uid": "ffae898b-073a-4ddb-9ece-e0448673d8c8"
      },
      "rationale": "To protect a system from denial of service due to a large number of concurrent sessions, use the rate limiting function of MaxSessions to protect availability of sshd logins and prevent overwhelming the daemon.",
      "severity": "medium",
      "title": "Set SSH MaxSessions limit"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The MaxStartups parameter specifies the maximum number of concurrent unauthenticated connections to the SSH daemon. Additional connections will be dropped until authentication succeeds or the LoginGraceTime expires for a connection. To confgure MaxStartups, you should add or correct the following line in the /etc/ssh/sshd_config file:\n\nMaxStartups 10:30:100 \n\nCIS recommends a MaxStartups value of '10:30:60', or more restrictive where dictated by site policy.",
      "id": "xccdf_org.ssgproject.content_rule_sshd_set_maxstartups",
      "instructions": "To check if MaxStartups is configured, run the following command:\n$ sudo grep MaxStartups /etc/ssh/sshd_config\nIf configured, this command should output the configuration.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-set-maxstartups",
          "compliance.openshift.io/rule-variable": "var-sshd-set-maxstartups"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-set-maxstartups",
        "namespace": "openshift-compliance",
        "resourceVersion": "78572",
        "uid": "d7f3d04d-49dc-4b51-9444-d742fed440ac"
      },
      "rationale": "To protect a system from denial of service due to a large number of pending authentication connection attempts, use the rate limiting function of MaxStartups to protect availability of sshd logins and prevent overwhelming the daemon.",
      "severity": "medium",
      "title": "Ensure SSH MaxStartups is configured"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "When enabled, SSH will create an unprivileged child process that has the privilege of the authenticated user. To enable privilege separation in SSH, add or correct the following line in the /etc/ssh/sshd_config file:\n\nUsePrivilegeSeparation sandbox",
      "id": "xccdf_org.ssgproject.content_rule_sshd_use_priv_separation",
      "instructions": "To check if UsePrivilegeSeparation is enabled or set correctly, run the\nfollowing command:\n$ sudo grep UsePrivilegeSeparation /etc/ssh/sshd_config\nIf configured properly, output should be .",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sshd-use-priv-separation",
          "compliance.openshift.io/rule-variable": "var-sshd-priv-separation",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-17(a);AC-6",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-17(a),AC-6",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sshd-use-priv-separation",
        "namespace": "openshift-compliance",
        "resourceVersion": "78582",
        "uid": "451f7847-c303-4536-9537-2a3c08a57e94"
      },
      "rationale": "SSH daemon privilege separation causes the SSH process to drop root privileges when not needed which would decrease the impact of software vulnerabilities in the unprivileged section.",
      "severity": "medium",
      "title": "Enable Use of Privilege Separation"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SSSD should be configured to authenticate access to the system using smart cards. To enable smart cards in SSSD, set pam_cert_auth to True under the [pam] section in /etc/sssd/sssd.conf. For example:\n\n[pam]\npam_cert_auth = True",
      "id": "xccdf_org.ssgproject.content_rule_sssd_enable_smartcards",
      "instructions": "To verify that smart cards are enabled in SSSD, run the following command:\n$ sudo grep pam_cert_auth /etc/sssd/sssd.conf\nIf configured properly, output should be\npam_cert_auth = True",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sssd-enable-smartcards",
          "control.compliance.openshift.io/PCI-DSS": "Req-8.3",
          "policies.open-cluster-management.io/controls": "Req-8.3",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sssd-enable-smartcards",
        "namespace": "openshift-compliance",
        "resourceVersion": "78575",
        "uid": "bb8c9cce-942d-43a8-8609-46e848dee7a8"
      },
      "rationale": "Using an authentication device, such as a CAC or token that is separate from the information system, ensures that even if the information system is compromised, that compromise will not affect credentials stored on the authentication device.\n\nMulti-Factor Authentication (MFA) solutions that require devices separate from information systems gaining access include, for example, hardware tokens providing time-based or challenge-response authenticators and smart cards such as the U.S. Government Personal Identity Verification card and the DoD Common Access Card.",
      "severity": "medium",
      "title": "Enable Smartcards in SSSD"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SSSD should be configured to expire offline credentials after 1 day. To configure SSSD to expire offline credentials, set offline_credentials_expiration to 1 under the [pam] section in /etc/sssd/sssd.conf. For example:\n\n[pam]\noffline_credentials_expiration = 1",
      "id": "xccdf_org.ssgproject.content_rule_sssd_offline_cred_expiration",
      "instructions": "To verify that SSSD expires offline credentials, run the following command:\n$ sudo grep offline_credentials_expiration /etc/sssd/sssd.conf /etc/sssd/conf.d/*.conf\nIf configured properly, output should be\noffline_credentials_expiration = 1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sssd-offline-cred-expiration",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);IA-5(13)",
          "policies.open-cluster-management.io/controls": "CM-6(a),IA-5(13)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sssd-offline-cred-expiration",
        "namespace": "openshift-compliance",
        "resourceVersion": "78578",
        "uid": "73946333-3617-45e6-b7b2-9a8592da693e"
      },
      "rationale": "If cached authentication information is out-of-date, the validity of the authentication information may be questionable.",
      "severity": "medium",
      "title": "Configure SSSD to Expire Offline Credentials"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "SSSD processes should be configured to run as user sssd, not root.",
      "id": "xccdf_org.ssgproject.content_rule_sssd_run_as_sssd_user",
      "instructions": "To verify that SSSD is configured to run as user sssd, run the following command:\n$ sudo grep -r '\\buser\\b' /etc/sssd\nIf configured properly, output should similar to /etc/sssd/conf.d/ospp.conf:user = sssd.\nSanity of SSSD configuration in general can be checked using $ sudo sssctl config-check",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sssd-run-as-sssd-user"
        },
        "creationTimestamp": "2024-03-05T15:03:26Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sssd-run-as-sssd-user",
        "namespace": "openshift-compliance",
        "resourceVersion": "78579",
        "uid": "5e3d4213-a3b1-45be-9631-8928f4d0f4be"
      },
      "rationale": "To minimize privileges of SSSD processes, they are configured to run as non-root user.",
      "severity": "medium",
      "title": "Configure SSSD to run as user sssd"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The sudo NOEXEC tag, when specified, prevents user executed commands from executing other commands, like a shell for example. This should be enabled by making sure that the NOEXEC tag exists in /etc/sudoers configuration file or any sudo configuration snippets in /etc/sudoers.d/.",
      "id": "xccdf_org.ssgproject.content_rule_sudo_add_noexec",
      "instructions": "To determine if NOEXEC has been configured for sudo, run the following command:\n$ sudo grep -ri \"^[\\s]*Defaults.*\\bnoexec\\b.*\" /etc/sudoers /etc/sudoers.d/\nThe command should return a matching output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "sudo-add-noexec"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sudo-add-noexec",
        "namespace": "openshift-compliance",
        "resourceVersion": "76698",
        "uid": "7da910f4-ea05-45c7-ab4d-002419216637"
      },
      "rationale": "Restricting the capability of sudo allowed commands to execute sub-commands prevents users from running programs with privileges they wouldn't have otherwise.",
      "severity": "high",
      "title": "Ensure Privileged Escalated Commands Cannot Execute Other Commands - sudo NOEXEC"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The sudo requiretty tag, when specified, will only execute sudo commands from users logged in to a real tty. This should be enabled by making sure that the requiretty tag exists in /etc/sudoers configuration file or any sudo configuration snippets in /etc/sudoers.d/.",
      "id": "xccdf_org.ssgproject.content_rule_sudo_add_requiretty",
      "instructions": "To determine if requiretty has been configured for sudo, run the following command:\n$ sudo grep -ri \"^[\\s]*Defaults.*\\brequiretty\\b.*\" /etc/sudoers /etc/sudoers.d/\nThe command should return a matching output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "sudo-add-requiretty"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sudo-add-requiretty",
        "namespace": "openshift-compliance",
        "resourceVersion": "76691",
        "uid": "a309ad45-4943-4eea-8546-7b322a55e53d"
      },
      "rationale": "Restricting the use cases in which a user is allowed to execute sudo commands reduces the attack surface.",
      "severity": "medium",
      "title": "Ensure Only Users Logged In To Real tty Can Execute Sudo - sudo requiretty"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The sudo use_pty tag, when specified, will only execute sudo commands from users logged in to a real tty. This should be enabled by making sure that the use_pty tag exists in /etc/sudoers configuration file or any sudo configuration snippets in /etc/sudoers.d/.",
      "id": "xccdf_org.ssgproject.content_rule_sudo_add_use_pty",
      "instructions": "To determine if use_pty has been configured for sudo, run the following command:\n$ sudo grep -ri \"^[\\s]*Defaults.*\\buse_pty\\b.*\" /etc/sudoers /etc/sudoers.d/\nThe command should return a matching output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "sudo-add-use-pty",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.5",
          "policies.open-cluster-management.io/controls": "Req-10.2.5",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:19Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sudo-add-use-pty",
        "namespace": "openshift-compliance",
        "resourceVersion": "76713",
        "uid": "762bcaa2-6d24-4c60-a1f7-2fd14e17f3b4"
      },
      "rationale": "Requiring that sudo commands be run in a pseudo-terminal can prevent an attacker from retaining access to the user's terminal after the main program has finished executing.",
      "severity": "medium",
      "title": "Ensure Only Users Logged In To Real tty Can Execute Sudo - sudo use_pty"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "A custom log sudo file can be configured with the 'logfile' tag. This rule configures a sudo custom logfile at the default location suggested by CIS, which uses /var/log/sudo.log.",
      "id": "xccdf_org.ssgproject.content_rule_sudo_custom_logfile",
      "instructions": "To determine if logfile has been configured for sudo, run the following command:\n$ sudo grep -ri \"^[\\s]*Defaults\\s*\\blogfile\\b.*\" /etc/sudoers /etc/sudoers.d/\nThe command should return a matching output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sudo-custom-logfile",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.2.5",
          "policies.open-cluster-management.io/controls": "Req-10.2.5",
          "policies.open-cluster-management.io/standards": "PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sudo-custom-logfile",
        "namespace": "openshift-compliance",
        "resourceVersion": "76718",
        "uid": "7e081407-5633-477a-b031-655db3229f70"
      },
      "rationale": "A sudo log file simplifies auditing of sudo commands.",
      "severity": "low",
      "title": "Ensure Sudo Logfile Exists - sudo logfile"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The sudo NOPASSWD and !authenticate option, when specified, allows a user to execute commands using sudo without having to authenticate. This should be disabled by making sure that NOPASSWD and/or !authenticate do not exist in /etc/sudoers configuration file or any sudo configuration snippets in /etc/sudoers.d/.\"",
      "id": "xccdf_org.ssgproject.content_rule_sudo_require_authentication",
      "instructions": "To determine if NOPASSWD or !authenticate have been configured for\nsudo, run the following command:\n$ sudo grep -ri \"nopasswd\\|\\!authenticate\" /etc/sudoers /etc/sudoers.d/\nThe command should return no output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sudo-require-authentication",
          "control.compliance.openshift.io/NIST-800-53": "IA-11;CM-6(a)",
          "policies.open-cluster-management.io/controls": "IA-11,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sudo-require-authentication",
        "namespace": "openshift-compliance",
        "resourceVersion": "76717",
        "uid": "ae342511-1db7-410b-aa49-ca5f4acef475"
      },
      "rationale": "Without re-authentication, users may access resources or perform tasks for which they do not have authorization.\n\nWhen operating systems provide the capability to escalate a functional capability, it is critical that the user re-authenticate.",
      "severity": "medium",
      "title": "Ensure Users Re-Authenticate for Privilege Escalation - sudo"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The sudo NOPASSWD tag, when specified, allows a user to execute commands using sudo without having to authenticate. Only the vdsm user should have this capability in any sudo configuration snippets in /etc/sudoers.d/.",
      "id": "xccdf_org.ssgproject.content_rule_sudo_vdsm_nopasswd",
      "instructions": "To determine if NOPASSWD has been configured for the vdsm user for sudo,\nrun the following command:\n$ sudo grep -ri nopasswd /etc/sudoers.d/\nThe command should return output only for the vdsm user.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sudo-vdsm-nopasswd"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sudo-vdsm-nopasswd",
        "namespace": "openshift-compliance",
        "resourceVersion": "76722",
        "uid": "d2a4f2f5-29df-43f0-ab56-05d100f35b84"
      },
      "rationale": "Without re-authentication, users may access resources or perform tasks for which they do not have authorization.\n\nWhen operating systems provide the capability to escalate a functional capability, it is critical that the user re-authenticate.",
      "severity": "medium",
      "title": "Only the VDSM User Can Use sudo NOPASSWD"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "All commands in the sudoers file must strictly specify the arguments allowed to be used for a given user. If the command is supposed to be executed only without arguments, pass \"\" as an argument in the corresponding user specification.",
      "id": "xccdf_org.ssgproject.content_rule_sudoers_explicit_command_args",
      "instructions": "To determine if arguments that commands can be executed with are restricted, run the following command:\n$ sudo grep -PR '^(?:\\s*[^#=]+)=(?:\\s*(?:\\([^\\)]+\\))?\\s*(?!\\s*\\()[^,\\s]+(?:[ \\t]+[^,\\s]+)+[ \\t]*,)*(\\s*(?:\\([^\\)]+\\))?\\s*(?!\\s*\\()[^,\\s]+[ \\t]*(?:,|$))' /etc/sudoers /etc/sudoers.d/\nThe command should return no output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "sudoers-explicit-command-args"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sudoers-explicit-command-args",
        "namespace": "openshift-compliance",
        "resourceVersion": "76726",
        "uid": "0173c122-e349-4852-8b56-e78cf295ee6c"
      },
      "rationale": "Any argument can modify quite significantly the behavior of a program, whether regarding the realized operation (read, write, delete, etc.) or accessed resources (path in a file system tree). To avoid any possibility of misuse of a command by a user, the ambiguities must be removed at the level of its specification. For example, on some systems, the kernel messages are only accessible by root. If a user nevertheless must have the privileges to read them, the argument of the dmesg command has to be restricted in order to prevent the user from flushing the buffer through the -c option:\n\nuser ALL = dmesg \"\"",
      "severity": "medium",
      "title": "Explicit arguments in sudo specifications",
      "warning": "Any argument can modify quite significantly the behavior of a program, whether regarding the realized operation (read, write, delete, etc.) or accessed resources (path in a file system tree). To avoid any possibility of misuse of a command by a user, the ambiguities must be removed at the level of its specification. For example, on some systems, the kernel messages are only accessible by root. If a user nevertheless must have the privileges to read them, the argument of the dmesg command has to be restricted in order to prevent the user from flushing the buffer through the -c option:\n\nuser ALL = dmesg \"\""
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Policies applied by sudo through the sudoers file should not involve negation. Each user specification in the sudoers file contains a comma-delimited list of command specifications. The definition can make use glob patterns, as well as of negations. Indirect definition of those commands by means of exclusion of a set of commands is trivial to bypass, so it is not allowed to use such constructs.",
      "id": "xccdf_org.ssgproject.content_rule_sudoers_no_command_negation",
      "instructions": "To determine if negation is used to define commands users are allowed to execute using sudo, run the following command:\n$ sudo grep -PR '^(?:\\s*[^#=]+)=(?:\\s*(?:\\([^\\)]+\\))?\\s*(?!\\s*\\()[^,!\\n][^,\\n]+,)*\\s*(?:\\([^\\)]+\\))?\\s*(?!\\s*\\()(!\\S+).*' /etc/sudoers /etc/sudoers.d/\nThe command should return no output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sudoers-no-command-negation"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sudoers-no-command-negation",
        "namespace": "openshift-compliance",
        "resourceVersion": "76740",
        "uid": "9c026319-42aa-4d05-abb1-c93a138186f8"
      },
      "rationale": "Specifying access right using negation is inefficient and can be easily circumvented. For example, it is expected that a specification like\n\n# To avoid absolutely , this rule can be easily circumvented!\nuser ALL = ALL ,!/ bin/sh\n\nprevents the execution of the shell but that’s not the case: just copy the binary /bin/sh to a different name to make it executable again through the rule keyword ALL.",
      "severity": "medium",
      "title": "Don't define allowed commands in sudoers by means of exclusion",
      "warning": "Specifying access right using negation is inefficient and can be easily circumvented. For example, it is expected that a specification like\n\n# To avoid absolutely , this rule can be easily circumvented!\nuser ALL = ALL ,!/ bin/sh\n\nprevents the execution of the shell but that’s not the case: just copy the binary /bin/sh to a different name to make it executable again through the rule keyword ALL."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The targeted users of a user specification should be, as much as possible, non privileged users (i.e.: non-root). User specifications have to explicitly list the runas spec (i.e. the list of target users that can be impersonated), and ALL or root should not be used.",
      "id": "xccdf_org.ssgproject.content_rule_sudoers_no_root_target",
      "instructions": "To determine if the users are allowed to run commands as root, run the following commands:\n$ sudo grep -PR '^\\s*((?!root\\b)[\\w]+)\\s*(\\w+)\\s*=\\s*(.*,)?\\s*[^\\(\\s]' /etc/sudoers /etc/sudoers.d/\nand\n$ sudo grep -PR '^\\s*((?!root\\b)[\\w]+)\\s*(\\w+)\\s*=\\s*(.*,)?\\s*\\([\\w\\s]*\\b(root|ALL)\\b[\\w\\s]*\\)' /etc/sudoers /etc/sudoers.d/\nBoth commands should return no output.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sudoers-no-root-target"
        },
        "creationTimestamp": "2024-03-05T15:02:20Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sudoers-no-root-target",
        "namespace": "openshift-compliance",
        "resourceVersion": "76743",
        "uid": "8aa72b59-ea59-4b4a-8e68-f651263739ec"
      },
      "rationale": "It is common that the command to be executed does not require superuser rights (editing a file whose the owner is not root, sending a signal to an unprivileged process,etc.). In order to limit any attempt of privilege escalation through a command, it is better to apply normal user rights.",
      "severity": "medium",
      "title": "Don't target root user in the sudoers file",
      "warning": "It is common that the command to be executed does not require superuser rights (editing a file whose the owner is not root, sending a signal to an unprivileged process,etc.). In order to limit any attempt of privilege escalation through a command, it is better to apply normal user rights."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "System running in FIPS mode is indicated by kernel parameter 'crypto.fips_enabled'. This parameter should be set to 1 in FIPS mode. To enable FIPS mode, run the following command:\n\nfips-mode-setup --enable\n\nTo enable strict FIPS compliance, the fips=1 kernel option needs to be added to the kernel boot parameters during system installation so key generation is done with FIPS-approved algorithms and continuous monitoring tests in place.",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_crypto_fips_enabled",
      "instructions": "To verify that kernel parameter 'crypto.fips_enabled' is set properly, run the following command:\nsysctl crypto.fips_enabled\nThe output should contain the following:\ncrypto.fips_enabled = 1",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sysctl-crypto-fips-enabled",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-12(2);SC-12(3);IA-7;SC-13;CM-6(a);SC-12",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R4.2,CIP-007-3 R5.1,SC-12(2),SC-12(3),IA-7,SC-13,CM-6(a),SC-12",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:17Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-crypto-fips-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "76570",
        "uid": "c7a8ab21-dec6-4570-9499-b88a01fde3d7"
      },
      "rationale": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.",
      "severity": "high",
      "title": "Set kernel parameter 'crypto.fips_enabled' to 1",
      "warning": "Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,fs.protected_hardlinks%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_fs_protected_hardlinks.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the fs.protected_hardlinks kernel parameter, run the following command:\n\n$ sudo sysctl -w fs.protected_hardlinks=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nfs.protected_hardlinks = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_fs_protected_hardlinks",
      "instructions": "The runtime status of the fs.protected_hardlinks kernel parameter can be queried\nby running the following command:\n$ sysctl fs.protected_hardlinks\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "sysctl-fs-protected-hardlinks",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-fs-protected-hardlinks",
        "namespace": "openshift-compliance",
        "resourceVersion": "78209",
        "uid": "20c5b87a-e435-4f59-9be4-ced436e0f87e"
      },
      "rationale": "By enabling this kernel parameter, users can no longer create soft or hard links to files which they do not own. Disallowing such hardlinks mitigate vulnerabilities based on insecure file system accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of open() or creat().",
      "severity": "medium",
      "title": "Enable Kernel Parameter to Enforce DAC on Hardlinks"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,fs.protected_symlinks%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_fs_protected_symlinks.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the fs.protected_symlinks kernel parameter, run the following command:\n\n$ sudo sysctl -w fs.protected_symlinks=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nfs.protected_symlinks = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_fs_protected_symlinks",
      "instructions": "The runtime status of the fs.protected_symlinks kernel parameter can be queried\nby running the following command:\n$ sysctl fs.protected_symlinks\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "sysctl-fs-protected-symlinks",
          "control.compliance.openshift.io/NERC-CIP": "CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 R2.3;CIP-007-3 R2.1;CIP-007-3 R2.2;CIP-007-3 R2.3;CIP-007-3 R5.1;CIP-007-3 R5.1.1;CIP-007-3 R5.1.2",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a);AC-6(1)",
          "policies.open-cluster-management.io/controls": "CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 R2.3,CIP-007-3 R2.1,CIP-007-3 R2.2,CIP-007-3 R2.3,CIP-007-3 R5.1,CIP-007-3 R5.1.1,CIP-007-3 R5.1.2,CM-6(a),AC-6(1)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:04Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-fs-protected-symlinks",
        "namespace": "openshift-compliance",
        "resourceVersion": "78211",
        "uid": "e6bca1d0-a110-4ca7-bb2f-295cf5988c5a"
      },
      "rationale": "By enabling this kernel parameter, symbolic links are permitted to be followed only when outside a sticky world-writable directory, or when the UID of the link and follower match, or when the directory owner matches the symlink's owner. Disallowing such symlinks helps mitigate vulnerabilities based on insecure file system accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of open() or creat().",
      "severity": "medium",
      "title": "Enable Kernel Parameter to Enforce DAC on Symlinks"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the fs.suid_dumpable kernel parameter, run the following command:\n\n$ sudo sysctl -w fs.suid_dumpable=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nfs.suid_dumpable = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_fs_suid_dumpable",
      "instructions": "The runtime status of the fs.suid_dumpable kernel parameter can be queried\nby running the following command:\n$ sysctl fs.suid_dumpable\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "sysctl-fs-suid-dumpable",
          "control.compliance.openshift.io/NIST-800-53": "SI-11(a);SI-11(b)",
          "policies.open-cluster-management.io/controls": "SI-11(a),SI-11(b)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-fs-suid-dumpable",
        "namespace": "openshift-compliance",
        "resourceVersion": "78388",
        "uid": "b7709b7b-f72c-464a-b7ec-5bf1074bcbc3"
      },
      "rationale": "The core dump of a setuid program is more likely to contain sensitive data, as the program itself runs with greater privileges than the user who initiated execution of the program. Disabling the ability for any setuid program to write a core file decreases the risk of unauthorized access of such data.",
      "severity": "medium",
      "title": "Disable Core Dumps for SUID programs"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,kernel.core_pattern%20%3D%20%7C/bin/false%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_kernel_core_pattern.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.core_pattern kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.core_pattern=|/bin/false\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.core_pattern = |/bin/false",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_core_pattern",
      "instructions": "The runtime status of the kernel.core_pattern kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.core_pattern\n|/bin/false.\n\n      Is it the case that the returned line does not have a value of \"|/bin/false\", or a line is not\nreturned and the need for core dumps is not documented with the Information",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-moderate,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "sysctl-kernel-core-pattern",
          "control.compliance.openshift.io/NIST-800-53": "SC-7(10)",
          "policies.open-cluster-management.io/controls": "SC-7(10)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-core-pattern",
        "namespace": "openshift-compliance",
        "resourceVersion": "78363",
        "uid": "cd88a39d-c5c9-466c-9f08-9dadf7339890"
      },
      "rationale": "A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems.",
      "severity": "medium",
      "title": "Disable storing core dumps"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.core_uses_pid kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.core_uses_pid=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.core_uses_pid = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_core_uses_pid",
      "instructions": "The runtime status of the kernel.core_uses_pid kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.core_uses_pid\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sysctl-kernel-core-uses-pid"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-core-uses-pid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78366",
        "uid": "d02dcffe-cd05-472a-9b14-521521aaf63a"
      },
      "rationale": "The default coredump filename is core. By setting core_uses_pid to 1 , the coredump filename becomes core.PID. If core_pattern does not include %p (default does not) and core_uses_pid is set, then.PID will be appended to the filename. When combined with kernel.core_pattern = \"\" configuration, it is ensured that no core dumps are generated and also no confusing error messages are printed by a shell.",
      "severity": "medium",
      "title": "Configure file name of core dumps"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,kernel.dmesg_restrict%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_kernel_dmesg_restrict.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.dmesg_restrict kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.dmesg_restrict=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.dmesg_restrict = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_dmesg_restrict",
      "instructions": "The runtime status of the kernel.dmesg_restrict kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.dmesg_restrict\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-e8,rhcos4-stig,rhcos4-high",
          "compliance.openshift.io/rule": "sysctl-kernel-dmesg-restrict",
          "control.compliance.openshift.io/NIST-800-53": "SI-11(a);SI-11(b)",
          "policies.open-cluster-management.io/controls": "SI-11(a),SI-11(b)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-dmesg-restrict",
        "namespace": "openshift-compliance",
        "resourceVersion": "78368",
        "uid": "24f6e4dd-d223-4e49-b688-cb92e990dafa"
      },
      "rationale": "Unprivileged access to the kernel syslog can expose sensitive kernel address information.",
      "severity": "low",
      "title": "Restrict Access to Kernel Message Buffer"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,kernel.kexec_load_disabled%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_kernel_kexec_load_disabled.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.kexec_load_disabled kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.kexec_load_disabled=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.kexec_load_disabled = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_kexec_load_disabled",
      "instructions": "The runtime status of the kernel.kexec_load_disabled kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.kexec_load_disabled\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "sysctl-kernel-kexec-load-disabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-6",
          "policies.open-cluster-management.io/controls": "CM-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:13Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-kexec-load-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78371",
        "uid": "82fcfac3-0d5b-432e-a489-d2c7a79393a7"
      },
      "rationale": "Disabling kexec_load allows greater control of the kernel memory. It makes it impossible to load another kernel image after it has been disabled.",
      "severity": "medium",
      "title": "Disable Kernel Image Loading"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,kernel.kptr_restrict%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_kernel_kptr_restrict.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.kptr_restrict kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.kptr_restrict= 1 \n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.kptr_restrict = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_kptr_restrict",
      "instructions": "The runtime status of the kernel.kptr_restrict kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.kptr_restrict\nThe output of the command should indicate either:\nkernel.kptr_restrict = 1\nor:\nkernel.kptr_restrict = 2\nThe output of the command should not indicate:\nkernel.kptr_restrict = 0\n\nThe preferable way how to assure the runtime compliance is to have\ncorrect persistent configuration, and rebooting the system.\n\nThe persistent kernel parameter configuration is performed by specifying the appropriate\nassignment in any file located in the /etc/sysctl.d directory.\nVerify that there is not any existing incorrect configuration by executing the following command:\n$ grep -r '^\\s*kernel.kptr_restrict\\s*=' /etc/sysctl.conf /etc/sysctl.d\nThe command should not find any assignments other than:\nkernel.kptr_restrict = 1\nor:\nkernel.kptr_restrict = 2\n\nConflicting assignments are not allowed.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-e8,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "sysctl-kernel-kptr-restrict",
          "compliance.openshift.io/rule-variable": "sysctl-kernel-kptr-restrict-value,sysctl-kernel-kptr-restrict-value",
          "control.compliance.openshift.io/NERC-CIP": "CIP-002-5 R1.1;CIP-002-5 R1.2;CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 4.1;CIP-004-6 4.2;CIP-004-6 R2.2.3;CIP-004-6 R2.2.4;CIP-004-6 R2.3;CIP-004-6 R4;CIP-005-6 R1;CIP-005-6 R1.1;CIP-005-6 R1.2;CIP-007-3 R3;CIP-007-3 R3.1;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3;CIP-007-3 R8.4;CIP-009-6 R.1.1;CIP-009-6 R4",
          "control.compliance.openshift.io/NIST-800-53": "SC-30;SC-30(2);SC-30(5);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CIP-002-5 R1.1,CIP-002-5 R1.2,CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 4.1,CIP-004-6 4.2,CIP-004-6 R2.2.3,CIP-004-6 R2.2.4,CIP-004-6 R2.3,CIP-004-6 R4,CIP-005-6 R1,CIP-005-6 R1.1,CIP-005-6 R1.2,CIP-007-3 R3,CIP-007-3 R3.1,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,CIP-007-3 R8.4,CIP-009-6 R.1.1,CIP-009-6 R4,SC-30,SC-30(2),SC-30(5),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-kptr-restrict",
        "namespace": "openshift-compliance",
        "resourceVersion": "78390",
        "uid": "b5b4db62-d047-4a5b-92d6-5bf6f108c4a8"
      },
      "rationale": "Exposing kernel pointers (through procfs or seq_printf() ) exposes kernel writeable structures which may contain functions pointers. If a write vulnerability occurs in the kernel, allowing write access to any of this structure, the kernel can be compromised. This option disallow any program without the CAP_SYSLOG capability to get the addresses of kernel pointers by replacing them with 0.",
      "severity": "medium",
      "title": "Restrict Exposed Kernel Pointer Addresses Access"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.panic_on_oops kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.panic_on_oops=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.panic_on_oops = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_panic_on_oops",
      "instructions": "The runtime status of the kernel.panic_on_oops kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.panic_on_oops\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "sysctl-kernel-panic-on-oops"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-panic-on-oops",
        "namespace": "openshift-compliance",
        "resourceVersion": "78374",
        "uid": "6d78b50a-8ce6-4047-b0d8-542d45f2e1dd"
      },
      "rationale": "An attacker trying to exploit the kernel may trigger kernel OOPSes, panicking the system will impede them from continuing.",
      "severity": "medium",
      "title": "Kernel panic on oops",
      "warning": "An attacker trying to exploit the kernel may trigger kernel OOPSes, panicking the system will impede them from continuing."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,kernel.perf_event_paranoid%3D2%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_kernel_perf_event_paranoid.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.perf_event_paranoid kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.perf_event_paranoid=2\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.perf_event_paranoid = 2",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_perf_event_paranoid",
      "instructions": "The runtime status of the kernel.perf_event_paranoid kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.perf_event_paranoid\n2.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-nerc-cip,rhcos4-high,rhcos4-stig",
          "compliance.openshift.io/rule": "sysctl-kernel-perf-event-paranoid",
          "control.compliance.openshift.io/NIST-800-53": "AC-6",
          "policies.open-cluster-management.io/controls": "AC-6",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-perf-event-paranoid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78375",
        "uid": "5572c4a6-f415-4b3e-b818-1241a86ae4cd"
      },
      "rationale": "Kernel profiling can reveal sensitive information about kernel behaviour.",
      "severity": "low",
      "title": "Disallow kernel profiling by unprivileged users"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,kernel.randomize_va_space%3D2%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_kernel_randomize_va_space.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.randomize_va_space kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.randomize_va_space=2\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.randomize_va_space = 2",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_randomize_va_space",
      "instructions": "The runtime status of the kernel.randomize_va_space kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.randomize_va_space\n2.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-e8,rhcos4-anssi-bp28-enhanced,rhcos4-stig-v1r1,rhcos4-stig",
          "compliance.openshift.io/rule": "sysctl-kernel-randomize-va-space",
          "control.compliance.openshift.io/NERC-CIP": "CIP-002-5 R1.1;CIP-002-5 R1.2;CIP-003-8 R5.1.1;CIP-003-8 R5.3;CIP-004-6 4.1;CIP-004-6 4.2;CIP-004-6 R2.2.3;CIP-004-6 R2.2.4;CIP-004-6 R2.3;CIP-004-6 R4;CIP-005-6 R1;CIP-005-6 R1.1;CIP-005-6 R1.2;CIP-007-3 R3;CIP-007-3 R3.1;CIP-007-3 R5.1;CIP-007-3 R5.1.2;CIP-007-3 R5.1.3;CIP-007-3 R5.2.1;CIP-007-3 R5.2.3;CIP-007-3 R8.4;CIP-009-6 R.1.1;CIP-009-6 R4",
          "control.compliance.openshift.io/NIST-800-53": "SC-30;SC-30(2);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-2.2.1",
          "policies.open-cluster-management.io/controls": "CIP-002-5 R1.1,CIP-002-5 R1.2,CIP-003-8 R5.1.1,CIP-003-8 R5.3,CIP-004-6 4.1,CIP-004-6 4.2,CIP-004-6 R2.2.3,CIP-004-6 R2.2.4,CIP-004-6 R2.3,CIP-004-6 R4,CIP-005-6 R1,CIP-005-6 R1.1,CIP-005-6 R1.2,CIP-007-3 R3,CIP-007-3 R3.1,CIP-007-3 R5.1,CIP-007-3 R5.1.2,CIP-007-3 R5.1.3,CIP-007-3 R5.2.1,CIP-007-3 R5.2.3,CIP-007-3 R8.4,CIP-009-6 R.1.1,CIP-009-6 R4,SC-30,SC-30(2),CM-6(a),Req-2.2.1",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:15Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-randomize-va-space",
        "namespace": "openshift-compliance",
        "resourceVersion": "78392",
        "uid": "715f4e99-e86b-4b81-9a55-6bc985090e90"
      },
      "rationale": "Address space layout randomization (ASLR) makes it more difficult for an attacker to predict the location of attack code they have introduced into a process's address space during an attempt at exploitation. Additionally, ASLR makes it more difficult for an attacker to know the location of existing code in order to re-purpose it using return oriented programming (ROP) techniques.",
      "severity": "medium",
      "title": "Enable Randomized Layout of Virtual Address Space"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,kernel.unprivileged_bpf_disabled%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_kernel_unprivileged_bpf_disabled.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.unprivileged_bpf_disabled kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.unprivileged_bpf_disabled=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.unprivileged_bpf_disabled = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_unprivileged_bpf_disabled",
      "instructions": "The runtime status of the kernel.unprivileged_bpf_disabled kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.unprivileged_bpf_disabled\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-e8,rhcos4-high-rev-4,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "sysctl-kernel-unprivileged-bpf-disabled",
          "control.compliance.openshift.io/NIST-800-53": "AC-6;SC-7(10)",
          "policies.open-cluster-management.io/controls": "AC-6,SC-7(10)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-unprivileged-bpf-disabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78376",
        "uid": "db52196b-e5a2-437b-ab7f-e436e987bd8d"
      },
      "rationale": "Loading and accessing the packet filters programs and maps using the bpf() syscall has the potential of revealing sensitive information about the kernel state.",
      "severity": "medium",
      "title": "Disable Access to Network bpf() Syscall From Unprivileged Processes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,kernel.yama.ptrace_scope%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_kernel_yama_ptrace_scope.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the kernel.yama.ptrace_scope kernel parameter, run the following command:\n\n$ sudo sysctl -w kernel.yama.ptrace_scope=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nkernel.yama.ptrace_scope = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_yama_ptrace_scope",
      "instructions": "The runtime status of the kernel.yama.ptrace_scope kernel parameter can be queried\nby running the following command:\n$ sysctl kernel.yama.ptrace_scope\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-e8,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high",
          "compliance.openshift.io/rule": "sysctl-kernel-yama-ptrace-scope",
          "control.compliance.openshift.io/NIST-800-53": "SC-7(10)",
          "policies.open-cluster-management.io/controls": "SC-7(10)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-kernel-yama-ptrace-scope",
        "namespace": "openshift-compliance",
        "resourceVersion": "78377",
        "uid": "1da208b5-b2ac-4677-b242-72aaea547262"
      },
      "rationale": "Unrestricted usage of ptrace allows compromised binaries to run ptrace on another processes of the user. Like this, the attacker can steal sensitive information from the target processes (e.g. SSH sessions, web browser, ...) without any additional assistance from the user (i.e. without resorting to phishing).",
      "severity": "medium",
      "title": "Restrict usage of ptrace to descendant processes"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.core.bpf_jit_harden%3D2%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_core_bpf_jit_harden.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.core.bpf_jit_harden kernel parameter, run the following command:\n\n$ sudo sysctl -w net.core.bpf_jit_harden=2\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.core.bpf_jit_harden = 2",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_core_bpf_jit_harden",
      "instructions": "The runtime status of the net.core.bpf_jit_harden kernel parameter can be queried\nby running the following command:\n$ sysctl net.core.bpf_jit_harden\n2.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-high,rhcos4-e8,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-intermediary,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "sysctl-net-core-bpf-jit-harden",
          "control.compliance.openshift.io/NIST-800-53": "CM-6;SC-7(10)",
          "policies.open-cluster-management.io/controls": "CM-6,SC-7(10)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-core-bpf-jit-harden",
        "namespace": "openshift-compliance",
        "resourceVersion": "78378",
        "uid": "3e3def5f-fbd7-49ad-901d-944cecceea85"
      },
      "rationale": "When hardened, the extended Berkeley Packet Filter just-in-time compiler will randomize any kernel addresses in the BPF programs and maps, and will not expose the JIT addresses in /proc/kallsyms.",
      "severity": "medium",
      "title": "Harden the operation of the BPF just-in-time compiler"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.accept_local kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.accept_local=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.accept_local = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_local",
      "instructions": "The runtime status of the net.ipv4.conf.all.accept_local kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.accept_local\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-accept-local"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-accept-local",
        "namespace": "openshift-compliance",
        "resourceVersion": "78114",
        "uid": "4bdb3e71-47f6-40ab-b4b8-c40dd5c080ce"
      },
      "rationale": "Configure net.ipv4.conf.all.accept_local=0 to consider as invalid the packets received from outside whose source is the 127.0.0.0/8 address block. In combination with suitable routing, this can be used to direct packets between two local interfaces over the wire and have them accepted properly.",
      "severity": "medium",
      "title": "Disable Accepting Packets Routed Between Local Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.all.accept_redirects%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_all_accept_redirects.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.accept_redirects kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.accept_redirects=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.accept_redirects = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_redirects",
      "instructions": "The runtime status of the net.ipv4.conf.all.accept_redirects kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.accept_redirects\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-accept-redirects",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);SC-7(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),SC-7(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-accept-redirects",
        "namespace": "openshift-compliance",
        "resourceVersion": "78116",
        "uid": "d1258981-22e6-4d2d-851f-d28a29328c53"
      },
      "rationale": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.\n\nThis feature of the IPv4 protocol has few legitimate uses. It should be disabled unless absolutely required.\"",
      "severity": "medium",
      "title": "Disable Accepting ICMP Redirects for All IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.all.accept_source_route%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_all_accept_source_route.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.accept_source_route kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.accept_source_route=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.accept_source_route = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_source_route",
      "instructions": "The runtime status of the net.ipv4.conf.all.accept_source_route kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.accept_source_route\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-accept-source-route",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5;CM-6(a);SC-7(a)",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,CM-7(a),CM-7(b),SC-5,CM-6(a),SC-7(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-accept-source-route",
        "namespace": "openshift-compliance",
        "resourceVersion": "78119",
        "uid": "34469c47-bc5e-46d4-b172-0c1bc4dd88db"
      },
      "rationale": "Source-routed packets allow the source of the packet to suggest routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the forwarding of source-routerd traffic, such as when IPv4 forwarding is enabled and the system is functioning as a router.\n\nAccepting source-routed packets in the IPv4 protocol has few legitimate uses. It should be disabled unless it is absolutely required.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.arp_filter kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.arp_filter= 0 \n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.arp_filter = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_arp_filter",
      "instructions": "The runtime status of the net.ipv4.conf.all.arp_filter kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.arp_filter\n.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-arp-filter",
          "compliance.openshift.io/rule-variable": "sysctl-net-ipv4-conf-all-arp-filter-value,sysctl-net-ipv4-conf-all-arp-filter-value"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-arp-filter",
        "namespace": "openshift-compliance",
        "resourceVersion": "78121",
        "uid": "371f234f-74ed-4b9e-a640-7863f3080a66"
      },
      "rationale": "Prevents the Linux Kernel from handling the ARP table globally. By default, the kernel may respond to an ARP request from a certain interface with information from another interface.",
      "severity": "medium",
      "title": "Configure ARP filtering for All IPv4 Interfaces",
      "warning": "Prevents the Linux Kernel from handling the ARP table globally. By default, the kernel may respond to an ARP request from a certain interface with information from another interface."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.arp_ignore kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.arp_ignore= 0 \n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.arp_ignore = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_arp_ignore",
      "instructions": "The runtime status of the net.ipv4.conf.all.arp_ignore kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.arp_ignore\n.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-arp-ignore",
          "compliance.openshift.io/rule-variable": "sysctl-net-ipv4-conf-all-arp-ignore-value,sysctl-net-ipv4-conf-all-arp-ignore-value"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-arp-ignore",
        "namespace": "openshift-compliance",
        "resourceVersion": "78124",
        "uid": "4c0da08b-6a80-4148-9ccc-b15b05a0480f"
      },
      "rationale": "Avoids ARP Flux on system that have more than one interface on the same subnet.",
      "severity": "medium",
      "title": "Configure Response Mode of ARP Requests for All IPv4 Interfaces",
      "warning": "Avoids ARP Flux on system that have more than one interface on the same subnet."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.all.log_martians%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_all_log_martians.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.log_martians kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.log_martians=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.log_martians = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_log_martians",
      "instructions": "The runtime status of the net.ipv4.conf.all.log_martians kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.log_martians\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-log-martians",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5(3)(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),SC-5(3)(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-log-martians",
        "namespace": "openshift-compliance",
        "resourceVersion": "78128",
        "uid": "4fc33a47-0aa0-46e2-b3d9-f37d848bae3e"
      },
      "rationale": "The presence of \"martian\" packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.",
      "severity": "unknown",
      "title": "Enable Kernel Parameter to Log Martian Packets on all IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.route_localnet kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.route_localnet=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.route_localnet = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_route_localnet",
      "instructions": "The runtime status of the net.ipv4.conf.all.route_localnet kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.route_localnet\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-route-localnet"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-route-localnet",
        "namespace": "openshift-compliance",
        "resourceVersion": "78130",
        "uid": "476e7a77-5f1c-4194-bc65-4aa583390f9e"
      },
      "rationale": "Refuse the routing of packets whose source or destination address is the local loopback. This prohibits the use of network 127/8 for local routing purposes. Enabling route_localnet can expose applications listening on localhost to external traffic.",
      "severity": "medium",
      "title": "Prevent Routing External Traffic to Local Loopback on All IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.all.rp_filter%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_all_rp_filter.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.rp_filter kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.rp_filter=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.rp_filter = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_rp_filter",
      "instructions": "The runtime status of the net.ipv4.conf.all.rp_filter parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.rp_filter\nThe output of the command should indicate either:\nnet.ipv4.conf.all.rp_filter = 1\nor:\nnet.ipv4.conf.all.rp_filter = 2\nThe output of the command should not indicate:\nnet.ipv4.conf.all.rp_filter = 0\n\nThe preferable way how to assure the runtime compliance is to have\ncorrect persistent configuration, and rebooting the system.\n\nThe persistent sysctl parameter configuration is performed by specifying the appropriate\nassignment in any file located in the /etc/sysctl.d directory.\nVerify that there is not any existing incorrect configuration by executing the following command:\n$ grep -r '^\\s*net.ipv4.conf.all.rp_filter\\s*=' /etc/sysctl.conf /etc/sysctl.d\nThe command should not find any assignments other than:\nnet.ipv4.conf.all.rp_filter = 1\nor:\nnet.ipv4.conf.all.rp_filter = 2\n\nConflicting assignments are not allowed.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-rp-filter",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);SC-7(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.4.3",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),SC-7(a),Req-1.4.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-rp-filter",
        "namespace": "openshift-compliance",
        "resourceVersion": "78133",
        "uid": "c3118fe9-f103-4688-b45d-cc709ce77241"
      },
      "rationale": "Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems which are routers for complicated networks, but is helpful for end hosts and routers serving small networks.",
      "severity": "medium",
      "title": "Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.all.secure_redirects%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_all_secure_redirects.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.secure_redirects kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.secure_redirects=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.secure_redirects = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_secure_redirects",
      "instructions": "The runtime status of the net.ipv4.conf.all.secure_redirects kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.secure_redirects\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-moderate",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-secure-redirects",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);SC-7(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.4.3",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),SC-7(a),Req-1.4.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-secure-redirects",
        "namespace": "openshift-compliance",
        "resourceVersion": "78136",
        "uid": "d3070a2f-2093-44d2-a635-aaac12c80041"
      },
      "rationale": "Accepting \"secure\" ICMP redirects (from those gateways listed as default gateways) has few legitimate uses. It should be disabled unless it is absolutely required.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for Accepting Secure ICMP Redirects on all IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.all.send_redirects%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_all_send_redirects.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.send_redirects kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.send_redirects=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.send_redirects = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_send_redirects",
      "instructions": "The runtime status of the net.ipv4.conf.all.send_redirects kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.send_redirects\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-send-redirects",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5;CM-6(a);SC-7(a)",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,CM-7(a),CM-7(b),SC-5,CM-6(a),SC-7(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-send-redirects",
        "namespace": "openshift-compliance",
        "resourceVersion": "78163",
        "uid": "11476849-01f1-4d7c-9536-a6a697f0cc8d"
      },
      "rationale": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table possibly revealing portions of the network topology.\n\nThe ability to send ICMP redirects is only appropriate for systems acting as routers.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.all.shared_media kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.all.shared_media= 0 \n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.all.shared_media = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_shared_media",
      "instructions": "The runtime status of the net.ipv4.conf.all.shared_media kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.all.shared_media\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-all-shared-media",
          "compliance.openshift.io/rule-variable": "sysctl-net-ipv4-conf-all-shared-media-value,sysctl-net-ipv4-conf-all-shared-media-value"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-all-shared-media",
        "namespace": "openshift-compliance",
        "resourceVersion": "78139",
        "uid": "a4dcaae6-3358-4f2b-b710-494c950251e9"
      },
      "rationale": "This setting should be aligned with net.ipv4.conf.all.secure_redirects because it overrides it. If shared_media is enabled for an interface secure_redirects will be enabled too.",
      "severity": "medium",
      "title": "Configure Sending and Accepting Shared Media Redirects for All IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.default.accept_redirects%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_default_accept_redirects.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.default.accept_redirects kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.default.accept_redirects=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.default.accept_redirects = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_redirects",
      "instructions": "The runtime status of the net.ipv4.conf.default.accept_redirects kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.default.accept_redirects\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-default-accept-redirects",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);SC-7(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.4.3",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),SC-7(a),Req-1.4.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-default-accept-redirects",
        "namespace": "openshift-compliance",
        "resourceVersion": "78142",
        "uid": "49b89d24-d1cb-4ddc-9360-2dc4e1f25021"
      },
      "rationale": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.\n\nThis feature of the IPv4 protocol has few legitimate uses. It should be disabled unless absolutely required.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.default.accept_source_route%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_default_accept_source_route.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.default.accept_source_route kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.default.accept_source_route=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.default.accept_source_route = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_source_route",
      "instructions": "The runtime status of the net.ipv4.conf.default.accept_source_route kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.default.accept_source_route\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-default-accept-source-route",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5;SC-7(a)",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,CM-7(a),CM-7(b),SC-5,SC-7(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:00Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-default-accept-source-route",
        "namespace": "openshift-compliance",
        "resourceVersion": "78143",
        "uid": "214a7b17-fd79-41f0-982b-2b00c0783ec3"
      },
      "rationale": "Source-routed packets allow the source of the packet to suggest routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures.\n\nAccepting source-routed packets in the IPv4 protocol has few legitimate uses. It should be disabled unless it is absolutely required, such as when IPv4 forwarding is enabled and the system is legitimately functioning as a router.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for Accepting Source-Routed Packets on IPv4 Interfaces by Default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.default.log_martians%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_default_log_martians.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.default.log_martians kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.default.log_martians=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.default.log_martians = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_log_martians",
      "instructions": "The runtime status of the net.ipv4.conf.default.log_martians kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.default.log_martians\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-default-log-martians",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5(3)(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),SC-5(3)(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-default-log-martians",
        "namespace": "openshift-compliance",
        "resourceVersion": "78144",
        "uid": "eb4fa39e-8cdc-4ca5-8551-de8c70389398"
      },
      "rationale": "The presence of \"martian\" packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.",
      "severity": "unknown",
      "title": "Enable Kernel Paremeter to Log Martian Packets on all IPv4 Interfaces by Default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.default.rp_filter%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_default_rp_filter.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.default.rp_filter kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.default.rp_filter=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.default.rp_filter = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_rp_filter",
      "instructions": "The runtime status of the net.ipv4.conf.default.rp_filter kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.default.rp_filter\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-default-rp-filter",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);SC-7(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),SC-7(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-default-rp-filter",
        "namespace": "openshift-compliance",
        "resourceVersion": "78147",
        "uid": "35b68d0e-299f-4ad7-91bf-5902a48d874a"
      },
      "rationale": "Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems which are routers for complicated networks, but is helpful for end hosts and routers serving small networks.",
      "severity": "medium",
      "title": "Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces by Default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.default.secure_redirects%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_default_secure_redirects.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.default.secure_redirects kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.default.secure_redirects=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.default.secure_redirects = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_secure_redirects",
      "instructions": "The runtime status of the net.ipv4.conf.default.secure_redirects kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.default.secure_redirects\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-default-secure-redirects",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5;SC-7(a)",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,CM-7(a),CM-7(b),SC-5,SC-7(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-default-secure-redirects",
        "namespace": "openshift-compliance",
        "resourceVersion": "78149",
        "uid": "d9219b1a-91ab-49c2-b080-8a019dc15e06"
      },
      "rationale": "Accepting \"secure\" ICMP redirects (from those gateways listed as default gateways) has few legitimate uses. It should be disabled unless it is absolutely required.",
      "severity": "medium",
      "title": "Configure Kernel Parameter for Accepting Secure Redirects By Default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.conf.default.send_redirects%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_conf_default_send_redirects.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.default.send_redirects kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.default.send_redirects=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.default.send_redirects = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_send_redirects",
      "instructions": "The runtime status of the net.ipv4.conf.default.send_redirects kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.default.send_redirects\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-default-send-redirects",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5;CM-6(a);SC-7(a)",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,CM-7(a),CM-7(b),SC-5,CM-6(a),SC-7(a)",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-default-send-redirects",
        "namespace": "openshift-compliance",
        "resourceVersion": "78164",
        "uid": "a3103ddb-f770-46dd-a56c-87548e91b991"
      },
      "rationale": "ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table possibly revealing portions of the network topology.\n\nThe ability to send ICMP redirects is only appropriate for systems acting as routers.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces by Default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.conf.default.shared_media kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.conf.default.shared_media= 0 \n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.conf.default.shared_media = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_shared_media",
      "instructions": "The runtime status of the net.ipv4.conf.default.shared_media kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.conf.default.shared_media\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-conf-default-shared-media",
          "compliance.openshift.io/rule-variable": "sysctl-net-ipv4-conf-default-shared-media-value,sysctl-net-ipv4-conf-default-shared-media-value"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-conf-default-shared-media",
        "namespace": "openshift-compliance",
        "resourceVersion": "78150",
        "uid": "98dce814-f027-4a87-a1b9-c651e41cb54c"
      },
      "rationale": "This setting should be aligned with net.ipv4.conf.default.secure_redirects because it overrides it. If shared_media is enabled for an interface secure_redirects will be enabled too.",
      "severity": "medium",
      "title": "Configure Sending and Accepting Shared Media Redirects by Default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.icmp_echo_ignore_broadcasts%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_icmp_echo_ignore_broadcasts.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.icmp_echo_ignore_broadcasts kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_echo_ignore_broadcasts",
      "instructions": "The runtime status of the net.ipv4.icmp_echo_ignore_broadcasts kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.icmp_echo_ignore_broadcasts\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-icmp-echo-ignore-broadcasts",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.4.3",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,CM-7(a),CM-7(b),SC-5,Req-1.4.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-icmp-echo-ignore-broadcasts",
        "namespace": "openshift-compliance",
        "resourceVersion": "78152",
        "uid": "ac6f9e41-97d2-4a34-8be5-c04d4834352e"
      },
      "rationale": "Responding to broadcast (ICMP) echoes facilitates network mapping and provides a vector for amplification attacks.\n\nIgnoring ICMP echo requests (pings) sent to broadcast or multicast addresses makes the system slightly more difficult to enumerate on the network.",
      "severity": "medium",
      "title": "Enable Kernel Parameter to Ignore ICMP Broadcast Echo Requests on IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.icmp_ignore_bogus_error_responses%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_icmp_ignore_bogus_error_responses.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.icmp_ignore_bogus_error_responses kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.icmp_ignore_bogus_error_responses = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_ignore_bogus_error_responses",
      "instructions": "The runtime status of the net.ipv4.icmp_ignore_bogus_error_responses kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.icmp_ignore_bogus_error_responses\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-icmp-ignore-bogus-error-responses",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.4.3",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,CM-7(a),CM-7(b),SC-5,Req-1.4.3",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-icmp-ignore-bogus-error-responses",
        "namespace": "openshift-compliance",
        "resourceVersion": "78158",
        "uid": "5a986c48-62dd-4b1e-ad12-3b89d1860891"
      },
      "rationale": "Ignoring bogus ICMP error responses reduces log size, although some activity would not be logged.",
      "severity": "unknown",
      "title": "Enable Kernel Parameter to Ignore Bogus ICMP Error Responses on IPv4 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.ip_forward kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.ip_forward=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.ip_forward = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_ip_forward",
      "instructions": "The runtime status of the net.ipv4.ip_forward kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.ip_forward\n0.\nThe ability to forward packets is only appropriate for routers.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high,rhcos4-anssi-bp28-intermediary",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-ip-forward",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5;CM-6(a);SC-7(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.3.1;Req-1.3.2",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,CM-7(a),CM-7(b),SC-5,CM-6(a),SC-7(a),Req-1.3.1,Req-1.3.2",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:02Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-ip-forward",
        "namespace": "openshift-compliance",
        "resourceVersion": "78167",
        "uid": "73a43dc7-703f-425d-9a50-62837e2970b3"
      },
      "rationale": "Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this capability is used when not required, system network information may be unnecessarily transmitted across the network.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for IP Forwarding on IPv4 Interfaces",
      "warning": "Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this capability is used when not required, system network information may be unnecessarily transmitted across the network."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Make sure that the system is configured to limit the maximal rate for sending duplicate acknowledgments in response to incoming TCP packets that are for an existing connection but that are invalid due to any of these reasons: (a) out-of-window sequence number, (b) out-of-window acknowledgment number, or (c) PAWS (Protection Against Wrapped Sequence numbers) check failure This measure protects against or limits effects of DoS attacks against the system. Set the system to implement rate-limiting measures by adding the following line to /etc/sysctl.conf or a configuration file in the /etc/sysctl.d/ directory (or modify the line to have the required value):\n\nnet.ipv4.tcp_invalid_ratelimit = 500 \n\nIssue the following command to make the changes take effect:\n\n# sysctl --system",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_tcp_invalid_ratelimit",
      "instructions": "To verify that the operating system protects against or limits the effects of DoS\nattacks by ensuring implementation of rate-limiting measures\non impacted network interfaces, run the following command:\n# grep 'net.ipv4.tcp_invalid_ratelimit' /etc/sysctl.conf /etc/sysctl.d/*\nThe command should output the following line:\n/etc/sysctl.conf:net.ipv4.tcp_invalid_ratelimit = \nThe file where the line has been found can differ, but it must be either /etc/sysctl.conf\nor a file located under the /etc/sysctl.d/ directory.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-tcp-invalid-ratelimit",
          "compliance.openshift.io/rule-variable": "sysctl-net-ipv4-tcp-invalid-ratelimit-value",
          "control.compliance.openshift.io/NERC-CIP": "CIP-007-3 R4;CIP-007-3 R4.1;CIP-007-3 R4.2;CIP-007-3 R5.1",
          "control.compliance.openshift.io/NIST-800-53": "SC-5",
          "policies.open-cluster-management.io/controls": "CIP-007-3 R4,CIP-007-3 R4.1,CIP-007-3 R4.2,CIP-007-3 R5.1,SC-5",
          "policies.open-cluster-management.io/standards": "NERC-CIP,NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-tcp-invalid-ratelimit",
        "namespace": "openshift-compliance",
        "resourceVersion": "78156",
        "uid": "b4e50bf0-0962-4c35-ab6b-4d6bce48713e"
      },
      "rationale": "Denial of Service (DoS) is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nThis can help mitigate simple “ack loop” DoS attacks, wherein a buggy or malicious middlebox or man-in-the-middle can rewrite TCP header fields in manner that causes each endpoint to think that the other is sending invalid TCP segments, thus causing each side to send an unterminating stream of duplicate acknowledgments for invalid segments.",
      "severity": "medium",
      "title": "Configure Kernel to Rate Limit Sending of Duplicate TCP Acknowledgments"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv4.tcp_syncookies%3D1%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv4_tcp_syncookies.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv4.tcp_syncookies kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv4.tcp_syncookies=1\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv4.tcp_syncookies = 1",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_tcp_syncookies",
      "instructions": "The runtime status of the net.ipv4.tcp_syncookies kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv4.tcp_syncookies\n1.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4",
          "compliance.openshift.io/rule": "sysctl-net-ipv4-tcp-syncookies",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);SC-5(1);SC-5(2);SC-5(3)(a);CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.4.1",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),SC-5(1),SC-5(2),SC-5(3)(a),CM-6(a),Req-1.4.1",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:01Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv4-tcp-syncookies",
        "namespace": "openshift-compliance",
        "resourceVersion": "78161",
        "uid": "d6ccad92-9925-4251-9b63-6d7ef19bbe4f"
      },
      "rationale": "A TCP SYN flood attack can cause a denial of service by filling a system's TCP connection table with connections in the SYN_RCVD state. Syncookies can be used to track a connection when a subsequent ACK is received, verifying the initiator is attempting a valid connection and is not a flood source. This feature is activated when a flood condition is detected, and enables the system to continue servicing valid connection requests.",
      "severity": "medium",
      "title": "Enable Kernel Parameter to Use TCP Syncookies on Network Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv6.conf.all.accept_ra%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv6_conf_all_accept_ra.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv6.conf.all.accept_ra kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv6.conf.all.accept_ra=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv6.conf.all.accept_ra = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_ra",
      "instructions": "The runtime status of the net.ipv6.conf.all.accept_ra kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv6.conf.all.accept_ra\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "sysctl-net-ipv6-conf-all-accept-ra",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv6-conf-all-accept-ra",
        "namespace": "openshift-compliance",
        "resourceVersion": "78100",
        "uid": "e37f4ac5-8799-4f79-a228-bdd8263ca5d8"
      },
      "rationale": "An illicit router advertisement message could result in a man-in-the-middle attack.",
      "severity": "medium",
      "title": "Configure Accepting Router Advertisements on All IPv6 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv6.conf.all.accept_redirects%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv6_conf_all_accept_redirects.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv6.conf.all.accept_redirects kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv6.conf.all.accept_redirects=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv6.conf.all.accept_redirects = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_redirects",
      "instructions": "The runtime status of the net.ipv6.conf.all.accept_redirects kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv6.conf.all.accept_redirects\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "sysctl-net-ipv6-conf-all-accept-redirects",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);CM-6(b);CM-6.1(iv)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),CM-6(b),CM-6.1(iv)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv6-conf-all-accept-redirects",
        "namespace": "openshift-compliance",
        "resourceVersion": "78103",
        "uid": "197cfd31-4ac4-4abf-8339-88eba1308c2f"
      },
      "rationale": "An illicit ICMP redirect message could result in a man-in-the-middle attack.",
      "severity": "medium",
      "title": "Disable Accepting ICMP Redirects for All IPv6 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv6.conf.all.accept_source_route%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv6_conf_all_accept_source_route.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv6.conf.all.accept_source_route kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv6.conf.all.accept_source_route=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv6.conf.all.accept_source_route = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_source_route",
      "instructions": "The runtime status of the net.ipv6.conf.all.accept_source_route kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv6.conf.all.accept_source_route\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "sysctl-net-ipv6-conf-all-accept-source-route",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv6-conf-all-accept-source-route",
        "namespace": "openshift-compliance",
        "resourceVersion": "78105",
        "uid": "bde882df-7176-408d-a76c-c84c1583927a"
      },
      "rationale": "Source-routed packets allow the source of the packet to suggest routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the forwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and the system is functioning as a router.\n\nAccepting source-routed packets in the IPv6 protocol has few legitimate uses. It should be disabled unless it is absolutely required.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv6 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To disable support for ( ipv6 ) addressing on all interface add the following line to /etc/sysctl.d/ipv6.conf (or another file in /etc/sysctl.d ):\n\nnet.ipv6.conf.all.disable_ipv6 = 1\n\nThis disables IPv6 on all network interfaces as other services and system functionality require the IPv6 stack loaded to work.",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_disable_ipv6",
      "instructions": "If the system uses IPv6, this is not applicable.\n\nIf the system is configured to prevent the usage of the ipv6 on\nnetwork interfaces, it will contain a line of the form:\nnet.ipv6.conf.all.disable_ipv6 = 1\nSuch lines may be inside any file in the /etc/sysctl.d directory.\nThis permits insertion of the IPv6 kernel module (which other parts of the\nsystem expect to be present), but otherwise keeps all network interfaces\nfrom using IPv6. Run the following command to search for such lines in all\nfiles in /etc/sysctl.d:\n$ grep -r ipv6 /etc/sysctl.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sysctl-net-ipv6-conf-all-disable-ipv6",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv6-conf-all-disable-ipv6",
        "namespace": "openshift-compliance",
        "resourceVersion": "78096",
        "uid": "0c97a3f8-a06c-4c25-af23-571b3f691918"
      },
      "rationale": "Any unnecessary network stacks - including IPv6 - should be disabled, to reduce the vulnerability to exploitation.",
      "severity": "medium",
      "title": "Disable IPv6 Addressing on All IPv6 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv6.conf.default.accept_ra%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv6_conf_default_accept_ra.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv6.conf.default.accept_ra kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv6.conf.default.accept_ra=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv6.conf.default.accept_ra = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_ra",
      "instructions": "The runtime status of the net.ipv6.conf.default.accept_ra kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv6.conf.default.accept_ra\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "sysctl-net-ipv6-conf-default-accept-ra",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv6-conf-default-accept-ra",
        "namespace": "openshift-compliance",
        "resourceVersion": "78107",
        "uid": "d84cbb28-f7aa-4058-aca8-03096937aea2"
      },
      "rationale": "An illicit router advertisement message could result in a man-in-the-middle attack.",
      "severity": "medium",
      "title": "Disable Accepting Router Advertisements on all IPv6 Interfaces by Default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv6.conf.default.accept_redirects%20%3D%200%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv6_conf_default_accept_redirects.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv6.conf.default.accept_redirects kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv6.conf.default.accept_redirects=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv6.conf.default.accept_redirects = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_redirects",
      "instructions": "The runtime status of the net.ipv6.conf.default.accept_redirects kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv6.conf.default.accept_redirects\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-high,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "sysctl-net-ipv6-conf-default-accept-redirects",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv6-conf-default-accept-redirects",
        "namespace": "openshift-compliance",
        "resourceVersion": "78109",
        "uid": "1bb565fb-0b91-4f5f-9279-d9730b074d10"
      },
      "rationale": "An illicit ICMP redirect message could result in a man-in-the-middle attack.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv6 Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,net.ipv6.conf.default.accept_source_route%3D0%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_net_ipv6_conf_default_accept_source_route.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the net.ipv6.conf.default.accept_source_route kernel parameter, run the following command:\n\n$ sudo sysctl -w net.ipv6.conf.default.accept_source_route=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nnet.ipv6.conf.default.accept_source_route = 0",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_source_route",
      "instructions": "The runtime status of the net.ipv6.conf.default.accept_source_route kernel parameter can be queried\nby running the following command:\n$ sysctl net.ipv6.conf.default.accept_source_route\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high,rhcos4-moderate,rhcos4-anssi-bp28-enhanced,rhcos4-high-rev-4,rhcos4-anssi-bp28-high,rhcos4-moderate-rev-4,rhcos4-anssi-bp28-intermediary,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "sysctl-net-ipv6-conf-default-accept-source-route",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a);CM-6(b);CM-6.1(iv)",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.4.3",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a),CM-6(b),CM-6.1(iv),Req-1.4.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv6-conf-default-accept-source-route",
        "namespace": "openshift-compliance",
        "resourceVersion": "78112",
        "uid": "b012e1f9-6832-45c9-8ea4-da1cbabe18da"
      },
      "rationale": "Source-routed packets allow the source of the packet to suggest routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the forwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and the system is functioning as a router. Accepting source-routed packets in the IPv6 protocol has few legitimate uses. It should be disabled unless it is absolutely required.",
      "severity": "medium",
      "title": "Disable Kernel Parameter for Accepting Source-Routed Packets on IPv6 Interfaces by Default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To disable support for ( ipv6 ) addressing on interfaces by default add the following line to /etc/sysctl.d/ipv6.conf (or another file in /etc/sysctl.d ):\n\nnet.ipv6.conf.default.disable_ipv6 = 1\n\nThis disables IPv6 on network interfaces by default as other services and system functionality require the IPv6 stack loaded to work.",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_disable_ipv6",
      "instructions": "If the system uses IPv6, this is not applicable.\n\nIf the system is configured to prevent the usage of the ipv6 on\nnetwork interfaces, it will contain a line of the form:\nnet.ipv6.conf.default.disable_ipv6 = 1\nSuch lines may be inside any file in the /etc/sysctl.d directory.\nThis permits insertion of the IPv6 kernel module (which other parts of the\nsystem expect to be present), but otherwise keeps network interfaces\nfrom using IPv6. Run the following command to search for such lines in all\nfiles in /etc/sysctl.d:\n$ grep -r ipv6 /etc/sysctl.d",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sysctl-net-ipv6-conf-default-disable-ipv6",
          "control.compliance.openshift.io/NIST-800-53": "CM-7(a);CM-7(b);CM-6(a)",
          "policies.open-cluster-management.io/controls": "CM-7(a),CM-7(b),CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:02:59Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-net-ipv6-conf-default-disable-ipv6",
        "namespace": "openshift-compliance",
        "resourceVersion": "78098",
        "uid": "df392406-f958-48a4-97f3-81280faa7bb2"
      },
      "rationale": "Any unnecessary network stacks - including IPv6 - should be disabled, to reduce the vulnerability to exploitation.",
      "severity": "medium",
      "title": "Disable IPv6 Addressing on IPv6 Interfaces by Default"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,user.max_user_namespaces%20%3D%200%0A"
                      },
                      "mode": 420,
                      "overwrite": true,
                      "path": "/etc/sysctl.d/75-sysctl_user_max_user_namespaces.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To set the runtime status of the user.max_user_namespaces kernel parameter, run the following command:\n\n$ sudo sysctl -w user.max_user_namespaces=0\n\nTo make sure that the setting is persistent, add the following line to a file in the directory /etc/sysctl.d :\n\nuser.max_user_namespaces = 0\n\nWhen containers are deployed on the machine, the value should be set to large non-zero value.",
      "id": "xccdf_org.ssgproject.content_rule_sysctl_user_max_user_namespaces",
      "instructions": "Verify that Red Hat Enterprise Linux CoreOS 4 disables the use of user namespaces with the following commands:\n\nNote: User namespaces are used primarily for Linux containers. If containers are in use, this requirement is not applicable.\n\nThe runtime status of the user.max_user_namespaces kernel parameter can be queried\nby running the following command:\n$ sysctl user.max_user_namespaces\n0.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "sysctl-user-max-user-namespaces",
          "control.compliance.openshift.io/NIST-800-53": "SC-39;CM-6(a)",
          "policies.open-cluster-management.io/controls": "SC-39,CM-6(a)",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:14Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-sysctl-user-max-user-namespaces",
        "namespace": "openshift-compliance",
        "resourceVersion": "78379",
        "uid": "16f9ec05-9e87-4d2a-96cb-29ff04d16d72"
      },
      "rationale": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or system objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors. User namespaces are used primarily for Linux containers. The value 0 disallows the use of user namespaces.",
      "severity": "medium",
      "title": "Disable the use of user namespaces",
      "warning": "It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or system objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors. User namespaces are used primarily for Linux containers. The value 0 disallows the use of user namespaces."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "The logrotate timer can be enabled with the following command:\n\n$ sudo systemctl enable logrotate.timer",
      "id": "xccdf_org.ssgproject.content_rule_timer_logrotate_enabled",
      "instructions": "Run the following command to determine the current status of the logrotate timer: $ sudo systemctl is-active logrotate.timer If the timer is running, it should return the following: active",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-anssi-bp28-enhanced,rhcos4-anssi-bp28-high",
          "compliance.openshift.io/rule": "timer-logrotate-enabled",
          "control.compliance.openshift.io/NIST-800-53": "CM-6(a)",
          "control.compliance.openshift.io/PCI-DSS": "Req-10.7",
          "policies.open-cluster-management.io/controls": "CM-6(a),Req-10.7",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:02:55Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-timer-logrotate-enabled",
        "namespace": "openshift-compliance",
        "resourceVersion": "78010",
        "uid": "cea5f2d6-1ad4-45a4-966c-4a7ee3b94ae9"
      },
      "rationale": "Log files that are not properly rotated run the risk of growing so large that they fill up the /var/log partition. Valuable logging information could be lost if the /var/log partition becomes full.",
      "severity": "medium",
      "title": "Enable logrotate Timer"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To allow authorization of Human Interface Devices (keyboard, mouse) by USBGuard daemon, add the line allow with-interface match-all { 03:*:* } to /etc/usbguard/rules.conf.",
      "id": "xccdf_org.ssgproject.content_rule_usbguard_allow_hid",
      "instructions": "To verify that USB Human Interface Devices will be authorized by the USBGuard daemon,\nrun the following command:\n$ sudo grep allow /etc/usbguard/rules.conf\nThe output lines should include\nallow with-interface match-all { 03:*:* }",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "usbguard-allow-hid"
        },
        "creationTimestamp": "2024-03-05T15:03:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-usbguard-allow-hid",
        "namespace": "openshift-compliance",
        "resourceVersion": "78585",
        "uid": "a33ace1a-1fcf-4952-9edd-24d2867af199"
      },
      "rationale": "Without allowing Human Interface Devices, it might not be possible to interact with the system.",
      "severity": "medium",
      "title": "Authorize Human Interface Devices in USBGuard daemon",
      "warning": "Without allowing Human Interface Devices, it might not be possible to interact with the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "availableFixes": [
        {
          "fixObject": {
            "apiVersion": "machineconfiguration.openshift.io/v1",
            "kind": "MachineConfig",
            "metadata": {
              "annotations": {
                "complianceascode.io/depends-on": "xccdf_org.ssgproject.content_rule_package_usbguard_installed"
              }
            },
            "spec": {
              "config": {
                "ignition": {
                  "version": "3.1.0"
                },
                "storage": {
                  "files": [
                    {
                      "contents": {
                        "source": "data:,{{ %0Aallow%20with-interface%20match-all%20%7B%2003%3A%2A%3A%2A%2009%3A00%3A%2A%20%7D }}"
                      },
                      "mode": 384,
                      "overwrite": true,
                      "path": "/etc/usbguard/rules.d/75-hid-and-hub.conf"
                    }
                  ]
                }
              }
            }
          }
        }
      ],
      "checkType": "Node",
      "description": "To allow authorization of USB devices combining human interface device and hub capabilities by USBGuard daemon, add the line allow with-interface match-all { 03:*:* 09:00:* } to /etc/usbguard/rules.conf.",
      "id": "xccdf_org.ssgproject.content_rule_usbguard_allow_hid_and_hub",
      "instructions": "To verify that USB Human Interface Devices and hubs will be authorized by the USBGuard daemon,\nrun the following command:\n$ sudo grep allow /etc/usbguard/rules.conf\nThe output lines should include\nallow with-interface match-all { 03:*:* 09:00:* }",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-stig-v1r1,rhcos4-stig,rhcos4-moderate-rev-4,rhcos4-nerc-cip",
          "compliance.openshift.io/rule": "usbguard-allow-hid-and-hub",
          "control.compliance.openshift.io/NIST-800-53": "CM-8(3);IA-3",
          "policies.open-cluster-management.io/controls": "CM-8(3),IA-3",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-usbguard-allow-hid-and-hub",
        "namespace": "openshift-compliance",
        "resourceVersion": "78588",
        "uid": "7442efeb-257f-4af6-a698-f216a515f0ac"
      },
      "rationale": "Without allowing Human Interface Devices, it might not be possible to interact with the system. Without allowing hubs, it might not be possible to use any USB devices on the system.",
      "severity": "medium",
      "title": "Authorize Human Interface Devices and USB hubs in USBGuard daemon",
      "warning": "Without allowing Human Interface Devices, it might not be possible to interact with the system. Without allowing hubs, it might not be possible to use any USB devices on the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To allow authorization of USB hub devices by USBGuard daemon, add line allow with-interface match-all { 09:00:* } to /etc/usbguard/rules.conf.",
      "id": "xccdf_org.ssgproject.content_rule_usbguard_allow_hub",
      "instructions": "To verify that USB hubs will be authorized by the USBGuard daemon,\nrun the following command:\n$ sudo grep allow /etc/usbguard/rules.conf\nOne of the output lines should be\nallow with-interface match-all { 09:00:* }",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "usbguard-allow-hub"
        },
        "creationTimestamp": "2024-03-05T15:03:27Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-usbguard-allow-hub",
        "namespace": "openshift-compliance",
        "resourceVersion": "78589",
        "uid": "9ad31bd7-71e0-44fe-ae76-4899c9aabfac"
      },
      "rationale": "Without allowing hubs, it might not be possible to use any USB devices on the system.",
      "severity": "medium",
      "title": "Authorize USB hubs in USBGuard daemon",
      "warning": "Without allowing hubs, it might not be possible to use any USB devices on the system."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "Some machines that include built-in wireless support offer the ability to disable the device through the BIOS. This is hardware-specific; consult your hardware manual or explore the BIOS setup during boot.",
      "id": "xccdf_org.ssgproject.content_rule_wireless_disable_in_bios",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-moderate-rev-4,rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate",
          "compliance.openshift.io/rule": "wireless-disable-in-bios",
          "control.compliance.openshift.io/NIST-800-53": "AC-18(a);AC-18(3);CM-7(a);CM-7(b);CM-6(a);MP-7",
          "policies.open-cluster-management.io/controls": "AC-18(a),AC-18(3),CM-7(a),CM-7(b),CM-6(a),MP-7",
          "policies.open-cluster-management.io/standards": "NIST-800-53"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-wireless-disable-in-bios",
        "namespace": "openshift-compliance",
        "resourceVersion": "78195",
        "uid": "d2da2f24-18e1-4b97-819f-173d684dc98a"
      },
      "rationale": "Disabling wireless support in the BIOS prevents easy activation of the wireless interface, generally requiring administrators to reboot the system first.",
      "severity": "unknown",
      "title": "Disable WiFi or Bluetooth in BIOS"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Deactivating wireless network interfaces should prevent normal usage of the wireless capability.\n\nConfigure the system to disable all wireless network interfaces with the following command:\n\n$ sudo nmcli radio all off",
      "id": "xccdf_org.ssgproject.content_rule_wireless_disable_interfaces",
      "instructions": "Verify that there are no wireless interfaces configured on the system\nwith the following command:\n\nNote: This requirement is Not Applicable for systems that do not have physical wireless network radios.\n\n$ nmcli device status\nDEVICE          TYPE      STATE         CONNECTION\nvirbr0          bridge    connected     virbr0\nwlp7s0          wifi      connected     wifiSSID\nenp6s0          ethernet  disconnected  --\np2p-dev-wlp7s0  wifi-p2p  disconnected  --\nlo              loopback  unmanaged     --\nvirbr0-nic      tun       unmanaged     --",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/profiles": "rhcos4-nerc-cip,rhcos4-high-rev-4,rhcos4-high,rhcos4-moderate,rhcos4-moderate-rev-4",
          "compliance.openshift.io/rule": "wireless-disable-interfaces",
          "control.compliance.openshift.io/NIST-800-53": "AC-18(a);AC-18(3);CM-7(a);CM-7(b);CM-6(a);MP-7",
          "control.compliance.openshift.io/PCI-DSS": "Req-1.3.3",
          "policies.open-cluster-management.io/controls": "AC-18(a),AC-18(3),CM-7(a),CM-7(b),CM-6(a),MP-7,Req-1.3.3",
          "policies.open-cluster-management.io/standards": "NIST-800-53,PCI-DSS"
        },
        "creationTimestamp": "2024-03-05T15:03:03Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-wireless-disable-interfaces",
        "namespace": "openshift-compliance",
        "resourceVersion": "78197",
        "uid": "bf403a1f-3f02-40f1-b9f8-2d0ca1860f35"
      },
      "rationale": "The use of wireless networking can introduce many different attack vectors into the organization's network. Common attack vectors such as malicious association and ad hoc networks will allow an attacker to spoof a wireless access point (AP), allowing validated systems to connect to the malicious AP and enabling the attacker to monitor and record network traffic. These malicious APs can also serve to create a man-in-the-middle attack or be used to create a denial of service to valid network resources.",
      "severity": "medium",
      "title": "Deactivate Wireless Network Interfaces"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To ensure all processes can be audited, even those which start prior to the audit daemon, check that all boot entries in /boot/loader/entries/*.conf have audit=1 included in its options.\n\nTo ensure that new kernels and boot entries continue to enable audit, add audit=1 to /etc/kernel/cmdline.",
      "id": "xccdf_org.ssgproject.content_rule_zipl_audit_argument",
      "instructions": "To check that audit is enabled at boot time, check all boot entries with following command:\nsudo grep -L \"^options\\s+.*\\baudit=1\\b\" /boot/loader/entries/*.conf\nNo line should be returned, each line returned is a boot entry that doesn't enable audit.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "zipl-audit-argument"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-zipl-audit-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77831",
        "uid": "5a19e5b8-84bf-4c7b-8f1f-157a8b274a71"
      },
      "rationale": "Each process on the system carries an \"auditable\" flag which indicates whether its activities can be audited. Although auditd takes care of enabling this for all processes which launch after it does, adding the kernel argument ensures it is set for every process during boot.",
      "severity": "medium",
      "title": "Enable Auditing to Start Prior to the Audit Daemon in zIPL"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To improve the kernel capacity to queue all log events, even those which start prior to the audit daemon, check that all boot entries in /boot/loader/entries/*.conf have audit_backlog_limit=8192 included in its options.\n\nTo ensure that new kernels and boot entries continue to extend the audit log events queue, add audit_backlog_limit=8192 to /etc/kernel/cmdline.",
      "id": "xccdf_org.ssgproject.content_rule_zipl_audit_backlog_limit_argument",
      "instructions": "To check that all boot entries extend the backlog limit;\nCheck that all boot entries extend the log events queue:\nsudo grep -L \"^options\\s+.*\\baudit_backlog_limit=8192\\b\" /boot/loader/entries/*.conf\nNo line should be returned, each line returned is a boot entry that does not extend the log events queue.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "zipl-audit-backlog-limit-argument"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-zipl-audit-backlog-limit-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77833",
        "uid": "f8ba0f54-d6bf-48ef-b5ac-07de57a8abe1"
      },
      "rationale": "audit_backlog_limit sets the queue length for audit events awaiting transfer to the audit daemon. Until the audit daemon is up and running, all log messages are stored in this queue. If the queue is overrun during boot process, the action defined by audit failure flag is taken.",
      "severity": "medium",
      "title": "Extend Audit Backlog Limit for the Audit Daemon in zIPL"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Ensure that zIPL boot entries fully adheres to Boot Loader Specification (BLS) by checking that /etc/zipl.conf doesn't contain image =.",
      "id": "xccdf_org.ssgproject.content_rule_zipl_bls_entries_only",
      "instructions": "Check that no boot image file is specified in /etc/zipl.conf:\ngrep -R \"^image\\s*=\" /etc/zipl.conf\nNo line should be returned, if a line is returned non BLS compliant boot entries are configured for zIPL.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "zipl-bls-entries-only"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-zipl-bls-entries-only",
        "namespace": "openshift-compliance",
        "resourceVersion": "77835",
        "uid": "9c36558c-5480-4b18-a81c-315365921953"
      },
      "rationale": "Red Hat Enterprise Linux CoreOS 4 adheres to Boot Loader Specification (BLS) and is the prefered method of configuration.",
      "severity": "medium",
      "title": "Ensure all zIPL boot entries are BLS compliant",
      "warning": "Red Hat Enterprise Linux CoreOS 4 adheres to Boot Loader Specification (BLS) and is the prefered method of configuration."
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "Make sure that /boot/bootmap is up to date.\n\nEvery time a boot entry or zIPL configuration is changed /boot/bootmap needs to be updated to reflect the changes.\n\nRun zipl command to generate an updated /boot/bootmap.",
      "id": "xccdf_org.ssgproject.content_rule_zipl_bootmap_is_up_to_date",
      "instructions": "Make sure that /boot/bootmap is newer than /boot/loader/entries/*.conf\nand /etc/zipl.conf:\nfind /boot/loader/entries/*.conf /etc/zipl.conf -newer /boot/bootmap\nNo line should be returned, if a line is returned /boot/bootmap is outdated and needs to be regenerated.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "zipl-bootmap-is-up-to-date"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-zipl-bootmap-is-up-to-date",
        "namespace": "openshift-compliance",
        "resourceVersion": "77844",
        "uid": "d8982fd9-de68-465a-8cdb-20180adfd02b"
      },
      "rationale": "The file /boot/bootmap contains all boot data, keeping it up to date is crucial to boot correct kernel and options.",
      "severity": "medium",
      "title": "Ensure zIPL bootmap is up to date"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "description": "To ensure SELinux is not disabled at boot time, check that no boot entry in /boot/loader/entries/*.conf has selinux=0 included in its options.",
      "id": "xccdf_org.ssgproject.content_rule_zipl_enable_selinux",
      "instructions": "To check that SELinux is not disabled at boot time;\nCheck that no boot entry disables selinux:\nsudo grep -L \"^options\\s+.*\\bselinux=0\\b\" /boot/loader/entries/*.conf\nNo line should be returned, each line returned is a boot entry that disables SELinux.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "zipl-enable-selinux"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-zipl-enable-selinux",
        "namespace": "openshift-compliance",
        "resourceVersion": "77845",
        "uid": "cd3b7d46-a766-4ed6-94b9-89e704e05903"
      },
      "rationale": "Disabling a major host protection feature, such as SELinux, at boot time prevents it from confining system services at boot time. Further, it increases the chances that it will remain off during system operation.",
      "severity": "medium",
      "title": "Ensure SELinux Not Disabled in zIPL"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable poisoning of free pages, check that all boot entries in /boot/loader/entries/*.conf have page_poison=1 included in its options.\n\nTo ensure that new kernels and boot entries continue to enable page poisoning, add page_poison=1 to /etc/kernel/cmdline.",
      "id": "xccdf_org.ssgproject.content_rule_zipl_page_poison_argument",
      "instructions": "To check that page poisoning is enabled at boot time, check all boot entries with following command:\nsudo grep -L \"^options\\s+.*\\bpage_poison=1\\b\" /boot/loader/entries/*.conf\nNo line should be returned, each line returned is a boot entry that doesn't enable page poisoning.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "zipl-page-poison-argument"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-zipl-page-poison-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77848",
        "uid": "4d8953e9-c1c3-4ecc-9621-91a64f76ae09"
      },
      "rationale": "Poisoning writes an arbitrary value to freed pages, so any modification or reference to that page after being freed or before being initialized will be detected and prevented. This prevents many types of use-after-free vulnerabilities at little performance cost. Also prevents leak of data and detection of corrupted memory.",
      "severity": "medium",
      "title": "Enable page allocator poisoning in zIPL"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To enable poisoning of SLUB/SLAB objects, check that all boot entries in /boot/loader/entries/*.conf have slub_debug=P included in its options.\n\nTo ensure that new kernels and boot entries continue to enable poisoning of SLUB/SLAB objects, add slub_debug=P to /etc/kernel/cmdline.",
      "id": "xccdf_org.ssgproject.content_rule_zipl_slub_debug_argument",
      "instructions": "To check that SLUB/SLAB poisoning is enabled, check all boot entries with following command;\nsudo grep -L \"^options\\s+.*\\bslub_debug=P\\b\" /boot/loader/entries/*.conf\nNo line should be returned, each line returned is a boot entry that does not enable poisoning.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "zipl-slub-debug-argument"
        },
        "creationTimestamp": "2024-03-05T15:02:49Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-zipl-slub-debug-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77850",
        "uid": "cd61a6ed-f8c7-4b0c-9d49-8d2932fabf46"
      },
      "rationale": "Poisoning writes an arbitrary value to freed objects, so any modification or reference to that object after being freed or before being initialized will be detected and prevented. This prevents many types of use-after-free vulnerabilities at little performance cost. Also prevents leak of data and detection of corrupted memory.",
      "severity": "medium",
      "title": "Enable SLUB/SLAB allocator poisoning in zIPL"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "systemd's debug-shell service is intended to diagnose systemd related boot issues with various systemctl commands. Once enabled and following a system reboot, the root shell will be available on tty9 which is access by pressing CTRL-ALT-F9. The debug-shell service should only be used for systemd related issues and should otherwise be disabled.\n\nBy default, the debug-shell systemd service is already disabled. Ensure the debug-shell is not enabled by the systemd.debug-shel=1 boot paramenter option. Check that not boot entries in /boot/loader/entries/*.conf have systemd.debug-shell=1 included in its options.\n\nTo ensure that new kernels and boot entries don't enable the debug-shell, check that systemd.debug-shell=1 is not present in /etc/kernel/cmdline.",
      "id": "xccdf_org.ssgproject.content_rule_zipl_systemd_debug-shell_argument_absent",
      "instructions": "Ensure that debug-shell service is not enabled with the following command:\nsudo grep -L \"^options\\s+.*\\bsystemd.debug-shell=1\\b\" /boot/loader/entries/*.conf\nNo line should be returned, each line returned is a boot entry that enables the debug-shell.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "zipl-systemd-debug-shell-argument-absent"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-zipl-systemd-debug-shell-argument-absent",
        "namespace": "openshift-compliance",
        "resourceVersion": "77853",
        "uid": "d293d99a-2319-4f10-b467-4aade2396a3b"
      },
      "rationale": "This prevents attackers with physical access from trivially bypassing security on the machine through valid troubleshooting configurations and gaining root access when the system is rebooted.",
      "severity": "medium",
      "title": "Ensure debug-shell service is not enabled in zIPL"
    },
    {
      "apiVersion": "compliance.openshift.io/v1alpha1",
      "checkType": "Node",
      "description": "To disable use of virtual syscalls, check that all boot entries in /boot/loader/entries/*.conf have vsyscall=none included in its options.\n\nTo ensure that new kernels and boot entries continue to disable virtual syscalls, add vsyscall=none to /etc/kernel/cmdline.",
      "id": "xccdf_org.ssgproject.content_rule_zipl_vsyscall_argument",
      "instructions": "To check that virtual syscalls are disabled at boot time, check all boot entries with following command:\nsudo grep -L \"^options\\s+.*\\bvsyscall=none\\b\" /boot/loader/entries/*.conf\nNo line should be returned, each line returned is a boot entry that doesn't disable virtual syscalls.",
      "kind": "Rule",
      "metadata": {
        "annotations": {
          "compliance.openshift.io/image-digest": "pb-rhcos442znq",
          "compliance.openshift.io/rule": "zipl-vsyscall-argument"
        },
        "creationTimestamp": "2024-03-05T15:02:50Z",
        "generation": 1,
        "labels": {
          "compliance.openshift.io/profile-bundle": "rhcos4"
        },
        "name": "rhcos4-zipl-vsyscall-argument",
        "namespace": "openshift-compliance",
        "resourceVersion": "77856",
        "uid": "97ad275e-7968-4e1c-ba5f-c5e06afb0a91"
      },
      "rationale": "Virtual Syscalls provide an opportunity of attack for a user who has control of the return instruction pointer.",
      "severity": "medium",
      "title": "Disable vsyscalls in zIPL"
    }
  ],
  "kind": "List",
  "metadata": {
    "resourceVersion": ""
  }
}
